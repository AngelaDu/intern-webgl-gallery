{"version":3,"file":"static/chunks/954-5448d0f24a47e4cf.js","mappings":"iGAWA,MAAMA,EAELC,YAAaC,EAAQC,EAAQC,EAAUC,EAAWC,EAAY,OAM7DC,KAAKL,OAASA,EAMdK,KAAKJ,OAASA,EAMdI,KAAKH,SAAWA,EAOhBG,KAAKC,WAAY,EAMjBD,KAAKE,aAAeF,KAAKG,WAMzBH,KAAKI,WAAaC,SAASC,cAAe,OAC1CN,KAAKI,WAAWG,UAAUC,IAAK,cAC/BR,KAAKI,WAAWG,UAAUC,IAAKV,GAM/BE,KAAKS,MAAQJ,SAASC,cAAe,OACrCN,KAAKS,MAAMF,UAAUC,IAAK,QAE1Bf,EAAWiB,WAAajB,EAAWiB,YAAc,EACjDV,KAAKS,MAAME,GAAK,mBAAkBlB,EAAWiB,WAM7CV,KAAKY,QAAUP,SAASC,cAAeP,GACvCC,KAAKY,QAAQL,UAAUC,IAAK,UAM5BR,KAAKa,SAAWb,KAAKY,QAErBZ,KAAKI,WAAWU,YAAad,KAAKS,OAClCT,KAAKI,WAAWU,YAAad,KAAKY,SAElCZ,KAAKL,OAAOoB,SAASC,KAAMhB,MAC3BA,KAAKL,OAAOsB,YAAYD,KAAMhB,MAE9BA,KAAKL,OAAOuB,UAAUJ,YAAad,KAAKI,YAExCJ,KAAKmB,gBAAkBnB,KAAKmB,gBAAgBC,KAAMpB,MAElDA,KAAKqB,KAAMxB,GASZwB,KAAMA,GAOL,OAFArB,KAAKsB,MAAQD,EACbrB,KAAKS,MAAMc,UAAYF,EAChBrB,KAiBRwB,SAAUC,GAOT,OADAzB,KAAK0B,UAAYD,EACVzB,KAOR2B,gBAEC3B,KAAKL,OAAOgC,cAAe3B,WAEH4B,IAAnB5B,KAAK0B,WACT1B,KAAK0B,UAAUG,KAAM7B,KAAMA,KAAKG,YAGjCH,KAAK8B,UAAW,EAgBjBC,eAAgBN,GAOf,OADAzB,KAAKgC,gBAAkBP,EAChBzB,KAORiC,sBAEMjC,KAAK8B,WAET9B,KAAKL,OAAOsC,oBAAqBjC,WAEH4B,IAAzB5B,KAAKgC,iBACThC,KAAKgC,gBAAgBH,KAAM7B,KAAMA,KAAKG,aAKxCH,KAAK8B,UAAW,EAQjBI,QAGC,OAFAlC,KAAKmC,SAAUnC,KAAKE,cACpBF,KAAKiC,sBACEjC,KAYRoC,OAAQC,GAAU,GACjB,OAAOrC,KAAKsC,SAAUD,GAYvBC,QAASC,GAAW,GAEnB,OAAKA,IAAavC,KAAKC,YAEvBD,KAAKC,UAAYsC,EAEjBvC,KAAKI,WAAWG,UAAUiC,OAAQ,WAAYD,GAC9CvC,KAAKa,SAAS4B,gBAAiB,WAAYF,IALDvC,KAsC3C0C,QAASA,GACR,MAAMC,EAAa3C,KAAKL,OAAOa,IAAKR,KAAKJ,OAAQI,KAAKH,SAAU6C,GAGhE,OAFAC,EAAWtB,KAAMrB,KAAKsB,OACtBtB,KAAK4C,UACED,EAQRE,IAAKA,GACJ,OAAO7C,KAQR8C,IAAKA,GACJ,OAAO9C,KAQR+C,KAAMA,GACL,OAAO/C,KAQRgD,OAAQA,GAAS,GAkBhB,OAXAhD,KAAKiD,WAAaD,OAEcpB,IAA3B5B,KAAKkD,oBACTC,qBAAsBnD,KAAKkD,mBAC3BlD,KAAKkD,uBAAoBtB,GAGrB5B,KAAKiD,YACTjD,KAAKmB,kBAGCnB,KAIRmB,kBACCnB,KAAKkD,kBAAoBE,sBAAuBpD,KAAKmB,iBACrDnB,KAAKqD,gBAONlD,WACC,OAAOH,KAAKJ,OAAQI,KAAKH,UAQ1BsC,SAAUmB,GAIT,OAHAtD,KAAKJ,OAAQI,KAAKH,UAAayD,EAC/BtD,KAAK2B,gBACL3B,KAAKqD,gBACErD,KAQRqD,gBACC,OAAOrD,KAGRuD,KAAMD,GAGL,OAFAtD,KAAKmC,SAAUmB,GACftD,KAAKiC,sBACEjC,KAGRwD,OACC,OAAOxD,KAAKG,WAMbyC,UACC5C,KAAKL,OAAOoB,SAAS0C,OAAQzD,KAAKL,OAAOoB,SAAS2C,QAAS1D,MAAQ,GACnEA,KAAKL,OAAOsB,YAAYwC,OAAQzD,KAAKL,OAAOsB,YAAYyC,QAAS1D,MAAQ,GACzEA,KAAKL,OAAOuB,UAAUyC,YAAa3D,KAAKI,YASzCwD,kBAAmBC,GAClBA,EAAGC,iBAAkB,WAAWC,GAAKA,EAAEC,oBACvCH,EAAGC,iBAAkB,SAASC,GAAKA,EAAEC,qBAKvC,MAAMC,UAA0BxE,EAE/BC,YAAaC,EAAQC,EAAQC,GAE5BqE,MAAOvE,EAAQC,EAAQC,EAAU,UAAW,SAE5CG,KAAKmE,OAAS9D,SAASC,cAAe,SACtCN,KAAKmE,OAAOC,aAAc,OAAQ,YAClCpE,KAAKmE,OAAOC,aAAc,kBAAmBpE,KAAKS,MAAME,IAExDX,KAAKY,QAAQE,YAAad,KAAKmE,QAE/BnE,KAAKmE,OAAOL,iBAAkB,UAAU,KACvC9D,KAAKmC,SAAUnC,KAAKmE,OAAOE,SAC3BrE,KAAKiC,yBAGNjC,KAAKa,SAAWb,KAAKmE,OAErBnE,KAAKqD,gBAINA,gBAEC,OADArD,KAAKmE,OAAOE,QAAUrE,KAAKG,WACpBH,MAKT,SAASsE,EAAsBC,GAE9B,IAAIC,EAAOC,EAkBX,OAhBKD,EAAQD,EAAOC,MAAO,0BAE1BC,EAASD,EAAO,IAELA,EAAQD,EAAOC,MAAO,+CAEjCC,EAASC,SAAUF,EAAO,IAAMG,SAAU,IAAKC,SAAU,EAAG,GACzDF,SAAUF,EAAO,IAAMG,SAAU,IAAKC,SAAU,EAAG,GACnDF,SAAUF,EAAO,IAAMG,SAAU,IAAKC,SAAU,EAAG,IAE3CJ,EAAQD,EAAOC,MAAO,0CAEjCC,EAASD,EAAO,GAAMA,EAAO,GAAMA,EAAO,GAAMA,EAAO,GAAMA,EAAO,GAAMA,EAAO,MAI7EC,GACG,IAAMA,EAOf,MAAMI,EAAS,CACdC,aAAa,EACbN,MAAOO,GAAkB,kBAANA,EACnBC,cAAeV,EACfW,YAAaX,GAGRY,EAAM,CACXJ,aAAa,EACbN,MAAOO,GAAkB,kBAANA,EACnBC,cAAeT,GAAUG,SAAUH,EAAOY,UAAW,GAAK,IAC1DF,YAAa3B,GAAS,IAAMA,EAAMqB,SAAU,IAAKC,SAAU,EAAG,IAGzDQ,EAAQ,CACbN,aAAa,EACbN,MAAOa,MAAMC,QACbN,cAAeT,EAAQgB,EAAQC,EAAW,GAEzC,MAAMC,EAAMP,EAAIF,cAAeT,GAE/BgB,EAAQ,IAAQE,GAAO,GAAK,KAAQ,IAAMD,EAC1CD,EAAQ,IAAQE,GAAO,EAAI,KAAQ,IAAMD,EACzCD,EAAQ,IAAc,IAANE,GAAc,IAAMD,GAGrCP,YAAW,EAAIS,EAAGC,EAAGC,GAAKJ,EAAW,IAQ7BN,EAAID,YAJGS,GAFdF,EAAW,IAAMA,IAEe,GAC7BG,EAAIH,GAAc,EAClBI,EAAIJ,GAAc,IAOjBK,EAAS,CACdf,aAAa,EACbN,MAAOO,GAAKe,OAAQf,KAAQA,EAC5BC,cAAeT,EAAQgB,EAAQC,EAAW,GAEzC,MAAMC,EAAMP,EAAIF,cAAeT,GAE/BgB,EAAOG,GAAMD,GAAO,GAAK,KAAQ,IAAMD,EACvCD,EAAOI,GAAMF,GAAO,EAAI,KAAQ,IAAMD,EACtCD,EAAOK,GAAY,IAANH,GAAc,IAAMD,GAGlCP,YAAW,EAAE,EAAES,EAAC,EAAEC,EAAC,EAAEC,GAAKJ,EAAW,IAQ7BN,EAAID,YAJGS,GAFdF,EAAW,IAAMA,IAEe,GAC7BG,EAAIH,GAAc,EAClBI,EAAIJ,GAAc,IAOjBO,EAAU,CAAElB,EAAQK,EAAKE,EAAOS,GAMtC,MAAMG,UAAwBvG,EAE7BC,YAAaC,EAAQC,EAAQC,EAAU2F,GANxC,IAAyBlC,EAQvBY,MAAOvE,EAAQC,EAAQC,EAAU,SAEjCG,KAAKmE,OAAS9D,SAASC,cAAe,SACtCN,KAAKmE,OAAOC,aAAc,OAAQ,SAClCpE,KAAKmE,OAAOC,aAAc,YAAa,GACvCpE,KAAKmE,OAAOC,aAAc,kBAAmBpE,KAAKS,MAAME,IAExDX,KAAKiG,MAAQ5F,SAASC,cAAe,SACrCN,KAAKiG,MAAM7B,aAAc,OAAQ,QACjCpE,KAAKiG,MAAM7B,aAAc,aAAc,SACvCpE,KAAKiG,MAAM7B,aAAc,kBAAmBpE,KAAKS,MAAME,IAEvDX,KAAKkG,SAAW7F,SAASC,cAAe,OACxCN,KAAKkG,SAAS3F,UAAUC,IAAK,WAE7BR,KAAKkG,SAASpF,YAAad,KAAKmE,QAChCnE,KAAKY,QAAQE,YAAad,KAAKkG,UAC/BlG,KAAKY,QAAQE,YAAad,KAAKiG,OAE/BjG,KAAKmG,SA3BkB7C,EA2BQtD,KAAKE,aA1B9B6F,EAAQK,MAAMC,GAAUA,EAAO7B,MAAOlB,MA2B5CtD,KAAKsG,UAAYd,EAEjBxF,KAAKuG,uBAAyBvG,KAAKwD,OACnCxD,KAAKwG,cAAe,EAEpBxG,KAAKmE,OAAOL,iBAAkB,SAAS,KACtC9D,KAAKyG,uBAAwBzG,KAAKmE,OAAOb,UAG1CtD,KAAKmE,OAAOL,iBAAkB,QAAQ,KACrC9D,KAAKiC,yBAGNjC,KAAKiG,MAAMnC,iBAAkB,SAAS,KACrC,MAAM4C,EAAWpC,EAAsBtE,KAAKiG,MAAM3C,OAC7CoD,GACJ1G,KAAKyG,uBAAwBC,MAI/B1G,KAAKiG,MAAMnC,iBAAkB,SAAS,KACrC9D,KAAKwG,cAAe,EACpBxG,KAAKiG,MAAMU,YAGZ3G,KAAKiG,MAAMnC,iBAAkB,QAAQ,KACpC9D,KAAKwG,cAAe,EACpBxG,KAAKqD,gBACLrD,KAAKiC,yBAGNjC,KAAKa,SAAWb,KAAKiG,MAErBjG,KAAK4D,kBAAmB5D,KAAKiG,OAE7BjG,KAAKqD,gBAINnB,QAEC,OADAlC,KAAKyG,uBAAwBzG,KAAKuG,wBAC3BvG,KAGRyG,uBAAwBnD,GAEvB,GAAKtD,KAAKmG,QAAQrB,YAAc,CAE/B,MAAM8B,EAAW5G,KAAKmG,QAAQnB,cAAe1B,GAC7CtD,KAAKmC,SAAUyE,QAIf5G,KAAKmG,QAAQnB,cAAe1B,EAAOtD,KAAKG,WAAYH,KAAKsG,WACzDtG,KAAK2B,gBACL3B,KAAKqD,gBAMPG,OACC,OAAOxD,KAAKmG,QAAQlB,YAAajF,KAAKG,WAAYH,KAAKsG,WAGxD/C,KAAMD,GAGL,OAFAtD,KAAKyG,uBAAwBnD,GAC7BtD,KAAKiC,sBACEjC,KAGRqD,gBAMC,OALArD,KAAKmE,OAAOb,MAAQtD,KAAKmG,QAAQlB,YAAajF,KAAKG,WAAYH,KAAKsG,WAC9DtG,KAAKwG,eACVxG,KAAKiG,MAAM3C,MAAQtD,KAAKmE,OAAOb,MAAM6B,UAAW,IAEjDnF,KAAKkG,SAASW,MAAMC,gBAAkB9G,KAAKmE,OAAOb,MAC3CtD,MAKT,MAAM+G,UAA2BtH,EAEhCC,YAAaC,EAAQC,EAAQC,GAE5BqE,MAAOvE,EAAQC,EAAQC,EAAU,YAGjCG,KAAKgH,QAAU3G,SAASC,cAAe,UACvCN,KAAKgH,QAAQlG,YAAad,KAAKS,OAC/BT,KAAKY,QAAQE,YAAad,KAAKgH,SAE/BhH,KAAKgH,QAAQlD,iBAAkB,SAASC,IACvCA,EAAEkD,iBACFjH,KAAKG,WAAW0B,KAAM7B,KAAKJ,WAI5BI,KAAKgH,QAAQlD,iBAAkB,cAAc,SAE7C9D,KAAKa,SAAWb,KAAKgH,SAMvB,MAAME,UAAyBzH,EAE9BC,YAAaC,EAAQC,EAAQC,EAAUgD,EAAKC,EAAKC,GAEhDmB,MAAOvE,EAAQC,EAAQC,EAAU,UAEjCG,KAAKmH,aAELnH,KAAK6C,IAAKA,GACV7C,KAAK8C,IAAKA,GAEV,MAAMsE,OAAwBxF,IAATmB,EACrB/C,KAAK+C,KAAMqE,EAAerE,EAAO/C,KAAKqH,mBAAoBD,GAE1DpH,KAAKqD,gBAINR,IAAKA,GAGJ,OAFA7C,KAAKsH,KAAOzE,EACZ7C,KAAKuH,kBACEvH,KAGR8C,IAAKA,GAGJ,OAFA9C,KAAKwH,KAAO1E,EACZ9C,KAAKuH,kBACEvH,KAGR+C,KAAMA,EAAM0E,GAAW,GAGtB,OAFAzH,KAAK0H,MAAQ3E,EACb/C,KAAK2H,cAAgBF,EACdzH,KAGRqD,gBAEC,MAAMC,EAAQtD,KAAKG,WAEnB,GAAKH,KAAK4H,WAAa,CAEtB,IAAIC,GAAYvE,EAAQtD,KAAKsH,OAAWtH,KAAKwH,KAAOxH,KAAKsH,MACzDO,EAAUC,KAAKhF,IAAK,EAAGgF,KAAKjF,IAAKgF,EAAS,IAE1C7H,KAAK+H,MAAMlB,MAAMmB,MAAkB,IAAVH,EAAgB,IAQ1C,OAJM7H,KAAKiI,gBACVjI,KAAKmE,OAAOb,MAAQA,GAGdtD,KAIRmH,aAECnH,KAAKmE,OAAS9D,SAASC,cAAe,SACtCN,KAAKmE,OAAOC,aAAc,OAAQ,UAClCpE,KAAKmE,OAAOC,aAAc,OAAQ,OAClCpE,KAAKmE,OAAOC,aAAc,kBAAmBpE,KAAKS,MAAME,IAExDX,KAAKY,QAAQE,YAAad,KAAKmE,QAE/BnE,KAAKa,SAAWb,KAAKmE,OAErBnE,KAAK4D,kBAAmB5D,KAAKmE,QAE7B,MAaM+D,EAAYC,IAEjB,MAAM7E,EAAQ8E,WAAYpI,KAAKmE,OAAOb,OAEjC+E,MAAO/E,KAEZtD,KAAKsI,mBAAoBhF,EAAQ6E,GAGjCnI,KAAKmE,OAAOb,MAAQtD,KAAKG,aA4B1B,IACCoI,EACAC,EACAC,EACAC,EACAC,EALGC,GAAyB,EAS7B,MAgBMC,EAAc9E,IAEnB,GAAK6E,EAAyB,CAE7B,MAAME,EAAK/E,EAAEgF,QAAUR,EACjBS,EAAKjF,EAAEkF,QAAUT,EAElBV,KAAKoB,IAAKF,GAvBG,GAyBjBjF,EAAEkD,iBACFjH,KAAKmE,OAAOgF,OACZP,GAAyB,EACzB5I,KAAKoJ,mBAAmB,EAAM,aAEnBtB,KAAKoB,IAAKJ,GA9BJ,GAgCjBO,IAOF,IAAMT,EAAyB,CAE9B,MAAMI,EAAKjF,EAAEkF,QAAUR,EAEvBE,GAAaK,EAAKhJ,KAAK0H,MAAQ1H,KAAKsJ,oBAAqBvF,GAIpD2E,EAAYC,EAAY3I,KAAKwH,KACjCmB,EAAY3I,KAAKwH,KAAOkB,EACbA,EAAYC,EAAY3I,KAAKsH,OACxCqB,EAAY3I,KAAKsH,KAAOoB,GAGzB1I,KAAKsI,mBAAoBI,EAAYC,GAItCF,EAAc1E,EAAEkF,SAIXI,EAAY,KACjBrJ,KAAKoJ,mBAAmB,EAAO,YAC/BpJ,KAAKiC,sBACLsH,OAAOC,oBAAqB,YAAaX,GACzCU,OAAOC,oBAAqB,UAAWH,IAgBxCrJ,KAAKmE,OAAOL,iBAAkB,SA5Id,KAEf,MAAMR,EAAQ8E,WAAYpI,KAAKmE,OAAOb,OAEjC+E,MAAO/E,IAEZtD,KAAKmC,SAAUnC,KAAKyJ,OAAQnG,OAuI7BtD,KAAKmE,OAAOL,iBAAkB,WAnHZC,IACD,UAAXA,EAAE2F,MACN1J,KAAKmE,OAAOgF,OAEG,YAAXpF,EAAE2F,OACN3F,EAAEkD,iBACFiB,EAAWlI,KAAK0H,MAAQ1H,KAAKsJ,oBAAqBvF,KAEnC,cAAXA,EAAE2F,OACN3F,EAAEkD,iBACFiB,EAAWlI,KAAK0H,MAAQ1H,KAAKsJ,oBAAqBvF,IAAO,OA0G3D/D,KAAKmE,OAAOL,iBAAkB,SAtGdC,IACV/D,KAAKiI,gBACTlE,EAAEkD,iBACFiB,EAAWlI,KAAK0H,MAAQ1H,KAAK2J,qBAAsB5F,QAoGrD/D,KAAKmE,OAAOL,iBAAkB,aAlFVC,IAEnBwE,EAAcxE,EAAEgF,QAChBP,EAAcC,EAAc1E,EAAEkF,QAC9BL,GAAyB,EAEzBF,EAAY1I,KAAKG,WACjBwI,EAAY,EAEZY,OAAOzF,iBAAkB,YAAa+E,GACtCU,OAAOzF,iBAAkB,UAAWuF,MAyErCrJ,KAAKmE,OAAOL,iBAAkB,SAdd,KACf9D,KAAKiI,eAAgB,KActBjI,KAAKmE,OAAOL,iBAAkB,QAXf,KACd9D,KAAKiI,eAAgB,EACrBjI,KAAKqD,gBACLrD,KAAKiC,yBAYP2H,cAEC5J,KAAK4H,YAAa,EAKlB5H,KAAK6J,QAAUxJ,SAASC,cAAe,OACvCN,KAAK6J,QAAQtJ,UAAUC,IAAK,UAE5BR,KAAK+H,MAAQ1H,SAASC,cAAe,OACrCN,KAAK+H,MAAMxH,UAAUC,IAAK,QAE1BR,KAAK6J,QAAQ/I,YAAad,KAAK+H,OAC/B/H,KAAKY,QAAQkJ,aAAc9J,KAAK6J,QAAS7J,KAAKmE,QAE9CnE,KAAKI,WAAWG,UAAUC,IAAK,aAK/B,MAIMuJ,EAAgBhB,IACrB,MAAMiB,EAAOhK,KAAK6J,QAAQI,wBAC1B,IAAI3G,GANSyB,EAMIgE,EANDmB,EAMUF,EAAKG,KANZvE,EAMkBoE,EAAKI,MANpBC,EAM2BrK,KAAKsH,KAN7BgD,EAMmCtK,KAAKwH,MALxDzC,EAAImF,IAAQtE,EAAIsE,IAAQI,EAAID,GAAMA,GADhC,IAAEtF,EAAGmF,EAAGtE,EAAGyE,EAAGC,EAOzBtK,KAAKsI,mBAAoBhF,IAapBiH,EAAYxG,IACjBgG,EAAehG,EAAEgF,UAGZyB,EAAU,KACfxK,KAAKiC,sBACLjC,KAAKoJ,mBAAmB,GACxBG,OAAOC,oBAAqB,YAAae,GACzChB,OAAOC,oBAAqB,UAAWgB,IAMxC,IAA8BC,EAAahC,EAAvCiC,GAAmB,EAEvB,MAAMC,EAAiB5G,IACtBA,EAAEkD,iBACFjH,KAAKoJ,mBAAmB,GACxBW,EAAehG,EAAE6G,QAAS,GAAI7B,SAC9B2B,GAAmB,GA2BdG,EAAc9G,IAEnB,GAAK2G,EAAmB,CAEvB,MAAM5B,EAAK/E,EAAE6G,QAAS,GAAI7B,QAAU0B,EAC9BzB,EAAKjF,EAAE6G,QAAS,GAAI3B,QAAUR,EAE/BX,KAAKoB,IAAKJ,GAAOhB,KAAKoB,IAAKF,GAG/B2B,EAAgB5G,IAKhBwF,OAAOC,oBAAqB,YAAaqB,GACzCtB,OAAOC,oBAAqB,WAAYsB,SAMzC/G,EAAEkD,iBACF8C,EAAehG,EAAE6G,QAAS,GAAI7B,UAM1B+B,EAAa,KAClB9K,KAAKiC,sBACLjC,KAAKoJ,mBAAmB,GACxBG,OAAOC,oBAAqB,YAAaqB,GACzCtB,OAAOC,oBAAqB,WAAYsB,IAQnCC,EAAqB/K,KAAKiC,oBAAoBb,KAAMpB,MAE1D,IAAIgL,EAuBJhL,KAAK6J,QAAQ/F,iBAAkB,aAxHbC,IACjB/D,KAAKoJ,mBAAmB,GACxBW,EAAehG,EAAEgF,SACjBQ,OAAOzF,iBAAkB,YAAayG,GACtChB,OAAOzF,iBAAkB,UAAW0G,MAqHrCxK,KAAK6J,QAAQ/F,iBAAkB,cA3FVC,IAEfA,EAAE6G,QAAQK,OAAS,IAInBjL,KAAKkL,eAETT,EAAc1G,EAAE6G,QAAS,GAAI7B,QAC7BN,EAAc1E,EAAE6G,QAAS,GAAI3B,QAC7ByB,GAAmB,GAKnBC,EAAgB5G,GAIjBwF,OAAOzF,iBAAkB,YAAa+G,GACtCtB,OAAOzF,iBAAkB,WAAYgH,OAwEtC9K,KAAK6J,QAAQ/F,iBAAkB,SAvBfC,IAIf,GADmB+D,KAAKoB,IAAKnF,EAAEoH,QAAWrD,KAAKoB,IAAKnF,EAAEqH,SACnCpL,KAAKkL,cAAgB,OAExCnH,EAAEkD,iBAGF,MAAMkB,EAAQnI,KAAK2J,qBAAsB5F,GAAM/D,KAAK0H,MACpD1H,KAAKsI,mBAAoBtI,KAAKG,WAAagI,GAG3CnI,KAAKmE,OAAOb,MAAQtD,KAAKG,WAGzBkL,aAAcL,GACdA,EAA2BM,WAAYP,EApBZ,QA8B7B3B,kBAAmBmC,EAAQC,EAAO,cAC5BxL,KAAK6J,SACT7J,KAAK6J,QAAQtJ,UAAUiC,OAAQ,SAAU+I,GAE1ClL,SAASoL,KAAKlL,UAAUiC,OAAQ,mBAAoB+I,GACpDlL,SAASoL,KAAKlL,UAAUiC,OAAQ,WAAWgJ,IAAQD,GAGpDlE,mBAEC,OAAKrH,KAAK0L,SAAW1L,KAAK2L,SAChB3L,KAAKwH,KAAOxH,KAAKsH,MAAS,IAG7B,GAIRC,mBAEOvH,KAAK4H,YAAc5H,KAAK0L,SAAW1L,KAAK2L,UAKvC3L,KAAK2H,eACV3H,KAAK+C,KAAM/C,KAAKqH,oBAAoB,GAGrCrH,KAAK4J,cACL5J,KAAKqD,iBAMPsG,qBAAsB5F,GAErB,IAAI,OAAEoH,EAAM,OAAEC,GAAWrH,EAKpB+D,KAAK8D,MAAO7H,EAAEqH,UAAarH,EAAEqH,QAAUrH,EAAE8H,aAC7CV,EAAS,EACTC,GAAUrH,EAAE8H,WAAa,IACzBT,GAAUpL,KAAK2H,cAAgB,EAAI,IAKpC,OAFcwD,GAAUC,EAMzB9B,oBAAqBvF,GAEpB,IAAI+H,EAAO9L,KAAK2H,cAAgB,EAAI,GAQpC,OANK5D,EAAEgI,SACND,GAAQ,GACG/H,EAAEiI,SACbF,GAAQ,IAGFA,EAIRG,MAAO3I,GAUN,MAAMoC,EAAIoC,KAAKoE,MAAO5I,EAAQtD,KAAK0H,OAAU1H,KAAK0H,MAClD,OAAOU,WAAY1C,EAAEyG,YAAa,KAInC1C,OAAQnG,GAIP,OAFKA,EAAQtD,KAAKsH,OAAOhE,EAAQtD,KAAKsH,MACjChE,EAAQtD,KAAKwH,OAAOlE,EAAQtD,KAAKwH,MAC/BlE,EAGRgF,mBAAoBhF,GACnBtD,KAAKmC,SAAUnC,KAAKyJ,OAAQzJ,KAAKiM,MAAO3I,KAGzC,oBACC,MAAM8I,EAAOpM,KAAKL,OAAOyM,KAAKlL,UAC9B,OAAOkL,EAAKC,aAAeD,EAAKE,aAGjC,cACC,YAAqB1K,IAAd5B,KAAKsH,KAGb,cACC,YAAqB1F,IAAd5B,KAAKwH,MAKd,MAAM+E,UAAyB9M,EAE9BC,YAAaC,EAAQC,EAAQC,EAAU6C,GAEtCwB,MAAOvE,EAAQC,EAAQC,EAAU,UAEjCG,KAAKwM,QAAUnM,SAASC,cAAe,UACvCN,KAAKwM,QAAQpI,aAAc,kBAAmBpE,KAAKS,MAAME,IAEzDX,KAAKkG,SAAW7F,SAASC,cAAe,OACxCN,KAAKkG,SAAS3F,UAAUC,IAAK,WAE7BR,KAAKyM,QAAUpH,MAAMC,QAAS5C,GAAYA,EAAUoD,OAAO4G,OAAQhK,GACnE1C,KAAK2M,OAAStH,MAAMC,QAAS5C,GAAYA,EAAUoD,OAAO8G,KAAMlK,GAEhE1C,KAAK2M,OAAOE,SAASxL,IACpB,MAAMyL,EAAUzM,SAASC,cAAe,UACxCwM,EAAQvL,UAAYF,EACpBrB,KAAKwM,QAAQ1L,YAAagM,MAG3B9M,KAAKwM,QAAQ1I,iBAAkB,UAAU,KACxC9D,KAAKmC,SAAUnC,KAAKyM,QAASzM,KAAKwM,QAAQO,gBAC1C/M,KAAKiC,yBAGNjC,KAAKwM,QAAQ1I,iBAAkB,SAAS,KACvC9D,KAAKkG,SAAS3F,UAAUC,IAAK,YAG9BR,KAAKwM,QAAQ1I,iBAAkB,QAAQ,KACtC9D,KAAKkG,SAAS3F,UAAUyM,OAAQ,YAGjChN,KAAKY,QAAQE,YAAad,KAAKwM,SAC/BxM,KAAKY,QAAQE,YAAad,KAAKkG,UAE/BlG,KAAKa,SAAWb,KAAKwM,QAErBxM,KAAKqD,gBAINA,gBACC,MAAMC,EAAQtD,KAAKG,WACb8M,EAAQjN,KAAKyM,QAAQ/I,QAASJ,GAGpC,OAFAtD,KAAKwM,QAAQO,cAAgBE,EAC7BjN,KAAKkG,SAAS3E,WAAuB,IAAX0L,EAAe3J,EAAQtD,KAAK2M,OAAQM,GACvDjN,MAKT,MAAMkN,UAAyBzN,EAE9BC,YAAaC,EAAQC,EAAQC,GAE5BqE,MAAOvE,EAAQC,EAAQC,EAAU,UAEjCG,KAAKmE,OAAS9D,SAASC,cAAe,SACtCN,KAAKmE,OAAOC,aAAc,OAAQ,QAClCpE,KAAKmE,OAAOC,aAAc,kBAAmBpE,KAAKS,MAAME,IAExDX,KAAKmE,OAAOL,iBAAkB,SAAS,KACtC9D,KAAKmC,SAAUnC,KAAKmE,OAAOb,UAG5BtD,KAAKmE,OAAOL,iBAAkB,WAAWC,IACxB,UAAXA,EAAE2F,MACN1J,KAAKmE,OAAOgF,UAIdnJ,KAAKmE,OAAOL,iBAAkB,QAAQ,KACrC9D,KAAKiC,yBAGNjC,KAAKY,QAAQE,YAAad,KAAKmE,QAE/BnE,KAAKa,SAAWb,KAAKmE,OAErBnE,KAAK4D,kBAAmB5D,KAAKmE,QAE7BnE,KAAKqD,gBAINA,gBAEC,OADArD,KAAKmE,OAAOb,MAAQtD,KAAKG,WAClBH,MAmcT,IAAImN,GAAiB,EAErB,MAAMC,EAiCL1N,aAAa,OACZC,EAAM,UACN0N,OAAuBzL,IAAXjC,EAAoB,UAChC2N,EAAS,MACTtF,EAAK,MACLuF,EAAQ,WAAU,aAClBC,GAAe,EAAI,YACnBC,GAAc,GACX,IAkFH,GA5EAzN,KAAKL,OAASA,EAMdK,KAAKoM,KAAOzM,EAASA,EAAOyM,KAAOpM,KAMnCA,KAAKe,SAAW,GAMhBf,KAAKiB,YAAc,GAMnBjB,KAAK0N,QAAU,GAMf1N,KAAK2N,SAAU,EAMf3N,KAAKI,WAAaC,SAASC,cAAe,OAC1CN,KAAKI,WAAWG,UAAUC,IAAK,WAM/BR,KAAK4N,OAASvN,SAASC,cAAe,OACtCN,KAAK4N,OAAOrN,UAAUC,IAAK,SAC3BR,KAAK4N,OAAOxJ,aAAc,OAAQ,UAClCpE,KAAK4N,OAAOxJ,aAAc,iBAAiB,GAC3CpE,KAAK4N,OAAOxJ,aAAc,WAAY,GAEtCpE,KAAK4N,OAAO9J,iBAAkB,SAAS,IAAM9D,KAAK6N,aAAc7N,KAAK2N,WACrE3N,KAAK4N,OAAO9J,iBAAkB,WAAWC,IACxB,UAAXA,EAAE2F,MAA+B,UAAX3F,EAAE2F,OAC5B3F,EAAEkD,iBACFjH,KAAK4N,OAAOE,YAKd9N,KAAK4N,OAAO9J,iBAAkB,cAAc,SAM5C9D,KAAKkB,UAAYb,SAASC,cAAe,OACzCN,KAAKkB,UAAUX,UAAUC,IAAK,YAE9BR,KAAKI,WAAWU,YAAad,KAAK4N,QAClC5N,KAAKI,WAAWU,YAAad,KAAKkB,WAElClB,KAAKuN,MAAOA,GAEPE,GACJzN,KAAKI,WAAWG,UAAUC,IAAK,sBAG3BR,KAAKL,OAQT,OANAK,KAAKL,OAAOoB,SAASC,KAAMhB,MAC3BA,KAAKL,OAAO+N,QAAQ1M,KAAMhB,WAE1BA,KAAKL,OAAOuB,UAAUJ,YAAad,KAAKI,YAOzCJ,KAAKI,WAAWG,UAAUC,IAAK,SAGzB2M,GAAkBK,KAvJ1B,SAAwBO,GACvB,MAAMC,EAAW3N,SAASC,cAAe,SACzC0N,EAASzM,UAAYwM,EACrB,MAAME,EAAS5N,SAAS6N,cAAe,yCAClCD,EACJ5N,SAAS8N,KAAKrE,aAAckE,EAAUC,GAEtC5N,SAAS8N,KAAKrN,YAAakN,GAiJ1BI,CA3kBgB,qhZA4kBhBjB,GAAiB,GAGbG,EAEJA,EAAUxM,YAAad,KAAKI,YAEjBiN,IAEXrN,KAAKI,WAAWG,UAAUC,IAAK,aAC/BH,SAASoL,KAAK3K,YAAad,KAAKI,aAI5B4H,GACJhI,KAAKI,WAAWyG,MAAMwH,YAAa,UAAWrG,EAAQ,MAoBxDxH,IAAKZ,EAAQC,EAAUyO,EAAIxL,EAAKC,GAE/B,GAAK+C,OAAQwI,KAASA,EAErB,OAAO,IAAI/B,EAAkBvM,KAAMJ,EAAQC,EAAUyO,GAItD,MAAMpO,EAAeN,EAAQC,GAE7B,cAAgBK,GAEf,IAAK,SAEJ,OAAO,IAAIgH,EAAkBlH,KAAMJ,EAAQC,EAAUyO,EAAIxL,EAAKC,GAE/D,IAAK,UAEJ,OAAO,IAAIkB,EAAmBjE,KAAMJ,EAAQC,GAE7C,IAAK,SAEJ,OAAO,IAAIqN,EAAkBlN,KAAMJ,EAAQC,GAE5C,IAAK,WAEJ,OAAO,IAAIkH,EAAoB/G,KAAMJ,EAAQC,GAI/C0O,QAAQC,MAAO,8BACJ3O,EAAU,cACZD,EAAQ,aACTM,GAuBTuO,SAAU7O,EAAQC,EAAU2F,EAAW,GACtC,OAAO,IAAIQ,EAAiBhG,KAAMJ,EAAQC,EAAU2F,GAerDkJ,UAAWnB,GACV,OAAO,IAAIH,EAAK,CAAEzN,OAAQK,KAAMuN,MAAAA,IASjChK,KAAMoL,EAAKC,GAAY,GA4BtB,OA1BKD,EAAI1N,aAERjB,KAAKiB,YAAY4L,SAASxC,IAEpBA,aAAatD,GAEbsD,EAAE/I,SAASqN,EAAI1N,aACnBoJ,EAAE9G,KAAMoL,EAAI1N,YAAaoJ,EAAE/I,WAOzBsN,GAAaD,EAAIjB,SAErB1N,KAAK0N,QAAQb,SAASgC,IAEhBA,EAAEC,UAAUH,EAAIjB,SACpBmB,EAAEtL,KAAMoL,EAAIjB,QAASmB,EAAEC,YAOnB9O,KAwBRwD,KAAMoL,GAAY,GAEjB,MAAMD,EAAM,CACX1N,YAAa,GACbyM,QAAS,IA6BV,OA1BA1N,KAAKiB,YAAY4L,SAASxC,IAEzB,KAAKA,aAAatD,GAAlB,CAEA,GAAKsD,EAAE/I,SAASqN,EAAI1N,YACnB,MAAM,IAAI8N,MAAO,4CAA4C1E,EAAE/I,UAGhEqN,EAAI1N,YAAaoJ,EAAE/I,OAAU+I,EAAE7G,WAI3BoL,GAEJ5O,KAAK0N,QAAQb,SAASgC,IAErB,GAAKA,EAAEC,UAAUH,EAAIjB,QACpB,MAAM,IAAIqB,MAAO,0CAA0CF,EAAEC,WAG9DH,EAAIjB,QAASmB,EAAEC,QAAWD,EAAErL,UAMvBmL,EAaRK,KAAMA,GAAO,GAOZ,OALAhP,KAAK2N,SAAWqB,EAEhBhP,KAAK4N,OAAOxJ,aAAc,iBAAkBpE,KAAK2N,SACjD3N,KAAKI,WAAWG,UAAUiC,OAAQ,SAAUxC,KAAK2N,SAE1C3N,KAQRiP,QACC,OAAOjP,KAAKgP,MAAM,GAGnBnB,aAAcmB,GAAO,GAoCpB,OAjCAhP,KAAK2N,SAAWqB,EAEhBhP,KAAK4N,OAAOxJ,aAAc,iBAAkBpE,KAAK2N,SAGjDvK,uBAAuB,KAGtB,MAAM8L,EAAgBlP,KAAKkB,UAAUoL,aACrCtM,KAAKkB,UAAU2F,MAAMsI,OAASD,EAAgB,KAE9ClP,KAAKI,WAAWG,UAAUC,IAAK,cAE/B,MAAM4O,EAAkBrL,IAClBA,EAAEwB,SAAWvF,KAAKkB,YACvBlB,KAAKkB,UAAU2F,MAAMsI,OAAS,GAC9BnP,KAAKI,WAAWG,UAAUyM,OAAQ,cAClChN,KAAKkB,UAAUsI,oBAAqB,gBAAiB4F,KAGtDpP,KAAKkB,UAAU4C,iBAAkB,gBAAiBsL,GAGlD,MAAMC,EAAgBL,EAAWhP,KAAKkB,UAAUmL,aAAnB,EAE7BrM,KAAKI,WAAWG,UAAUiC,OAAQ,UAAWwM,GAE7C5L,uBAAuB,KACtBpD,KAAKkB,UAAU2F,MAAMsI,OAASE,EAAe,WAKxCrP,KASRuN,MAAOA,GAON,OAFAvN,KAAK8O,OAASvB,EACdvN,KAAK4N,OAAOrM,UAAYgM,EACjBvN,KAQRkC,MAAO0M,GAAY,GAGlB,OAFoBA,EAAY5O,KAAKsP,uBAAyBtP,KAAKiB,aACvD4L,SAASxC,GAAKA,EAAEnI,UACrBlC,KAeRwB,SAAUC,GAOT,OADAzB,KAAK0B,UAAYD,EACVzB,KAGR2B,cAAegB,GAET3C,KAAKL,QACTK,KAAKL,OAAOgC,cAAegB,QAGJf,IAAnB5B,KAAK0B,WACT1B,KAAK0B,UAAUG,KAAM7B,KAAM,CAC1BJ,OAAQ+C,EAAW/C,OACnBC,SAAU8C,EAAW9C,SACrByD,MAAOX,EAAWxC,WAClBwC,WAAAA,IAiBHZ,eAAgBN,GAOf,OADAzB,KAAKgC,gBAAkBP,EAChBzB,KAGRiC,oBAAqBU,GAEf3C,KAAKL,QACTK,KAAKL,OAAOsC,oBAAqBU,QAGJf,IAAzB5B,KAAKgC,iBACThC,KAAKgC,gBAAgBH,KAAM7B,KAAM,CAChCJ,OAAQ+C,EAAW/C,OACnBC,SAAU8C,EAAW9C,SACrByD,MAAOX,EAAWxC,WAClBwC,WAAAA,IAQHC,UAEM5C,KAAKL,SACTK,KAAKL,OAAOoB,SAAS0C,OAAQzD,KAAKL,OAAOoB,SAAS2C,QAAS1D,MAAQ,GACnEA,KAAKL,OAAO+N,QAAQjK,OAAQzD,KAAKL,OAAO+N,QAAQhK,QAAS1D,MAAQ,IAG7DA,KAAKI,WAAWmP,eACpBvP,KAAKI,WAAWmP,cAAc5L,YAAa3D,KAAKI,YAGjDiF,MAAMmK,KAAMxP,KAAKe,UAAW8L,SAASxC,GAAKA,EAAEzH,YAQ7C0M,uBACC,IAAIrO,EAAcoE,MAAMmK,KAAMxP,KAAKiB,aAInC,OAHAjB,KAAK0N,QAAQb,SAASgC,IACrB5N,EAAcA,EAAYwO,OAAQZ,EAAES,2BAE9BrO,EAORyO,mBACC,IAAIhC,EAAUrI,MAAMmK,KAAMxP,KAAK0N,SAI/B,OAHA1N,KAAK0N,QAAQb,SAASgC,IACrBnB,EAAUA,EAAQ+B,OAAQZ,EAAEa,uBAEtBhC,GAKT,Q,mECprEA,MAAMiC,EAAS,IAAI,MACbC,EAAa,IAAI,MAEjBC,EAAW,IAAI,MACfC,EAAU,IAAI,MACdC,EAAgB,IAAI,MACpBC,EAAiB,IAAI,MACrBC,EAAiB,IAAI,MAE3B,MAAMC,UAAqB,MAE1BxQ,YAAayQ,EAAUC,EAASC,GAE/BnM,QAEAmM,EAAYxJ,MAAMyJ,YAAc,OAEhC,IAAIC,EAAY,KAAMC,EAAW,KAEjC,MAAMC,EAAiB,GAIjBC,EAAQ1Q,KAEd,SAAS2Q,IAERN,EAAYvM,iBAAkB,cAAe8M,GAC7CP,EAAYvM,iBAAkB,cAAe+M,GAC7CR,EAAYvM,iBAAkB,YAAagN,GAC3CT,EAAYvM,iBAAkB,eAAgBgN,GAI/C,SAASC,IAERV,EAAY7G,oBAAqB,cAAeoH,GAChDP,EAAY7G,oBAAqB,cAAeqH,GAChDR,EAAY7G,oBAAqB,YAAasH,GAC9CT,EAAY7G,oBAAqB,eAAgBsH,GAEjDT,EAAYxJ,MAAMmK,OAAS,GAsB5B,SAASJ,EAAeK,GAEvB,IAAuB,IAAlBP,EAAMrO,QAAX,CAMA,GAJA6O,EAAeD,GAEfrB,EAAWuB,cAAetB,EAAUO,GAE/BG,EAUJ,OARKX,EAAWwB,IAAIC,eAAgB1B,EAAQI,IAE3CQ,EAAUe,SAASC,KAAMxB,EAAcyB,IAAK1B,GAAU2B,aAAcxB,SAIrES,EAAMgB,cAAe,CAAEC,KAAM,OAAQ/R,OAAQ2Q,IAQ9C,GAA2B,UAAtBU,EAAMW,aAAiD,QAAtBX,EAAMW,YAO3C,GALAnB,EAAexF,OAAS,EAExB2E,EAAWuB,cAAetB,EAAUO,GACpCR,EAAWiC,iBAAkB1B,GAAU,EAAMM,GAExCA,EAAexF,OAAS,EAAI,CAEhC,MAAMrL,EAAS6Q,EAAgB,GAAI7Q,OAEnC+P,EAAOmC,8BAA+B1B,EAAQ2B,kBAAmBpC,EAAOqC,QAAUhC,EAAeiC,sBAAuBrS,EAAOsS,cAE1H1B,IAAa5Q,GAAuB,OAAb4Q,IAE3BE,EAAMgB,cAAe,CAAEC,KAAM,WAAY/R,OAAQ4Q,IAEjDH,EAAYxJ,MAAMmK,OAAS,OAC3BR,EAAW,MAIPA,IAAa5Q,IAEjB8Q,EAAMgB,cAAe,CAAEC,KAAM,UAAW/R,OAAQA,IAEhDyQ,EAAYxJ,MAAMmK,OAAS,UAC3BR,EAAW5Q,QAMM,OAAb4Q,IAEJE,EAAMgB,cAAe,CAAEC,KAAM,WAAY/R,OAAQ4Q,IAEjDH,EAAYxJ,MAAMmK,OAAS,OAC3BR,EAAW,OAUf,SAASK,EAAeI,IAEA,IAAlBP,EAAMrO,UAEX6O,EAAeD,GAEfR,EAAexF,OAAS,EAExB2E,EAAWuB,cAAetB,EAAUO,GACpCR,EAAWiC,iBAAkB1B,GAAU,EAAMM,GAExCA,EAAexF,OAAS,IAE5BsF,GAAuC,IAAzBG,EAAMyB,eAA4BhC,EAAU,GAAMM,EAAgB,GAAI7Q,OAEpF+P,EAAOmC,8BAA+B1B,EAAQ2B,kBAAmBpC,EAAOqC,QAAUhC,EAAeiC,sBAAuB1B,EAAU2B,cAE7HtC,EAAWwB,IAAIC,eAAgB1B,EAAQI,KAE3CE,EAAesB,KAAMhB,EAAU5Q,OAAOuS,aAAcE,SACpDtC,EAAQyB,KAAMxB,GAAgByB,IAAKxB,EAAeiC,sBAAuB1B,EAAU2B,eAIpF7B,EAAYxJ,MAAMmK,OAAS,OAE3BN,EAAMgB,cAAe,CAAEC,KAAM,YAAa/R,OAAQ2Q,MAOpD,SAASO,KAEe,IAAlBJ,EAAMrO,UAENkO,IAEJG,EAAMgB,cAAe,CAAEC,KAAM,UAAW/R,OAAQ2Q,IAEhDA,EAAY,MAIbF,EAAYxJ,MAAMmK,OAASR,EAAW,UAAY,QAInD,SAASU,EAAeD,GAEvB,MAAMjH,EAAOqG,EAAYpG,wBAEzB4F,EAASwC,GAAMpB,EAAMlI,QAAUiB,EAAKG,MAASH,EAAKhC,MAAQ,EAAI,EAC9D6H,EAASyC,IAAQrB,EAAMhI,QAAUe,EAAKuI,KAAQvI,EAAKmF,OAAS,EAAI,EAIjEwB,IAIA3Q,KAAKqC,SAAU,EACfrC,KAAKmS,gBAAiB,EAEtBnS,KAAK2Q,SAAWA,EAChB3Q,KAAK+Q,WAAaA,EAClB/Q,KAAKwS,QA7JL,WAECzB,KA4JD/Q,KAAKyS,WAxJL,WAEC,OAAOtC,GAuJRnQ,KAAK0S,aAnJL,WAEC,OAAO9C,M,mECnDV,MAAM+C,EAAe,CAAEhB,KAAM,UACvBiB,EAAc,CAAEjB,KAAM,SACtBkB,EAAY,CAAElB,KAAM,OAE1B,MAAMmB,UAAsB,MAE3BpT,YAAaE,EAAQQ,GAEpB8D,aAEoBtC,IAAfxB,GAA2BmO,QAAQwE,KAAM,4EACzC3S,IAAeC,UAAWkO,QAAQC,MAAO,4HAE9CxO,KAAKJ,OAASA,EACdI,KAAKI,WAAaA,EAClBJ,KAAKI,WAAWyG,MAAMyJ,YAAc,OAGpCtQ,KAAKqC,SAAU,EAGfrC,KAAKuF,OAAS,IAAI,MAGlBvF,KAAKgT,YAAc,EACnBhT,KAAKiT,YAAcC,EAAAA,EAGnBlT,KAAKmT,QAAU,EACfnT,KAAKoT,QAAUF,EAAAA,EAIflT,KAAKqT,cAAgB,EACrBrT,KAAKsT,cAAgBxL,KAAKyL,GAI1BvT,KAAKwT,iBAAoBN,EAAAA,EACzBlT,KAAKyT,gBAAkBP,EAAAA,EAIvBlT,KAAK0T,eAAgB,EACrB1T,KAAK2T,cAAgB,IAIrB3T,KAAK4T,YAAa,EAClB5T,KAAK6T,UAAY,EAGjB7T,KAAK8T,cAAe,EACpB9T,KAAK+T,YAAc,EAGnB/T,KAAKgU,WAAY,EACjBhU,KAAKiU,SAAW,EAChBjU,KAAKkU,oBAAqB,EAC1BlU,KAAKmU,YAAc,EAInBnU,KAAKoU,YAAa,EAClBpU,KAAKqU,gBAAkB,EAGvBrU,KAAK4M,KAAO,CAAE0H,KAAM,YAAaC,GAAI,UAAWC,MAAO,aAAcC,OAAQ,aAG7EzU,KAAK0U,aAAe,CAAEJ,KAAM,aAAcK,OAAQ,YAAaH,MAAO,WAGtExU,KAAK4K,QAAU,CAAEgK,IAAK,aAAcC,IAAK,iBAGzC7U,KAAK8U,QAAU9U,KAAKuF,OAAOwP,QAC3B/U,KAAKgV,UAAYhV,KAAKJ,OAAO0R,SAASyD,QACtC/U,KAAKiV,MAAQjV,KAAKJ,OAAOsV,KAGzBlV,KAAKmV,qBAAuB,KAM5BnV,KAAKoV,cAAgB,WAEpB,OAAOC,EAAUC,KAIlBtV,KAAKuV,kBAAoB,WAExB,OAAOF,EAAUG,OAIlBxV,KAAKyV,YAAc,WAElB,OAAOzV,KAAKJ,OAAO0R,SAASoE,WAAY1V,KAAKuF,SAI9CvF,KAAK2V,kBAAoB,SAAWvV,GAEnCA,EAAW0D,iBAAkB,UAAW8R,GACxC5V,KAAKmV,qBAAuB/U,GAI7BJ,KAAK6V,UAAY,WAEhBnF,EAAMoE,QAAQvD,KAAMb,EAAMnL,QAC1BmL,EAAMsE,UAAUzD,KAAMb,EAAM9Q,OAAO0R,UACnCZ,EAAMuE,MAAQvE,EAAM9Q,OAAOsV,MAI5BlV,KAAKkC,MAAQ,WAEZwO,EAAMnL,OAAOgM,KAAMb,EAAMoE,SACzBpE,EAAM9Q,OAAO0R,SAASC,KAAMb,EAAMsE,WAClCtE,EAAM9Q,OAAOsV,KAAOxE,EAAMuE,MAE1BvE,EAAM9Q,OAAOkW,yBACbpF,EAAMgB,cAAeiB,GAErBjC,EAAMqF,SAENC,EAAQC,EAAMC,MAKflW,KAAK+V,OAAS,WAEb,MAAMI,EAAS,IAAI,MAGbC,GAAO,IAAI,OAAaC,mBAAoBzW,EAAO0W,GAAI,IAAI,MAAS,EAAG,EAAG,IAC1EC,EAAcH,EAAKrB,QAAQ3C,SAE3BoE,EAAe,IAAI,MACnBC,EAAiB,IAAI,MAErBC,EAAQ,EAAI5O,KAAKyL,GAEvB,OAAO,WAEN,MAAMjC,EAAWZ,EAAM9Q,OAAO0R,SAE9B6E,EAAO5E,KAAMD,GAAWE,IAAKd,EAAMnL,QAGnC4Q,EAAOQ,gBAAiBP,GAGxBf,EAAUuB,eAAgBT,GAErBzF,EAAM0D,YAAc4B,IAAUC,EAAMC,MAExCW,EAsLK,EAAI/O,KAAKyL,GAAK,GAAK,GAAK7C,EAAM2D,iBAlL/B3D,EAAMgD,eAEV2B,EAAUG,OAASsB,EAAetB,MAAQ9E,EAAMiD,cAChD0B,EAAUC,KAAOwB,EAAexB,IAAM5E,EAAMiD,gBAI5C0B,EAAUG,OAASsB,EAAetB,MAClCH,EAAUC,KAAOwB,EAAexB,KAMjC,IAAIzS,EAAM6N,EAAM8C,gBACZ1Q,EAAM4N,EAAM+C,gBA2EhB,OAzEKsD,SAAUlU,IAASkU,SAAUjU,KAE5BD,GAAQiF,KAAKyL,GAAK1Q,GAAO6T,EAAiB7T,EAAMiF,KAAKyL,KAAK1Q,GAAO6T,GAEjE5T,GAAQgF,KAAKyL,GAAKzQ,GAAO4T,EAAiB5T,EAAMgF,KAAKyL,KAAKzQ,GAAO4T,GAIrErB,EAAUG,MAFN3S,GAAOC,EAEOgF,KAAKhF,IAAKD,EAAKiF,KAAKjF,IAAKC,EAAKuS,EAAUG,QAItCH,EAAUG,OAAU3S,EAAMC,GAAQ,EACrDgF,KAAKhF,IAAKD,EAAKwS,EAAUG,OACzB1N,KAAKjF,IAAKC,EAAKuS,EAAUG,QAO5BH,EAAUC,IAAMxN,KAAKhF,IAAK4N,EAAM2C,cAAevL,KAAKjF,IAAK6N,EAAM4C,cAAe+B,EAAUC,MAExFD,EAAU2B,WAGV3B,EAAU4B,QAAUC,EAGpB7B,EAAU4B,OAASnP,KAAKhF,IAAK4N,EAAMsC,YAAalL,KAAKjF,IAAK6N,EAAMuC,YAAaoC,EAAU4B,UAI1D,IAAxBvG,EAAMgD,cAEVhD,EAAMnL,OAAO4R,gBAAiBC,EAAW1G,EAAMiD,eAI/CjD,EAAMnL,OAAO/E,IAAK4W,GAInBjB,EAAOkB,iBAAkBhC,GAGzBc,EAAOQ,gBAAiBJ,GAExBjF,EAASC,KAAMb,EAAMnL,QAAS/E,IAAK2V,GAEnCzF,EAAM9Q,OAAO0X,OAAQ5G,EAAMnL,SAEE,IAAxBmL,EAAMgD,eAEVoD,EAAetB,OAAW,EAAI9E,EAAMiD,cACpCmD,EAAexB,KAAS,EAAI5E,EAAMiD,cAElCyD,EAAUG,eAAgB,EAAI7G,EAAMiD,iBAIpCmD,EAAeU,IAAK,EAAG,EAAG,GAE1BJ,EAAUI,IAAK,EAAG,EAAG,IAItBN,EAAQ,KAMHO,GACJjB,EAAakB,kBAAmBhH,EAAM9Q,OAAO0R,UAAaqG,GAC1D,GAAM,EAAIlB,EAAemB,IAAKlH,EAAM9Q,OAAOiY,aAAiBF,KAE5DjH,EAAMgB,cAAeiB,GAErB6D,EAAajF,KAAMb,EAAM9Q,OAAO0R,UAChCmF,EAAelF,KAAMb,EAAM9Q,OAAOiY,YAClCJ,GAAc,GAEP,IAnII,GA6IdzX,KAAKwS,QAAU,WAEd9B,EAAMtQ,WAAWoJ,oBAAqB,cAAesO,GAErDpH,EAAMtQ,WAAWoJ,oBAAqB,cAAeqH,GACrDH,EAAMtQ,WAAWoJ,oBAAqB,gBAAiBsH,GACvDJ,EAAMtQ,WAAWoJ,oBAAqB,QAASuO,GAE/CrH,EAAMtQ,WAAWoJ,oBAAqB,cAAeoH,GACrDF,EAAMtQ,WAAWoJ,oBAAqB,YAAawO,GAGf,OAA/BtH,EAAMyE,sBAEVzE,EAAMyE,qBAAqB3L,oBAAqB,UAAWoM,IAY7D,MAAMlF,EAAQ1Q,KAERiW,EAAQ,CACbC,MAAQ,EACR+B,OAAQ,EACRC,MAAO,EACPC,IAAK,EACLC,aAAc,EACdC,UAAW,EACXC,gBAAiB,EACjBC,mBAAoB,GAGrB,IAAIvC,EAAQC,EAAMC,KAElB,MAAMyB,EAAM,KAGNtC,EAAY,IAAI,KAChByB,EAAiB,IAAI,KAE3B,IAAII,EAAQ,EACZ,MAAME,EAAY,IAAI,MACtB,IAAIK,GAAc,EAElB,MAAMe,EAAc,IAAI,MAClBC,EAAY,IAAI,MAChBC,EAAc,IAAI,MAElBC,EAAW,IAAI,MACfC,EAAS,IAAI,MACbC,EAAW,IAAI,MAEfC,EAAa,IAAI,MACjBC,EAAW,IAAI,MACfC,EAAa,IAAI,MAEjBC,EAAW,GACXC,EAAmB,GAQzB,SAASC,IAER,OAAOrR,KAAKsR,IAAK,IAAM1I,EAAMmD,WAI9B,SAASgD,EAAYwC,GAEpBvC,EAAetB,OAAS6D,EAIzB,SAASC,EAAUD,GAElBvC,EAAexB,KAAO+D,EAIvB,MAAME,EAAU,WAEf,MAAMxU,EAAI,IAAI,MAEd,OAAO,SAAkByU,EAAUC,GAElC1U,EAAE2U,oBAAqBD,EAAc,GACrC1U,EAAEwS,gBAAkBiC,GAEpBpC,EAAU5W,IAAKuE,IATD,GAeV4U,EAAQ,WAEb,MAAM5U,EAAI,IAAI,MAEd,OAAO,SAAgByU,EAAUC,IAEE,IAA7B/I,EAAMwD,mBAEVnP,EAAE2U,oBAAqBD,EAAc,IAIrC1U,EAAE2U,oBAAqBD,EAAc,GACrC1U,EAAE6U,aAAclJ,EAAM9Q,OAAO0W,GAAIvR,IAIlCA,EAAEwS,eAAgBiC,GAElBpC,EAAU5W,IAAKuE,IAnBH,GA0BR8U,EAAM,WAEX,MAAM1D,EAAS,IAAI,MAEnB,OAAO,SAAchL,EAAQC,GAE5B,MAAM0O,EAAUpJ,EAAMtQ,WAEtB,GAAKsQ,EAAM9Q,OAAOma,oBAAsB,CAGvC,MAAMzI,EAAWZ,EAAM9Q,OAAO0R,SAC9B6E,EAAO5E,KAAMD,GAAWE,IAAKd,EAAMnL,QACnC,IAAIyU,EAAiB7D,EAAOlL,SAG5B+O,GAAkBlS,KAAKmS,IAAOvJ,EAAM9Q,OAAOsa,IAAM,EAAMpS,KAAKyL,GAAK,KAGjEgG,EAAS,EAAIpO,EAAS6O,EAAiBF,EAAQxN,aAAcoE,EAAM9Q,OAAOua,QAC1ER,EAAO,EAAIvO,EAAS4O,EAAiBF,EAAQxN,aAAcoE,EAAM9Q,OAAOua,aAE7DzJ,EAAM9Q,OAAOwa,sBAGxBb,EAASpO,GAAWuF,EAAM9Q,OAAOwK,MAAQsG,EAAM9Q,OAAOuK,MAASuG,EAAM9Q,OAAOsV,KAAO4E,EAAQO,YAAa3J,EAAM9Q,OAAOua,QACrHR,EAAOvO,GAAWsF,EAAM9Q,OAAO2S,IAAM7B,EAAM9Q,OAAO0a,QAAW5J,EAAM9Q,OAAOsV,KAAO4E,EAAQxN,aAAcoE,EAAM9Q,OAAOua,UAKpH5L,QAAQwE,KAAM,gFACdrC,EAAMsD,WAAY,IAhCT,GAwCZ,SAASuG,EAAUC,GAEb9J,EAAM9Q,OAAOma,oBAEjB7C,GAASsD,EAEE9J,EAAM9Q,OAAOwa,sBAExB1J,EAAM9Q,OAAOsV,KAAOpN,KAAKhF,IAAK4N,EAAMyC,QAASrL,KAAKjF,IAAK6N,EAAM0C,QAAS1C,EAAM9Q,OAAOsV,KAAOsF,IAC1F9J,EAAM9Q,OAAOkW,yBACb2B,GAAc,IAIdlJ,QAAQwE,KAAM,uFACdrC,EAAMkD,YAAa,GAMrB,SAAS6G,EAASD,GAEZ9J,EAAM9Q,OAAOma,oBAEjB7C,GAASsD,EAEE9J,EAAM9Q,OAAOwa,sBAExB1J,EAAM9Q,OAAOsV,KAAOpN,KAAKhF,IAAK4N,EAAMyC,QAASrL,KAAKjF,IAAK6N,EAAM0C,QAAS1C,EAAM9Q,OAAOsV,KAAOsF,IAC1F9J,EAAM9Q,OAAOkW,yBACb2B,GAAc,IAIdlJ,QAAQwE,KAAM,uFACdrC,EAAMkD,YAAa,GAUrB,SAAS8G,EAAuBzJ,GAE/BuH,EAAYhB,IAAKvG,EAAMlI,QAASkI,EAAMhI,SAUvC,SAAS0R,EAAoB1J,GAE5B0H,EAASnB,IAAKvG,EAAMlI,QAASkI,EAAMhI,SAkHpC,SAAS2R,IAER,GAAyB,IAApB3B,EAAShO,OAEbuN,EAAYhB,IAAKyB,EAAU,GAAI4B,MAAO5B,EAAU,GAAI6B,WAE9C,CAEN,MAAMzI,EAAI,IAAQ4G,EAAU,GAAI4B,MAAQ5B,EAAU,GAAI4B,OAChDvI,EAAI,IAAQ2G,EAAU,GAAI6B,MAAQ7B,EAAU,GAAI6B,OAEtDtC,EAAYhB,IAAKnF,EAAGC,IAMtB,SAASyI,IAER,GAAyB,IAApB9B,EAAShO,OAEb0N,EAASnB,IAAKyB,EAAU,GAAI4B,MAAO5B,EAAU,GAAI6B,WAE3C,CAEN,MAAMzI,EAAI,IAAQ4G,EAAU,GAAI4B,MAAQ5B,EAAU,GAAI4B,OAChDvI,EAAI,IAAQ2G,EAAU,GAAI6B,MAAQ7B,EAAU,GAAI6B,OAEtDnC,EAASnB,IAAKnF,EAAGC,IAMnB,SAAS0I,IAER,MAAMlS,EAAKmQ,EAAU,GAAI4B,MAAQ5B,EAAU,GAAI4B,MACzC7R,EAAKiQ,EAAU,GAAI6B,MAAQ7B,EAAU,GAAI6B,MAEzCtB,EAAW1R,KAAKmT,KAAMnS,EAAKA,EAAKE,EAAKA,GAE3C8P,EAAWtB,IAAK,EAAGgC,GAoBpB,SAAS0B,EAAuBjK,GAE/B,GAAwB,GAAnBgI,EAAShO,OAEbwN,EAAUjB,IAAKvG,EAAM4J,MAAO5J,EAAM6J,WAE5B,CAEN,MAAMxJ,EAAW6J,EAA0BlK,GAErCoB,EAAI,IAAQpB,EAAM4J,MAAQvJ,EAASe,GACnCC,EAAI,IAAQrB,EAAM6J,MAAQxJ,EAASgB,GAEzCmG,EAAUjB,IAAKnF,EAAGC,GAInBoG,EAAY0C,WAAY3C,EAAWD,GAAcjB,eAAgB7G,EAAMqD,aAEvE,MAAM+F,EAAUpJ,EAAMtQ,WAEtByW,EAAY,EAAI/O,KAAKyL,GAAKmF,EAAYrG,EAAIyH,EAAQxN,cAElDgN,EAAU,EAAIxR,KAAKyL,GAAKmF,EAAYpG,EAAIwH,EAAQxN,cAEhDkM,EAAYjH,KAAMkH,GAInB,SAAS4C,EAAoBpK,GAE5B,GAAyB,IAApBgI,EAAShO,OAEb2N,EAAOpB,IAAKvG,EAAM4J,MAAO5J,EAAM6J,WAEzB,CAEN,MAAMxJ,EAAW6J,EAA0BlK,GAErCoB,EAAI,IAAQpB,EAAM4J,MAAQvJ,EAASe,GACnCC,EAAI,IAAQrB,EAAM6J,MAAQxJ,EAASgB,GAEzCsG,EAAOpB,IAAKnF,EAAGC,GAIhBuG,EAASuC,WAAYxC,EAAQD,GAAWpB,eAAgB7G,EAAMuD,UAE9D4F,EAAKhB,EAASxG,EAAGwG,EAASvG,GAE1BqG,EAASpH,KAAMqH,GAIhB,SAAS0C,EAAsBrK,GAE9B,MAAMK,EAAW6J,EAA0BlK,GAErCnI,EAAKmI,EAAM4J,MAAQvJ,EAASe,EAC5BrJ,EAAKiI,EAAM6J,MAAQxJ,EAASgB,EAE5BkH,EAAW1R,KAAKmT,KAAMnS,EAAKA,EAAKE,EAAKA,GAE3C+P,EAASvB,IAAK,EAAGgC,GAEjBR,EAAWxB,IAAK,EAAG1P,KAAKsR,IAAKL,EAASzG,EAAIwG,EAAWxG,EAAG5B,EAAMmD,YAE9D0G,EAAUvB,EAAW1G,GAErBwG,EAAWvH,KAAMwH,GAwBlB,SAASlI,EAAeI,IAEA,IAAlBP,EAAMrO,UAEc,IAApB4W,EAAShO,SAEbyF,EAAMtQ,WAAWmb,kBAAmBtK,EAAMuK,WAE1C9K,EAAMtQ,WAAW0D,iBAAkB,cAAe8M,GAClDF,EAAMtQ,WAAW0D,iBAAkB,YAAakU,IAwWlD,SAAqB/G,GAEpBgI,EAASjY,KAAMiQ,GApWfwK,CAAYxK,GAEe,UAAtBA,EAAMW,YA8MZ,SAAuBX,GAItB,OAFAyK,EAAczK,GAELgI,EAAShO,QAEjB,KAAK,EAEJ,OAASyF,EAAM9F,QAAQgK,KAEtB,KAAK,aAEJ,IAA4B,IAAvBlE,EAAMoD,aAAyB,OAEpC8G,IAEA5E,EAAQC,EAAMmC,aAEd,MAED,KAAK,UAEJ,IAAyB,IAApB1H,EAAMsD,UAAsB,OAEjC+G,IAEA/E,EAAQC,EAAMoC,UAEd,MAED,QAECrC,EAAQC,EAAMC,KAIhB,MAED,KAAK,EAEJ,OAASxF,EAAM9F,QAAQiK,KAEtB,KAAK,gBAEJ,IAA0B,IAArBnE,EAAMkD,aAA4C,IAApBlD,EAAMsD,UAAsB,OAtX9DtD,EAAMkD,YAAaoH,IAEnBtK,EAAMsD,WAAY+G,IAwXnB/E,EAAQC,EAAMqC,gBAEd,MAED,KAAK,mBAEJ,IAA0B,IAArB5H,EAAMkD,aAA+C,IAAvBlD,EAAMoD,aAAyB,OAxXjEpD,EAAMkD,YAAaoH,IAEnBtK,EAAMoD,cAAe8G,IA0XtB5E,EAAQC,EAAMsC,mBAEd,MAED,QAECvC,EAAQC,EAAMC,KAIhB,MAED,QAECF,EAAQC,EAAMC,KAIXF,IAAUC,EAAMC,MAEpBxF,EAAMgB,cAAekB,GA1RrB+I,CAAc1K,GAmDhB,SAAsBA,GAErB,IAAI2K,EAEJ,OAAS3K,EAAM4K,QAEd,KAAK,EAEJD,EAAclL,EAAMgE,aAAaJ,KACjC,MAED,KAAK,EAEJsH,EAAclL,EAAMgE,aAAaC,OACjC,MAED,KAAK,EAEJiH,EAAclL,EAAMgE,aAAaF,MACjC,MAED,QAECoH,GAAgB,EAIlB,OAASA,GAER,KAAK,YAEJ,IAA0B,IAArBlL,EAAMkD,WAAuB,QAzXrC,SAA+B3C,GAE9B6H,EAAWtB,IAAKvG,EAAMlI,QAASkI,EAAMhI,SAyXnC6S,CAAsB7K,GAEtB+E,EAAQC,EAAMiC,MAEd,MAED,KAAK,aAEJ,GAAKjH,EAAM8K,SAAW9K,EAAM+K,SAAW/K,EAAMlF,SAAW,CAEvD,IAAyB,IAApB2E,EAAMsD,UAAsB,OAEjC2G,EAAoB1J,GAEpB+E,EAAQC,EAAMkC,QAER,CAEN,IAA4B,IAAvBzH,EAAMoD,aAAyB,OAEpC4G,EAAuBzJ,GAEvB+E,EAAQC,EAAMgC,OAIf,MAED,KAAK,UAEJ,GAAKhH,EAAM8K,SAAW9K,EAAM+K,SAAW/K,EAAMlF,SAAW,CAEvD,IAA4B,IAAvB2E,EAAMoD,aAAyB,OAEpC4G,EAAuBzJ,GAEvB+E,EAAQC,EAAMgC,WAER,CAEN,IAAyB,IAApBvH,EAAMsD,UAAsB,OAEjC2G,EAAoB1J,GAEpB+E,EAAQC,EAAMkC,IAIf,MAED,QAECnC,EAAQC,EAAMC,KAIXF,IAAUC,EAAMC,MAEpBxF,EAAMgB,cAAekB,GA1IrBqJ,CAAahL,IAMf,SAASL,EAAeK,IAEA,IAAlBP,EAAMrO,UAEgB,UAAtB4O,EAAMW,YAkRZ,SAAsBX,GAIrB,OAFAyK,EAAczK,GAEL+E,GAER,KAAKC,EAAMmC,aAEV,IAA4B,IAAvB1H,EAAMoD,aAAyB,OAEpCoH,EAAuBjK,GAEvBP,EAAMqF,SAEN,MAED,KAAKE,EAAMoC,UAEV,IAAyB,IAApB3H,EAAMsD,UAAsB,OAEjCqH,EAAoBpK,GAEpBP,EAAMqF,SAEN,MAED,KAAKE,EAAMqC,gBAEV,IAA0B,IAArB5H,EAAMkD,aAA4C,IAApBlD,EAAMsD,UAAsB,QAnWlE,SAAkC/C,GAE5BP,EAAMkD,YAAa0H,EAAsBrK,GAEzCP,EAAMsD,WAAYqH,EAAoBpK,GAiWzCiL,CAAyBjL,GAEzBP,EAAMqF,SAEN,MAED,KAAKE,EAAMsC,mBAEV,IAA0B,IAArB7H,EAAMkD,aAA+C,IAAvBlD,EAAMoD,aAAyB,QArWrE,SAAqC7C,GAE/BP,EAAMkD,YAAa0H,EAAsBrK,GAEzCP,EAAMoD,cAAeoH,EAAuBjK,GAmW/CkL,CAA4BlL,GAE5BP,EAAMqF,SAEN,MAED,QAECC,EAAQC,EAAMC,MAhUfrL,CAAaoG,GAoIf,SAAsBA,GAErB,IAAuB,IAAlBP,EAAMrO,QAAoB,OAE/B,OAAS2T,GAER,KAAKC,EAAMgC,OAEV,IAA4B,IAAvBvH,EAAMoD,aAAyB,QAvbvC,SAAgC7C,GAE/BwH,EAAUjB,IAAKvG,EAAMlI,QAASkI,EAAMhI,SAEpCyP,EAAY0C,WAAY3C,EAAWD,GAAcjB,eAAgB7G,EAAMqD,aAEvE,MAAM+F,EAAUpJ,EAAMtQ,WAEtByW,EAAY,EAAI/O,KAAKyL,GAAKmF,EAAYrG,EAAIyH,EAAQxN,cAElDgN,EAAU,EAAIxR,KAAKyL,GAAKmF,EAAYpG,EAAIwH,EAAQxN,cAEhDkM,EAAYjH,KAAMkH,GAElB/H,EAAMqF,SA2aJqG,CAAuBnL,GAEvB,MAED,KAAKgF,EAAMiC,MAEV,IAA0B,IAArBxH,EAAMkD,WAAuB,QA7arC,SAA+B3C,GAE9B8H,EAASvB,IAAKvG,EAAMlI,QAASkI,EAAMhI,SAEnC+P,EAAWoC,WAAYrC,EAAUD,GAE5BE,EAAW1G,EAAI,EAEnBiI,EAAUpB,KAECH,EAAW1G,EAAI,GAE1BmI,EAAStB,KAIVL,EAAWvH,KAAMwH,GAEjBrI,EAAMqF,SA6ZJsG,CAAsBpL,GAEtB,MAED,KAAKgF,EAAMkC,IAEV,IAAyB,IAApBzH,EAAMsD,UAAsB,QA/ZpC,SAA6B/C,GAE5B2H,EAAOpB,IAAKvG,EAAMlI,QAASkI,EAAMhI,SAEjC4P,EAASuC,WAAYxC,EAAQD,GAAWpB,eAAgB7G,EAAMuD,UAE9D4F,EAAKhB,EAASxG,EAAGwG,EAASvG,GAE1BqG,EAASpH,KAAMqH,GAEflI,EAAMqF,SAuZJuG,CAAoBrL,IA1JrBpI,CAAaoI,IAMf,SAAS+G,EAAa/G,GAElBsL,EAAetL,GAEU,IAApBgI,EAAShO,SAEVyF,EAAMtQ,WAAWoc,sBAAuBvL,EAAMuK,WAE9C9K,EAAMtQ,WAAWoJ,oBAAqB,cAAeoH,GACrDF,EAAMtQ,WAAWoJ,oBAAqB,YAAawO,IAIvDtH,EAAMgB,cAAemB,GAErBmD,EAAQC,EAAMC,KAIlB,SAASpF,EAAiBG,GAEzBsL,EAAetL,GAuIhB,SAAS8G,EAAc9G,IAEC,IAAlBP,EAAMrO,UAA0C,IAArBqO,EAAMkD,YAAwBoC,IAAUC,EAAMC,OAE9EjF,EAAMhK,iBAENyJ,EAAMgB,cAAekB,GAjatB,SAA2B3B,GAErBA,EAAM7F,OAAS,EAEnBqP,EAAStB,KAEElI,EAAM7F,OAAS,GAE1BmP,EAAUpB,KAIXzI,EAAMqF,SAuZN0G,CAAkBxL,GAElBP,EAAMgB,cAAemB,IAItB,SAAS+C,EAAW3E,IAEI,IAAlBP,EAAMrO,UAAyC,IAApBqO,EAAMsD,WA3ZvC,SAAwB/C,GAEvB,IAAIyL,GAAc,EAElB,OAASzL,EAAMvH,MAEd,KAAKgH,EAAM9D,KAAK2H,GACfsF,EAAK,EAAGnJ,EAAMyD,aACduI,GAAc,EACd,MAED,KAAKhM,EAAM9D,KAAK6H,OACfoF,EAAK,GAAKnJ,EAAMyD,aAChBuI,GAAc,EACd,MAED,KAAKhM,EAAM9D,KAAK0H,KACfuF,EAAKnJ,EAAMyD,YAAa,GACxBuI,GAAc,EACd,MAED,KAAKhM,EAAM9D,KAAK4H,MACfqF,GAAOnJ,EAAMyD,YAAa,GAC1BuI,GAAc,EAKXA,IAGJzL,EAAMhK,iBAENyJ,EAAMqF,UA4XP4G,CAAe1L,GA8IhB,SAAS6G,EAAe7G,IAEA,IAAlBP,EAAMrO,SAEX4O,EAAMhK,iBAUP,SAASsV,EAAetL,UAEhBiI,EAAkBjI,EAAMuK,WAE/B,IAAM,IAAIoB,EAAI,EAAGA,EAAI3D,EAAShO,OAAQ2R,IAErC,GAAK3D,EAAU2D,GAAIpB,WAAavK,EAAMuK,UAGrC,YADAvC,EAASxV,OAAQmZ,EAAG,GASvB,SAASlB,EAAczK,GAEtB,IAAIK,EAAW4H,EAAkBjI,EAAMuK,gBAErB5Z,IAAb0P,IAEJA,EAAW,IAAI,MACf4H,EAAkBjI,EAAMuK,WAAclK,GAIvCA,EAASkG,IAAKvG,EAAM4J,MAAO5J,EAAM6J,OAIlC,SAASK,EAA0BlK,GAElC,MAAM4L,EAAY5L,EAAMuK,YAAcvC,EAAU,GAAIuC,UAAcvC,EAAU,GAAMA,EAAU,GAE5F,OAAOC,EAAkB2D,EAAQrB,WAMlC9K,EAAMtQ,WAAW0D,iBAAkB,cAAegU,GAElDpH,EAAMtQ,WAAW0D,iBAAkB,cAAe+M,GAClDH,EAAMtQ,WAAW0D,iBAAkB,gBAAiBgN,GACpDJ,EAAMtQ,WAAW0D,iBAAkB,QAASiU,EAAc,CAAE+E,SAAS,IAIrE9c,KAAK+V,Y,6lDClrCHgH,EAAM,GACNC,EAAO,SAAU3S,GAAK,OAAO4S,IAAIC,gBAAgB,IAAIC,KAAK,CAAC9S,GAAI,CAAEsH,KAAM,sBACvEyL,EAAM,SAAUC,GAAK,OAAO,IAAIC,OAAOD,IAC3C,IACIJ,IAAIM,gBAAgBP,EAAK,KAE7B,MAAOjZ,IAEHiZ,EAAO,SAAU3S,GAAK,MAAO,6CAA+CmT,UAAUnT,IAEtF+S,EAAM,SAAUC,GAAK,OAAO,IAAIC,OAAOD,EAAG,CAAE1L,KAAM,YAEtD,IASI8L,EAAKC,WAAYC,EAAMC,YAAaC,EAAMC,YAE1CC,EAAO,IAAIN,EAAG,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAgB,EAAG,EAAoB,IAG1IO,EAAO,IAAIP,EAAG,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAiB,EAAG,IAEjIQ,EAAO,IAAIR,EAAG,CAAC,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,KAE7ES,EAAO,SAAUC,EAAIC,GAErB,IADA,IAAIxY,EAAI,IAAI+X,EAAI,IACPf,EAAI,EAAGA,EAAI,KAAMA,EACtBhX,EAAEgX,GAAKwB,GAAS,GAAKD,EAAGvB,EAAI,GAGhC,IAAIlX,EAAI,IAAImY,EAAIjY,EAAE,KAClB,IAASgX,EAAI,EAAGA,EAAI,KAAMA,EACtB,IAAK,IAAIyB,EAAIzY,EAAEgX,GAAIyB,EAAIzY,EAAEgX,EAAI,KAAMyB,EAC/B3Y,EAAE2Y,GAAOA,EAAIzY,EAAEgX,IAAO,EAAKA,EAGnC,MAAO,CAAChX,EAAGF,IAEX4Y,EAAKJ,EAAKH,EAAM,GAAIQ,EAAKD,EAAG,GAAIE,EAAQF,EAAG,GAE/CC,EAAG,IAAM,IAAKC,EAAM,KAAO,GAI3B,IAHA,IAAIC,EAAKP,EAAKF,EAAM,GAAIU,EAAKD,EAAG,GAAIE,EAAQF,EAAG,GAE3CG,EAAM,IAAIjB,EAAI,OACTf,EAAI,EAAGA,EAAI,QAASA,EAAG,CAE5B,IAAIvK,GAAU,MAAJuK,KAAgB,GAAW,MAAJA,IAAe,EAEhDvK,GAAU,OADVA,GAAU,MAAJA,KAAgB,GAAW,MAAJA,IAAe,MACtB,GAAW,KAAJA,IAAe,EAC5CuM,EAAIhC,KAAY,MAAJvK,KAAgB,GAAW,IAAJA,IAAe,KAAQ,EAK9D,IAAIwM,EAAO,SAAWC,EAAIC,EAAIrZ,GAO1B,IANA,IAAIsZ,EAAIF,EAAG7T,OAEP2R,EAAI,EAEJqC,EAAI,IAAItB,EAAIoB,GAETnC,EAAIoC,IAAKpC,IACVqC,EAAEH,EAAGlC,GAAK,GAEhB,IAIIsC,EAJAC,EAAK,IAAIxB,EAAIoB,GACjB,IAAKnC,EAAI,EAAGA,EAAImC,IAAMnC,EAClBuC,EAAGvC,GAAMuC,EAAGvC,EAAI,GAAKqC,EAAErC,EAAI,IAAO,EAGtC,GAAIlX,EAAG,CAEHwZ,EAAK,IAAIvB,EAAI,GAAKoB,GAElB,IAAIK,EAAM,GAAKL,EACf,IAAKnC,EAAI,EAAGA,EAAIoC,IAAKpC,EAEjB,GAAIkC,EAAGlC,GAQH,IANA,IAAIyC,EAAMzC,GAAK,EAAKkC,EAAGlC,GAEnB0C,EAAMP,EAAKD,EAAGlC,GAEd7X,EAAIoa,EAAGL,EAAGlC,GAAK,MAAQ0C,EAElBC,EAAIxa,GAAM,GAAKua,GAAO,EAAIva,GAAKwa,IAAKxa,EAEzCma,EAAGN,EAAI7Z,KAAOqa,GAAOC,OAOjC,IADAH,EAAK,IAAIvB,EAAIqB,GACRpC,EAAI,EAAGA,EAAIoC,IAAKpC,EACbkC,EAAGlC,KACHsC,EAAGtC,GAAKgC,EAAIO,EAAGL,EAAGlC,GAAK,QAAW,GAAKkC,EAAGlC,IAItD,OAAOsC,GAGPM,EAAM,IAAI/B,EAAG,KACjB,IAASb,EAAI,EAAGA,EAAI,MAAOA,EACvB4C,EAAI5C,GAAK,EACb,IAASA,EAAI,IAAKA,EAAI,MAAOA,EACzB4C,EAAI5C,GAAK,EACb,IAASA,EAAI,IAAKA,EAAI,MAAOA,EACzB4C,EAAI5C,GAAK,EACb,IAASA,EAAI,IAAKA,EAAI,MAAOA,EACzB4C,EAAI5C,GAAK,EAEb,IAAI6C,EAAM,IAAIhC,EAAG,IACjB,IAASb,EAAI,EAAGA,EAAI,KAAMA,EACtB6C,EAAI7C,GAAK,EAEb,IAAI8C,EAAoBb,EAAKW,EAAK,EAAG,GAAIG,EAAqBd,EAAKW,EAAK,EAAG,GAEvEI,EAAoBf,EAAKY,EAAK,EAAG,GAAII,EAAqBhB,EAAKY,EAAK,EAAG,GAEvE3c,EAAM,SAAUoH,GAEhB,IADA,IAAIqV,EAAIrV,EAAE,GACD0S,EAAI,EAAGA,EAAI1S,EAAEe,SAAU2R,EACxB1S,EAAE0S,GAAK2C,IACPA,EAAIrV,EAAE0S,IAEd,OAAO2C,GAGPO,EAAO,SAAUxV,EAAGyV,EAAGR,GACvB,IAAIS,EAAKD,EAAI,EAAK,EAClB,OAASzV,EAAE0V,GAAM1V,EAAE0V,EAAI,IAAM,KAAY,EAAJD,GAAUR,GAG/CU,EAAS,SAAU3V,EAAGyV,GACtB,IAAIC,EAAKD,EAAI,EAAK,EAClB,OAASzV,EAAE0V,GAAM1V,EAAE0V,EAAI,IAAM,EAAM1V,EAAE0V,EAAI,IAAM,MAAa,EAAJD,IAGxDG,EAAO,SAAUH,GAAK,OAASA,EAAI,EAAK,IAAU,EAAJA,GAAS,IAGvDI,EAAM,SAAUpb,EAAGia,EAAGjb,IACb,MAALib,GAAaA,EAAI,KACjBA,EAAI,IACC,MAALjb,GAAaA,EAAIgB,EAAEkG,UACnBlH,EAAIgB,EAAEkG,QAEV,IAAImV,EAAI,IAAKrb,aAAa4Y,EAAMA,EAAM5Y,aAAa8Y,EAAMA,EAAMJ,GAAI1Z,EAAIib,GAEvE,OADAoB,EAAE5I,IAAIzS,EAAEsb,SAASrB,EAAGjb,IACbqc,GAGPE,EAAQ,SAAUC,EAAKC,EAAKC,GAE5B,IAAIC,EAAKH,EAAItV,OACb,IAAKyV,GAAOD,IAAOA,EAAGxB,GAAKyB,EAAK,EAC5B,OAAOF,GAAO,IAAI/C,EAAG,GAEzB,IAAIkD,GAASH,GAAOC,EAEhBG,GAAQH,GAAMA,EAAG7D,EAChB6D,IACDA,EAAK,IAEJD,IACDA,EAAM,IAAI/C,EAAQ,EAALiD,IAEjB,IAAIG,EAAO,SAAU5B,GACjB,IAAI6B,EAAKN,EAAIvV,OAEb,GAAIgU,EAAI6B,EAAI,CAER,IAAIC,EAAO,IAAItD,EAAG3V,KAAKhF,IAAS,EAALge,EAAQ7B,IACnC8B,EAAKvJ,IAAIgJ,GACTA,EAAMO,IAIVC,EAAQP,EAAG5R,GAAK,EAAGoS,EAAMR,EAAGV,GAAK,EAAGmB,EAAKT,EAAG7a,GAAK,EAAGub,EAAKV,EAAGxB,EAAGmC,EAAKX,EAAGnW,EAAG+W,EAAMZ,EAAGlB,EAAG+B,EAAMb,EAAGL,EAE/FmB,EAAY,EAALb,EACX,EAAG,CACC,IAAKS,EAAI,CAELV,EAAG5R,EAAImS,EAAQlB,EAAKS,EAAKU,EAAK,GAE9B,IAAItP,EAAOmO,EAAKS,EAAKU,EAAM,EAAG,GAE9B,GADAA,GAAO,GACFtP,EAAM,CAEP,IAAuBsN,EAAIsB,GAAvBvB,EAAIkB,EAAKe,GAAO,GAAe,GAAMV,EAAIvB,EAAI,IAAM,EAAIwC,EAAIxC,EAAIC,EACnE,GAAIuC,EAAId,EAAI,CACR,GAAIE,EACA,KAAM,iBACV,MAGAD,GACAE,EAAKK,EAAKjC,GAEduB,EAAIhJ,IAAI+I,EAAIF,SAASrB,EAAGwC,GAAIN,GAE5BT,EAAG7a,EAAIsb,GAAMjC,EAAGwB,EAAGV,EAAIkB,EAAU,EAAJO,EAC7B,SAEC,GAAY,GAAR7P,EACLwP,EAAKxB,EAAMyB,EAAKvB,EAAMwB,EAAM,EAAGC,EAAM,MACpC,IAAY,GAAR3P,EAmDL,KAAM,qBAjDN,IAAI8P,EAAO3B,EAAKS,EAAKU,EAAK,IAAM,IAAKS,EAAQ5B,EAAKS,EAAKU,EAAM,GAAI,IAAM,EACnEU,EAAKF,EAAO3B,EAAKS,EAAKU,EAAM,EAAG,IAAM,EACzCA,GAAO,GAKP,IAHA,IAAIW,EAAM,IAAInE,EAAGkE,GAEbE,EAAM,IAAIpE,EAAG,IACRb,EAAI,EAAGA,EAAI8E,IAAS9E,EAEzBiF,EAAI5D,EAAKrB,IAAMkD,EAAKS,EAAKU,EAAU,EAAJrE,EAAO,GAE1CqE,GAAe,EAARS,EAEP,IAAII,EAAMhf,EAAI+e,GAAME,GAAU,GAAKD,GAAO,EAEtCE,EAAMnD,EAAKgD,EAAKC,EAAK,GACzB,IAASlF,EAAI,EAAGA,EAAI+E,GAAK,CACrB,IAII3C,EAJAtZ,EAAIsc,EAAIlC,EAAKS,EAAKU,EAAKc,IAM3B,GAJAd,GAAW,GAAJvb,GAEHsZ,EAAItZ,IAAM,GAEN,GACJkc,EAAIhF,KAAOoC,MAEV,CAED,IAAI3U,EAAI,EAAG+V,EAAI,EAOf,IANS,IAALpB,GACAoB,EAAI,EAAIN,EAAKS,EAAKU,EAAK,GAAIA,GAAO,EAAG5W,EAAIuX,EAAIhF,EAAI,IACvC,IAALoC,GACLoB,EAAI,EAAIN,EAAKS,EAAKU,EAAK,GAAIA,GAAO,GACxB,IAALjC,IACLoB,EAAI,GAAKN,EAAKS,EAAKU,EAAK,KAAMA,GAAO,GAClCb,KACHwB,EAAIhF,KAAOvS,GAIvB,IAAI4X,EAAKL,EAAIvB,SAAS,EAAGoB,GAAOS,EAAKN,EAAIvB,SAASoB,GAElDJ,EAAMve,EAAImf,GAEVX,EAAMxe,EAAIof,GACVf,EAAKtC,EAAKoD,EAAIZ,EAAK,GACnBD,EAAKvC,EAAKqD,EAAIZ,EAAK,GAIvB,GAAIL,EAAMM,EAAM,CACZ,GAAIX,EACA,KAAM,iBACV,OAKJD,GACAE,EAAKK,EAAK,QAGd,IAFA,IAAIiB,GAAO,GAAKd,GAAO,EAAGe,GAAO,GAAKd,GAAO,EACzCe,EAAOpB,GACHoB,EAAOpB,EAAK,CAEhB,IAAoCqB,GAAhCjY,EAAI8W,EAAGlB,EAAOM,EAAKU,GAAOkB,MAAkB,EAEhD,IADAlB,GAAW,GAAJ5W,GACGkX,EAAM,CACZ,GAAIX,EACA,KAAM,iBACV,MAEJ,IAAKvW,EACD,KAAM,yBACV,GAAIiY,EAAM,IACN9B,EAAIU,KAAQoB,MACX,IAAW,KAAPA,EAAY,CACjBD,EAAOpB,EAAKE,EAAK,KACjB,MAGA,IAAI3gB,EAAM8hB,EAAM,IAEhB,GAAIA,EAAM,IAAK,CAEX,IAAmB1c,EAAImY,EAAnBnB,EAAI0F,EAAM,KACd9hB,EAAMsf,EAAKS,EAAKU,GAAM,GAAKrb,GAAK,GAAK2Y,EAAG3B,GACxCqE,GAAOrb,EAGX,IAAI0E,EAAI8W,EAAGnB,EAAOM,EAAKU,GAAOmB,GAAMG,GAAOjY,IAAM,EACjD,IAAKA,EACD,KAAM,mBACV2W,GAAW,GAAJ3W,EACH4X,EAAKxD,EAAG6D,IACZ,GAAIA,GAAO,EAAG,CACN3c,EAAIoY,EAAKuE,IACbL,GAAMjC,EAAOM,EAAKU,IAAS,GAAKrb,GAAK,EAAIqb,GAAOrb,EAEpD,GAAIqb,EAAMM,EAAM,CACZ,GAAIX,EACA,KAAM,iBACV,MAEAD,GACAE,EAAKK,EAAK,QAEd,IADA,IAAIsB,GAAMtB,EAAK1gB,EACR0gB,EAAKsB,GAAKtB,GAAM,EACnBV,EAAIU,GAAMV,EAAIU,EAAKgB,GACnB1B,EAAIU,EAAK,GAAKV,EAAIU,EAAK,EAAIgB,GAC3B1B,EAAIU,EAAK,GAAKV,EAAIU,EAAK,EAAIgB,GAC3B1B,EAAIU,EAAK,GAAKV,EAAIU,EAAK,EAAIgB,GAE/BhB,EAAKsB,IAGb/B,EAAGxB,EAAIkC,EAAIV,EAAGV,EAAIsC,EAAM5B,EAAG7a,EAAIsb,EAC3BC,IACAH,EAAQ,EAAGP,EAAGlB,EAAI8B,EAAKZ,EAAGnW,EAAI8W,EAAIX,EAAGL,EAAIkB,UACvCN,GACV,OAAOE,GAAMV,EAAIvV,OAASuV,EAAML,EAAIK,EAAK,EAAGU,IAG5CuB,EAAQ,SAAUnY,EAAGyV,EAAGhb,GACxBA,IAAU,EAAJgb,EACN,IAAIC,EAAKD,EAAI,EAAK,EAClBzV,EAAE0V,IAAMjb,EACRuF,EAAE0V,EAAI,IAAMjb,IAAM,GAGlB2d,EAAU,SAAUpY,EAAGyV,EAAGhb,GAC1BA,IAAU,EAAJgb,EACN,IAAIC,EAAKD,EAAI,EAAK,EAClBzV,EAAE0V,IAAMjb,EACRuF,EAAE0V,EAAI,IAAMjb,IAAM,EAClBuF,EAAE0V,EAAI,IAAMjb,IAAM,IAGlB4d,EAAQ,SAAUrY,EAAGyU,GAGrB,IADA,IAAIyC,EAAI,GACC5E,EAAI,EAAGA,EAAItS,EAAEW,SAAU2R,EACxBtS,EAAEsS,IACF4E,EAAExgB,KAAK,CAAEge,EAAGpC,EAAG/N,EAAGvE,EAAEsS,KAE5B,IAAIoC,EAAIwC,EAAEvW,OACN2X,EAAKpB,EAAEqB,QACX,IAAK7D,EACD,MAAO,CAAC8D,EAAI,GAChB,GAAS,GAAL9D,EAAQ,CACR,IAAIja,EAAI,IAAI0Y,EAAG+D,EAAE,GAAGxC,EAAI,GAExB,OADAja,EAAEyc,EAAE,GAAGxC,GAAK,EACL,CAACja,EAAG,GAEfyc,EAAEuB,MAAK,SAAU7Y,EAAGtE,GAAK,OAAOsE,EAAE2E,EAAIjJ,EAAEiJ,KAGxC2S,EAAExgB,KAAK,CAAEge,GAAI,EAAGnQ,EAAG,QACnB,IAAIoQ,EAAIuC,EAAE,GAAI9b,EAAI8b,EAAE,GAAIwB,EAAK,EAAGC,EAAK,EAAGC,EAAK,EAO7C,IANA1B,EAAE,GAAK,CAAExC,GAAI,EAAGnQ,EAAGoQ,EAAEpQ,EAAInJ,EAAEmJ,EAAGoQ,EAAGA,EAAGvZ,EAAGA,GAMhCud,GAAMjE,EAAI,GACbC,EAAIuC,EAAEA,EAAEwB,GAAInU,EAAI2S,EAAE0B,GAAIrU,EAAImU,IAAOE,KACjCxd,EAAI8b,EAAEwB,GAAMC,GAAMzB,EAAEwB,GAAInU,EAAI2S,EAAE0B,GAAIrU,EAAImU,IAAOE,KAC7C1B,EAAEyB,KAAQ,CAAEjE,GAAI,EAAGnQ,EAAGoQ,EAAEpQ,EAAInJ,EAAEmJ,EAAGoQ,EAAGA,EAAGvZ,EAAGA,GAE9C,IAAIyd,EAASP,EAAG,GAAG5D,EACnB,IAASpC,EAAI,EAAGA,EAAIoC,IAAKpC,EACjBgG,EAAGhG,GAAGoC,EAAImE,IACVA,EAASP,EAAGhG,GAAGoC,GAGvB,IAAIoE,EAAK,IAAIzF,EAAIwF,EAAS,GAEtBE,EAAMC,EAAG9B,EAAEyB,EAAK,GAAIG,EAAI,GAC5B,GAAIC,EAAMtE,EAAI,CAINnC,EAAI,EAAR,IAAWsF,EAAK,EAEZqB,EAAMF,EAAMtE,EAAIyE,EAAM,GAAKD,EAE/B,IADAX,EAAGG,MAAK,SAAU7Y,EAAGtE,GAAK,OAAOwd,EAAGxd,EAAEoZ,GAAKoE,EAAGlZ,EAAE8U,IAAM9U,EAAE2E,EAAIjJ,EAAEiJ,KACvD+N,EAAIoC,IAAKpC,EAAG,CACf,IAAI6G,EAAOb,EAAGhG,GAAGoC,EACjB,KAAIoE,EAAGK,GAAQ1E,GAKX,MAJAmD,GAAMsB,GAAO,GAAMH,EAAMD,EAAGK,IAC5BL,EAAGK,GAAQ1E,EAMnB,IADAmD,KAAQqB,EACDrB,EAAK,GAAG,CACX,IAAIwB,EAAOd,EAAGhG,GAAGoC,EACboE,EAAGM,GAAQ3E,EACXmD,GAAM,GAAMnD,EAAKqE,EAAGM,KAAU,IAE5B9G,EAEV,KAAOA,GAAK,GAAKsF,IAAMtF,EAAG,CACtB,IAAI+G,EAAOf,EAAGhG,GAAGoC,EACboE,EAAGO,IAAS5E,MACVqE,EAAGO,KACHzB,GAGVmB,EAAMtE,EAEV,MAAO,CAAC,IAAItB,EAAG2F,GAAKC,IAGpBC,EAAK,SAAUlD,EAAGnB,EAAG3U,GACrB,OAAe,GAAR8V,EAAEpB,EACHlX,KAAKhF,IAAIwgB,EAAGlD,EAAEnB,EAAGA,EAAG3U,EAAI,GAAIgZ,EAAGlD,EAAE1a,EAAGuZ,EAAG3U,EAAI,IAC1C2U,EAAEmB,EAAEpB,GAAK1U,GAGhBsZ,EAAK,SAAUvZ,GAGf,IAFA,IAAI2U,EAAI3U,EAAEY,OAEH+T,IAAM3U,IAAI2U,KAMjB,IAJA,IAAI6E,EAAK,IAAIlG,IAAMqB,GAEf8E,EAAM,EAAGC,EAAM1Z,EAAE,GAAI2Z,EAAM,EAC3BC,EAAI,SAAUlf,GAAK8e,EAAGC,KAAS/e,GAC1B6X,EAAI,EAAGA,GAAKoC,IAAKpC,EACtB,GAAIvS,EAAEuS,IAAMmH,GAAOnH,GAAKoC,IAClBgF,MACD,CACD,IAAKD,GAAOC,EAAM,EAAG,CACjB,KAAOA,EAAM,IAAKA,GAAO,IACrBC,EAAE,OACFD,EAAM,IACNC,EAAED,EAAM,GAAOA,EAAM,IAAO,EAAK,MAAUA,EAAM,GAAM,EAAK,OAC5DA,EAAM,QAGT,GAAIA,EAAM,EAAG,CAEd,IADAC,EAAEF,KAAQC,EACHA,EAAM,EAAGA,GAAO,EACnBC,EAAE,MACFD,EAAM,IACNC,EAAID,EAAM,GAAM,EAAK,MAAOA,EAAM,GAE1C,KAAOA,KACHC,EAAEF,GACNC,EAAM,EACND,EAAM1Z,EAAEuS,GAGhB,MAAO,CAACiH,EAAGxD,SAAS,EAAGyD,GAAM9E,IAG7BkF,EAAO,SAAUC,EAAIN,GAErB,IADA,IAAI5E,EAAI,EACCrC,EAAI,EAAGA,EAAIiH,EAAG5Y,SAAU2R,EAC7BqC,GAAKkF,EAAGvH,GAAKiH,EAAGjH,GACpB,OAAOqC,GAIPmF,EAAQ,SAAUC,EAAKpD,EAAKV,GAE5B,IAAIvB,EAAIuB,EAAItV,OACR+U,EAAIE,EAAKe,EAAM,GACnBoD,EAAIrE,GAAS,IAAJhB,EACTqF,EAAIrE,EAAI,GAAKhB,IAAM,EACnBqF,EAAIrE,EAAI,GAAc,IAATqE,EAAIrE,GACjBqE,EAAIrE,EAAI,GAAkB,IAAbqE,EAAIrE,EAAI,GACrB,IAAK,IAAIpD,EAAI,EAAGA,EAAIoC,IAAKpC,EACrByH,EAAIrE,EAAIpD,EAAI,GAAK2D,EAAI3D,GACzB,OAAqB,GAAboD,EAAI,EAAIhB,IAGhBsF,EAAO,SAAU/D,EAAK8D,EAAKrD,EAAOuD,EAAMC,EAAIC,EAAItG,EAAIuG,EAAIC,EAAI7D,EAAIf,GAChE0C,EAAM4B,EAAKtE,IAAKiB,KACdwD,EAAG,KAML,IALA,IAAIlG,EAAKqE,EAAM6B,EAAI,IAAKI,EAAMtG,EAAG,GAAIuG,EAAMvG,EAAG,GAC1CG,EAAKkE,EAAM8B,EAAI,IAAKK,EAAMrG,EAAG,GAAIsG,EAAMtG,EAAG,GAC1CuG,EAAKpB,EAAGgB,GAAMK,EAAOD,EAAG,GAAIE,EAAMF,EAAG,GACrCG,EAAKvB,EAAGkB,GAAMM,EAAOD,EAAG,GAAIE,EAAMF,EAAG,GACrCG,EAAS,IAAI3H,EAAI,IACZf,EAAI,EAAGA,EAAIqI,EAAKha,SAAU2R,EAC/B0I,EAAiB,GAAVL,EAAKrI,MAChB,IAASA,EAAI,EAAGA,EAAIwI,EAAKna,SAAU2R,EAC/B0I,EAAiB,GAAVF,EAAKxI,MAGhB,IAFA,IAAI2I,EAAK5C,EAAM2C,EAAQ,GAAIE,EAAMD,EAAG,GAAIE,EAAOF,EAAG,GAC9CG,EAAO,GACJA,EAAO,IAAMF,EAAIvH,EAAKyH,EAAO,MAAOA,GAE3C,IAKIvE,EAAIwE,EAAIvE,EAAIwE,EALZC,EAAQ/E,EAAK,GAAM,EACnBgF,EAAQ5B,EAAKM,EAAIhF,GAAO0E,EAAKO,EAAIhF,GAAOtB,EACxC4H,EAAQ7B,EAAKM,EAAII,GAAOV,EAAKO,EAAIK,GAAO3G,EAAK,GAAK,EAAIuH,EAAOxB,EAAKoB,EAAQE,IAAQ,EAAIF,EAAO,IAAM,EAAIA,EAAO,IAAM,EAAIA,EAAO,KACnI,GAAIO,GAAQC,GAASD,GAAQE,EACzB,OAAO3B,EAAMC,EAAKtE,EAAGQ,EAAIF,SAASsE,EAAIA,EAAK7D,IAG/C,GADA2B,EAAM4B,EAAKtE,EAAG,GAAKgG,EAAQD,IAAS/F,GAAK,EACrCgG,EAAQD,EAAO,CACf3E,EAAKtC,EAAK+F,EAAKC,EAAK,GAAIc,EAAKf,EAAKxD,EAAKvC,EAAKiG,EAAKC,EAAK,GAAIa,EAAKd,EAC/D,IAAIkB,EAAMnH,EAAK2G,EAAKC,EAAM,GAC1BhD,EAAM4B,EAAKtE,EAAGmF,EAAM,KACpBzC,EAAM4B,EAAKtE,EAAI,EAAGsF,EAAM,GACxB5C,EAAM4B,EAAKtE,EAAI,GAAI2F,EAAO,GAC1B3F,GAAK,GACL,IAASnD,EAAI,EAAGA,EAAI8I,IAAQ9I,EACxB6F,EAAM4B,EAAKtE,EAAI,EAAInD,EAAG4I,EAAIvH,EAAKrB,KACnCmD,GAAK,EAAI2F,EAET,IADA,IAAIO,EAAO,CAAChB,EAAMG,GACTc,EAAK,EAAGA,EAAK,IAAKA,EACvB,KAAIC,GAAOF,EAAKC,GAChB,IAAStJ,EAAI,EAAGA,EAAIuJ,GAAKlb,SAAU2R,EAAG,CAClC,IAAIwJ,GAAgB,GAAVD,GAAKvJ,GACf6F,EAAM4B,EAAKtE,EAAGiG,EAAII,KAAOrG,GAAKyF,EAAIY,IAC9BA,GAAM,KACN3D,EAAM4B,EAAKtE,EAAIoG,GAAKvJ,KAAO,EAAK,KAAMmD,GAAKoG,GAAKvJ,KAAO,WAKnEuE,EAAKzB,EAAKiG,EAAKnG,EAAK4B,EAAKxB,EAAKgG,EAAKnG,EAEvC,IAAS7C,EAAI,EAAGA,EAAI8H,IAAM9H,EACtB,GAAI2H,EAAK3H,GAAK,IAAK,CACXwJ,GAAO7B,EAAK3H,KAAO,GAAM,GAC7B8F,EAAQ2B,EAAKtE,EAAGoB,EAAGiF,GAAM,MAAOrG,GAAK4F,EAAGS,GAAM,KAC1CA,GAAM,IACN3D,EAAM4B,EAAKtE,EAAIwE,EAAK3H,KAAO,GAAM,IAAKmD,GAAKhC,EAAKqI,KACpD,IAAIC,GAAgB,GAAV9B,EAAK3H,GACf8F,EAAQ2B,EAAKtE,EAAGqB,EAAGiF,KAAOtG,GAAK6F,EAAGS,IAC9BA,GAAM,IACN3D,EAAQ2B,EAAKtE,EAAIwE,EAAK3H,KAAO,EAAK,MAAOmD,GAAK/B,EAAKqI,UAGvD3D,EAAQ2B,EAAKtE,EAAGoB,EAAGoD,EAAK3H,KAAMmD,GAAK4F,EAAGpB,EAAK3H,IAInD,OADA8F,EAAQ2B,EAAKtE,EAAGoB,EAAG,MACZpB,EAAI4F,EAAG,MAGdW,EAAoB,IAAIzI,EAAI,CAAC,MAAO,OAAQ,OAAQ,OAAQ,OAAQ,QAAS,QAAS,QAAS,UAE/FiF,EAAmB,IAAIrF,EAAG,GAE1B8I,EAAO,SAAUhG,EAAKiG,EAAKC,EAAMC,EAAKC,EAAMC,GAC5C,IAAI5H,EAAIuB,EAAItV,OACR+U,EAAI,IAAIvC,EAAGiJ,EAAM1H,EAAI,GAAK,EAAIlX,KAAK+e,KAAK7H,EAAI,MAAS2H,GAErD1C,EAAIjE,EAAEK,SAASqG,EAAK1G,EAAE/U,OAAS0b,GAC/B1F,EAAM,EACV,IAAKuF,GAAOxH,EAAI,EACZ,IAAK,IAAIpC,EAAI,EAAGA,GAAKoC,EAAGpC,GAAK,MAAO,CAEhC,IAAI7Y,EAAI6Y,EAAI,MACR7Y,EAAIib,EAEJiC,EAAMmD,EAAMH,EAAGhD,EAAKV,EAAIF,SAASzD,EAAG7Y,KAIpCkgB,EAAErH,GAAKgK,EACP3F,EAAMmD,EAAMH,EAAGhD,EAAKV,EAAIF,SAASzD,EAAGoC,SAI3C,CAeD,IAdA,IAAI8H,EAAMR,EAAIE,EAAM,GAChBpG,EAAI0G,IAAQ,GAAIzc,EAAU,KAANyc,EACpBC,GAAS,GAAKN,GAAQ,EAEtBO,EAAO,IAAIrJ,EAAI,OAAQxP,EAAO,IAAIwP,EAAIoJ,EAAQ,GAC9CE,EAAQnf,KAAK+e,KAAKJ,EAAO,GAAIS,EAAQ,EAAID,EACzCE,EAAM,SAAUvK,GAAK,OAAQ2D,EAAI3D,GAAM2D,EAAI3D,EAAI,IAAMqK,EAAU1G,EAAI3D,EAAI,IAAMsK,GAAUH,GAGvFxC,EAAO,IAAI1G,EAAI,MAEf2G,EAAK,IAAI7G,EAAI,KAAM8G,EAAK,IAAI9G,EAAI,IAEhCyJ,EAAO,EAAGjJ,EAAK,EAAUuG,GAAP9H,EAAI,EAAQ,GAAGyK,EAAK,EAAG1C,EAAK,EAC3C/H,EAAIoC,IAAKpC,EAAG,CAGf,IAAI0K,EAAKH,EAAIvK,GAET2K,EAAW,MAAJ3K,EAAW4K,EAAQrZ,EAAKmZ,GAKnC,GAJAN,EAAKO,GAAQC,EACbrZ,EAAKmZ,GAAMC,EAGPF,GAAMzK,EAAG,CAET,IAAI6K,EAAMzI,EAAIpC,EACd,IAAKwK,EAAO,KAAQ1C,EAAK,QAAU+C,EAAM,IAAK,CAC1CxG,EAAMqD,EAAK/D,EAAK0D,EAAG,EAAGM,EAAMC,EAAIC,EAAItG,EAAIuG,EAAIC,EAAI/H,EAAI+H,EAAI1D,GACxDyD,EAAK0C,EAAOjJ,EAAK,EAAGwG,EAAK/H,EACzB,IAAK,IAAIyB,EAAI,EAAGA,EAAI,MAAOA,EACvBmG,EAAGnG,GAAK,EACZ,IAASA,EAAI,EAAGA,EAAI,KAAMA,EACtBoG,EAAGpG,GAAK,EAGhB,IAAIY,EAAI,EAAG3U,EAAI,EAAGod,EAAOrd,EAAGsd,EAAOJ,EAAOC,EAAS,MACnD,GAAIC,EAAM,GAAKH,GAAMH,EAAIvK,EAAI+K,GAMzB,IALA,IAAIC,EAAO9f,KAAKjF,IAAIud,EAAGqH,GAAO,EAC1BI,EAAO/f,KAAKjF,IAAI,MAAO+Z,GAGvBkL,EAAKhgB,KAAKjF,IAAI,IAAK4kB,GAChBE,GAAOE,KAAUH,GAAQH,GAAQC,GAAO,CAC3C,GAAIjH,EAAI3D,EAAIqC,IAAMsB,EAAI3D,EAAIqC,EAAI0I,GAAM,CAEhC,IADA,IAAII,GAAK,EACFA,GAAKD,GAAMvH,EAAI3D,EAAImL,KAAOxH,EAAI3D,EAAImL,GAAKJ,KAAQI,IAEtD,GAAIA,GAAK9I,EAAG,CAGR,GAFAA,EAAI8I,GAAIzd,EAAIqd,EAERI,GAAKH,EACL,MAIJ,IAAII,GAAMlgB,KAAKjF,IAAI8kB,EAAKI,GAAK,GACzBE,GAAK,EACT,IAAS5J,EAAI,EAAGA,EAAI2J,KAAO3J,EAAG,CAC1B,IAAI6J,GAAMtL,EAAI+K,EAAMtJ,EAAI,MAAS,MAE7BS,GAAMoJ,GADAlB,EAAKkB,IACM,MAAS,MAC1BpJ,GAAKmJ,KACLA,GAAKnJ,GAAI0I,EAAQU,MAMjCP,IADAJ,EAAOC,IAAOA,EAAQR,EAAKO,IACJ,MAAS,MAIxC,GAAIjd,EAAG,CAGHia,EAAKG,KAAQ,UAAalG,EAAMS,IAAM,GAAMN,EAAMrU,GAClD,IAAI6d,GAAiB,GAAX3J,EAAMS,GAASmJ,GAAiB,GAAXzJ,EAAMrU,GACrC6T,GAAMJ,EAAKoK,IAAOnK,EAAKoK,MACrB5D,EAAG,IAAM2D,MACT1D,EAAG2D,IACLf,EAAKzK,EAAIqC,IACPmI,OAGF7C,EAAKG,KAAQnE,EAAI3D,KACf4H,EAAGjE,EAAI3D,KAIrBqE,EAAMqD,EAAK/D,EAAK0D,EAAG2C,EAAKrC,EAAMC,EAAIC,EAAItG,EAAIuG,EAAIC,EAAI/H,EAAI+H,EAAI1D,IAErD2F,GAAa,EAAN3F,IACRA,EAAMmD,EAAMH,EAAGhD,EAAM,EAAG6B,IAEhC,OAAO3C,EAAIH,EAAG,EAAG0G,EAAMxG,EAAKe,GAAO0F,IAGnC0B,EAAqB,WAErB,IADA,IAAI7G,EAAI,IAAI3D,EAAI,KACPjB,EAAI,EAAGA,EAAI,MAAOA,EAAG,CAE1B,IADA,IAAIvS,EAAIuS,EAAG0L,EAAI,IACNA,GACLje,GAAU,EAAJA,GAAU,YAAeA,IAAM,EACzCmX,EAAE5E,GAAKvS,EAEX,OAAOmX,EARc,GAWrB+G,EAAM,WACN,IAAIle,GAAK,EACT,MAAO,CACH0V,EAAG,SAAUzV,GAGT,IADA,IAAIke,EAAKne,EACAuS,EAAI,EAAGA,EAAItS,EAAEW,SAAU2R,EAC5B4L,EAAKH,EAAW,IAALG,EAAYle,EAAEsS,IAAO4L,IAAO,EAC3Cne,EAAIme,GAERle,EAAG,WAAc,OAAQD,KAI7Boe,EAAQ,WACR,IAAIve,EAAI,EAAGtE,EAAI,EACf,MAAO,CACHma,EAAG,SAAUzV,GAIT,IAFA,IAAI8V,EAAIlW,EAAGqV,EAAI3Z,EACXqZ,EAAI3U,EAAEW,OACD2R,EAAI,EAAGA,GAAKqC,GAAI,CAErB,IADA,IAAIlb,EAAI+D,KAAKjF,IAAI+Z,EAAI,KAAMqC,GACpBrC,EAAI7Y,IAAK6Y,EACZ2C,GAAKa,GAAK9V,EAAEsS,GAChBwD,GAAS,MAAJA,GAAa,IAAMA,GAAK,IAAKb,GAAS,MAAJA,GAAa,IAAMA,GAAK,IAEnErV,EAAIkW,EAAGxa,EAAI2Z,GAEfjV,EAAG,WAEC,OAAY,KADZJ,GAAK,SACe,GAAMA,IAAM,GAAM,IAAU,KADpCtE,GAAK,SACuC,EAAKA,IAAM,KAM3E8iB,EAAO,SAAUnI,EAAKuG,EAAKJ,EAAKC,EAAMlG,GACtC,OAAO8F,EAAKhG,EAAkB,MAAbuG,EAAI6B,MAAgB,EAAI7B,EAAI6B,MAAkB,MAAX7B,EAAI8B,IAAc9gB,KAAK+e,KAAuD,IAAlD/e,KAAKhF,IAAI,EAAGgF,KAAKjF,IAAI,GAAIiF,KAAK+gB,IAAItI,EAAItV,WAAoB,GAAK6b,EAAI8B,IAAMlC,EAAKC,GAAOlG,IAGrKqI,EAAM,SAAU5e,EAAGtE,GACnB,IAAIoa,EAAI,GACR,IAAK,IAAIsI,KAAKpe,EACV8V,EAAEsI,GAAKpe,EAAEoe,GACb,IAAK,IAAIA,KAAK1iB,EACVoa,EAAEsI,GAAK1iB,EAAE0iB,GACb,OAAOtI,GASP+I,EAAO,SAAUC,EAAIC,EAAOC,GAI5B,IAHA,IAAIhH,EAAK8G,IACLvI,EAAKuI,EAAGrkB,WACRwkB,EAAK1I,EAAGoC,MAAMpC,EAAG/c,QAAQ,KAAO,EAAG+c,EAAG2I,YAAY,MAAMC,QAAQ,KAAM,IAAIC,MAAM,KAC3E1M,EAAI,EAAGA,EAAIsF,EAAGjX,SAAU2R,EAAG,CAChC,IAAI7X,EAAImd,EAAGtF,GAAI0L,EAAIa,EAAGvM,GACtB,GAAgB,mBAAL7X,EAAiB,CACxBkkB,GAAS,IAAMX,EAAI,IACnB,IAAIiB,EAAOxkB,EAAEJ,WACb,GAAII,EAAEykB,UAEF,IAAsC,GAAlCD,EAAK7lB,QAAQ,iBAAwB,CACrC,IAAI+lB,EAAQF,EAAK7lB,QAAQ,IAAK,GAAK,EACnCulB,GAASM,EAAK1G,MAAM4G,EAAOF,EAAK7lB,QAAQ,IAAK+lB,SAI7C,IAAK,IAAIjI,KADTyH,GAASM,EACKxkB,EAAEykB,UACZP,GAAS,IAAMX,EAAI,cAAgB9G,EAAI,IAAMzc,EAAEykB,UAAUhI,GAAG7c,gBAIpEskB,GAASM,OAGbL,EAAGZ,GAAKvjB,EAEhB,MAAO,CAACkkB,EAAOC,IAEfQ,GAAK,GAWLC,GAAO,SAAUC,EAAKC,EAAMlpB,EAAImpB,GAChC,IAAIxL,EACJ,IAAKoL,GAAG/oB,GAAK,CAET,IADA,IAAIsoB,EAAQ,GAAIc,EAAO,GAAIxK,EAAIqK,EAAI3e,OAAS,EACnC2R,EAAI,EAAGA,EAAI2C,IAAK3C,EACWqM,GAAhC3K,EAAKyK,EAAKa,EAAIhN,GAAIqM,EAAOc,IAAkB,GAAIA,EAAOzL,EAAG,GAC7DoL,GAAG/oB,GAAMooB,EAAKa,EAAIrK,GAAI0J,EAAOc,GAEjC,IAAIb,EAAKJ,EAAI,GAAIY,GAAG/oB,GAAI,IACxB,OArxBK,SAAW0J,EAAG1J,EAAIqpB,EAAKC,EAAUH,GACtC,IAAI7F,EAAI7G,EAAIL,EAAIpc,KAAQoc,EAAIpc,GAAMqc,EAAK3S,KAIvC,OAHA4Z,EAAEiG,QAAU,SAAUnmB,GAAK,OAAO+lB,EAAG/lB,EAAEyK,MAAO,OAC9CyV,EAAEkG,UAAY,SAAUpmB,GAAK,OAAO+lB,EAAG,KAAM/lB,EAAEqmB,OAC/CnG,EAAEoG,YAAYL,EAAKC,GACZhG,EAgxBAqG,CAAGZ,GAAG/oB,GAAI,GAAK,0EAA4EkpB,EAAKllB,WAAa,IAAKhE,EAAIuoB,EAlBtH,SAAUnkB,GACjB,IAAI4c,EAAK,GACT,IAAK,IAAI2G,KAAKvjB,GACNA,EAAEujB,aAAc7K,GAAM1Y,EAAEujB,aAAc3K,GAAO5Y,EAAEujB,aAAczK,IAC7D8D,EAAG3gB,MAAM+D,EAAEujB,GAAK,IAAIvjB,EAAEujB,GAAG5oB,YAAYqF,EAAEujB,KAAKiC,QAEpD,OAAO5I,EAY0H6I,CAAKtB,GAAKY,IAG3IW,GAAS,WAAc,MAAO,CAAChN,EAAIE,EAAKE,EAAKE,EAAMC,EAAMC,EAAMM,EAAIG,EAAIiB,EAAME,EAAMjB,EAAKC,EAAM/b,EAAKgd,EAAMG,EAAQC,EAAMC,EAAKG,EAAOoK,GAAaC,GAAKC,KACrJC,GAAQ,WAAc,MAAO,CAACpN,EAAIE,EAAKE,EAAKE,EAAMC,EAAMC,EAAMO,EAAOG,EAAOe,EAAKF,EAAKI,EAAKH,EAAKb,EAAK0H,EAAKxD,EAAIjE,EAAM4D,EAAOC,EAASC,EAAOW,EAAIM,EAAIM,EAAME,EAAOE,EAAMpE,EAAMC,EAAKoG,EAAMmC,EAAMoC,GAAaH,KAE1MI,GAAM,WAAc,MAAO,CAACC,GAAKC,GAAMC,GAAQ3C,EAAKF,IAEpD8C,GAAO,WAAc,MAAO,CAACC,GAAKC,KAElCC,GAAM,WAAc,MAAO,CAACC,GAAKL,GAAQzC,IAEzC+C,GAAO,WAAc,MAAO,CAACC,KAE7Bd,GAAM,SAAUX,GAAO,OAAOK,YAAYL,EAAK,CAACA,EAAIO,UAEpDK,GAAM,SAAU5K,GAAK,OAAOA,GAAKA,EAAE0L,MAAQ,IAAIjO,EAAGuC,EAAE0L,OAEpDC,GAAQ,SAAUpL,EAAKqL,EAAMhC,EAAKC,EAAMlpB,EAAImpB,GAC5C,IAAI7F,EAAI0F,GAAKC,EAAKC,EAAMlpB,GAAI,SAAUkrB,EAAKtL,GACvC0D,EAAE6H,YACFhC,EAAG+B,EAAKtL,MAGZ,OADA0D,EAAEoG,YAAY,CAAC9J,EAAKqL,GAAOA,EAAKG,QAAU,CAACxL,EAAIgK,QAAU,IAClD,WAActG,EAAE6H,cAGvBE,GAAQ,SAAUC,GAElB,OADAA,EAAKC,OAAS,SAAU3L,EAAKS,GAAS,OAAOqJ,YAAY,CAAC9J,EAAKS,GAAQ,CAACT,EAAIgK,UACrE,SAAU4B,GAAM,OAAOF,EAAKjrB,KAAKmrB,EAAG/B,KAAK,GAAI+B,EAAG/B,KAAK,MAG5DgC,GAAW,SAAUxC,EAAKqC,EAAML,EAAM/B,EAAMlpB,GAC5C,IAAI6gB,EACAyC,EAAI0F,GAAKC,EAAKC,EAAMlpB,GAAI,SAAUkrB,EAAKtL,GACnCsL,GACA5H,EAAE6H,YAAaG,EAAKC,OAAOrqB,KAAKoqB,EAAMJ,KAElCtL,EAAI,IACJ0D,EAAE6H,YACNG,EAAKC,OAAOrqB,KAAKoqB,EAAMJ,EAAKtL,EAAI,GAAIA,EAAI,QAGhD0D,EAAEoG,YAAYuB,GACdK,EAAKjrB,KAAO,SAAUsJ,EAAGuE,GACrB,GAAI2S,EACA,KAAM,kBACV,IAAKyK,EAAKC,OACN,KAAM,oBACVjI,EAAEoG,YAAY,CAAC/f,EAAGkX,EAAI3S,GAAI,CAACvE,EAAEigB,UAEjC0B,EAAKH,UAAY,WAAc7H,EAAE6H,cAGjCO,GAAK,SAAU/hB,EAAG1E,GAAK,OAAO0E,EAAE1E,GAAM0E,EAAE1E,EAAI,IAAM,GAElD0mB,GAAK,SAAUhiB,EAAG1E,GAAK,OAAQ0E,EAAE1E,GAAM0E,EAAE1E,EAAI,IAAM,EAAM0E,EAAE1E,EAAI,IAAM,GAAO0E,EAAE1E,EAAI,IAAM,MAAS,GACjG2mB,GAAK,SAAUjiB,EAAG1E,GAAK,OAAO0mB,GAAGhiB,EAAG1E,GAAqB,WAAf0mB,GAAGhiB,EAAG1E,EAAI,IAEpDslB,GAAS,SAAU5gB,EAAG1E,EAAGb,GACzB,KAAOA,IAAKa,EACR0E,EAAE1E,GAAKb,EAAGA,KAAO,GAGrBimB,GAAM,SAAU3gB,EAAG2V,GACnB,IAAIgJ,EAAKhJ,EAAEwM,SAIX,GAHAniB,EAAE,GAAK,GAAIA,EAAE,GAAK,IAAKA,EAAE,GAAK,EAAGA,EAAE,GAAK2V,EAAE2I,MAAQ,EAAI,EAAe,GAAX3I,EAAE2I,MAAa,EAAI,EAAGte,EAAE,GAAK,EACxE,GAAX2V,EAAEyM,OACFvB,GAAO7gB,EAAG,EAAGvC,KAAK8D,MAAM,IAAI8gB,KAAK1M,EAAEyM,OAASC,KAAKC,OAAS,MAC1D3D,EAAI,CACJ3e,EAAE,GAAK,EACP,IAAK,IAAIuS,EAAI,EAAGA,GAAKoM,EAAG/d,SAAU2R,EAC9BvS,EAAEuS,EAAI,IAAMoM,EAAG4D,WAAWhQ,KAKlCwO,GAAM,SAAU9gB,GAChB,GAAY,IAARA,EAAE,IAAoB,KAARA,EAAE,IAAqB,GAARA,EAAE,GAC/B,KAAM,oBACV,IAAIuiB,EAAMviB,EAAE,GACRmW,EAAK,GACC,EAANoM,IACApM,GAAMnW,EAAE,IAAqB,GAAdA,EAAE,KAAO,IAC5B,IAAK,IAAIwiB,GAAMD,GAAO,EAAI,IAAMA,GAAO,EAAI,GAAIC,EAAK,EAAGA,IAAOxiB,EAAEmW,MAEhE,OAAOA,GAAY,EAANoM,IAGbxB,GAAM,SAAU/gB,GAChB,IAAI2U,EAAI3U,EAAEW,OACV,OAASX,EAAE2U,EAAI,GAAK3U,EAAE2U,EAAI,IAAM,EAAI3U,EAAE2U,EAAI,IAAM,GAAO3U,EAAE2U,EAAI,IAAM,MAAS,GAG5EgM,GAAO,SAAUjL,GAAK,OAAO,IAAOA,EAAEwM,UAAaxM,EAAEwM,SAASvhB,OAAS,GAAO,IAE9EsgB,GAAM,SAAUlhB,EAAG2V,GACnB,IAAI+M,EAAK/M,EAAE2I,MAAOpK,EAAW,GAANwO,EAAU,EAAIA,EAAK,EAAI,EAAU,GAANA,EAAU,EAAI,EAChE1iB,EAAE,GAAK,IAAKA,EAAE,GAAMkU,GAAM,GAAMA,EAAM,GAAK,EAAIA,EAAM,IAGrDkN,GAAM,SAAUnhB,GAChB,GAAmB,IAAP,GAAPA,EAAE,KAAkBA,EAAE,KAAO,EAAK,IAAOA,EAAE,IAAM,EAAIA,EAAE,IAAM,GAC9D,KAAM,oBACV,GAAW,GAAPA,EAAE,GACF,KAAM,wDAEd,SAAS0iB,GAAapB,EAAM9B,GAIxB,OAHKA,GAAqB,mBAAR8B,IACd9B,EAAK8B,EAAMA,EAAO,IACtB5rB,KAAKksB,OAASpC,EACP8B,EAMX,IAAIqB,GAAyB,WACzB,SAASA,EAAQrB,EAAM9B,GACdA,GAAqB,mBAAR8B,IACd9B,EAAK8B,EAAMA,EAAO,IACtB5rB,KAAKksB,OAASpC,EACd9pB,KAAKggB,EAAI4L,GAAQ,GAkBrB,OAhBAqB,EAAQzD,UAAUzJ,EAAI,SAAU1V,EAAGwE,GAC/B7O,KAAKksB,OAAOxD,EAAKre,EAAGrK,KAAKggB,EAAG,EAAG,GAAInR,GAAIA,IAO3Coe,EAAQzD,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACtC,GAAIhhB,KAAKsK,EACL,KAAM,kBACV,IAAKtK,KAAKksB,OACN,KAAM,oBACVlsB,KAAKsK,EAAI0W,EACThhB,KAAK+f,EAAEmN,EAAOlM,IAAS,IAEpBiM,EAvBiB,GA6BxBE,GAA8B,WAU9B,OATA,SAAsBvB,EAAM9B,GACxBsC,GAAS,CACLvB,GACA,WAAc,MAAO,CAACmB,GAAOiB,MAC9BjtB,KAAMgtB,GAAanrB,KAAK7B,KAAM4rB,EAAM9B,IAAK,SAAUqC,GAClD,IAAIF,EAAO,IAAIgB,GAAQd,EAAG/B,MAC1BD,UAAY6B,GAAMC,KACnB,IARsB,GAa1B,SAASmB,GAAQhD,EAAMwB,EAAM9B,GAGhC,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAO6B,GAAMvB,EAAMwB,EAAM,CACrBf,KACD,SAAUsB,GAAM,OAAOxB,GAAIG,GAAYqB,EAAG/B,KAAK,GAAI+B,EAAG/B,KAAK,OAAS,EAAGN,GAQvE,SAASgB,GAAYV,EAAMwB,GAC9B,OAAOlD,EAAK0B,EAAMwB,GAAQ,GAAI,EAAG,GAKrC,IAAIyB,GAAyB,WAKzB,SAASA,EAAQvD,GACb9pB,KAAKgf,EAAI,GACThf,KAAK+f,EAAI,IAAItC,EAAG,GAChBzd,KAAKksB,OAASpC,EA2BlB,OAzBAuD,EAAQ7D,UAAUzlB,EAAI,SAAUsG,GAC5B,GAAIrK,KAAKsK,EACL,KAAM,kBACV,IAAKtK,KAAKksB,OACN,KAAM,oBACV,IAAIjN,EAAIjf,KAAK+f,EAAE9U,OACXmV,EAAI,IAAI3C,EAAGwB,EAAI5U,EAAEY,QACrBmV,EAAE5I,IAAIxX,KAAK+f,GAAIK,EAAE5I,IAAInN,EAAG4U,GAAIjf,KAAK+f,EAAIK,GAEzCiN,EAAQ7D,UAAUnf,EAAI,SAAU2W,GAC5BhhB,KAAKsK,EAAItK,KAAKgf,EAAEpC,EAAIoE,IAAS,EAC7B,IAAIsM,EAAMttB,KAAKgf,EAAEpZ,EACbsc,EAAK5B,EAAMtgB,KAAK+f,EAAG/f,KAAKggB,EAAGhgB,KAAKgf,GACpChf,KAAKksB,OAAO/L,EAAI+B,EAAIoL,EAAKttB,KAAKgf,EAAEpZ,GAAI5F,KAAKsK,GACzCtK,KAAKggB,EAAIG,EAAI+B,EAAIliB,KAAKgf,EAAEpZ,EAAI,OAAQ5F,KAAKgf,EAAEpZ,EAAI5F,KAAKggB,EAAE/U,OACtDjL,KAAK+f,EAAII,EAAIngB,KAAK+f,EAAI/f,KAAKgf,EAAEe,EAAI,EAAK,GAAI/f,KAAKgf,EAAEe,GAAK,GAO1DsN,EAAQ7D,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACtChhB,KAAK+D,EAAEmpB,GAAQltB,KAAKqK,EAAE2W,IAEnBqM,EAnCiB,GAyCxBE,GAA8B,WAe9B,OAVA,SAAsBzD,GAClB9pB,KAAKksB,OAASpC,EACdsC,GAAS,CACL3B,GACA,WAAc,MAAO,CAACuB,GAAOqB,MAC9BrtB,KAAM,GAAG,WACR,IAAIisB,EAAO,IAAIoB,GACflD,UAAY6B,GAAMC,KACnB,IAbsB,GAkB1B,SAASuB,GAAQpD,EAAMwB,EAAM9B,GAGhC,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAO6B,GAAMvB,EAAMwB,EAAM,CACrBnB,KACD,SAAU0B,GAAM,OAAOxB,GAAID,GAAYyB,EAAG/B,KAAK,GAAIQ,GAAIuB,EAAG/B,KAAK,QAAU,EAAGN,GAQ5E,SAASY,GAAYN,EAAM/F,GAC9B,OAAO/D,EAAM8J,EAAM/F,GAMvB,IAAIoJ,GAAsB,WACtB,SAASA,EAAK7B,EAAM9B,GAChB9pB,KAAKqK,EAAIke,IACTvoB,KAAKif,EAAI,EACTjf,KAAK+E,EAAI,EACTkoB,GAAQprB,KAAK7B,KAAM4rB,EAAM9B,GAoB7B,OAbA2D,EAAKjE,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACnCiM,GAAQzD,UAAUxoB,KAAKa,KAAK7B,KAAMktB,EAAOlM,IAE7CyM,EAAKjE,UAAUzJ,EAAI,SAAU1V,EAAGwE,GAC5B7O,KAAKqK,EAAE0V,EAAE1V,GACTrK,KAAKif,GAAK5U,EAAEY,OACZ,IAAIyiB,EAAMhF,EAAKre,EAAGrK,KAAKggB,EAAGhgB,KAAK+E,GAAKkmB,GAAKjrB,KAAKggB,GAAInR,GAAK,GAAIA,GACvD7O,KAAK+E,IACLimB,GAAI0C,EAAK1tB,KAAKggB,GAAIhgB,KAAK+E,EAAI,GAC3B8J,IACAqc,GAAOwC,EAAKA,EAAIziB,OAAS,EAAGjL,KAAKqK,EAAEC,KAAM4gB,GAAOwC,EAAKA,EAAIziB,OAAS,EAAGjL,KAAKif,IAC9Ejf,KAAKksB,OAAOwB,EAAK7e,IAEd4e,EAzBc,GA+BrBE,GAA2B,WAW3B,OAVA,SAAmB/B,EAAM9B,GACrBsC,GAAS,CACLvB,GACAE,GACA,WAAc,MAAO,CAACiB,GAAOiB,GAASQ,MACvCztB,KAAMgtB,GAAanrB,KAAK7B,KAAM4rB,EAAM9B,IAAK,SAAUqC,GAClD,IAAIF,EAAO,IAAIwB,GAAKtB,EAAG/B,MACvBD,UAAY6B,GAAMC,KACnB,IATmB,GAcvB,SAAS2B,GAAKxD,EAAMwB,EAAM9B,GAG7B,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAO6B,GAAMvB,EAAMwB,EAAM,CACrBf,GACAE,GACA,WAAc,MAAO,CAAC8C,OACvB,SAAU1B,GAAM,OAAOxB,GAAIkD,GAAS1B,EAAG/B,KAAK,GAAI+B,EAAG/B,KAAK,OAAS,EAAGN,GAQpE,SAAS+D,GAASzD,EAAMwB,GACtBA,IACDA,EAAO,IACX,IAAIvhB,EAAIke,IAAOtJ,EAAImL,EAAKnf,OACxBZ,EAAE0V,EAAEqK,GACJ,IAAI9f,EAAIoe,EAAK0B,EAAMwB,EAAMX,GAAKW,GAAO,GAAI5M,EAAI1U,EAAEW,OAC/C,OAAO+f,GAAI1gB,EAAGshB,GAAOV,GAAO5gB,EAAG0U,EAAI,EAAG3U,EAAEC,KAAM4gB,GAAO5gB,EAAG0U,EAAI,EAAGC,GAAI3U,EAKvE,IAAIwjB,GAAwB,WAKxB,SAASA,EAAOhE,GACZ9pB,KAAK+E,EAAI,EACTsoB,GAAQxrB,KAAK7B,KAAM8pB,GAwBvB,OAjBAgE,EAAOtE,UAAUxoB,KAAO,SAAUksB,EAAOlM,GAErC,GADAqM,GAAQ7D,UAAUzlB,EAAElC,KAAK7B,KAAMktB,GAC3BltB,KAAK+E,EAAG,CACR,IAAIia,EAAIhf,KAAK+f,EAAE9U,OAAS,EAAImgB,GAAIprB,KAAK+f,GAAK,EAC1C,GAAIf,GAAKhf,KAAK+f,EAAE9U,SAAW+V,EACvB,OACJhhB,KAAK+f,EAAI/f,KAAK+f,EAAEM,SAASrB,GAAIhf,KAAK+E,EAAI,EAE1C,GAAIic,EAAO,CACP,GAAIhhB,KAAK+f,EAAE9U,OAAS,EAChB,KAAM,sBACVjL,KAAK+f,EAAI/f,KAAK+f,EAAEM,SAAS,GAAI,GAIjCgN,GAAQ7D,UAAUnf,EAAExI,KAAK7B,KAAMghB,IAE5B8M,EA/BgB,GAqCvBC,GAA6B,WAgB7B,OAXA,SAAqBjE,GACjB9pB,KAAKksB,OAASpC,EACdsC,GAAS,CACL3B,GACAU,GACA,WAAc,MAAO,CAACa,GAAOqB,GAASS,MACvC9tB,KAAM,GAAG,WACR,IAAIisB,EAAO,IAAI6B,GACf3D,UAAY6B,GAAMC,KACnB,IAdqB,GAmBzB,SAAS+B,GAAO5D,EAAMwB,EAAM9B,GAG/B,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAO6B,GAAMvB,EAAMwB,EAAM,CACrBnB,GACAU,GACA,WAAc,MAAO,CAAC8C,OACvB,SAAU9B,GAAM,OAAOxB,GAAIsD,GAAW9B,EAAG/B,KAAK,OAAS,EAAGN,GAQ1D,SAASmE,GAAW7D,EAAM/F,GAC7B,OAAO/D,EAAM8J,EAAK/J,SAAS+K,GAAIhB,IAAQ,GAAI/F,GAAO,IAAI5G,EAAG4N,GAAIjB,KAKjE,IAAI8D,GAAsB,WACtB,SAASA,EAAKtC,EAAM9B,GAChB9pB,KAAKqK,EAAIoe,IACTzoB,KAAK+E,EAAI,EACTkoB,GAAQprB,KAAK7B,KAAM4rB,EAAM9B,GAmB7B,OAZAoE,EAAK1E,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACnCiM,GAAQzD,UAAUxoB,KAAKa,KAAK7B,KAAMktB,EAAOlM,IAE7CkN,EAAK1E,UAAUzJ,EAAI,SAAU1V,EAAGwE,GAC5B7O,KAAKqK,EAAE0V,EAAE1V,GACT,IAAIqjB,EAAMhF,EAAKre,EAAGrK,KAAKggB,EAAGhgB,KAAK+E,GAAK,EAAG8J,GAAK,GAAIA,GAC5C7O,KAAK+E,IACLwmB,GAAImC,EAAK1tB,KAAKggB,GAAIhgB,KAAK+E,EAAI,GAC3B8J,GACAqc,GAAOwC,EAAKA,EAAIziB,OAAS,EAAGjL,KAAKqK,EAAEC,KACvCtK,KAAKksB,OAAOwB,EAAK7e,IAEdqf,EAvBc,GA6BrBC,GAA2B,WAW3B,OAVA,SAAmBvC,EAAM9B,GACrBsC,GAAS,CACLvB,GACAS,GACA,WAAc,MAAO,CAACU,GAAOiB,GAASiB,MACvCluB,KAAMgtB,GAAanrB,KAAK7B,KAAM4rB,EAAM9B,IAAK,SAAUqC,GAClD,IAAIF,EAAO,IAAIiC,GAAK/B,EAAG/B,MACvBD,UAAY6B,GAAMC,KACnB,KATmB,GAcvB,SAASmC,GAAKhE,EAAMwB,EAAM9B,GAG7B,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAO6B,GAAMvB,EAAMwB,EAAM,CACrBf,GACAS,GACA,WAAc,MAAO,CAAC+C,OACvB,SAAUlC,GAAM,OAAOxB,GAAI0D,GAASlC,EAAG/B,KAAK,GAAI+B,EAAG/B,KAAK,OAAS,EAAGN,GAQpE,SAASuE,GAASjE,EAAMwB,GACtBA,IACDA,EAAO,IACX,IAAI1hB,EAAIue,IACRve,EAAE6V,EAAEqK,GACJ,IAAI9f,EAAIoe,EAAK0B,EAAMwB,EAAM,EAAG,GAC5B,OAAOL,GAAIjhB,EAAGshB,GAAOV,GAAO5gB,EAAGA,EAAEW,OAAS,EAAGf,EAAEI,KAAMA,EAKzD,IAAIgkB,GAAwB,WAKxB,SAASA,EAAOxE,GACZ9pB,KAAK+E,EAAI,EACTsoB,GAAQxrB,KAAK7B,KAAM8pB,GAuBvB,OAhBAwE,EAAO9E,UAAUxoB,KAAO,SAAUksB,EAAOlM,GAErC,GADAqM,GAAQ7D,UAAUzlB,EAAElC,KAAK7B,KAAMktB,GAC3BltB,KAAK+E,EAAG,CACR,GAAI/E,KAAK+f,EAAE9U,OAAS,IAAM+V,EACtB,OACJhhB,KAAK+f,EAAI/f,KAAK+f,EAAEM,SAAS,GAAIrgB,KAAK+E,EAAI,EAE1C,GAAIic,EAAO,CACP,GAAIhhB,KAAK+f,EAAE9U,OAAS,EAChB,KAAM,sBACVjL,KAAK+f,EAAI/f,KAAK+f,EAAEM,SAAS,GAAI,GAIjCgN,GAAQ7D,UAAUnf,EAAExI,KAAK7B,KAAMghB,IAE5BsN,EA9BgB,GAoCvBC,GAA6B,WAgB7B,OAXA,SAAqBzE,GACjB9pB,KAAKksB,OAASpC,EACdsC,GAAS,CACL3B,GACAe,GACA,WAAc,MAAO,CAACQ,GAAOqB,GAASiB,MACvCtuB,KAAM,GAAG,WACR,IAAIisB,EAAO,IAAIqC,GACfnE,UAAY6B,GAAMC,KACnB,KAdqB,GAmBzB,SAASuC,GAAOpE,EAAMwB,EAAM9B,GAG/B,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAO6B,GAAMvB,EAAMwB,EAAM,CACrBnB,GACAe,GACA,WAAc,MAAO,CAACiD,OACvB,SAAUtC,GAAM,OAAOxB,GAAI8D,GAAWtC,EAAG/B,KAAK,GAAIQ,GAAIuB,EAAG/B,KAAK,QAAU,EAAGN,GAQ3E,SAAS2E,GAAWrE,EAAM/F,GAC7B,OAAO/D,GAAOmL,GAAIrB,GAAOA,EAAK/J,SAAS,GAAI,IAAKgE,GASpD,IAAIqK,GAA4B,WAK5B,SAASA,EAAW5E,GAChB9pB,KAAK2uB,EAAIb,GACT9tB,KAAK4uB,EAAIvB,GACTrtB,KAAK6uB,EAAIP,GACTtuB,KAAKksB,OAASpC,EAgClB,OAzBA4E,EAAWlF,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACzC,IAAKhhB,KAAKksB,OACN,KAAM,oBACV,GAAKlsB,KAAKgf,EAoBNhf,KAAKgf,EAAEhe,KAAKksB,EAAOlM,OApBV,CACT,GAAIhhB,KAAK+f,GAAK/f,KAAK+f,EAAE9U,OAAQ,CACzB,IAAImV,EAAI,IAAI3C,EAAGzd,KAAK+f,EAAE9U,OAASiiB,EAAMjiB,QACrCmV,EAAE5I,IAAIxX,KAAK+f,GAAIK,EAAE5I,IAAI0V,EAAOltB,KAAK+f,EAAE9U,aAGnCjL,KAAK+f,EAAImN,EACb,GAAIltB,KAAK+f,EAAE9U,OAAS,EAAG,CACnB,IAAI6jB,EAAU9uB,KACV8pB,EAAK,WAAcgF,EAAQ5C,OAAO6C,MAAMD,EAASE,YACrDhvB,KAAKgf,EAAkB,IAAbhf,KAAK+f,EAAE,IAAyB,KAAb/f,KAAK+f,EAAE,IAA0B,GAAb/f,KAAK+f,EAAE,GAClD,IAAI/f,KAAK2uB,EAAE7E,GACU,IAAP,GAAZ9pB,KAAK+f,EAAE,KAAkB/f,KAAK+f,EAAE,IAAM,EAAK,IAAO/f,KAAK+f,EAAE,IAAM,EAAI/f,KAAK+f,EAAE,IAAM,GAC9E,IAAI/f,KAAK4uB,EAAE9E,GACX,IAAI9pB,KAAK6uB,EAAE/E,GACrB9pB,KAAKgf,EAAEhe,KAAKhB,KAAK+f,EAAGiB,GACpBhhB,KAAK+f,EAAI,QAMd2O,EAzCoB,GA+C3BO,GAAiC,WAKjC,SAASA,EAAgBnF,GACrB9pB,KAAK2uB,EAAIZ,GACT/tB,KAAK4uB,EAAIrB,GACTvtB,KAAK6uB,EAAIN,GACTvuB,KAAKksB,OAASpC,EAUlB,OAHAmF,EAAgBzF,UAAUxoB,KAAO,SAAUksB,EAAOlM,GAC9C0N,GAAWlF,UAAUxoB,KAAKa,KAAK7B,KAAMktB,EAAOlM,IAEzCiO,EAnByB,GAsB7B,SAASC,GAAW9E,EAAMwB,EAAM9B,GAGnC,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,OAAmB,IAAXM,EAAK,IAAuB,KAAXA,EAAK,IAAwB,GAAXA,EAAK,GAC1C4D,GAAO5D,EAAMwB,EAAM9B,GACA,IAAP,GAAVM,EAAK,KAAkBA,EAAK,IAAM,EAAK,IAAOA,EAAK,IAAM,EAAIA,EAAK,IAAM,GACtEoD,GAAQpD,EAAMwB,EAAM9B,GACpB0E,GAAOpE,EAAMwB,EAAM9B,GAQ1B,SAASqF,GAAe/E,EAAM/F,GACjC,OAAmB,IAAX+F,EAAK,IAAuB,KAAXA,EAAK,IAAwB,GAAXA,EAAK,GAC1C6D,GAAW7D,EAAM/F,GACE,IAAP,GAAV+F,EAAK,KAAkBA,EAAK,IAAM,EAAK,IAAOA,EAAK,IAAM,EAAIA,EAAK,IAAM,GACtEM,GAAYN,EAAM/F,GAClBoK,GAAWrE,EAAM/F,GAG/B,IAAI+K,GAAO,SAAU9kB,EAAGyV,EAAGyB,EAAGxB,GAC1B,IAAK,IAAIsI,KAAKhe,EAAG,CACb,IAAI+kB,EAAM/kB,EAAEge,GAAIlI,EAAIL,EAAIuI,EACpB+G,aAAe5R,EACf+D,EAAEpB,GAAK,CAACiP,EAAKrP,GACR3a,MAAMC,QAAQ+pB,GACnB7N,EAAEpB,GAAK,CAACiP,EAAI,GAAIvG,EAAI9I,EAAGqP,EAAI,KAE3BD,GAAKC,EAAKjP,EAAI,IAAKoB,EAAGxB,KAI9BsP,GAA2B,oBAAfC,aAA4C,IAAIA,YAE5DrG,GAA2B,oBAAfsG,aAA4C,IAAIA,YAE5DC,GAAM,EACV,IACIvG,GAAGwG,OAAO5M,EAAI,CAAE6M,QAAQ,IACxBF,GAAM,EAEV,MAAO1rB,KAEP,IAAI6rB,GAAQ,SAAUtlB,GAClB,IAAK,IAAI5E,EAAI,GAAIkX,EAAI,IAAK,CACtB,IAAIvS,EAAIC,EAAEsS,KACNuB,GAAM9T,EAAI,MAAQA,EAAI,MAAQA,EAAI,KACtC,GAAIuS,EAAIuB,EAAK7T,EAAEW,OACX,MAAO,CAACvF,EAAGya,EAAI7V,EAAGsS,EAAI,IACrBuB,EAEU,GAANA,GACL9T,IAAU,GAAJA,IAAW,IAAe,GAATC,EAAEsS,OAAc,IAAe,GAATtS,EAAEsS,OAAc,EAAc,GAATtS,EAAEsS,MAAc,MAC9ElX,GAAKmqB,OAAOC,aAAa,MAASzlB,GAAK,GAAK,MAAa,KAAJA,IAGzD3E,GADU,EAALyY,EACA0R,OAAOC,cAAkB,GAAJzlB,IAAW,EAAc,GAATC,EAAEsS,MAEvCiT,OAAOC,cAAkB,GAAJzlB,IAAW,IAAe,GAATC,EAAEsS,OAAc,EAAc,GAATtS,EAAEsS,MARlElX,GAAKmqB,OAAOC,aAAazlB,KAcjC0lB,GAA4B,WAK5B,SAASA,EAAWjG,GAChB9pB,KAAKksB,OAASpC,EACV2F,GACAzvB,KAAKwhB,EAAI,IAAIgO,YAEbxvB,KAAK+f,EAAI+C,EAmCjB,OA5BAiN,EAAWvG,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACzC,IAAKhhB,KAAKksB,OACN,KAAM,cAEV,GADAlL,IAAUA,EACNhhB,KAAKwhB,GAEL,GADAxhB,KAAKksB,OAAOlsB,KAAKwhB,EAAEkO,OAAOxC,EAAO,CAAEyC,QAAQ,IAAS3O,GAChDA,EAAO,CACP,GAAIhhB,KAAKwhB,EAAEkO,SAASzkB,OAChB,KAAM,qBACVjL,KAAKwhB,EAAI,UALjB,CASA,IAAKxhB,KAAK+f,EACN,KAAM,kBACV,IAAIQ,EAAM,IAAI9C,EAAGzd,KAAK+f,EAAE9U,OAASiiB,EAAMjiB,QACvCsV,EAAI/I,IAAIxX,KAAK+f,GACbQ,EAAI/I,IAAI0V,EAAOltB,KAAK+f,EAAE9U,QACtB,IAAIqT,EAAKsR,GAAMrP,GAAMmJ,EAAKpL,EAAG,GAAI0R,EAAK1R,EAAG,GACzC,GAAI0C,EAAO,CACP,GAAIgP,EAAG/kB,OACH,KAAM,qBACVjL,KAAK+f,EAAI,UAGT/f,KAAK+f,EAAIiQ,EACbhwB,KAAKksB,OAAOxC,EAAI1I,KAEb+O,EA7CoB,GAmD3BE,GAA4B,WAK5B,SAASA,EAAWnG,GAChB9pB,KAAKksB,OAASpC,EAclB,OAPAmG,EAAWzG,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACzC,IAAKhhB,KAAKksB,OACN,KAAM,cACV,GAAIlsB,KAAKsK,EACL,KAAM,kBACVtK,KAAKksB,OAAOgE,GAAQhD,GAAQltB,KAAKsK,EAAI0W,IAAS,IAE3CiP,EApBoB,GA8BxB,SAASC,GAAQC,EAAKC,GACzB,GAAIA,EAAQ,CAER,IADA,IAAIC,EAAO,IAAI5S,EAAG0S,EAAIllB,QACb2R,EAAI,EAAGA,EAAIuT,EAAIllB,SAAU2R,EAC9ByT,EAAKzT,GAAKuT,EAAIvD,WAAWhQ,GAC7B,OAAOyT,EAEX,GAAIf,GACA,OAAOA,GAAGgB,OAAOH,GACrB,IAAIlR,EAAIkR,EAAIllB,OACRslB,EAAK,IAAI9S,EAAG0S,EAAIllB,QAAUklB,EAAIllB,QAAU,IACxCulB,EAAK,EACLvM,EAAI,SAAUlf,GAAKwrB,EAAGC,KAAQzrB,GAClC,IAAS6X,EAAI,EAAGA,EAAIqC,IAAKrC,EAAG,CACxB,GAAI4T,EAAK,EAAID,EAAGtlB,OAAQ,CACpB,IAAImV,EAAI,IAAI3C,EAAG+S,EAAK,GAAMvR,EAAIrC,GAAM,IACpCwD,EAAE5I,IAAI+Y,GACNA,EAAKnQ,EAET,IAAI/V,EAAI8lB,EAAIvD,WAAWhQ,GACnBvS,EAAI,KAAO+lB,EACXnM,EAAE5Z,GACGA,EAAI,MACT4Z,EAAE,IAAO5Z,GAAK,GAAK4Z,EAAE,IAAW,GAAJ5Z,IACvBA,EAAI,OAASA,EAAI,OAElB4Z,EAAE,KADN5Z,EAAI,OAAa,QAAJA,GAAyC,KAAtB8lB,EAAIvD,aAAahQ,KAC/B,IAAMqH,EAAE,IAAQ5Z,GAAK,GAAM,IAAM4Z,EAAE,IAAQ5Z,GAAK,EAAK,IAAM4Z,EAAE,IAAW,GAAJ5Z,KAEtF4Z,EAAE,IAAO5Z,GAAK,IAAM4Z,EAAE,IAAQ5Z,GAAK,EAAK,IAAM4Z,EAAE,IAAW,GAAJ5Z,IAE/D,OAAO8V,EAAIoQ,EAAI,EAAGC,GASf,SAASC,GAAUlQ,EAAK6P,GAC3B,GAAIA,EAAQ,CAER,IADA,IAAI1qB,EAAI,GACCkX,EAAI,EAAGA,EAAI2D,EAAItV,OAAQ2R,GAAK,MACjClX,GAAKmqB,OAAOC,aAAaf,MAAM,KAAMxO,EAAIF,SAASzD,EAAGA,EAAI,QAC7D,OAAOlX,EAEN,GAAIwjB,GACL,OAAOA,GAAGwG,OAAOnP,GAEjB,IAAIjC,EAAKsR,GAAMrP,GAAM8D,EAAM/F,EAAG,GAC9B,GADwCA,EAAG,GACnCrT,OACJ,KAAM,qBACV,OAAOoZ,EAKf,IAAIqM,GAAM,SAAUzR,GAAK,OAAY,GAALA,EAAS,EAAIA,EAAI,EAAI,EAAS,GAALA,EAAS,EAAI,GAElE0R,GAAO,SAAUrmB,EAAG1E,GAAK,OAAOA,EAAI,GAAKymB,GAAG/hB,EAAG1E,EAAI,IAAMymB,GAAG/hB,EAAG1E,EAAI,KAEnEgrB,GAAK,SAAUtmB,EAAG1E,EAAGirB,GACrB,IAAIC,EAAMzE,GAAG/hB,EAAG1E,EAAI,IAAKojB,EAAKyH,GAAUnmB,EAAE+V,SAASza,EAAI,GAAIA,EAAI,GAAKkrB,KAAuB,KAAfzE,GAAG/hB,EAAG1E,EAAI,KAAamrB,EAAKnrB,EAAI,GAAKkrB,EAAKnM,EAAK2H,GAAGhiB,EAAG1E,EAAI,IACjI0Y,EAAKuS,GAAW,YAANlM,EAAmBqM,GAAK1mB,EAAGymB,GAAM,CAACpM,EAAI2H,GAAGhiB,EAAG1E,EAAI,IAAK0mB,GAAGhiB,EAAG1E,EAAI,KAAMqrB,EAAK3S,EAAG,GAAI4S,EAAK5S,EAAG,GAAI6S,EAAM7S,EAAG,GACpH,MAAO,CAAC+N,GAAG/hB,EAAG1E,EAAI,IAAKqrB,EAAIC,EAAIlI,EAAI+H,EAAK1E,GAAG/hB,EAAG1E,EAAI,IAAMymB,GAAG/hB,EAAG1E,EAAI,IAAKurB,IAGvEH,GAAO,SAAU1mB,EAAG1E,GACpB,KAAmB,GAAZymB,GAAG/hB,EAAG1E,GAASA,GAAK,EAAIymB,GAAG/hB,EAAG1E,EAAI,IAEzC,MAAO,CAAC2mB,GAAGjiB,EAAG1E,EAAI,IAAK2mB,GAAGjiB,EAAG1E,EAAI,GAAI2mB,GAAGjiB,EAAG1E,EAAI,MAG/CwrB,GAAO,SAAUC,GACjB,IAAIlS,EAAK,EACT,GAAIkS,EACA,IAAK,IAAI/I,KAAK+I,EAAI,CACd,IAAIpS,EAAIoS,EAAG/I,GAAGrd,OACd,GAAIgU,EAAI,MACJ,KAAM,uBACVE,GAAMF,EAAI,EAGlB,OAAOE,GAGPmS,GAAM,SAAUhnB,EAAG1E,EAAGiJ,EAAGma,EAAI3L,EAAGhT,EAAGknB,EAAIrS,GACvC,IAAIX,EAAKyK,EAAG/d,OAAQomB,EAAKxiB,EAAE2iB,MAAOC,EAAMvS,GAAMA,EAAGjU,OAC7CymB,EAAMN,GAAKC,GACfnG,GAAO5gB,EAAG1E,EAAS,MAAN2rB,EAAa,SAAY,UAAY3rB,GAAK,EAC7C,MAAN2rB,IACAjnB,EAAE1E,KAAO,GAAI0E,EAAE1E,KAAOiJ,EAAE8iB,IAC5BrnB,EAAE1E,GAAK,GAAIA,GAAK,EAChB0E,EAAE1E,KAAQiJ,EAAE+iB,MAAQ,GAAW,MAALvnB,GAAa,GAAIC,EAAE1E,KAAOyX,GAAK,EACzD/S,EAAE1E,KAAuB,IAAhBiJ,EAAEgjB,YAAmBvnB,EAAE1E,KAAOiJ,EAAEgjB,aAAe,EACxD,IAAI3P,EAAK,IAAIwK,KAAgB,MAAX7d,EAAE4d,MAAgBC,KAAKC,MAAQ9d,EAAE4d,OAAQna,EAAI4P,EAAG4P,cAAgB,KAClF,GAAIxf,EAAI,GAAKA,EAAI,IACb,KAAM,8BAgBV,GAfA4Y,GAAO5gB,EAAG1E,EAAI0M,GAAK,GAAQ4P,EAAG6P,WAAa,GAAM,GAAO7P,EAAG8P,WAAa,GAAO9P,EAAG+P,YAAc,GAAO/P,EAAGgQ,cAAgB,EAAMhQ,EAAGiQ,eAAiB,GAAKvsB,GAAK,EACrJ,MAALyE,IACA6gB,GAAO5gB,EAAG1E,EAAGiJ,EAAE0Z,KACf2C,GAAO5gB,EAAG1E,EAAI,EAAGyE,GACjB6gB,GAAO5gB,EAAG1E,EAAI,EAAGiJ,EAAE6c,OAEvBR,GAAO5gB,EAAG1E,EAAI,GAAI2Y,GAClB2M,GAAO5gB,EAAG1E,EAAI,GAAI8rB,GAAM9rB,GAAK,GACnB,MAAN2rB,IACArG,GAAO5gB,EAAG1E,EAAG6rB,GACbvG,GAAO5gB,EAAG1E,EAAI,EAAGiJ,EAAEujB,OACnBlH,GAAO5gB,EAAG1E,EAAI,GAAI2rB,GAAK3rB,GAAK,IAEhC0E,EAAEkN,IAAIwR,EAAIpjB,GACVA,GAAK2Y,EACDmT,EACA,IAAK,IAAIpJ,KAAK+I,EAAI,CACd,IAAIgB,EAAMhB,EAAG/I,GAAIrJ,EAAIoT,EAAIpnB,OACzBigB,GAAO5gB,EAAG1E,GAAI0iB,GACd4C,GAAO5gB,EAAG1E,EAAI,EAAGqZ,GACjB3U,EAAEkN,IAAI6a,EAAKzsB,EAAI,GAAIA,GAAK,EAAIqZ,EAKpC,OAFIwS,IACAnnB,EAAEkN,IAAI0H,EAAItZ,GAAIA,GAAK6rB,GAChB7rB,GAGP0sB,GAAM,SAAUtS,EAAGpa,EAAGyE,EAAGC,EAAGvG,GAC5BmnB,GAAOlL,EAAGpa,EAAG,WACbslB,GAAOlL,EAAGpa,EAAI,EAAGyE,GACjB6gB,GAAOlL,EAAGpa,EAAI,GAAIyE,GAClB6gB,GAAOlL,EAAGpa,EAAI,GAAI0E,GAClB4gB,GAAOlL,EAAGpa,EAAI,GAAI7B,IAKlBwuB,GAAgC,WAKhC,SAASA,EAAe/F,GACpBxsB,KAAKwsB,SAAWA,EAChBxsB,KAAKqK,EAAIke,IACTvoB,KAAK0rB,KAAO,EACZ1rB,KAAK6xB,YAAc,EA6BvB,OAnBAU,EAAe/I,UAAUgJ,QAAU,SAAUtF,EAAOlM,GAChDhhB,KAAKksB,OAAO,KAAMgB,EAAOlM,IAS7BuR,EAAe/I,UAAUxoB,KAAO,SAAUksB,EAAOlM,GAC7C,IAAKhhB,KAAKksB,OACN,KAAM,kDACVlsB,KAAKqK,EAAE0V,EAAEmN,GACTltB,KAAK0rB,MAAQwB,EAAMjiB,OACf+V,IACAhhB,KAAKuoB,IAAMvoB,KAAKqK,EAAEC,KACtBtK,KAAKwyB,QAAQtF,EAAOlM,IAAS,IAE1BuR,EAtCwB,GA8C/BE,GAA4B,WAM5B,SAASA,EAAWjG,EAAUZ,GAC1B,IAAIkD,EAAU9uB,KACT4rB,IACDA,EAAO,IACX2G,GAAe1wB,KAAK7B,KAAMwsB,GAC1BxsB,KAAKsK,EAAI,IAAI2iB,GAAQrB,GAAM,SAAUrL,EAAKS,GACtC8N,EAAQ5C,OAAO,KAAM3L,EAAKS,MAE9BhhB,KAAK6xB,YAAc,EACnB7xB,KAAK4xB,KAAOlB,GAAI9E,EAAKjD,OAkBzB,OAhBA8J,EAAWjJ,UAAUgJ,QAAU,SAAUtF,EAAOlM,GAC5C,IACIhhB,KAAKsK,EAAEtJ,KAAKksB,EAAOlM,GAEvB,MAAOjd,IACH/D,KAAKksB,OAAOnoB,GAAG,KAAMid,KAQ7ByR,EAAWjJ,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACzCuR,GAAe/I,UAAUxoB,KAAKa,KAAK7B,KAAMktB,EAAOlM,IAE7CyR,EAjCoB,GAuC3BC,GAAiC,WAMjC,SAASA,EAAgBlG,EAAUZ,GAC/B,IAAIkD,EAAU9uB,KACT4rB,IACDA,EAAO,IACX2G,GAAe1wB,KAAK7B,KAAMwsB,GAC1BxsB,KAAKsK,EAAI,IAAI6iB,GAAavB,GAAM,SAAUC,EAAKtL,EAAKS,GAChD8N,EAAQ5C,OAAOL,EAAKtL,EAAKS,MAE7BhhB,KAAK6xB,YAAc,EACnB7xB,KAAK4xB,KAAOlB,GAAI9E,EAAKjD,OACrB3oB,KAAK8rB,UAAY9rB,KAAKsK,EAAEwhB,UAa5B,OAXA4G,EAAgBlJ,UAAUgJ,QAAU,SAAUtF,EAAOlM,GACjDhhB,KAAKsK,EAAEtJ,KAAKksB,EAAOlM,IAOvB0R,EAAgBlJ,UAAUxoB,KAAO,SAAUksB,EAAOlM,GAC9CuR,GAAe/I,UAAUxoB,KAAKa,KAAK7B,KAAMktB,EAAOlM,IAE7C0R,EA7ByB,GAoChCC,GAAqB,WAMrB,SAASA,EAAI7I,GACT9pB,KAAKksB,OAASpC,EACd9pB,KAAKqd,EAAI,GACTrd,KAAKsK,EAAI,EAiIb,OA3HAqoB,EAAInJ,UAAUhpB,IAAM,SAAUoyB,GAC1B,IAAI9D,EAAU9uB,KACd,GAAa,EAATA,KAAKsK,EACL,KAAM,kBACV,IAAIuE,EAAIqhB,GAAQ0C,EAAKpG,UAAWjO,EAAK1P,EAAE5D,OACnC4nB,EAAMD,EAAKE,QAAS9S,EAAI6S,GAAO3C,GAAQ2C,GACvCxV,EAAIkB,GAAMqU,EAAKpG,SAASvhB,QAAW+U,GAAM6S,EAAI5nB,QAAU+U,EAAE/U,OACzD8nB,EAAKxU,EAAK6S,GAAKwB,EAAKpB,OAAS,GACjC,GAAIjT,EAAK,MACL,KAAM,oBACV,IAAIyU,EAAS,IAAIvV,EAAGsV,GACpBzB,GAAI0B,EAAQ,EAAGJ,EAAM/jB,EAAGwO,GACxB,IAAI4V,EAAO,CAACD,GACRE,EAAO,WACP,IAAK,IAAIC,EAAK,EAAGC,EAASH,EAAME,EAAKC,EAAOnoB,OAAQkoB,IAAM,CACtD,IAAIE,EAAMD,EAAOD,GACjBrE,EAAQ5C,OAAO,KAAMmH,GAAK,GAE9BJ,EAAO,IAEP7P,EAAKpjB,KAAKsK,EACdtK,KAAKsK,EAAI,EACT,IAAIgpB,EAAMtzB,KAAKqd,EAAEpS,OACbsoB,EAAKzK,EAAI8J,EAAM,CACf/jB,EAAGA,EACHwO,EAAGA,EACH2C,EAAGA,EACHwB,EAAG,WACKoR,EAAK9G,WACL8G,EAAK9G,aAEbpmB,EAAG,WAEC,GADAwtB,IACI9P,EAAI,CACJ,IAAIoQ,EAAM1E,EAAQzR,EAAEiW,EAAM,GACtBE,EACAA,EAAI9tB,IAEJopB,EAAQxkB,EAAI,EAEpB8Y,EAAK,KAGTS,EAAK,EACT+O,EAAK1G,OAAS,SAAUL,EAAKtL,EAAKS,GAC9B,GAAI6K,EACAiD,EAAQ5C,OAAOL,EAAKtL,EAAKS,GACzB8N,EAAQhD,iBAKR,GAFAjI,GAAMtD,EAAItV,OACVgoB,EAAKjyB,KAAKuf,GACNS,EAAO,CACP,IAAIyS,EAAK,IAAIhW,EAAG,IAChByN,GAAOuI,EAAI,EAAG,WACdvI,GAAOuI,EAAI,EAAGb,EAAKrK,KACnB2C,GAAOuI,EAAI,EAAG5P,GACdqH,GAAOuI,EAAI,GAAIb,EAAKlH,MACpBuH,EAAKjyB,KAAKyyB,GACVF,EAAGlpB,EAAIwZ,EAAI0P,EAAG3tB,EAAImtB,EAAKlP,EAAK,GAAI0P,EAAGhL,IAAMqK,EAAKrK,IAAKgL,EAAG7H,KAAOkH,EAAKlH,KAC9DtI,GACAmQ,EAAG7tB,IACP0d,EAAK,OAEAA,GACL8P,KAGZlzB,KAAKqd,EAAErc,KAAKuyB,IAOhBZ,EAAInJ,UAAUhH,IAAM,WAChB,IAAIsM,EAAU9uB,KACd,GAAa,EAATA,KAAKsK,EAAO,CACZ,GAAa,EAATtK,KAAKsK,EACL,KAAM,mBACV,KAAM,kBAENtK,KAAKsK,EACLtK,KAAK+D,IAEL/D,KAAKqd,EAAErc,KAAK,CACR0E,EAAG,WACmB,EAAZopB,EAAQxkB,IAEdwkB,EAAQzR,EAAE5Z,QAAQ,EAAG,GACrBqrB,EAAQ/qB,MAEZyd,EAAG,eAEXxhB,KAAKsK,EAAI,GAEbqoB,EAAInJ,UAAUzlB,EAAI,WAEd,IADA,IAAImd,EAAK,EAAGjC,EAAI,EAAG0C,EAAK,EACfwR,EAAK,EAAG7U,EAAKte,KAAKqd,EAAG8V,EAAK7U,EAAGrT,OAAQkoB,IAAM,CAEhDxR,GAAM,IADF9S,EAAIyP,EAAG6U,IACEtkB,EAAE5D,OAASmmB,GAAKviB,EAAE2iB,QAAU3iB,EAAEmR,EAAInR,EAAEmR,EAAE/U,OAAS,GAGhE,IADA,IAAIoZ,EAAM,IAAI5G,EAAGkE,EAAK,IACblD,EAAK,EAAGuG,EAAKhlB,KAAKqd,EAAGoB,EAAKuG,EAAG/Z,OAAQwT,IAAM,CAChD,IAAI5P,EAAImW,EAAGvG,GACX6S,GAAIjN,EAAKnD,EAAIrS,EAAGA,EAAEA,EAAGA,EAAEwO,EAAGxO,EAAExE,EAAG4U,EAAGpQ,EAAEmR,GACpCkB,GAAM,GAAKrS,EAAEA,EAAE5D,OAASmmB,GAAKviB,EAAE2iB,QAAU3iB,EAAEmR,EAAInR,EAAEmR,EAAE/U,OAAS,GAAIgU,GAAKpQ,EAAEjJ,EAE3E0sB,GAAIjO,EAAKnD,EAAIlhB,KAAKqd,EAAEpS,OAAQ0W,EAAI1C,GAChCjf,KAAKksB,OAAO,KAAM7H,GAAK,GACvBrkB,KAAKsK,EAAI,GAMbqoB,EAAInJ,UAAUsC,UAAY,WACtB,IAAK,IAAIqH,EAAK,EAAG7U,EAAKte,KAAKqd,EAAG8V,EAAK7U,EAAGrT,OAAQkoB,IAAM,CACxC7U,EAAG6U,GACT3R,IAENxhB,KAAKsK,EAAI,GAENqoB,EA1Ia,GA6IjB,SAASe,GAAItJ,EAAMwB,EAAM9B,GAG5B,GAFKA,IACDA,EAAK8B,EAAMA,EAAO,IACL,mBAAN9B,EACP,KAAM,cACV,IAAIpkB,EAAI,GACR0pB,GAAKhF,EAAM,GAAI1kB,EAAGkmB,GAClB,IAAItD,EAAIxiB,OAAO8G,KAAKlH,GAChB6d,EAAM+E,EAAErd,OAAQ+U,EAAI,EAAG2T,EAAM,EAC7BC,EAAOrQ,EAAKsQ,EAAQ,IAAIxuB,MAAMke,GAC9BuQ,EAAO,GACPC,EAAO,WACP,IAAK,IAAInX,EAAI,EAAGA,EAAIkX,EAAK7oB,SAAU2R,EAC/BkX,EAAKlX,MAEToX,EAAM,WACN,IAAI3P,EAAM,IAAI5G,EAAGkW,EAAM,IAAKM,EAAKjU,EAAGkU,EAAMP,EAAM3T,EAChD2T,EAAM,EACN,IAAK,IAAI/W,EAAI,EAAGA,EAAIgX,IAAQhX,EAAG,CAC3B,IAAI/N,EAAIglB,EAAMjX,GACd,IACI,IAAIqC,EAAIpQ,EAAExE,EAAEY,OACZqmB,GAAIjN,EAAKsP,EAAK9kB,EAAGA,EAAEA,EAAGA,EAAEwO,EAAG4B,GAC3B,IAAIkV,EAAO,GAAKtlB,EAAEA,EAAE5D,OAASmmB,GAAKviB,EAAE2iB,OAChC4C,EAAMT,EAAMQ,EAChB9P,EAAI7M,IAAI3I,EAAExE,EAAG+pB,GACb9C,GAAIjN,EAAKrE,EAAGnR,EAAGA,EAAEA,EAAGA,EAAEwO,EAAG4B,EAAG0U,EAAK9kB,EAAE0Q,GAAIS,GAAK,GAAKmU,GAAQtlB,EAAE0Q,EAAI1Q,EAAE0Q,EAAEtU,OAAS,GAAI0oB,EAAMS,EAAMnV,EAEhG,MAAOlb,IACH,OAAO+lB,EAAG/lB,GAAG,OAGrBuuB,GAAIjO,EAAKrE,EAAG6T,EAAM5oB,OAAQipB,EAAKD,GAC/BnK,EAAG,KAAMzF,IAERd,GACDyQ,IAgDJ,IA/CA,IAAIK,EAAU,SAAUzX,GACpB,IAAIoM,EAAKV,EAAE1L,GACP0B,EAAK5Y,EAAEsjB,GAAK4J,EAAOtU,EAAG,GAAIyB,EAAIzB,EAAG,GACjCjU,EAAIke,IAAOmD,EAAOkH,EAAK3nB,OAC3BZ,EAAE0V,EAAE6S,GACJ,IAAI/jB,EAAIqhB,GAAQlH,GAAKhK,EAAInQ,EAAE5D,OACvB4nB,EAAM9S,EAAE+S,QAASvT,EAAIsT,GAAO3C,GAAQ2C,GAAMyB,EAAK/U,GAAKA,EAAEtU,OACtDymB,EAAMN,GAAKrR,EAAEyR,OACbK,EAAyB,GAAX9R,EAAE4I,MAAa,EAAI,EACjC4L,EAAM,SAAUxwB,EAAGuG,GACnB,GAAIvG,EACAgwB,IACAjK,EAAG/lB,EAAG,UAEL,CACD,IAAIkb,EAAI3U,EAAEW,OACV4oB,EAAMjX,GAAKkM,EAAI/I,EAAG,CACd2L,KAAMA,EACNnD,IAAKle,EAAEC,IACPD,EAAGC,EACHuE,EAAGA,EACH0Q,EAAGA,EACHlC,EAAG2B,GAAKgK,EAAG/d,QAAWsU,GAAMsT,EAAI5nB,QAAUqpB,EAC1CzC,YAAaA,IAEjB7R,GAAK,GAAKhB,EAAI0S,EAAMzS,EACpB0U,GAAO,GAAK,GAAK3U,EAAI0S,IAAQ4C,GAAM,GAAKrV,IACjCsE,GACHyQ,MAKZ,GAFIhV,EAAI,OACJuV,EAAI,oBAAqB,MACxB1C,EAEA,GAAInG,EAAO,KACZ,IACI6I,EAAI,KAAMzJ,GAAY8H,EAAM7S,IAEhC,MAAOhc,IACHwwB,EAAIxwB,GAAG,WAIX+vB,EAAK9yB,KAAKosB,GAAQwF,EAAM7S,EAAGwU,SAV3BA,EAAI,KAAM3B,IAaThW,EAAI,EAAGA,EAAIgX,IAAQhX,EACxByX,EAAQzX,GAEZ,OAAOmX,EASJ,SAASS,GAAQpK,EAAMwB,GACrBA,IACDA,EAAO,IACX,IAAIlmB,EAAI,GACJmuB,EAAQ,GACZzE,GAAKhF,EAAM,GAAI1kB,EAAGkmB,GAClB,IAAI5L,EAAI,EACJ2T,EAAM,EACV,IAAK,IAAI3K,KAAMtjB,EAAG,CACd,IAAI4Y,EAAK5Y,EAAEsjB,GAAK4J,EAAOtU,EAAG,GAAIyB,EAAIzB,EAAG,GACjCuT,EAAyB,GAAX9R,EAAE4I,MAAa,EAAI,EAChB3J,GAAjBnQ,EAAIqhB,GAAQlH,IAAW/d,OACvB4nB,EAAM9S,EAAE+S,QAASvT,EAAIsT,GAAO3C,GAAQ2C,GAAMyB,EAAK/U,GAAKA,EAAEtU,OACtDymB,EAAMN,GAAKrR,EAAEyR,OACjB,GAAIxS,EAAI,MACJ,KAAM,oBACV,IAAI1U,EAAIunB,EAAc/G,GAAY8H,EAAM7S,GAAK6S,EAAM3T,EAAI3U,EAAEW,OACrDZ,EAAIke,IACRle,EAAE0V,EAAE6S,GACJiB,EAAM7yB,KAAK8nB,EAAI/I,EAAG,CACd2L,KAAMkH,EAAK3nB,OACXsd,IAAKle,EAAEC,IACPD,EAAGC,EACHuE,EAAGA,EACH0Q,EAAGA,EACHlC,EAAG2B,GAAKgK,EAAG/d,QAAWsU,GAAMsT,EAAI5nB,QAAUqpB,EAC1CtU,EAAGA,EACH6R,YAAaA,KAEjB7R,GAAK,GAAKhB,EAAI0S,EAAMzS,EACpB0U,GAAO,GAAK,GAAK3U,EAAI0S,IAAQ4C,GAAM,GAAKrV,EAG5C,IADA,IAAIoF,EAAM,IAAI5G,EAAGkW,EAAM,IAAKM,EAAKjU,EAAGkU,EAAMP,EAAM3T,EACvCpD,EAAI,EAAGA,EAAIiX,EAAM5oB,SAAU2R,EAAG,CACnC,IAAI/N,EAAIglB,EAAMjX,GACd0U,GAAIjN,EAAKxV,EAAEmR,EAAGnR,EAAGA,EAAEA,EAAGA,EAAEwO,EAAGxO,EAAExE,EAAEY,QAC/B,IAAIkpB,EAAO,GAAKtlB,EAAEA,EAAE5D,OAASmmB,GAAKviB,EAAE2iB,OACpCnN,EAAI7M,IAAI3I,EAAExE,EAAGwE,EAAEmR,EAAImU,GACnB7C,GAAIjN,EAAKrE,EAAGnR,EAAGA,EAAEA,EAAGA,EAAEwO,EAAGxO,EAAExE,EAAEY,OAAQ4D,EAAEmR,EAAGnR,EAAE0Q,GAAIS,GAAK,GAAKmU,GAAQtlB,EAAE0Q,EAAI1Q,EAAE0Q,EAAEtU,OAAS,GAGzF,OADAqnB,GAAIjO,EAAKrE,EAAG6T,EAAM5oB,OAAQipB,EAAKD,GACxB5P,EAKX,IAAIoQ,GAAkC,WAClC,SAASA,KAMT,OAJAA,EAAiBjL,UAAUxoB,KAAO,SAAUopB,EAAMpJ,GAC9ChhB,KAAKksB,OAAO,KAAM9B,EAAMpJ,IAE5ByT,EAAiB5C,YAAc,EACxB4C,EAP0B,GAcjCC,GAA8B,WAI9B,SAASA,IACL,IAAI5F,EAAU9uB,KACdA,KAAK4c,EAAI,IAAIyQ,IAAQ,SAAU9M,EAAKS,GAChC8N,EAAQ5C,OAAO,KAAM3L,EAAKS,MAYlC,OATA0T,EAAalL,UAAUxoB,KAAO,SAAUopB,EAAMpJ,GAC1C,IACIhhB,KAAK4c,EAAE5b,KAAKopB,EAAMpJ,GAEtB,MAAOjd,IACH/D,KAAKksB,OAAOnoB,GAAGqmB,EAAMpJ,KAG7B0T,EAAa7C,YAAc,EACpB6C,EAnBsB,GAyB7BC,GAAmC,WAInC,SAASA,EAAkBC,EAAGC,GAC1B,IAAI/F,EAAU9uB,KACV60B,EAAK,KACL70B,KAAK4c,EAAI,IAAIyQ,IAAQ,SAAU9M,EAAKS,GAChC8N,EAAQ5C,OAAO,KAAM3L,EAAKS,OAI9BhhB,KAAK4c,EAAI,IAAI2Q,IAAa,SAAU1B,EAAKtL,EAAKS,GAC1C8N,EAAQ5C,OAAOL,EAAKtL,EAAKS,MAE7BhhB,KAAK8rB,UAAY9rB,KAAK4c,EAAEkP,WAShC,OANA6I,EAAkBnL,UAAUxoB,KAAO,SAAUopB,EAAMpJ,GAC3ChhB,KAAK4c,EAAEkP,YACP1B,EAAOjK,EAAIiK,EAAM,IACrBpqB,KAAK4c,EAAE5b,KAAKopB,EAAMpJ,IAEtB2T,EAAkB9C,YAAc,EACzB8C,EAxB2B,GA8BlCG,GAAuB,WAKvB,SAASA,EAAMhL,GACX9pB,KAAK+0B,OAASjL,EACd9pB,KAAKsoB,EAAI,GACTtoB,KAAKggB,EAAI,CACL,EAAGyU,IAEPz0B,KAAK+f,EAAI+C,EAwIb,OAjIAgS,EAAMtL,UAAUxoB,KAAO,SAAUksB,EAAOlM,GACpC,IAAI8N,EAAU9uB,KACd,IAAKA,KAAK+0B,OACN,KAAM,cACV,IAAK/0B,KAAK+f,EACN,KAAM,kBACV,GAAI/f,KAAKqK,EAAI,EAAG,CACZ,IAAI+b,EAAMte,KAAKjF,IAAI7C,KAAKqK,EAAG6iB,EAAMjiB,QAC7B+pB,EAAQ9H,EAAM7M,SAAS,EAAG+F,GAO9B,GANApmB,KAAKqK,GAAK+b,EACNpmB,KAAKsK,EACLtK,KAAKsK,EAAEtJ,KAAKg0B,GAAQh1B,KAAKqK,GAEzBrK,KAAKsoB,EAAE,GAAGtnB,KAAKg0B,IACnB9H,EAAQA,EAAM7M,SAAS+F,IACbnb,OACN,OAAOjL,KAAKgB,KAAKksB,EAAOlM,OAE3B,CACD,IAAInS,EAAI,EAAG+N,EAAI,EAAGqY,OAAK,EAAQzU,OAAM,EAChCxgB,KAAK+f,EAAE9U,OAEFiiB,EAAMjiB,SAGZuV,EAAM,IAAI/C,EAAGzd,KAAK+f,EAAE9U,OAASiiB,EAAMjiB,SAC/BuM,IAAIxX,KAAK+f,GAAIS,EAAIhJ,IAAI0V,EAAOltB,KAAK+f,EAAE9U,SAHvCuV,EAAMxgB,KAAK+f,EAFXS,EAAM0M,EA6EV,IAtEA,IAAIjO,EAAIuB,EAAIvV,OAAQiqB,EAAKl1B,KAAKqK,EAAG7J,EAAM00B,GAAMl1B,KAAKsK,EAC9C6qB,EAAU,WACV,IAAI7W,EACA8W,EAAM9I,GAAG9L,EAAK5D,GAClB,GAAW,UAAPwY,EAAkB,CAClBvmB,EAAI,EAAGomB,EAAKrY,EACZyY,EAAO/qB,EAAI,KACX+qB,EAAOhrB,EAAI,EACX,IAAIirB,EAAKjJ,GAAG7L,EAAK5D,EAAI,GAAI2Y,EAAQlJ,GAAG7L,EAAK5D,EAAI,GAAIS,EAAS,KAALiY,EAAW7B,EAAU,EAAL6B,EAAQxE,EAAMzE,GAAG7L,EAAK5D,EAAI,IAAKmU,EAAK1E,GAAG7L,EAAK5D,EAAI,IACrH,GAAIqC,EAAIrC,EAAI,GAAKkU,EAAMC,EAAI,CACvB,IAAIyE,EAAS,GACbH,EAAO/M,EAAEmN,QAAQD,GACjB3mB,EAAI,EACJ,IASI6mB,EATAC,EAAOrJ,GAAG9L,EAAK5D,EAAI,IAAKgZ,EAAOtJ,GAAG9L,EAAK5D,EAAI,IAC3CiZ,EAAOpF,GAAUjQ,EAAIH,SAASzD,EAAI,GAAIA,GAAK,GAAKkU,IAAOzT,GAC/C,YAARsY,GACArX,EAAKmV,EAAK,EAAE,GAAKzC,GAAKxQ,EAAK5D,GAAI+Y,EAAOrX,EAAG,GAAIsX,EAAOtX,EAAG,IAElDmV,IACLkC,GAAQ,GACZ/Y,GAAKmU,EACLsE,EAAOhrB,EAAIsrB,EAEX,IAAIG,EAAS,CACTz0B,KAAMw0B,EACNhE,YAAa0D,EACbnX,MAAO,WACH,IAAK0X,EAAO5J,OACR,KAAM,cACV,GAAKyJ,EAEA,CACD,IAAII,EAAMjH,EAAQ9O,EAAEuV,GACpB,IAAKQ,EACD,KAAM,4BAA8BR,GACxCG,EAAMC,EAAO,EAAI,IAAII,EAAIF,GAAQ,IAAIE,EAAIF,EAAMF,EAAMC,IACjD1J,OAAS,SAAUL,EAAKtL,EAAKS,GAAS8U,EAAO5J,OAAOL,EAAKtL,EAAKS,IAClE,IAAK,IAAImS,EAAK,EAAG6C,EAASR,EAAQrC,EAAK6C,EAAO/qB,OAAQkoB,IAAM,CACxD,IAAI5S,EAAMyV,EAAO7C,GACjBuC,EAAI10B,KAAKuf,GAAK,GAEduO,EAAQxG,EAAE,IAAMkN,GAAU1G,EAAQzkB,EAClCykB,EAAQxkB,EAAIorB,EAEZA,EAAI10B,KAAK8hB,GAAI,QAdjBgT,EAAO5J,OAAO,KAAMpJ,GAAI,IAiBhCgJ,UAAW,WACH4J,GAAOA,EAAI5J,WACX4J,EAAI5J,cAGZ6J,GAAQ,IACRG,EAAOpK,KAAOiK,EAAMG,EAAOG,aAAeL,GAC9CP,EAAON,OAAOe,GAElB,MAAO,QAEN,GAAIZ,EAAI,CACT,GAAW,WAAPE,EAEA,OADAH,EAAKrY,GAAK,KAAa,GAAPsY,GAAY,GAAIrmB,EAAI,EAAGwmB,EAAOhrB,EAAI,EAC3C,QAEN,GAAW,UAAP+qB,EAEL,OADAH,EAAKrY,GAAK,EAAG/N,EAAI,EAAGwmB,EAAOhrB,EAAI,EACxB,UAIfgrB,EAASr1B,KACN4c,EAAIqC,EAAI,IAAKrC,EAAG,CAEnB,GAAgB,UADFuY,IAEV,MAGR,GADAn1B,KAAK+f,EAAI+C,EACLoS,EAAK,EAAG,CACR,IAAI3U,EAAM1R,EAAI2R,EAAIH,SAAS,EAAG4U,EAAK,KAAa,GAAPC,GAAY,IAA0B,WAApB5I,GAAG9L,EAAKyU,EAAK,KAAoB,IAAMzU,EAAIH,SAAS,EAAGzD,GAC9Gpc,EACAA,EAAIQ,KAAKuf,IAAO1R,GAEhB7O,KAAKsoB,IAAS,GAALzZ,IAAS7N,KAAKuf,GAE/B,GAAQ,EAAJ1R,EACA,OAAO7O,KAAKgB,KAAKwf,EAAIH,SAASzD,GAAIoE,GACtChhB,KAAK+f,EAAIS,EAAIH,SAASzD,GAE1B,GAAIoE,EAAO,CACP,GAAIhhB,KAAKqK,EACL,KAAM,mBACVrK,KAAK+f,EAAI,OAQjB+U,EAAMtL,UAAU0M,SAAW,SAAUC,GACjCn2B,KAAKggB,EAAEmW,EAAQtE,aAAesE,GAE3BrB,EAnJe,GA4JnB,SAASsB,GAAMhM,EAAMN,GACxB,GAAiB,mBAANA,EACP,KAAM,cAQV,IAPA,IAAIgK,EAAO,GACPC,EAAO,WACP,IAAK,IAAInX,EAAI,EAAGA,EAAIkX,EAAK7oB,SAAU2R,EAC/BkX,EAAKlX,MAETiX,EAAQ,GACR9vB,EAAIqmB,EAAKnf,OAAS,GACA,WAAfqhB,GAAGlC,EAAMrmB,KAAmBA,EAC/B,IAAKA,GAAKqmB,EAAKnf,OAASlH,EAAI,MAExB,YADA+lB,EAAG,mBAAoB,MAK/B,IAAIvG,EAAM8I,GAAGjC,EAAMrmB,EAAI,GAClBwf,GACDuG,EAAG,KAAM,IACb,IAAIzf,EAAIkZ,EACJvD,EAAIsM,GAAGlC,EAAMrmB,EAAI,IACjB8sB,EAAS,YAAL7Q,EACR,GAAI6Q,EAAG,CAEH,GADA9sB,EAAIuoB,GAAGlC,EAAMrmB,EAAI,IACE,WAAfuoB,GAAGlC,EAAMrmB,GAET,YADA+lB,EAAG,mBAAoB,MAG3Bzf,EAAIkZ,EAAM+I,GAAGlC,EAAMrmB,EAAI,IACvBic,EAAIsM,GAAGlC,EAAMrmB,EAAI,IAkCrB,IAhCA,IAAIsyB,EAAU,SAAUzZ,GACpB,IAAI0B,EAAKsS,GAAGxG,EAAMpK,EAAG6Q,GAAIyF,EAAMhY,EAAG,GAAI2S,EAAK3S,EAAG,GAAI4S,EAAK5S,EAAG,GAAI0K,EAAK1K,EAAG,GAAIiY,EAAKjY,EAAG,GAAI6S,EAAM7S,EAAG,GAAI1Y,EAAI+qB,GAAKvG,EAAM+G,GAClHnR,EAAIuW,EACJ,IAAIhC,EAAM,SAAUxwB,EAAGuG,GACfvG,GACAgwB,IACAjK,EAAG/lB,EAAG,QAGN8vB,EAAM7K,GAAM1e,IACLiZ,GACHuG,EAAG,KAAM+J,KAGrB,GAAKyC,EAEA,GAAW,GAAPA,EAAU,CACf,IAAIE,EAAOpM,EAAK/J,SAASza,EAAGA,EAAIqrB,GAChC,GAAIA,EAAK,KACL,IACIsD,EAAI,KAAM7J,GAAY8L,EAAM,IAAI/Y,EAAGyT,KAEvC,MAAOntB,GACHwwB,EAAIxwB,EAAG,WAIX+vB,EAAK9yB,KAAKwsB,GAAQgJ,EAAM,CAAE9K,KAAMwF,GAAMqD,SAG1CA,EAAI,4BAA8B+B,EAAK,WAfvC/B,EAAI,KAAMpU,EAAIiK,EAAMxkB,EAAGA,EAAIqrB,KAiB1BrU,EAAI,EAAGA,EAAIvS,IAAKuS,EACrByZ,IAEJ,OAAOtC,EAQJ,SAAS0C,GAAUrM,GAGtB,IAFA,IAAIyJ,EAAQ,GACR9vB,EAAIqmB,EAAKnf,OAAS,GACA,WAAfqhB,GAAGlC,EAAMrmB,KAAmBA,EAC/B,IAAKA,GAAKqmB,EAAKnf,OAASlH,EAAI,MACxB,KAAM,mBAGd,IAAIsG,EAAIgiB,GAAGjC,EAAMrmB,EAAI,GACrB,IAAKsG,EACD,MAAO,GACX,IAAI2V,EAAIsM,GAAGlC,EAAMrmB,EAAI,IACjB8sB,EAAS,YAAL7Q,EACR,GAAI6Q,EAAG,CAEH,GADA9sB,EAAIuoB,GAAGlC,EAAMrmB,EAAI,IACE,WAAfuoB,GAAGlC,EAAMrmB,GACT,KAAM,mBACVsG,EAAIiiB,GAAGlC,EAAMrmB,EAAI,IACjBic,EAAIsM,GAAGlC,EAAMrmB,EAAI,IAErB,IAAK,IAAI6Y,EAAI,EAAGA,EAAIvS,IAAKuS,EAAG,CACxB,IAAI0B,EAAKsS,GAAGxG,EAAMpK,EAAG6Q,GAAI6F,EAAMpY,EAAG,GAAI2S,EAAK3S,EAAG,GAAI4S,EAAK5S,EAAG,GAAI0K,EAAK1K,EAAG,GAAIiY,EAAKjY,EAAG,GAAI6S,EAAM7S,EAAG,GAAI1Y,EAAI+qB,GAAKvG,EAAM+G,GAElH,GADAnR,EAAIuW,EACCG,EAEA,IAAW,GAAPA,EAGL,KAAM,4BAA8BA,EAFpC7C,EAAM7K,GAAM0B,GAAYN,EAAK/J,SAASza,EAAGA,EAAIqrB,GAAK,IAAIxT,EAAGyT,SAFzD2C,EAAM7K,GAAM7I,EAAIiK,EAAMxkB,EAAGA,EAAIqrB,GAMrC,OAAO4C,EC/4EX,SAAS8C,GAAU5W,EAAG1C,EAAGuZ,GAExB,MAAMxW,EAAIwW,EAAE3rB,OAAS8U,EAAI,EAEzB,GAAK1C,GAAKuZ,EAAGxW,GAEZ,OAAOA,EAAI,EAIZ,GAAK/C,GAAKuZ,EAAG7W,GAEZ,OAAOA,EAIR,IAAI8W,EAAM9W,EACN+W,EAAO1W,EACP2W,EAAMjvB,KAAK8D,OAASirB,EAAMC,GAAS,GAEvC,KAAQzZ,EAAIuZ,EAAGG,IAAS1Z,GAAKuZ,EAAGG,EAAM,IAEhC1Z,EAAIuZ,EAAGG,GAEXD,EAAOC,EAIPF,EAAME,EAIPA,EAAMjvB,KAAK8D,OAASirB,EAAMC,GAAS,GAIpC,OAAOC,EAeR,SAASC,GAAoBC,EAAM5Z,EAAG0C,EAAG6W,GAExC,MAAMM,EAAI,GACJ/sB,EAAO,GACPC,EAAQ,GACd8sB,EAAG,GAAM,EAET,IAAM,IAAI7Y,EAAI,EAAGA,GAAK0B,IAAM1B,EAAI,CAE/BlU,EAAMkU,GAAMhB,EAAIuZ,EAAGK,EAAO,EAAI5Y,GAC9BjU,EAAOiU,GAAMuY,EAAGK,EAAO5Y,GAAMhB,EAE7B,IAAI8Z,EAAQ,EAEZ,IAAM,IAAIzxB,EAAI,EAAGA,EAAI2Y,IAAM3Y,EAAI,CAE9B,MAAM0xB,EAAKhtB,EAAO1E,EAAI,GAChBqnB,EAAK5iB,EAAMkU,EAAI3Y,GACf2xB,EAAOH,EAAGxxB,IAAQ0xB,EAAKrK,GAC7BmK,EAAGxxB,GAAMyxB,EAAQC,EAAKC,EACtBF,EAAQpK,EAAKsK,EAIdH,EAAG7Y,GAAM8Y,EAIV,OAAOD,EA0OR,SAASI,GAAYhP,EAAG1L,GAEvB,IAAI2a,EAAM,EAEV,IAAM,IAAIlZ,EAAI,EAAGA,GAAKiK,IAAMjK,EAE3BkZ,GAAOlZ,EAIR,IAAImZ,EAAQ,EAEZ,IAAM,IAAInZ,EAAI,EAAGA,GAAKzB,IAAMyB,EAE3BmZ,GAASnZ,EAIV,IAAM,IAAIA,EAAI,EAAGA,GAAKiK,EAAI1L,IAAMyB,EAE/BmZ,GAASnZ,EAIV,OAAOkZ,EAAMC,EA0Dd,SAASC,GAAsB1X,EAAG6W,EAAGc,EAAGra,EAAGsa,GAG1C,OAjDD,SAAuCC,GAEtC,MAAMD,EAAKC,EAAM3sB,OACX4sB,EAAQ,GACRC,EAAQ,GAEd,IAAM,IAAIlb,EAAI,EAAGA,EAAI+a,IAAO/a,EAAI,CAE/B,MAAMmb,EAAQH,EAAOhb,GACrBib,EAAOjb,GAAM,IAAI,MAASmb,EAAM1lB,EAAG0lB,EAAMzlB,EAAGylB,EAAMlH,GAClDiH,EAAOlb,GAAMmb,EAAM9T,EAIpB,MAAM+T,EAAK,GAEX,IAAM,IAAI1P,EAAI,EAAGA,EAAIqP,IAAOrP,EAAI,CAE/B,MAAMvjB,EAAI8yB,EAAOvP,GAAIvT,QAErB,IAAM,IAAI6H,EAAI,EAAGA,GAAK0L,IAAM1L,EAE3B7X,EAAEyM,IAAKwmB,EAAI1P,EAAI1L,GAAI7H,QAAQwC,eAAgB+f,GAAYhP,EAAG1L,GAAMkb,EAAOlb,KAIxEob,EAAI1P,GAAMvjB,EAAEkzB,aAAcH,EAAO,IAIlC,OAAOE,EAmBAE,CAxIR,SAAiCnY,EAAG6W,EAAGc,EAAGra,EAAGsa,GAE5C,MAAMQ,EAAKR,EAAK5X,EAAI4X,EAAK5X,EACnBiY,EAAK,GACLf,EAAON,GAAU5W,EAAG1C,EAAGuZ,GACvBwB,EA3IP,SAAuCnB,EAAM5Z,EAAG0C,EAAGK,EAAGwW,GAErD,MAAMyB,EAAU,GAChB,IAAM,IAAIzb,EAAI,EAAGA,GAAKmD,IAAMnD,EAC3Byb,EAASzb,GAAM,EAEhB,MAAM0b,EAAO,GAEb,IAAM,IAAI1b,EAAI,EAAGA,GAAKwD,IAAMxD,EAC3B0b,EAAM1b,GAAMyb,EAAQxV,MAAO,GAE5B,MAAM0V,EAAM,GAEZ,IAAM,IAAI3b,EAAI,EAAGA,GAAKmD,IAAMnD,EAC3B2b,EAAK3b,GAAMyb,EAAQxV,MAAO,GAE3B0V,EAAK,GAAK,GAAM,EAEhB,MAAMpuB,EAAOkuB,EAAQxV,MAAO,GACtBzY,EAAQiuB,EAAQxV,MAAO,GAE7B,IAAM,IAAIxE,EAAI,EAAGA,GAAK0B,IAAM1B,EAAI,CAE/BlU,EAAMkU,GAAMhB,EAAIuZ,EAAGK,EAAO,EAAI5Y,GAC9BjU,EAAOiU,GAAMuY,EAAGK,EAAO5Y,GAAMhB,EAE7B,IAAI8Z,EAAQ,EAEZ,IAAM,IAAIzxB,EAAI,EAAGA,EAAI2Y,IAAM3Y,EAAI,CAE9B,MAAM0xB,EAAKhtB,EAAO1E,EAAI,GAChBqnB,EAAK5iB,EAAMkU,EAAI3Y,GACrB6yB,EAAKla,GAAK3Y,GAAM0xB,EAAKrK,EAErB,MAAMsK,EAAOkB,EAAK7yB,GAAK2Y,EAAI,GAAMka,EAAKla,GAAK3Y,GAC3C6yB,EAAK7yB,GAAK2Y,GAAM8Y,EAAQC,EAAKC,EAC7BF,EAAQpK,EAAKsK,EAIdkB,EAAKla,GAAKA,GAAM8Y,EAIjB,IAAM,IAAI9Y,EAAI,EAAGA,GAAK0B,IAAM1B,EAE3Bia,EAAM,GAAKja,GAAMka,EAAKla,GAAK0B,GAI5B,IAAM,IAAIra,EAAI,EAAGA,GAAKqa,IAAMra,EAAI,CAE/B,IAAI8yB,EAAK,EACLC,EAAK,EAET,MAAMvuB,EAAI,GACV,IAAM,IAAI0S,EAAI,EAAGA,GAAKmD,IAAMnD,EAE3B1S,EAAG0S,GAAMyb,EAAQxV,MAAO,GAIzB3Y,EAAG,GAAK,GAAM,EAEd,IAAM,IAAIoe,EAAI,EAAGA,GAAKlI,IAAMkI,EAAI,CAE/B,IAAIhe,EAAI,EACR,MAAMouB,EAAKhzB,EAAI4iB,EACTqQ,EAAK5Y,EAAIuI,EAEV5iB,GAAK4iB,IAETpe,EAAGuuB,GAAM,GAAMvuB,EAAGsuB,GAAM,GAAMD,EAAKI,EAAK,GAAKD,GAC7CpuB,EAAIJ,EAAGuuB,GAAM,GAAMF,EAAKG,GAAMC,IAI/B,MACMC,EAAOlzB,EAAI,GAAKizB,EAAOrQ,EAAI,EAAIvI,EAAIra,EAEzC,IAAM,IAAI2Y,EAHGqa,IAAQ,EAAM,GAAMA,EAGfra,GAAKua,IAAOva,EAE7BnU,EAAGuuB,GAAMpa,IAAQnU,EAAGsuB,GAAMna,GAAMnU,EAAGsuB,GAAMna,EAAI,IAAQka,EAAKI,EAAK,GAAKD,EAAKra,GACzE/T,GAAKJ,EAAGuuB,GAAMpa,GAAMka,EAAKG,EAAKra,GAAKsa,GAI/BjzB,GAAKizB,IAETzuB,EAAGuuB,GAAMnQ,IAAQpe,EAAGsuB,GAAMlQ,EAAI,GAAMiQ,EAAKI,EAAK,GAAKjzB,GACnD4E,GAAKJ,EAAGuuB,GAAMnQ,GAAMiQ,EAAK7yB,GAAKizB,IAI/BL,EAAMhQ,GAAK5iB,GAAM4E,EAEjB,MAAM+T,EAAIma,EACVA,EAAKC,EACLA,EAAKpa,GAMP,IAAI3Y,EAAIqa,EAER,IAAM,IAAIuI,EAAI,EAAGA,GAAKlI,IAAMkI,EAAI,CAE/B,IAAM,IAAIjK,EAAI,EAAGA,GAAK0B,IAAM1B,EAE3Bia,EAAMhQ,GAAKjK,IAAO3Y,EAInBA,GAAKqa,EAAIuI,EAIV,OAAOgQ,EAqBOO,CAA8B5B,EAAM5Z,EAAG0C,EAAGoY,EAAIvB,GACtDkC,EAAK,GAEX,IAAM,IAAIlc,EAAI,EAAGA,EAAI8a,EAAEzsB,SAAW2R,EAAI,CAErC,MAAMmb,EAAQL,EAAG9a,GAAI7H,QACfkP,EAAI8T,EAAM9T,EAEhB8T,EAAM1lB,GAAK4R,EACX8T,EAAMzlB,GAAK2R,EACX8T,EAAMlH,GAAK5M,EAEX6U,EAAIlc,GAAMmb,EAIX,IAAM,IAAIzP,EAAI,EAAGA,GAAK6P,IAAO7P,EAAI,CAEhC,MAAMyP,EAAQe,EAAI7B,EAAOlX,GAAIhL,QAAQwC,eAAgB6gB,EAAO9P,GAAK,IAEjE,IAAM,IAAIjK,EAAI,EAAGA,GAAK0B,IAAM1B,EAE3B0Z,EAAMv3B,IAAKs4B,EAAI7B,EAAOlX,EAAI1B,GAAItJ,QAAQwC,eAAgB6gB,EAAO9P,GAAKjK,KAInE2Z,EAAI1P,GAAMyP,EAIX,IAAM,IAAIzP,EAAI6P,EAAK,EAAG7P,GAAKqP,EAAK,IAAMrP,EAErC0P,EAAI1P,GAAM,IAAI,MAAS,EAAG,EAAG,GAI9B,OAAO0P,EA8FOe,CAAwBhZ,EAAG6W,EAAGc,EAAGra,EAAGsa,ICtZnD,MAAMqB,WAAmB,MAExBt5B,YACCu5B,EACAC,EACAC,EACAC,EACAC,GAGAn1B,QAEAlE,KAAKi5B,OAASA,EACdj5B,KAAKk5B,MAAQA,EACbl5B,KAAKm5B,cAAgB,GAErBn5B,KAAKo5B,UAAYA,GAAa,EAC9Bp5B,KAAKq5B,QAAUA,GAAar5B,KAAKk5B,MAAMjuB,OAAS,EAEhD,IAAM,IAAI2R,EAAI,EAAGA,EAAIuc,EAAcluB,SAAW2R,EAAI,CAGjD,MAAMmb,EAAQoB,EAAevc,GAC7B5c,KAAKm5B,cAAevc,GAAM,IAAI,MAASmb,EAAM1lB,EAAG0lB,EAAMzlB,EAAGylB,EAAMlH,EAAGkH,EAAM9T,IAM1EqV,SAAU9X,EAAG+X,EAAiB,IAAI,OAEjC,MAAMxB,EAAQwB,EAERlc,EAAIrd,KAAKk5B,MAAOl5B,KAAKo5B,WAAc5X,GAAMxhB,KAAKk5B,MAAOl5B,KAAKq5B,SAAYr5B,KAAKk5B,MAAOl5B,KAAKo5B,YAGvFI,EDmER,SAA2BzZ,EAAG6W,EAAGc,EAAGra,GAEnC,MAAM4Z,EAAON,GAAU5W,EAAG1C,EAAGuZ,GACvBM,EAAIF,GAAoBC,EAAM5Z,EAAG0C,EAAG6W,GACpC6C,EAAI,IAAI,MAAS,EAAG,EAAG,EAAG,GAEhC,IAAM,IAAIpb,EAAI,EAAGA,GAAK0B,IAAM1B,EAAI,CAE/B,MAAM0Z,EAAQL,EAAGT,EAAOlX,EAAI1B,GACtBqb,EAAKxC,EAAG7Y,GACRsb,EAAM5B,EAAM9T,EAAIyV,EACtBD,EAAEpnB,GAAK0lB,EAAM1lB,EAAIsnB,EACjBF,EAAEnnB,GAAKylB,EAAMzlB,EAAIqnB,EACjBF,EAAE5I,GAAKkH,EAAMlH,EAAI8I,EACjBF,EAAExV,GAAK8T,EAAM9T,EAAIyV,EAIlB,OAAOD,ECrFS,CAA6Bz5B,KAAKi5B,OAAQj5B,KAAKk5B,MAAOl5B,KAAKm5B,cAAe9b,GASzF,OAPkB,IAAbmc,EAAOvV,GAGXuV,EAAOvB,aAAcuB,EAAOvV,GAItB8T,EAAMvgB,IAAKgiB,EAAOnnB,EAAGmnB,EAAOlnB,EAAGknB,EAAO3I,GAI9C+I,WAAYpY,EAAG+X,EAAiB,IAAI,OAEnC,MAAMM,EAAUN,EAEVlc,EAAIrd,KAAKk5B,MAAO,GAAM1X,GAAMxhB,KAAKk5B,MAAOl5B,KAAKk5B,MAAMjuB,OAAS,GAAMjL,KAAKk5B,MAAO,IAC9EZ,EAAO,GAAiCt4B,KAAKi5B,OAAQj5B,KAAKk5B,MAAOl5B,KAAKm5B,cAAe9b,EAAG,GAG9F,OAFAwc,EAAQtoB,KAAM+mB,EAAM,IAAMwB,YAEnBD,GCVT,IAAIE,GACAC,GACAC,GAEJ,MAAMC,WAAkB,MAEvBx6B,YAAay6B,GAEZj2B,MAAOi2B,GAIR52B,KAAM62B,EAAKC,EAAQC,EAAYC,GAE9B,MAAM7pB,EAAQ1Q,KAERw6B,EAAwB,KAAf9pB,EAAM8pB,KAAgB,qBAA4BJ,GAAQ1pB,EAAM8pB,KAEzEC,EAAS,IAAI,MAAYz6B,KAAKm6B,SACpCM,EAAOC,QAAShqB,EAAM8pB,MACtBC,EAAOE,gBAAiB,eACxBF,EAAOG,iBAAkBlqB,EAAMmqB,eAC/BJ,EAAOK,mBAAoBpqB,EAAMqqB,iBAEjCN,EAAOl3B,KAAM62B,GAAK,SAAW7P,GAE5B,IAEC8P,EAAQ3pB,EAAMsqB,MAAOzQ,EAAQiQ,IAE5B,MAAQz2B,IAEJw2B,EAEJA,EAASx2B,IAITwK,QAAQC,MAAOzK,IAIhB2M,EAAMypB,QAAQc,UAAWb,MAIxBE,EAAYC,GAIhBS,MAAOE,EAAWV,GAEjB,GA6nHF,SAA4BjQ,GAE3B,MAAM4Q,EAAU,yBAEhB,OAAO5Q,EAAO6Q,YAAcD,EAAQlwB,QAAUkwB,IAAYE,GAA4B9Q,EAAQ,EAAG4Q,EAAQlwB,QAjoHnGqwB,CAAmBJ,GAEvBnB,IAAU,IAAIwB,IAAeP,MAAOE,OAE9B,CAEN,MAAMM,EAAUH,GAA4BH,GAE5C,IA6nHH,SAA2BO,GAE1B,MAAMN,EAAU,CAAE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,MAEpH,IAAInqB,EAAS,EAEb,SAAS0qB,EAAMvlB,GAEd,MAAM1R,EAASg3B,EAAMtlB,EAAS,GAG9B,OAFAslB,EAAOA,EAAK5Y,MAAO7R,EAASmF,GAC5BnF,IACOvM,EAIR,IAAM,IAAImY,EAAI,EAAGA,EAAIue,EAAQlwB,SAAW2R,EAAI,CAG3C,GADY8e,EAAM,KACLP,EAASve,GAErB,OAAO,EAMT,OAAO,EAvpHE+e,CAAkBH,GAExB,MAAM,IAAIzsB,MAAO,oCAIlB,GAAK6sB,GAAeJ,GAAY,IAE/B,MAAM,IAAIzsB,MAAO,4DAA8D6sB,GAAeJ,IAI/FzB,IAAU,IAAI8B,IAAab,MAAOQ,GAMnC,MAAMM,EAAgB,IAAI,MAAe97B,KAAKm6B,SAAUO,QAAS16B,KAAK+7B,cAAgBvB,GAAOwB,eAAgBh8B,KAAKi8B,aAElH,OAAO,IAAIC,GAAeJ,EAAe97B,KAAKm6B,SAAUa,MAAOjB,KAOjE,MAAMmC,GAELx8B,YAAao8B,EAAe3B,GAE3Bn6B,KAAK87B,cAAgBA,EACrB97B,KAAKm6B,QAAUA,EAIhBa,QAEChB,GAAch6B,KAAKm8B,mBAEnB,MAAMC,EAASp8B,KAAKq8B,cACdC,EAAWt8B,KAAKu8B,cAAeH,GAC/BI,EAAYx8B,KAAKy8B,eAAgBH,GACjCI,EAAY18B,KAAK28B,iBACjBC,GAAc,IAAIC,IAAiB7B,MAAO0B,GAIhD,OAFA18B,KAAK88B,WAAYJ,EAAWE,EAAaJ,GAElCvC,GAMRkC,mBAEC,MAAMY,EAAgB,IAAIC,IAE1B,GAAK,gBAAiBjD,GAAU,CAERA,GAAQkD,YAAYjD,YAE5BntB,SAAS,SAAWqwB,GAElC,MAAMC,EAASD,EAAe,GACxBE,EAAOF,EAAe,GACtBG,EAAeH,EAAe,GAE7BH,EAAcO,IAAKH,IAEzBJ,EAAcvlB,IAAK2lB,EAAQ,CAC1BI,QAAS,GACTx8B,SAAU,KAKZ,MAAMy8B,EAAqB,CAAEC,GAAIL,EAAMC,aAAcA,GACrDN,EAAcW,IAAKP,GAASI,QAAQv8B,KAAMw8B,GAEnCT,EAAcO,IAAKF,IAEzBL,EAAcvlB,IAAK4lB,EAAM,CACxBG,QAAS,GACTx8B,SAAU,KAKZ,MAAM48B,EAAoB,CAAEF,GAAIN,EAAQE,aAAcA,GACtDN,EAAcW,IAAKN,GAAOr8B,SAASC,KAAM28B,MAM3C,OAAOZ,EAORV,cAEC,MAAMD,EAAS,GACTwB,EAAQ,GAEd,GAAK,UAAW7D,GAAQ8D,QAAU,CAEjC,MAAMC,EAAa/D,GAAQ8D,QAAQE,MAEnC,IAAM,MAAMC,KAAUF,EAAa,CAElC,MAAMG,EAAYH,EAAYE,GAO9B,GAHA5B,EAFW13B,SAAUs5B,IAENC,EAAUC,kBAAoBD,EAAUE,SAGlD,YAAaF,EAAY,CAE7B,MAAMG,EAAuBH,EAAUI,mBAAmBC,aAAmBL,EAAUI,QAAQjD,WAAa,EACtGmD,EAA+C,kBAAtBN,EAAUI,SAAkD,KAAtBJ,EAAUI,QAE/E,GAAKD,GAAsBG,EAAgB,CAE1C,MAAMC,EAAQx+B,KAAKy+B,WAAYX,EAAYE,IAE3CJ,EAAOK,EAAUC,kBAAoBD,EAAUE,UAAaK,KAUhE,IAAM,MAAM79B,KAAMy7B,EAAS,CAE1B,MAAM5P,EAAW4P,EAAQz7B,QAEEiB,IAAtBg8B,EAAOpR,GAA2B4P,EAAQz7B,GAAOi9B,EAAOpR,GACxD4P,EAAQz7B,GAAOy7B,EAAQz7B,GAAK2oB,MAAO,MAAOoV,MAIhD,OAAOtC,EAKRqC,WAAYR,GAEX,MAAMU,EAAUV,EAAUI,QACpBO,EAAWX,EAAUC,kBAAoBD,EAAUE,SACnDU,EAAYD,EAAS/b,MAAO+b,EAASxV,YAAa,KAAQ,GAAI0V,cAEpE,IAAIntB,EAEJ,OAASktB,GAER,IAAK,MAEJltB,EAAO,YACP,MAED,IAAK,MACL,IAAK,OAEJA,EAAO,aACP,MAED,IAAK,MAEJA,EAAO,YACP,MAED,IAAK,MAEJA,EAAO,aACP,MAED,IAAK,MAEuC,OAAtC3R,KAAKm6B,QAAQ4E,WAAY,SAE7BxwB,QAAQwE,KAAM,6CAA8C6rB,GAI7DjtB,EAAO,YACP,MAED,QAGC,YADApD,QAAQwE,KAAM,0BAA4B8rB,EAAY,uBAKxD,GAAwB,kBAAZF,EAEX,MAAO,QAAUhtB,EAAO,WAAagtB,EAE/B,CAEN,MAAMK,EAAQ,IAAIthB,WAAYihB,GAC9B,OAAOp1B,OAAO0T,IAAIC,gBAAiB,IAAIC,KAAM,CAAE6hB,GAAS,CAAErtB,KAAMA,MASlE4qB,cAAeH,GAEd,MAAM6C,EAAa,IAAIjC,IAEvB,GAAK,YAAajD,GAAQ8D,QAAU,CAEnC,MAAMqB,EAAenF,GAAQ8D,QAAQsB,QACrC,IAAM,MAAMnB,KAAUkB,EAAe,CAEpC,MAAME,EAAUp/B,KAAKq/B,aAAcH,EAAclB,GAAU5B,GAC3D6C,EAAWznB,IAAK9S,SAAUs5B,GAAUoB,IAMtC,OAAOH,EAKRI,aAAcC,EAAalD,GAE1B,MAAMgD,EAAUp/B,KAAKu/B,YAAaD,EAAalD,GAE/CgD,EAAQ3B,GAAK6B,EAAY3+B,GAEzBy+B,EAAQ/9B,KAAOi+B,EAAYE,SAE3B,MAAMC,EAAYH,EAAYI,UACxBC,EAAYL,EAAYM,UAExBC,OAAuBj+B,IAAd69B,EAA0BA,EAAUn8B,MAAQ,EACrDw8B,OAAuBl+B,IAAd+9B,EAA0BA,EAAUr8B,MAAQ,EAQ3D,GAHA87B,EAAQW,MAAmB,IAAXF,EAAe,MAAiB,MAChDT,EAAQY,MAAmB,IAAXF,EAAe,MAAiB,MAE3C,YAAaR,EAAc,CAE/B,MAAM5yB,EAAS4yB,EAAYW,QAAQ38B,MAEnC87B,EAAQc,OAAO7tB,EAAI3F,EAAQ,GAC3B0yB,EAAQc,OAAO5tB,EAAI5F,EAAQ,GAI5B,OAAO0yB,EAKRG,YAAaD,EAAalD,GAEzB,IAAIwC,EAEJ,MAAMuB,EAAcngC,KAAK87B,cAActB,KAEjCz5B,EAAWi5B,GAAY0D,IAAK4B,EAAY3+B,IAAKI,SAcnD,IAAIq+B,OAZcx9B,IAAbb,GAA0BA,EAASkK,OAAS,QAAoCrJ,IAA/Bw6B,EAAQr7B,EAAU,GAAI08B,MAE3EmB,EAAWxC,EAAQr7B,EAAU,GAAI08B,IAEI,IAAhCmB,EAASl7B,QAAS,UAAmD,IAAhCk7B,EAASl7B,QAAS,UAE3D1D,KAAK87B,cAAcpB,aAAS94B,IAQ9B,MAAMi9B,EAAYS,EAAYc,SAASvd,OAAS,GAAIic,cAEpD,GAAmB,QAAdD,EAAsB,CAE1B,MAAMpE,EAASz6B,KAAKm6B,QAAQ4E,WAAY,QAExB,OAAXtE,GAEJlsB,QAAQwE,KAAM,oEAAqEusB,EAAYpB,kBAC/FkB,EAAU,IAAI,QAId3E,EAAOC,QAAS16B,KAAK87B,cAActB,MACnC4E,EAAU3E,EAAOl3B,KAAMq7B,QAIC,QAAdC,GAEXtwB,QAAQwE,KAAM,8EAA+EusB,EAAYpB,kBACzGkB,EAAU,IAAI,OAIdA,EAAUp/B,KAAK87B,cAAcv4B,KAAMq7B,GAMpC,OAFA5+B,KAAK87B,cAAcpB,QAASyF,GAErBf,EAKR3C,eAAgBwC,GAEf,MAAMoB,EAAc,IAAIrD,IAExB,GAAK,aAAcjD,GAAQ8D,QAAU,CAEpC,MAAMyC,EAAgBvG,GAAQ8D,QAAQ0C,SAEtC,IAAM,MAAMvC,KAAUsC,EAAgB,CAErC,MAAME,EAAWxgC,KAAKygC,cAAeH,EAAetC,GAAUiB,GAE5C,OAAbuB,GAAoBH,EAAY7oB,IAAK9S,SAAUs5B,GAAUwC,IAMhE,OAAOH,EAORI,cAAeC,EAAczB,GAE5B,MAAMxB,EAAKiD,EAAa//B,GAClBU,EAAOq/B,EAAalB,SAC1B,IAAI7tB,EAAO+uB,EAAaC,aAUxB,GAPqB,kBAAThvB,IAEXA,EAAOA,EAAKrO,QAKN02B,GAAYsD,IAAKG,GAAO,OAAO,KAEtC,MAAMmD,EAAa5gC,KAAK6gC,gBAAiBH,EAAczB,EAAYxB,GAEnE,IAAI+C,EAEJ,OAAS7uB,EAAKmtB,eAEb,IAAK,QACJ0B,EAAW,IAAI,MACf,MACD,IAAK,UACJA,EAAW,IAAI,MACf,MACD,QACCjyB,QAAQwE,KAAM,gFAAiFpB,GAC/F6uB,EAAW,IAAI,MAQjB,OAHAA,EAASM,UAAWF,GACpBJ,EAASn/B,KAAOA,EAETm/B,EAMRK,gBAAiBH,EAAczB,EAAYxB,GAE1C,MAAMmD,EAAa,GAEdF,EAAaK,aAEjBH,EAAWI,UAAYN,EAAaK,WAAWz9B,OAI3Co9B,EAAaO,QAEjBL,EAAWM,OAAQ,IAAI,OAAQC,UAAWT,EAAaO,QAAQ39B,QAEpDo9B,EAAaU,cAAqD,UAAnCV,EAAaU,aAAazvB,MAAuD,aAAnC+uB,EAAaU,aAAazvB,OAGlHivB,EAAWM,OAAQ,IAAI,OAAQC,UAAWT,EAAaU,aAAa99B,QAIhEo9B,EAAaW,qBAEjBT,EAAWU,kBAAoBZ,EAAaW,mBAAmB/9B,OAI3Do9B,EAAaa,SAEjBX,EAAWY,UAAW,IAAI,OAAQL,UAAWT,EAAaa,SAASj+B,QAExDo9B,EAAae,eAAuD,UAApCf,EAAae,cAAc9vB,MAAwD,aAApC+uB,EAAae,cAAc9vB,OAGrHivB,EAAWY,UAAW,IAAI,OAAQL,UAAWT,EAAae,cAAcn+B,QAIpEo9B,EAAagB,iBAEjBd,EAAWe,kBAAoBv5B,WAAYs4B,EAAagB,eAAep+B,QAInEo9B,EAAakB,UAEjBhB,EAAWiB,QAAUz5B,WAAYs4B,EAAakB,QAAQt+B,QAIlDs9B,EAAWiB,QAAU,IAEzBjB,EAAWkB,aAAc,GAIrBpB,EAAaqB,mBAEjBnB,EAAWoB,aAAetB,EAAaqB,iBAAiBz+B,OAIpDo9B,EAAauB,YAEjBrB,EAAWsB,UAAYxB,EAAauB,UAAU3+B,OAI1Co9B,EAAayB,SAEjBvB,EAAWwB,UAAW,IAAI,OAAQjB,UAAWT,EAAayB,SAAS7+B,OAExDo9B,EAAa2B,eAAqD,UAApC3B,EAAa2B,cAAc1wB,OAGpEivB,EAAWwB,UAAW,IAAI,OAAQjB,UAAWT,EAAa2B,cAAc/+B,QAIzE,MAAMoN,EAAQ1Q,KAoFd,OAnFAg6B,GAAY0D,IAAKD,GAAK18B,SAAS8L,SAAS,SAAWy1B,GAElD,MAAM3wB,EAAO2wB,EAAMjF,aAEnB,OAAS1rB,GAER,IAAK,OACJivB,EAAW2B,QAAU7xB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,IACzD,MAED,IAAK,kBACJmD,EAAW6B,MAAQ/xB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,IACvD,MAED,IAAK,eACL,IAAK,qBACJmD,EAAW8B,IAAMhyB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,SAC7B77B,IAAnBg/B,EAAW8B,MAEf9B,EAAW8B,IAAIC,SAAW,OAI3B,MAED,IAAK,oBACJ/B,EAAWgC,gBAAkBlyB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,IACjE,MAED,IAAK,gBACJmD,EAAWiC,YAAcnyB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,SAC7B77B,IAA3Bg/B,EAAWiC,cAEfjC,EAAWiC,YAAYF,SAAW,OAInC,MAED,IAAK,YACL,IAAK,sBACJ/B,EAAWkC,UAAYpyB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,IAC3D,MAED,IAAK,kBACJmD,EAAWmC,OAASryB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,SAC7B77B,IAAtBg/B,EAAWmC,SAEfnC,EAAWmC,OAAOC,QAAU,MAC5BpC,EAAWmC,OAAOJ,SAAW,OAI9B,MAED,IAAK,gBACJ/B,EAAWqC,YAAcvyB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,SAC7B77B,IAA3Bg/B,EAAWqC,cAEfrC,EAAWqC,YAAYN,SAAW,OAInC,MAED,IAAK,mBACL,IAAK,qBACJ/B,EAAWsC,SAAWxyB,EAAM8xB,WAAYvD,EAAYqD,EAAM7E,IAC1DmD,EAAWkB,aAAc,EACzB,MAED,IAAK,eACL,IAAK,oBACL,IAAK,iBACL,IAAK,0BACL,QACCvzB,QAAQwE,KAAM,0EAA2EpB,OAOrFivB,EAKR4B,WAAYvD,EAAYt+B,GAUvB,MAPK,mBAAoBo5B,GAAQ8D,SAAWl9B,KAAMo5B,GAAQ8D,QAAQsF,iBAEjE50B,QAAQwE,KAAM,oGACdpS,EAAKq5B,GAAY0D,IAAK/8B,GAAKI,SAAU,GAAI08B,IAInCwB,EAAWvB,IAAK/8B,GAOxBg8B,iBAEC,MAAMyG,EAAY,GACZC,EAAe,GAErB,GAAK,aAActJ,GAAQ8D,QAAU,CAEpC,MAAMyF,EAAgBvJ,GAAQ8D,QAAQ0F,SAEtC,IAAM,MAAMvF,KAAUsF,EAAgB,CAErC,MAAME,EAAeF,EAAetF,GAE9ByF,EAAgBzJ,GAAY0D,IAAKh5B,SAAUs5B,IAEjD,GAA+B,SAA1BwF,EAAaE,SAAsB,CAEvC,MAAMC,EAAW3jC,KAAK4jC,cAAeH,EAAeH,GACpDK,EAASlG,GAAKO,EAETyF,EAAclG,QAAQtyB,OAAS,GAAIsD,QAAQwE,KAAM,kFACtD4wB,EAASE,WAAaJ,EAAclG,QAAS,GAAIE,GAEjD2F,EAAWpF,GAAW2F,OAEhB,GAA+B,eAA1BH,EAAaE,SAA4B,CAEpD,MAAMI,EAAc,CACnBnjC,GAAIq9B,GAGL8F,EAAYC,WAAa/jC,KAAKgkC,kBAAmBP,EAAeH,GAChEQ,EAAYnjC,GAAKq9B,EAEZyF,EAAclG,QAAQtyB,OAAS,GAAIsD,QAAQwE,KAAM,sFAEtDswB,EAAcrF,GAAW8F,IAQ5B,MAAO,CAENV,UAAWA,EACXC,aAAcA,GAShBO,cAAeH,EAAeQ,GAE7B,MAAMC,EAAW,GA8BjB,OA5BAT,EAAc1iC,SAAS8L,SAAS,SAAWy1B,GAE1C,MAAM6B,EAAWF,EAAe3B,EAAM7E,IAEtC,GAA2B,YAAtB0G,EAAST,SAAyB,OAEvC,MAAMU,EAAU,CAEf3G,GAAI6E,EAAM7E,GACV4G,QAAS,GACTC,QAAS,GACTC,eAAe,IAAI,OAAUpD,UAAWgD,EAASK,cAAct6B,IAM3D,YAAai6B,IAEjBC,EAAQC,QAAUF,EAASM,QAAQv6B,EACnCk6B,EAAQE,QAAUH,EAASO,QAAQx6B,GAIpCg6B,EAASljC,KAAMojC,MAIT,CAENF,SAAUA,EACVS,MAAO,IAOTX,kBAAmBP,EAAeQ,GAEjC,MAAMW,EAAkB,GAExB,IAAM,IAAIhoB,EAAI,EAAGA,EAAI6mB,EAAc1iC,SAASkK,OAAQ2R,IAAO,CAE1D,MAAM0lB,EAAQmB,EAAc1iC,SAAU6b,GAEhCioB,EAAkBZ,EAAe3B,EAAM7E,IAEvCqH,EAAiB,CAEtBzjC,KAAMwjC,EAAgBrF,SACtBuF,cAAeF,EAAgBG,cAC/BrkC,GAAIkkC,EAAgBlkC,GACpBskC,YAAaJ,EAAgBK,YAAYh7B,GAI1C,GAAkC,sBAA7B26B,EAAgBnB,SAAmC,OAExDoB,EAAeK,MAAQnL,GAAY0D,IAAKh5B,SAAU49B,EAAM7E,KAAO18B,SAASqkC,QAAQ,SAAW9C,GAE1F,YAA8B1gC,IAAvB0gC,EAAMjF,gBAET,GAAII,GAETmH,EAAgB5jC,KAAM8jC,GAIvB,OAAOF,EAKR9H,WAAYJ,EAAWE,EAAayD,GAEnCpG,GAAa,IAAI,MAEjB,MAAMoL,EAAWrlC,KAAKslC,YAAa5I,EAAU0G,UAAWxG,EAAayD,GAE/DkF,EAAaxL,GAAQ8D,QAAQ2H,MAE7B90B,EAAQ1Q,KACdqlC,EAASx4B,SAAS,SAAW44B,GAE5B,MAAMC,EAAYH,EAAYE,EAAMhI,IACpC/sB,EAAMi1B,oBAAqBF,EAAOC,GAER1L,GAAY0D,IAAK+H,EAAMhI,IAAKF,QAEpC1wB,SAAS,SAAW+4B,GAErC,MAAMjmC,EAAS0lC,EAAS3H,IAAKkI,EAAWnI,SACxB77B,IAAXjC,GAAuBA,EAAOa,IAAKilC,MAInB,OAAjBA,EAAM9lC,QAEVs6B,GAAWz5B,IAAKilC,MAOlBzlC,KAAK6lC,aAAcnJ,EAAU0G,UAAWxG,EAAayI,GAErDrlC,KAAK8lC,qBAEL7L,GAAW8L,UAAU,SAAWC,GAE/B,GAAKA,EAAKC,SAASC,cAAgB,CAE7BF,EAAKrmC,SAETqmC,EAAKC,SAASC,cAAcC,aAAeH,EAAKrmC,OAAOwa,OACvD6rB,EAAKC,SAASC,cAAcE,kBAAoBJ,EAAKrmC,OAAOuS,aAI7D,MAAMm0B,EAAYC,GAAmBN,EAAKC,SAASC,eAEnDF,EAAKv0B,aAAc40B,GACnBL,EAAKO,wBAMP,MAAMC,GAAa,IAAIC,IAAkBzL,QAGL,IAA/Bf,GAAWl5B,SAASkK,QAAgBgvB,GAAWl5B,SAAU,GAAI2lC,UAEjEzM,GAAWl5B,SAAU,GAAIylC,WAAaA,EACtCvM,GAAaA,GAAWl5B,SAAU,IAInCk5B,GAAWuM,WAAaA,EAKzBlB,YAAalC,EAAWxG,EAAayD,GAEpC,MAAMgF,EAAW,IAAIrI,IACfuI,EAAaxL,GAAQ8D,QAAQ2H,MAEnC,IAAM,MAAMxH,KAAUuH,EAAa,CAElC,MAAM5kC,EAAK+D,SAAUs5B,GACfgI,EAAOT,EAAYvH,GACnByF,EAAgBzJ,GAAY0D,IAAK/8B,GAEvC,IAAI8kC,EAAQzlC,KAAK2mC,cAAelD,EAAeL,EAAWziC,EAAIqlC,EAAKxG,UAEnE,IAAOiG,EAAQ,CAEd,OAASO,EAAKtC,UAEb,IAAK,SACJ+B,EAAQzlC,KAAK4mC,aAAcnD,GAC3B,MACD,IAAK,QACJgC,EAAQzlC,KAAK6mC,YAAapD,GAC1B,MACD,IAAK,OACJgC,EAAQzlC,KAAK8mC,WAAYrD,EAAe7G,EAAayD,GACrD,MACD,IAAK,aACJoF,EAAQzlC,KAAK+mC,YAAatD,EAAe7G,GACzC,MACD,IAAK,WACL,IAAK,OACJ6I,EAAQ,IAAI,MACZ,MACD,IAAK,OACL,QACCA,EAAQ,IAAI,MAKdA,EAAMpkC,KAAO2kC,EAAKxG,SAAW,uBAAkCwG,EAAKxG,UAAa,GAEjFiG,EAAMhI,GAAK98B,EAIZX,KAAKgnC,iBAAkBvB,EAAOO,GAC9BX,EAAS7tB,IAAK7W,EAAI8kC,GAInB,OAAOJ,EAIRsB,cAAelD,EAAeL,EAAWziC,EAAIU,GAE5C,IAAI4lC,EAAO,KAwCX,OAtCAxD,EAAclG,QAAQ1wB,SAAS,SAAWlN,GAEzC,IAAM,MAAM89B,KAAM2F,EAAY,CAE7B,MAAMO,EAAWP,EAAW3F,GAE5BkG,EAASO,SAASr3B,SAAS,SAAWu3B,EAASxnB,GAE9C,GAAKwnB,EAAQ3G,KAAO99B,EAAO89B,GAAK,CAE/B,MAAMyJ,EAAUD,EAChBA,EAAO,IAAI,MAEXA,EAAK/0B,YAAYX,KAAM6yB,EAAQG,eAI/B0C,EAAK5lC,KAAOA,EAAO,uBAAkCA,GAAS,GAC9D4lC,EAAKxJ,GAAK98B,EAEVgjC,EAASgB,MAAO/nB,GAAMqqB,EAIL,OAAZC,GAEJD,EAAKzmC,IAAK0mC,WAYRD,EAKRL,aAAcnD,GAEb,IAAIgC,EACA0B,EAcJ,GAZA1D,EAAc1iC,SAAS8L,SAAS,SAAWy1B,GAE1C,MAAM8E,EAAOrN,GAAQ8D,QAAQwJ,cAAe/E,EAAM7E,SAEpC77B,IAATwlC,IAEJD,EAAkBC,WAMKxlC,IAApBulC,EAEJ1B,EAAQ,IAAI,UAEN,CAEN,IAAI9zB,EAAO,OACmC/P,IAAzCulC,EAAgBG,sBAAqF,IAA/CH,EAAgBG,qBAAqBhkC,QAE/FqO,EAAO,GAIR,IAAI41B,EAAoB,OACW3lC,IAA9BulC,EAAgBK,YAEpBD,EAAoBJ,EAAgBK,UAAUlkC,MAAQ,KAIvD,IAAImkC,EAAmB,SACW7lC,IAA7BulC,EAAgBO,WAEpBD,EAAmBN,EAAgBO,SAASpkC,MAAQ,KAKrD,IAAI0E,EAAQuB,OAAOo+B,WACfx4B,EAAS5F,OAAOq+B,iBAEiBhmC,IAAhCulC,EAAgBU,kBAA8DjmC,IAAjCulC,EAAgBW,eAEjE9/B,EAAQm/B,EAAgBU,YAAYvkC,MACpC6L,EAASg4B,EAAgBW,aAAaxkC,OAIvC,MAAMykC,EAAS//B,EAAQmH,EAEvB,IAAI+K,EAAM,QAC2BtY,IAAhCulC,EAAgBa,cAEpB9tB,EAAMitB,EAAgBa,YAAY1kC,OAInC,MAAM2kC,EAAcd,EAAgBe,YAAcf,EAAgBe,YAAY5kC,MAAQ,KAEtF,OAASqO,GAER,KAAK,EACJ8zB,EAAQ,IAAI,MAAmBvrB,EAAK6tB,EAAQR,EAAmBE,GAC1C,OAAhBQ,GAAuBxC,EAAM0C,eAAgBF,GAClD,MAED,KAAK,EACJxC,EAAQ,IAAI,OAAsBz9B,EAAQ,EAAGA,EAAQ,EAAGmH,EAAS,GAAKA,EAAS,EAAGo4B,EAAmBE,GACrG,MAED,QACCl5B,QAAQwE,KAAM,wCAA0CpB,EAAO,KAC/D8zB,EAAQ,IAAI,OAOf,OAAOA,EAKRoB,YAAapD,GAEZ,IAAIgC,EACA2C,EAcJ,GAZA3E,EAAc1iC,SAAS8L,SAAS,SAAWy1B,GAE1C,MAAM8E,EAAOrN,GAAQ8D,QAAQwJ,cAAe/E,EAAM7E,SAEpC77B,IAATwlC,IAEJgB,EAAiBhB,WAMKxlC,IAAnBwmC,EAEJ3C,EAAQ,IAAI,UAEN,CAEN,IAAI9zB,EAKHA,OAFiC/P,IAA7BwmC,EAAeC,UAEZ,EAIAD,EAAeC,UAAU/kC,MAIjC,IAAI49B,EAAQ,cAEkBt/B,IAAzBwmC,EAAeE,QAEnBpH,GAAQ,IAAI,OAAQC,UAAWiH,EAAeE,MAAMhlC,QAIrD,IAAIilC,OAA2C3mC,IAA7BwmC,EAAeI,UAA4B,EAAIJ,EAAeI,UAAUllC,MAAQ,SAGxD1B,IAArCwmC,EAAeK,mBAA8E,IAA3CL,EAAeK,kBAAkBnlC,QAEvFilC,EAAY,GAIb,IAAI/uB,EAAW,OAC2B5X,IAArCwmC,EAAeM,oBAIlBlvB,OAF4C5X,IAAxCwmC,EAAeO,sBAAoF,IAA9CP,EAAeO,qBAAqBrlC,MAElF,EAIA8kC,EAAeM,kBAAkBplC,OAO9C,MAAMslC,EAAQ,EAEd,OAASj3B,GAER,KAAK,EACJ8zB,EAAQ,IAAI,MAAYvE,EAAOqH,EAAW/uB,EAAUovB,GACpD,MAED,KAAK,EACJnD,EAAQ,IAAI,MAAkBvE,EAAOqH,GACrC,MAED,KAAK,EACJ,IAAIlvB,EAAQvR,KAAKyL,GAAK,OAEa3R,IAA9BwmC,EAAeS,aAEnBxvB,EAAQ,eAAoB+uB,EAAeS,WAAWvlC,QAIvD,IAAIwlC,EAAW,OACoBlnC,IAA9BwmC,EAAeW,aAKnBD,EAAW,eAAoBV,EAAeW,WAAWzlC,OACzDwlC,EAAWhhC,KAAKhF,IAAKgmC,EAAU,IAIhCrD,EAAQ,IAAI,MAAWvE,EAAOqH,EAAW/uB,EAAUH,EAAOyvB,EAAUF,GACpE,MAED,QACCr6B,QAAQwE,KAAM,uCAAyCq1B,EAAeC,UAAU/kC,MAAQ,iCACxFmiC,EAAQ,IAAI,MAAYvE,EAAOqH,QAKG3mC,IAA/BwmC,EAAeY,aAAkE,IAArCZ,EAAeY,YAAY1lC,QAE3EmiC,EAAMwD,YAAa,GAMrB,OAAOxD,EAIRqB,WAAYrD,EAAe7G,EAAayD,GAEvC,IAAIoF,EACAyD,EAAW,KACX1I,EAAW,KACf,MAAMhE,EAAY,GAuDlB,OApDAiH,EAAc1iC,SAAS8L,SAAS,SAAWy1B,GAErC1F,EAAYU,IAAKgF,EAAM7E,MAE3ByL,EAAWtM,EAAYc,IAAK4E,EAAM7E,KAI9B4C,EAAY/C,IAAKgF,EAAM7E,KAE3BjB,EAAUx7B,KAAMq/B,EAAY3C,IAAK4E,EAAM7E,QAMpCjB,EAAUvxB,OAAS,EAEvBu1B,EAAWhE,EAEAA,EAAUvxB,OAAS,EAE9Bu1B,EAAWhE,EAAW,IAItBgE,EAAW,IAAI,MAAmB,CAAEU,MAAO,WAC3C1E,EAAUx7B,KAAMw/B,IAIZ,UAAW0I,EAASC,YAExB3M,EAAU3vB,SAAS,SAAW2zB,GAE7BA,EAAS4I,cAAe,KAMrBF,EAASG,cAEb5D,EAAQ,IAAI,MAAayD,EAAU1I,GACnCiF,EAAM6D,wBAIN7D,EAAQ,IAAI,MAAMyD,EAAU1I,GAItBiF,EAIRsB,YAAatD,EAAe7G,GAE3B,MAAMsM,EAAWzF,EAAc1iC,SAASwoC,QAAQ,SAAWC,EAAKlH,GAI/D,OAFK1F,EAAYU,IAAKgF,EAAM7E,MAAO+L,EAAM5M,EAAYc,IAAK4E,EAAM7E,KAEzD+L,IAEL,MAGGhJ,EAAW,IAAI,MAAmB,CAAEU,MAAO,QAAUuI,UAAW,IACtE,OAAO,IAAI,MAAMP,EAAU1I,GAK5BwG,iBAAkBvB,EAAOC,GAExB,MAAMQ,EAAgB,GAEjB,gBAAiBR,IAAYQ,EAAcwD,YAAchlC,SAAUghC,EAAUiE,YAAYrmC,QAE1D4iC,EAAc0D,WAA7C,kBAAmBlE,EAAuCmE,GAAenE,EAAUoE,cAAcxmC,OACtE,MAE3B,oBAAqBoiC,IAAYQ,EAAc6D,YAAcrE,EAAUsE,gBAAgB1mC,OAEvF,gBAAiBoiC,IAAYQ,EAAc+D,YAAcvE,EAAUwE,YAAY5mC,OAC/E,iBAAkBoiC,IAAYQ,EAAciE,SAAWzE,EAAU0E,aAAa9mC,OAC9E,iBAAkBoiC,IAAYQ,EAAcmE,aAAe3E,EAAU4E,aAAahnC,OAElF,gBAAiBoiC,IAAYQ,EAAchvB,MAAQwuB,EAAU6E,YAAYjnC,OAEzE,kBAAmBoiC,IAAYQ,EAAcsE,cAAgB9E,EAAU+E,cAAcnnC,OACrF,iBAAkBoiC,IAAYQ,EAAcwE,aAAehF,EAAUiF,aAAarnC,OAElF,mBAAoBoiC,IAAYQ,EAAc0E,eAAiBlF,EAAUmF,eAAevnC,OACxF,kBAAmBoiC,IAAYQ,EAAc4E,cAAgBpF,EAAUqF,cAAcznC,OAE1FmiC,EAAMQ,SAASC,cAAgBA,EAIhCP,oBAAqBF,EAAOC,GAE3B,GAAK,mBAAoBA,EAAY,CAEnB1L,GAAY0D,IAAK+H,EAAMhI,IAAK18B,SAEpC8L,SAAS,SAAWy1B,GAE5B,GAA4B,mBAAvBA,EAAMjF,aAAoC,CAE9C,MAAM2N,EAAejR,GAAQ8D,QAAQ2H,MAAOlD,EAAM7E,IAElD,GAAK,oBAAqBuN,EAAe,CAExC,MAAM/pB,EAAM+pB,EAAahB,gBAAgB1mC,WAGnB1B,IAAjB6jC,EAAMlgC,QAEVkgC,EAAMlgC,OAAO+L,SAAS6vB,UAAWlgB,GACjCgZ,GAAWz5B,IAAKilC,EAAMlgC,SAItBkgC,EAAMnuB,QAAQ,IAAI,OAAU6pB,UAAWlgB,UAc7C4kB,aAAczC,EAAWxG,EAAayI,GAErC,MAAM4F,EAAejrC,KAAKkrC,iBAE1B,IAAM,MAAMzN,KAAM2F,EAAY,CAE7B,MAAMO,EAAWP,EAAW3F,GAEZzD,GAAY0D,IAAKh5B,SAAUi/B,EAASlG,KAAOF,QAEnD1wB,SAAS,SAAWlN,GAE3B,GAAKi9B,EAAYU,IAAK39B,EAAO89B,IAAO,CAEnC,MAAM0H,EAAQxlC,EAAO89B,GACIzD,GAAY0D,IAAKyH,GAEzB5H,QAAQ1wB,SAAS,SAAWs+B,GAE5C,GAAK9F,EAAS/H,IAAK6N,EAAc1N,IAAO,CAEzB4H,EAAS3H,IAAKyN,EAAc1N,IAEpCr8B,KAAM,IAAI,MAAUuiC,EAASgB,OAASsG,EAAcE,EAAc1N,cAc9EyN,iBAEC,MAAMD,EAAe,GAErB,GAAK,SAAUlR,GAAQ8D,QAAU,CAEhC,MAAMuN,EAAerR,GAAQ8D,QAAQwN,KAErC,IAAM,MAAMrN,KAAUoN,EAErB,GAAyC,aAApCA,EAAcpN,GAAS0F,UAA2B0H,EAAcpN,GAASsN,YAAc,EAAI,CAE/F,MAAMC,EAAYH,EAAcpN,GAASwN,SAEpCnmC,MAAMC,QAASimC,GAEnBA,EAAU1+B,SAAS,SAAW4+B,GAE7BR,EAAcQ,EAASC,OAAS,IAAI,OAAUvK,UAAWsK,EAASE,OAAOzhC,MAM1E+gC,EAAcM,EAAUG,OAAS,IAAI,OAAUvK,UAAWoK,EAAUI,OAAOzhC,IAU/E,OAAO+gC,EAKRnF,qBAEC,GAAK,mBAAoB/L,IAAW,iBAAkBA,GAAQ6R,eAAiB,CAE9E,MAAMC,EAAe9R,GAAQ6R,eAAeE,aAAaxoC,MACnDoC,EAAImmC,EAAc,GAClBlmC,EAAIkmC,EAAc,GAClBjmC,EAAIimC,EAAc,GAExB,GAAW,IAANnmC,GAAiB,IAANC,GAAiB,IAANC,EAAU,CAEpC,MAAMs7B,EAAQ,IAAI,MAAOx7B,EAAGC,EAAGC,GAC/Bq0B,GAAWz5B,IAAK,IAAI,MAAc0gC,EAAO,OAW7C,MAAMrE,GAGL7B,MAAO0B,GAEN,MAAME,EAAc,IAAII,IAExB,GAAK,aAAcjD,GAAQ8D,QAAU,CAEpC,MAAMkO,EAAWhS,GAAQ8D,QAAQmO,SAEjC,IAAM,MAAMhO,KAAU+N,EAAW,CAEhC,MAAMtI,EAAgBzJ,GAAY0D,IAAKh5B,SAAUs5B,IAC3CwL,EAAMxpC,KAAKisC,cAAexI,EAAesI,EAAU/N,GAAUtB,GAEnEE,EAAYplB,IAAK9S,SAAUs5B,GAAUwL,IAMvC,OAAO5M,EAKRqP,cAAexI,EAAeyI,EAASxP,GAEtC,OAASwP,EAAQxI,UAEhB,IAAK,OACJ,OAAO1jC,KAAKmsC,kBAAmB1I,EAAeyI,EAASxP,GAGxD,IAAK,aACJ,OAAO18B,KAAKosC,mBAAoBF,IAQnCC,kBAAmB1I,EAAeyI,EAASxP,GAE1C,MAAM0G,EAAY1G,EAAU0G,UACtBC,EAAe,GAEfkC,EAAa9B,EAAclG,QAAQmF,KAAK,SAAW/iC,GAExD,OAAOo6B,GAAQ8D,QAAQ2H,MAAO7lC,EAAO89B,OAKtC,GAA2B,IAAtB8H,EAAWt6B,OAAe,OAE/B,MAAM04B,EAAWF,EAAc1iC,SAASwoC,QAAQ,SAAW5F,EAAUrB,GAIpE,YAF+B1gC,IAA1BwhC,EAAWd,EAAM7E,MAAqBkG,EAAWP,EAAWd,EAAM7E,KAEhEkG,IAEL,MAEHF,EAAc1iC,SAAS8L,SAAS,SAAWy1B,QAEE1gC,IAAvC86B,EAAU2G,aAAcf,EAAM7E,KAElC4F,EAAariC,KAAM07B,EAAU2G,aAAcf,EAAM7E,QAQnD,MAAMiI,EAAYH,EAAY,GAExBW,EAAgB,GAEjB,kBAAmBR,IAAYQ,EAAc0D,WAAaC,GAAenE,EAAUoE,cAAcxmC,QACjG,gBAAiBoiC,IAAYQ,EAAcwD,YAAchlC,SAAUghC,EAAUiE,YAAYrmC,QAEzF,yBAA0BoiC,IAAYQ,EAAc6D,YAAcrE,EAAU2G,qBAAqB/oC,OACjG,sBAAuBoiC,IAAYQ,EAAciE,SAAWzE,EAAU4G,kBAAkBhpC,OACxF,qBAAsBoiC,IAAYQ,EAAchvB,MAAQwuB,EAAU6G,iBAAiBjpC,OAExF,MAAM+iC,EAAYC,GAAmBJ,GAErC,OAAOlmC,KAAKwsC,YAAaN,EAASvI,EAAUN,EAAcgD,GAK3DmG,YAAaN,EAASvI,EAAUN,EAAcoJ,GAE7C,MAAMjD,EAAM,IAAI,MACX0C,EAAQ1M,WAAWgK,EAAInoC,KAAO6qC,EAAQ1M,UAE3C,MAAMkN,EAAU1sC,KAAK2sC,aAAcT,EAASvI,GACtCiJ,EAAU5sC,KAAK6sC,WAAYH,GAE3BI,EAAoB,IAAI,MAAwBF,EAAQG,OAAQ,GAuBtE,GArBAD,EAAkBr7B,aAAcg7B,GAEhCjD,EAAIplC,aAAc,WAAY0oC,GAEzBF,EAAQI,OAAO/hC,OAAS,GAE5Bu+B,EAAIplC,aAAc,QAAS,IAAI,MAAwBwoC,EAAQI,OAAQ,IAInErJ,IAEJ6F,EAAIplC,aAAc,YAAa,IAAI,MAAuBwoC,EAAQK,eAAgB,IAElFzD,EAAIplC,aAAc,aAAc,IAAI,MAAwBwoC,EAAQM,cAAe,IAGnF1D,EAAIH,aAAe1F,GAIfiJ,EAAQ56B,OAAO/G,OAAS,EAAI,CAEhC,MAAMkiC,GAAe,IAAI,OAAUC,gBAAiBX,GAE9CY,EAAkB,IAAI,MAAwBT,EAAQ56B,OAAQ,GACpEq7B,EAAgBC,kBAAmBH,GAEnC3D,EAAIplC,aAAc,SAAUipC,GAoB7B,GAhBAT,EAAQW,IAAI1gC,SAAS,SAAW2gC,EAAU5wB,GAGzC,IAAIvb,EAAO,MAASub,EAAI,GAAIjY,WAGjB,IAANiY,IAEJvb,EAAO,MAIRmoC,EAAIplC,aAAc/C,EAAM,IAAI,MAAwBurC,EAAQW,IAAK3wB,GAAK,OAIlE8vB,EAAQlM,UAA6C,YAAjCkM,EAAQlM,SAASiN,YAA4B,CAGrE,IAAIC,EAAoBd,EAAQe,cAAe,GAC3CC,EAAa,EAgBjB,GAdAhB,EAAQe,cAAc9gC,SAAS,SAAWghC,EAAcjxB,GAElDixB,IAAiBH,IAErBlE,EAAIsE,SAAUF,EAAYhxB,EAAIgxB,EAAYF,GAE1CA,EAAoBG,EACpBD,EAAahxB,MAOV4sB,EAAIuE,OAAO9iC,OAAS,EAAI,CAE5B,MAAM+iC,EAAYxE,EAAIuE,OAAQvE,EAAIuE,OAAO9iC,OAAS,GAC5CgjC,EAAYD,EAAU5vB,MAAQ4vB,EAAUE,MAEzCD,IAAcrB,EAAQe,cAAc1iC,QAExCu+B,EAAIsE,SAAUG,EAAWrB,EAAQe,cAAc1iC,OAASgjC,EAAWP,GAQ1C,IAAtBlE,EAAIuE,OAAO9iC,QAEfu+B,EAAIsE,SAAU,EAAGlB,EAAQe,cAAc1iC,OAAQ2hC,EAAQe,cAAe,IAQxE,OAFA3tC,KAAKmuC,gBAAiB3E,EAAK0C,EAAS7I,EAAcoJ,GAE3CjD,EAIRmD,aAAcT,EAASvI,GAEtB,MAAM+I,EAAU,GAuBhB,GArBAA,EAAQ0B,qBAAyCxsC,IAArBsqC,EAAQmC,SAA2BnC,EAAQmC,SAASnkC,EAAI,GACpFwiC,EAAQ4B,mBAAiD1sC,IAA/BsqC,EAAQqC,mBAAqCrC,EAAQqC,mBAAmBrkC,EAAI,GAEjGgiC,EAAQsC,oBAEZ9B,EAAQxL,MAAQlhC,KAAKyuC,kBAAmBvC,EAAQsC,kBAAmB,KAI/DtC,EAAQwC,uBAEZhC,EAAQlM,SAAWxgC,KAAK2uC,qBAAsBzC,EAAQwC,qBAAsB,KAIxExC,EAAQ0C,qBAEZlC,EAAQ16B,OAAShS,KAAK6uC,aAAc3C,EAAQ0C,mBAAoB,KAI5D1C,EAAQ4C,eAAiB,CAE7BpC,EAAQqC,GAAK,GAEb,IAAInyB,EAAI,EACR,KAAQsvB,EAAQ4C,eAAgBlyB,IAE1BsvB,EAAQ4C,eAAgBlyB,GAAIoyB,IAEhCtC,EAAQqC,GAAG/tC,KAAMhB,KAAKivC,SAAU/C,EAAQ4C,eAAgBlyB,KAIzDA,IAgCF,OA1BA8vB,EAAQwC,YAAc,GAEJ,OAAbvL,IAEJ+I,EAAQ/I,SAAWA,EAEnBA,EAASO,SAASr3B,SAAS,SAAWu3B,EAASxnB,GAG9CwnB,EAAQC,QAAQx3B,SAAS,SAAWI,EAAOoR,QAEJzc,IAAjC8qC,EAAQwC,YAAajiC,KAAwBy/B,EAAQwC,YAAajiC,GAAU,IAEjFy/B,EAAQwC,YAAajiC,GAAQjM,KAAM,CAElCL,GAAIic,EACJuyB,OAAQ/K,EAAQE,QAASjmB,YAUtBquB,EAIRG,WAAYH,GAEX,MAAME,EAAU,CACfG,OAAQ,GACR/6B,OAAQ,GACRg7B,OAAQ,GACRO,IAAK,GACLI,cAAe,GACfT,cAAe,GACfD,eAAgB,IAGjB,IAAImC,EAAe,EACfC,EAAa,EACbC,GAA0B,EAG1BC,EAAsB,GACtBC,EAAc,GACdC,EAAa,GACbC,EAAU,GACVC,EAAc,GACdC,EAAoB,GAExB,MAAMl/B,EAAQ1Q,KA6Jd,OA5JA0sC,EAAQ4B,cAAczhC,SAAS,SAAWgjC,EAAaC,GAEtD,IAAInC,EACAoC,GAAY,EASXF,EAAc,IAElBA,IAA8B,EAC9BE,GAAY,GAIb,IAAIC,EAAgB,GAChB1L,EAAU,GAId,GAFAiL,EAAoBvuC,KAAoB,EAAd6uC,EAA+B,EAAdA,EAAkB,EAAiB,EAAdA,EAAkB,GAE7EnD,EAAQxL,MAAQ,CAEpB,MAAM9W,EAAO6lB,GAASH,EAAoBV,EAAcS,EAAanD,EAAQxL,OAE7EuO,EAAWzuC,KAAMopB,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAI9C,GAAKsiB,EAAQ/I,SAAW,CAcvB,QAZ4C/hC,IAAvC8qC,EAAQwC,YAAaW,IAEzBnD,EAAQwC,YAAaW,GAAchjC,SAAS,SAAWqjC,GAEtD5L,EAAQtjC,KAAMkvC,EAAGf,QACjBa,EAAchvC,KAAMkvC,EAAGvvC,OAOpB2jC,EAAQr5B,OAAS,EAAI,CAElBqkC,IAEN/gC,QAAQwE,KAAM,6GACdu8B,GAA0B,GAI3B,MAAMa,EAAS,CAAE,EAAG,EAAG,EAAG,GACpBC,EAAS,CAAE,EAAG,EAAG,EAAG,GAE1B9L,EAAQz3B,SAAS,SAAWsiC,EAAQkB,GAEnC,IAAIC,EAAgBnB,EAChBtB,EAAemC,EAAeK,GAElCD,EAAOvjC,SAAS,SAAW0jC,EAAgBC,EAAqBC,GAE/D,GAAKH,EAAgBC,EAAiB,CAErCE,EAAqBD,GAAwBF,EAC7CA,EAAgBC,EAEhB,MAAMG,EAAMP,EAAQK,GACpBL,EAAQK,GAAwB3C,EAChCA,EAAe6C,SAQlBV,EAAgBG,EAChB7L,EAAU8L,EAKX,KAAQ9L,EAAQr5B,OAAS,GAExBq5B,EAAQtjC,KAAM,GACdgvC,EAAchvC,KAAM,GAIrB,IAAM,IAAI4b,EAAI,EAAGA,EAAI,IAAMA,EAE1B+yB,EAAY3uC,KAAMsjC,EAAS1nB,IAC3BgzB,EAAkB5uC,KAAMgvC,EAAepzB,IAMzC,GAAK8vB,EAAQ16B,OAAS,CAErB,MAAMoY,EAAO6lB,GAASH,EAAoBV,EAAcS,EAAanD,EAAQ16B,QAE7Ew9B,EAAYxuC,KAAMopB,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAI1CsiB,EAAQlM,UAA6C,YAAjCkM,EAAQlM,SAASiN,cAEzCE,EAAgBsC,GAASH,EAAoBV,EAAcS,EAAanD,EAAQlM,UAAY,IAIxFkM,EAAQqC,IAEZrC,EAAQqC,GAAGliC,SAAS,SAAWkiC,EAAInyB,GAElC,MAAMwN,EAAO6lB,GAASH,EAAoBV,EAAcS,EAAad,QAE/CntC,IAAjB8tC,EAAS9yB,KAEb8yB,EAAS9yB,GAAM,IAIhB8yB,EAAS9yB,GAAI5b,KAAMopB,EAAM,IACzBslB,EAAS9yB,GAAI5b,KAAMopB,EAAM,OAM3BilB,IAEKU,IAEJr/B,EAAMigC,QAAS/D,EAASF,EAAS6C,EAAqB5B,EAAe6B,EAAaC,EAAYC,EAASC,EAAaC,EAAmBP,GAEvID,IACAC,EAAa,EAGbE,EAAsB,GACtBC,EAAc,GACdC,EAAa,GACbC,EAAU,GACVC,EAAc,GACdC,EAAoB,OAMfhD,EAKR+D,QAAS/D,EAASF,EAAS6C,EAAqB5B,EAAe6B,EAAaC,EAAYC,EAASC,EAAaC,EAAmBP,GAEhI,IAAM,IAAIzyB,EAAI,EAAGA,EAAIyyB,EAAYzyB,IAEhCgwB,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAqB,KACnE3C,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAqB,KACnE3C,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAqB,KAEnE3C,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAiC,GAAV3yB,EAAI,MACzEgwB,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAiC,GAAV3yB,EAAI,GAAU,KACnFgwB,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAiC,GAAV3yB,EAAI,GAAU,KAEnFgwB,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAyB,EAAJ3yB,KACnEgwB,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAyB,EAAJ3yB,EAAQ,KAC3EgwB,EAAQG,OAAO/rC,KAAM0rC,EAAQ0B,gBAAiBmB,EAAyB,EAAJ3yB,EAAQ,KAEtE8vB,EAAQ/I,WAEZiJ,EAAQM,cAAclsC,KAAM2uC,EAAa,IACzC/C,EAAQM,cAAclsC,KAAM2uC,EAAa,IACzC/C,EAAQM,cAAclsC,KAAM2uC,EAAa,IACzC/C,EAAQM,cAAclsC,KAAM2uC,EAAa,IAEzC/C,EAAQM,cAAclsC,KAAM2uC,EAAyB,GAAV/yB,EAAI,KAC/CgwB,EAAQM,cAAclsC,KAAM2uC,EAAyB,GAAV/yB,EAAI,GAAU,IACzDgwB,EAAQM,cAAclsC,KAAM2uC,EAAyB,GAAV/yB,EAAI,GAAU,IACzDgwB,EAAQM,cAAclsC,KAAM2uC,EAAyB,GAAV/yB,EAAI,GAAU,IAEzDgwB,EAAQM,cAAclsC,KAAM2uC,EAAiB,EAAJ/yB,IACzCgwB,EAAQM,cAAclsC,KAAM2uC,EAAiB,EAAJ/yB,EAAQ,IACjDgwB,EAAQM,cAAclsC,KAAM2uC,EAAiB,EAAJ/yB,EAAQ,IACjDgwB,EAAQM,cAAclsC,KAAM2uC,EAAiB,EAAJ/yB,EAAQ,IAEjDgwB,EAAQK,eAAejsC,KAAM4uC,EAAmB,IAChDhD,EAAQK,eAAejsC,KAAM4uC,EAAmB,IAChDhD,EAAQK,eAAejsC,KAAM4uC,EAAmB,IAChDhD,EAAQK,eAAejsC,KAAM4uC,EAAmB,IAEhDhD,EAAQK,eAAejsC,KAAM4uC,EAA+B,GAAVhzB,EAAI,KACtDgwB,EAAQK,eAAejsC,KAAM4uC,EAA+B,GAAVhzB,EAAI,GAAU,IAChEgwB,EAAQK,eAAejsC,KAAM4uC,EAA+B,GAAVhzB,EAAI,GAAU,IAChEgwB,EAAQK,eAAejsC,KAAM4uC,EAA+B,GAAVhzB,EAAI,GAAU,IAEhEgwB,EAAQK,eAAejsC,KAAM4uC,EAAuB,EAAJhzB,IAChDgwB,EAAQK,eAAejsC,KAAM4uC,EAAuB,EAAJhzB,EAAQ,IACxDgwB,EAAQK,eAAejsC,KAAM4uC,EAAuB,EAAJhzB,EAAQ,IACxDgwB,EAAQK,eAAejsC,KAAM4uC,EAAuB,EAAJhzB,EAAQ,KAIpD8vB,EAAQxL,QAEZ0L,EAAQI,OAAOhsC,KAAMyuC,EAAY,IACjC7C,EAAQI,OAAOhsC,KAAMyuC,EAAY,IACjC7C,EAAQI,OAAOhsC,KAAMyuC,EAAY,IAEjC7C,EAAQI,OAAOhsC,KAAMyuC,EAAwB,GAAV7yB,EAAI,KACvCgwB,EAAQI,OAAOhsC,KAAMyuC,EAAwB,GAAV7yB,EAAI,GAAU,IACjDgwB,EAAQI,OAAOhsC,KAAMyuC,EAAwB,GAAV7yB,EAAI,GAAU,IAEjDgwB,EAAQI,OAAOhsC,KAAMyuC,EAAgB,EAAJ7yB,IACjCgwB,EAAQI,OAAOhsC,KAAMyuC,EAAgB,EAAJ7yB,EAAQ,IACzCgwB,EAAQI,OAAOhsC,KAAMyuC,EAAgB,EAAJ7yB,EAAQ,KAIrC8vB,EAAQlM,UAA6C,YAAjCkM,EAAQlM,SAASiN,cAEzCb,EAAQe,cAAc3sC,KAAM2sC,GAC5Bf,EAAQe,cAAc3sC,KAAM2sC,GAC5Bf,EAAQe,cAAc3sC,KAAM2sC,IAIxBjB,EAAQ16B,SAEZ46B,EAAQ56B,OAAOhR,KAAMwuC,EAAa,IAClC5C,EAAQ56B,OAAOhR,KAAMwuC,EAAa,IAClC5C,EAAQ56B,OAAOhR,KAAMwuC,EAAa,IAElC5C,EAAQ56B,OAAOhR,KAAMwuC,EAAyB,GAAV5yB,EAAI,KACxCgwB,EAAQ56B,OAAOhR,KAAMwuC,EAAyB,GAAV5yB,EAAI,GAAU,IAClDgwB,EAAQ56B,OAAOhR,KAAMwuC,EAAyB,GAAV5yB,EAAI,GAAU,IAElDgwB,EAAQ56B,OAAOhR,KAAMwuC,EAAiB,EAAJ5yB,IAClCgwB,EAAQ56B,OAAOhR,KAAMwuC,EAAiB,EAAJ5yB,EAAQ,IAC1CgwB,EAAQ56B,OAAOhR,KAAMwuC,EAAiB,EAAJ5yB,EAAQ,KAItC8vB,EAAQqC,IAEZrC,EAAQqC,GAAGliC,SAAS,SAAWkiC,EAAI1wB,QAERzc,IAArBgrC,EAAQW,IAAKlvB,KAAoBuuB,EAAQW,IAAKlvB,GAAM,IAEzDuuB,EAAQW,IAAKlvB,GAAIrd,KAAM0uC,EAASrxB,GAAK,IACrCuuB,EAAQW,IAAKlvB,GAAIrd,KAAM0uC,EAASrxB,GAAK,IAErCuuB,EAAQW,IAAKlvB,GAAIrd,KAAM0uC,EAASrxB,GAAiB,GAAVzB,EAAI,KAC3CgwB,EAAQW,IAAKlvB,GAAIrd,KAAM0uC,EAASrxB,GAAiB,GAAVzB,EAAI,GAAU,IAErDgwB,EAAQW,IAAKlvB,GAAIrd,KAAM0uC,EAASrxB,GAAS,EAAJzB,IACrCgwB,EAAQW,IAAKlvB,GAAIrd,KAAM0uC,EAASrxB,GAAS,EAAJzB,EAAQ,OAUjDuxB,gBAAiByC,EAAWC,EAAexN,EAAcoJ,GAExD,GAA6B,IAAxBpJ,EAAap4B,OAAe,OAEjC2lC,EAAUE,sBAAuB,EAEjCF,EAAUG,gBAAgBz/B,SAAW,GAGrC,MAAMZ,EAAQ1Q,KACdqjC,EAAax2B,SAAS,SAAWi3B,GAEhCA,EAAYC,WAAWl3B,SAAS,SAAWmkC,GAE1C,MAAMC,EAAelX,GAAQ8D,QAAQmO,SAAUgF,EAAU7L,YAEnCvjC,IAAjBqvC,GAEJvgC,EAAMwgC,iBAAkBN,EAAWC,EAAeI,EAAcxE,EAAcuE,EAAU3vC,YAc5F6vC,iBAAkBN,EAAWC,EAAeI,EAAcxE,EAAcprC,GAEvE,MAAMitC,OAAuD1sC,IAArCivC,EAActC,mBAAqCsC,EAActC,mBAAmBrkC,EAAI,GAE1GinC,OAAmDvvC,IAA1BqvC,EAAa5C,SAA2B4C,EAAa5C,SAASnkC,EAAI,GAC3Fm6B,OAAqCziC,IAAzBqvC,EAAaxM,QAA0BwM,EAAaxM,QAAQv6B,EAAI,GAE5Ee,EAA+C,EAAtC2lC,EAAUzH,WAAW73B,SAAS48B,MACvCkD,EAAiB,IAAIC,aAAcpmC,GAEzC,IAAM,IAAI2R,EAAI,EAAGA,EAAIynB,EAAQp5B,OAAQ2R,IAAO,CAE3C,MAAM00B,EAA4B,EAAfjN,EAASznB,GAE5Bw0B,EAAgBE,GAAeH,EAA0B,EAAJv0B,GACrDw0B,EAAgBE,EAAa,GAAMH,EAA0B,EAAJv0B,EAAQ,GACjEw0B,EAAgBE,EAAa,GAAMH,EAA0B,EAAJv0B,EAAQ,GAKlE,MAAM20B,EAAe,CACpBjD,cAAeA,EACfF,gBAAiBgD,GAIZI,EAAexxC,KAAK6sC,WAAY0E,GAEhCzE,EAAoB,IAAI,MAAwB0E,EAAazE,OAAQ,GAC3ED,EAAkBzrC,KAAOA,GAAQ4vC,EAAazR,SAE9CsN,EAAkBr7B,aAAcg7B,GAEhCmE,EAAUG,gBAAgBz/B,SAAStQ,KAAM8rC,GAK1C+B,aAAc4C,GAEb,MAAMhE,EAAcgE,EAAWC,uBACzBC,EAAgBF,EAAWG,yBAC3BrnB,EAASknB,EAAWI,QAAQ3nC,EAClC,IAAI4nC,EAAc,GAelB,MAduB,kBAAlBH,IAEC,gBAAiBF,EAErBK,EAAcL,EAAWM,YAAY7nC,EAE1B,iBAAkBunC,IAE7BK,EAAcL,EAAWO,aAAa9nC,IAMjC,CACN+nC,SAAU,EACV1nB,OAAQA,EACR8Z,QAASyN,EACTrE,YAAaA,EACbkE,cAAeA,GAMjB1C,SAAUiD,GAET,MAAMzE,EAAcyE,EAAOR,uBACrBC,EAAgBO,EAAON,yBACvBrnB,EAAS2nB,EAAOlD,GAAG9kC,EACzB,IAAI4nC,EAAc,GAOlB,MANuB,kBAAlBH,IAEJG,EAAcI,EAAOC,QAAQjoC,GAIvB,CACN+nC,SAAU,EACV1nB,OAAQA,EACR8Z,QAASyN,EACTrE,YAAaA,EACbkE,cAAeA,GAMjBlD,kBAAmB2D,GAElB,MAAM3E,EAAc2E,EAAUV,uBACxBC,EAAgBS,EAAUR,yBAC1BrnB,EAAS6nB,EAAUC,OAAOnoC,EAChC,IAAI4nC,EAAc,GAOlB,MANuB,kBAAlBH,IAEJG,EAAcM,EAAUE,WAAWpoC,GAI7B,CACN+nC,SAAU,EACV1nB,OAAQA,EACR8Z,QAASyN,EACTrE,YAAaA,EACbkE,cAAeA,GAMjBhD,qBAAsB4D,GAErB,MAAM9E,EAAc8E,EAAab,uBAC3BC,EAAgBY,EAAaX,yBAEnC,GAAqB,yBAAhBnE,EAEJ,MAAO,CACNwE,SAAU,EACV1nB,OAAQ,CAAE,GACV8Z,QAAS,CAAE,GACXoJ,YAAa,UACbkE,cAAeA,GAKjB,MAAMa,EAAsBD,EAAaE,UAAUvoC,EAK7CwoC,EAAkB,GAExB,IAAM,IAAI91B,EAAI,EAAGA,EAAI41B,EAAoBvnC,SAAW2R,EAEnD81B,EAAgB1xC,KAAM4b,GAIvB,MAAO,CACNq1B,SAAU,EACV1nB,OAAQioB,EACRnO,QAASqO,EACTjF,YAAaA,EACbkE,cAAeA,GAMjBvF,mBAAoBF,GAEnB,QAAoBtqC,IAAfo3B,GAGJ,OADAzqB,QAAQC,MAAO,8HACR,IAAI,MAIZ,MAAMmkC,EAAQjuC,SAAUwnC,EAAQ0G,OAEhC,GAAKvqC,MAAOsqC,GAGX,OADApkC,QAAQC,MAAO,8DAA+D09B,EAAQ0G,MAAO1G,EAAQvrC,IAC9F,IAAI,MAIZ,MAAMs4B,EAAS0Z,EAAQ,EAEjBzZ,EAAQgT,EAAQ2G,WAAW3oC,EAC3BivB,EAAgB,GAChB2Z,EAAe5G,EAAQ6G,OAAO7oC,EAEpC,IAAM,IAAI0S,EAAI,EAAGqC,EAAI6zB,EAAa7nC,OAAQ2R,EAAIqC,EAAGrC,GAAK,EAErDuc,EAAcn4B,MAAM,IAAI,OAAUmgC,UAAW2R,EAAcl2B,IAI5D,IAAIwc,EAAWC,EAEf,GAAsB,WAAjB6S,EAAQ8G,KAEZ7Z,EAAcn4B,KAAMm4B,EAAe,SAE7B,GAAsB,aAAjB+S,EAAQ8G,KAAsB,CAEzC5Z,EAAYH,EACZI,EAAUH,EAAMjuB,OAAS,EAAImuB,EAE7B,IAAM,IAAIxc,EAAI,EAAGA,EAAIqc,IAAWrc,EAE/Buc,EAAcn4B,KAAMm4B,EAAevc,IAMrC,MACMq2B,EADQ,IAAIja,GAAYC,EAAQC,EAAOC,EAAeC,EAAWC,GAClD6Z,UAAkC,GAAvB/Z,EAAcluB,QAE9C,OAAO,IAAI,OAAiBkoC,cAAeF,IAO7C,MAAMxM,GAGLzL,QAEC,MAAMoY,EAAiB,GAEjBC,EAAWrzC,KAAKszC,aAEtB,QAAkB1xC,IAAbyxC,EAEJ,IAAM,MAAME,KAAOF,EAAW,CAE7B,MAAMG,EAAUH,EAAUE,GAEpBE,EAAOzzC,KAAK0zC,QAASF,GAE3BJ,EAAepyC,KAAMyyC,GAMvB,OAAOL,EAIRE,aAIC,QAAwC1xC,IAAnCm4B,GAAQ8D,QAAQ8V,eAA+B,OAEpD,MAAMC,EAAgB5zC,KAAK6zC,2BAE3B7zC,KAAK8zC,qBAAsBF,GAE3B,MAAMG,EAAY/zC,KAAKg0C,qBAAsBJ,GAG7C,OAFiB5zC,KAAKi0C,gBAAiBF,GASxCF,2BAEC,MAAMK,EAAgBna,GAAQ8D,QAAQsW,mBAEhCP,EAAgB,IAAI5W,IAE1B,IAAM,MAAMgB,KAAUkW,EAAgB,CAErC,MAAME,EAAeF,EAAelW,GAEpC,GAA8D,OAAzDoW,EAAa5U,SAASh7B,MAAO,uBAAmC,CAEpE,MAAM6vC,EAAY,CAEjB1zC,GAAIyzC,EAAazzC,GACjBymC,KAAMgN,EAAa5U,SACnB8U,OAAQ,IAITV,EAAcp8B,IAAK68B,EAAU1zC,GAAI0zC,IAMnC,OAAOT,EAORE,qBAAsBF,GAErB,MAAMW,EAAYxa,GAAQ8D,QAAQ8V,eASlC,IAAM,MAAM3V,KAAUuW,EAAY,CAEjC,MAAMC,EAAiB,CAEtB7zC,GAAI4zC,EAAWvW,GAASr9B,GACxB8zC,MAAOF,EAAWvW,GAAS0W,QAAQxqC,EAAEw4B,IAAKiS,IAC1CjoC,OAAQ6nC,EAAWvW,GAAS4W,cAAc1qC,GAIrCu5B,EAAgBzJ,GAAY0D,IAAK8W,EAAe7zC,IAEtD,QAAuBiB,IAAlB6hC,EAA8B,CAElC,MAAMoR,EAAmBpR,EAAclG,QAAS,GAAIE,GAC9CqX,EAA6BrR,EAAclG,QAAS,GAAIF,aAEzDyX,EAA2BtwC,MAAO,KAEtCovC,EAAclW,IAAKmX,GAAmBP,OAAY,EAAIE,EAE3CM,EAA2BtwC,MAAO,KAE7CovC,EAAclW,IAAKmX,GAAmBP,OAAY,EAAIE,EAE3CM,EAA2BtwC,MAAO,KAE7CovC,EAAclW,IAAKmX,GAAmBP,OAAY,EAAIE,EAE3CM,EAA2BtwC,MAAO,oBAAuBovC,EAActW,IAAKuX,KAEvFjB,EAAclW,IAAKmX,GAAmBP,OAAgB,MAAIE,KAa9DR,qBAAsBJ,GAErB,MAAMmB,EAAYhb,GAAQ8D,QAAQmX,eAE5BjB,EAAY,IAAI/W,IAEtB,IAAM,MAAMgB,KAAU+W,EAAY,CAEjC,MAAME,EAAkB,GAElBrP,EAAa5L,GAAY0D,IAAKh5B,SAAUs5B,IAE9C,QAAoBp8B,IAAfgkC,EAA2B,CAGdA,EAAW7kC,SAEnB8L,SAAS,SAAWy1B,EAAO1lB,GAEnC,GAAKg3B,EAActW,IAAKgF,EAAM7E,IAAO,CAEpC,MAAM4W,EAAYT,EAAclW,IAAK4E,EAAM7E,IAG3C,QAA4B77B,IAAvByyC,EAAUC,OAAOjiC,QAA0CzQ,IAAvByyC,EAAUC,OAAOhiC,QAA0C1Q,IAAvByyC,EAAUC,OAAOzjB,EAAkB,CAE/G,QAA8BjvB,IAAzBqzC,EAAiBr4B,GAAoB,CAEzC,MAAMs4B,EAAUlb,GAAY0D,IAAK4E,EAAM7E,IAAKF,QAAQ6H,QAAQ,SAAWzlC,GAEtE,YAA+BiC,IAAxBjC,EAAO09B,gBAEV,GAAII,GAET,QAAiB77B,IAAZszC,EAAwB,CAE5B,MAAMC,EAAWpb,GAAQ8D,QAAQ2H,MAAO0P,EAAQvwC,YAEhD,QAAkB/C,IAAbuzC,EAGJ,YADA5mC,QAAQwE,KAAM,+CAAgDuvB,GAK/D,MAAM0D,EAAO,CAEZoP,UAAWD,EAAS3V,SAAW,uBAAkC2V,EAAS3V,UAAa,GACvF/B,GAAI0X,EAASx0C,GACb00C,gBAAiB,CAAE,EAAG,EAAG,GACzBC,gBAAiB,CAAE,EAAG,EAAG,GACzBC,aAAc,CAAE,EAAG,EAAG,IAIvBtb,GAAW8L,UAAU,SAAWzD,GAE1BA,EAAM7E,KAAO0X,EAASx0C,KAE1BqlC,EAAKK,UAAY/D,EAAMnoB,OAElBmoB,EAAM2D,SAASC,gBAAgBF,EAAK4D,WAAatH,EAAM2D,SAASC,cAAc0D,gBAM9E5D,EAAKK,YAAYL,EAAKK,UAAY,IAAI,OAIxC,gBAAiB8O,IAAWnP,EAAKiE,YAAckL,EAASjL,YAAY5mC,OACpE,iBAAkB6xC,IAAWnP,EAAKqE,aAAe8K,EAAS7K,aAAahnC,OAE5E2xC,EAAiBr4B,GAAMopB,GAMpBiP,EAAiBr4B,KAAMq4B,EAAiBr4B,GAAKy3B,EAAUjN,MAASiN,QAE/D,QAAgCzyC,IAA3ByyC,EAAUC,OAAOkB,MAAsB,CAElD,QAA8B5zC,IAAzBqzC,EAAiBr4B,GAAoB,CAEzC,MAAM64B,EAAazb,GAAY0D,IAAK4E,EAAM7E,IAAKF,QAAQ6H,QAAQ,SAAWzlC,GAEzE,YAA+BiC,IAAxBjC,EAAO09B,gBAEV,GAAII,GAEHiY,EAAY1b,GAAY0D,IAAK+X,GAAalY,QAAS,GAAIE,GACvD0H,EAAQnL,GAAY0D,IAAKgY,GAAYnY,QAAS,GAAIE,GAGlDyX,EAAUlb,GAAY0D,IAAKyH,GAAQ5H,QAAS,GAAIE,GAEhD0X,EAAWpb,GAAQ8D,QAAQ2H,MAAO0P,GAElClP,EAAO,CAEZoP,UAAWD,EAAS3V,SAAW,uBAAkC2V,EAAS3V,UAAa,GACvFmW,UAAW5b,GAAQ8D,QAAQ0F,SAAUkS,GAAajW,UAInDyV,EAAiBr4B,GAAMopB,EAIxBiP,EAAiBr4B,GAAKy3B,EAAUjN,MAASiN,OAQ5CN,EAAUv8B,IAAK9S,SAAUs5B,GAAUiX,IAMrC,OAAOlB,EAMRE,gBAAiBF,GAEhB,MAAM6B,EAAY7b,GAAQ8D,QAAQgY,eAG5BxC,EAAW,GAEjB,IAAM,MAAMrV,KAAU4X,EAAY,CAEjC,MAAM70C,EAAWi5B,GAAY0D,IAAKh5B,SAAUs5B,IAAWj9B,SAElDA,EAASkK,OAAS,GAItBsD,QAAQwE,KAAM,sIAIf,MAAM+iC,EAAQ/B,EAAUrW,IAAK38B,EAAU,GAAI08B,IAE3C4V,EAAUrV,GAAW,CAEpB38B,KAAMu0C,EAAW5X,GAASwB,SAC1BsW,MAAOA,GAMT,OAAOzC,EAIRK,QAASF,GAER,IAAIuC,EAAS,GAEb,MAAMrlC,EAAQ1Q,KAOd,OANAwzC,EAAQsC,MAAMjpC,SAAS,SAAWmpC,GAEjCD,EAASA,EAAOtmC,OAAQiB,EAAMulC,eAAgBD,OAIxC,IAAI,MAAexC,EAAQnyC,MAAQ,EAAG00C,GAI9CE,eAAgBD,GAEf,MAAMD,EAAS,GAEf,IAAIV,EAAkB,IAAI,MACtBC,EAAkB,IAAI,MACtBC,EAAe,IAAI,MAQvB,GANKS,EAAU3P,WAAY2P,EAAU3P,UAAU6P,UAAWb,EAAiBC,EAAiBC,GAE5FF,EAAkBA,EAAgBc,UAClCb,GAAkB,IAAI,OAAQc,kBAAmBd,EAAiBU,EAAUpM,YAAauM,UACzFZ,EAAeA,EAAaY,eAEPv0C,IAAhBo0C,EAAUK,GAAmBvwC,OAAO8G,KAAMopC,EAAUK,EAAE/B,QAASrpC,OAAS,EAAI,CAEhF,MAAMqrC,EAAgBt2C,KAAKu2C,oBAAqBP,EAAUZ,UAAWY,EAAUK,EAAE/B,OAAQe,EAAiB,iBACnFzzC,IAAlB00C,GAA8BP,EAAO/0C,KAAMs1C,GAIjD,QAAqB10C,IAAhBo0C,EAAUQ,GAAmB1wC,OAAO8G,KAAMopC,EAAUQ,EAAElC,QAASrpC,OAAS,EAAI,CAEhF,MAAMwrC,EAAgBz2C,KAAK02C,sBAAuBV,EAAUZ,UAAWY,EAAUQ,EAAElC,OAAQgB,EAAiBU,EAAU/L,YAAa+L,EAAU3L,aAAc2L,EAAUpM,iBAC9IhoC,IAAlB60C,GAA8BV,EAAO/0C,KAAMy1C,GAIjD,QAAqB70C,IAAhBo0C,EAAUW,GAAmB7wC,OAAO8G,KAAMopC,EAAUW,EAAErC,QAASrpC,OAAS,EAAI,CAEhF,MAAM2rC,EAAa52C,KAAKu2C,oBAAqBP,EAAUZ,UAAWY,EAAUW,EAAErC,OAAQiB,EAAc,cAChF3zC,IAAfg1C,GAA2Bb,EAAO/0C,KAAM41C,GAI9C,QAAiCh1C,IAA5Bo0C,EAAUhR,cAA8B,CAE5C,MAAM6R,EAAa72C,KAAK82C,mBAAoBd,QACxBp0C,IAAfi1C,GAA2Bd,EAAO/0C,KAAM61C,GAI9C,OAAOd,EAIRQ,oBAAqBnB,EAAWd,EAAQp0C,EAAcyR,GAErD,MAAM8iC,EAAQz0C,KAAK+2C,mBAAoBzC,GACjC5nC,EAAS1M,KAAKg3C,uBAAwBvC,EAAOH,EAAQp0C,GAE3D,OAAO,IAAI,MAAqBk1C,EAAY,IAAMzjC,EAAM8iC,EAAO/nC,GAIhEgqC,sBAAuBtB,EAAWd,EAAQp0C,EAAc+pC,EAAaI,EAAcT,QAEhEhoC,IAAb0yC,EAAOjiC,IAEXrS,KAAKi3C,qBAAsB3C,EAAOjiC,GAClCiiC,EAAOjiC,EAAE3F,OAAS4nC,EAAOjiC,EAAE3F,OAAOg2B,IAAK,sBAItB9gC,IAAb0yC,EAAOhiC,IAEXtS,KAAKi3C,qBAAsB3C,EAAOhiC,GAClCgiC,EAAOhiC,EAAE5F,OAAS4nC,EAAOhiC,EAAE5F,OAAOg2B,IAAK,sBAItB9gC,IAAb0yC,EAAOzjB,IAEX7wB,KAAKi3C,qBAAsB3C,EAAOzjB,GAClCyjB,EAAOzjB,EAAEnkB,OAAS4nC,EAAOzjB,EAAEnkB,OAAOg2B,IAAK,iBAIxC,MAAM+R,EAAQz0C,KAAK+2C,mBAAoBzC,GACjC5nC,EAAS1M,KAAKg3C,uBAAwBvC,EAAOH,EAAQp0C,QAEtC0B,IAAhBqoC,KAEJA,EAAcA,EAAYvH,IAAK,iBACnB1hC,KAAM4oC,GAElBK,GAAc,IAAI,OAAQ9I,UAAW8I,GACrCA,GAAc,IAAI,OAAaiN,aAAcjN,SAIxBroC,IAAjByoC,KAEJA,EAAeA,EAAa3H,IAAK,iBACpB1hC,KAAM4oC,GAEnBS,GAAe,IAAI,OAAQlJ,UAAWkJ,GACtCA,GAAe,IAAI,OAAa6M,aAAc7M,GAAej4B,UAI9D,MAAMyF,EAAa,IAAI,MACjBs/B,EAAQ,IAAI,MAEZC,EAAmB,GAEzB,IAAM,IAAIx6B,EAAI,EAAGA,EAAIlQ,EAAOzB,OAAQ2R,GAAK,EAExCu6B,EAAM3/B,IAAK9K,EAAQkQ,GAAKlQ,EAAQkQ,EAAI,GAAKlQ,EAAQkQ,EAAI,GAAKgtB,GAE1D/xB,EAAWq/B,aAAcC,QAEJv1C,IAAhBqoC,GAA4BpyB,EAAWw/B,YAAapN,QACnCroC,IAAjByoC,GAA6BxyB,EAAWy/B,SAAUjN,GAEvDxyB,EAAWs+B,QAASiB,EAAoBx6B,EAAI,EAAM,GAInD,OAAO,IAAI,MAAyBw4B,EAAY,cAAeX,EAAO2C,GAIvEN,mBAAoBd,GAEnB,MAAM1B,EAAS0B,EAAUhR,cAAcsP,OAAOkB,MACxC9oC,EAAS4nC,EAAO5nC,OAAOg2B,KAAK,SAAWrT,GAE5C,OAAOA,EAAM,OAIRkoB,EAAWtd,GAAWud,gBAAiBxB,EAAUZ,WAAYqC,sBAAuBzB,EAAUL,WAEpG,OAAO,IAAI,MAAqBK,EAAUZ,UAAY,0BAA4BmC,EAAW,IAAKjD,EAAOG,MAAO/nC,GAMjHqqC,mBAAoBzC,GAEnB,IAAIG,EAAQ,GAeZ,QAZkB7yC,IAAb0yC,EAAOjiC,IAAkBoiC,EAAQA,EAAMhlC,OAAQ6kC,EAAOjiC,EAAEoiC,aAC3C7yC,IAAb0yC,EAAOhiC,IAAkBmiC,EAAQA,EAAMhlC,OAAQ6kC,EAAOhiC,EAAEmiC,aAC3C7yC,IAAb0yC,EAAOzjB,IAAkB4jB,EAAQA,EAAMhlC,OAAQ6kC,EAAOzjB,EAAE4jB,QAG7DA,EAAQA,EAAM1xB,MAAM,SAAW7Y,EAAGtE,GAEjC,OAAOsE,EAAItE,KAKP6uC,EAAMxpC,OAAS,EAAI,CAEvB,IAAIysC,EAAc,EACdC,EAAYlD,EAAO,GACvB,IAAM,IAAI73B,EAAI,EAAGA,EAAI63B,EAAMxpC,OAAQ2R,IAAO,CAEzC,MAAMg7B,EAAenD,EAAO73B,GACvBg7B,IAAiBD,IAErBlD,EAAOiD,GAAgBE,EACvBD,EAAYC,EACZF,KAMFjD,EAAQA,EAAM5xB,MAAO,EAAG60B,GAIzB,OAAOjD,EAIRuC,uBAAwBvC,EAAOH,EAAQp0C,GAEtC,MAAM23C,EAAY33C,EAEZwM,EAAS,GAEf,IAAIorC,GAAW,EACXC,GAAW,EACXC,GAAW,EAgDf,OA9CAvD,EAAM5nC,SAAS,SAAWorC,GAOzB,GALK3D,EAAOjiC,IAAIylC,EAASxD,EAAOjiC,EAAEoiC,MAAM/wC,QAASu0C,IAC5C3D,EAAOhiC,IAAIylC,EAASzD,EAAOhiC,EAAEmiC,MAAM/wC,QAASu0C,IAC5C3D,EAAOzjB,IAAImnB,EAAS1D,EAAOzjB,EAAE4jB,MAAM/wC,QAASu0C,KAG/B,IAAbH,EAAiB,CAErB,MAAMI,EAAS5D,EAAOjiC,EAAE3F,OAAQorC,GAChCprC,EAAO1L,KAAMk3C,GACbL,EAAW,GAAMK,OAKjBxrC,EAAO1L,KAAM62C,EAAW,IAIzB,IAAkB,IAAbE,EAAiB,CAErB,MAAMI,EAAS7D,EAAOhiC,EAAE5F,OAAQqrC,GAChCrrC,EAAO1L,KAAMm3C,GACbN,EAAW,GAAMM,OAIjBzrC,EAAO1L,KAAM62C,EAAW,IAIzB,IAAkB,IAAbG,EAAiB,CAErB,MAAMI,EAAS9D,EAAOzjB,EAAEnkB,OAAQsrC,GAChCtrC,EAAO1L,KAAMo3C,GACbP,EAAW,GAAMO,OAIjB1rC,EAAO1L,KAAM62C,EAAW,OAMnBnrC,EAORuqC,qBAAsBoB,GAErB,IAAM,IAAIz7B,EAAI,EAAGA,EAAIy7B,EAAM3rC,OAAOzB,OAAQ2R,IAAO,CAEhD,MAAM1c,EAAem4C,EAAM3rC,OAAQkQ,EAAI,GACjC07B,EAAaD,EAAM3rC,OAAQkQ,GAAM1c,EAEjCq4C,EAAezwC,KAAKoB,IAAKovC,GAE/B,GAAKC,GAAgB,IAAM,CAE1B,MAAMC,EAAkBD,EAAe,IAEjCx1C,EAAOu1C,EAAaE,EAC1B,IAAIC,EAAYv4C,EAAe6C,EAE/B,MAAM21C,EAAcL,EAAM5D,MAAO73B,EAAI,GAE/B+7B,GADWN,EAAM5D,MAAO73B,GAAM87B,GACRF,EAC5B,IAAII,EAAWF,EAAcC,EAE7B,MAAME,EAAoB,GACpBC,EAAqB,GAE3B,KAAQF,EAAWP,EAAM5D,MAAO73B,IAE/Bi8B,EAAkB73C,KAAM43C,GACxBA,GAAYD,EAEZG,EAAmB93C,KAAMy3C,GACzBA,GAAa11C,EAIds1C,EAAM5D,MAAQsE,GAAQV,EAAM5D,MAAO73B,EAAGi8B,GACtCR,EAAM3rC,OAASqsC,GAAQV,EAAM3rC,OAAQkQ,EAAGk8B,MAW5C,MAAMjd,GAELmd,cAEC,OAAOh5C,KAAKi5C,UAAWj5C,KAAKk5C,cAAgB,GAI7CC,iBAEC,OAAOn5C,KAAKi5C,UAAWj5C,KAAKk5C,cAAgB,GAI7CE,iBAEC,OAAOp5C,KAAKq5C,YAIbC,UAAWtT,GAEVhmC,KAAKi5C,UAAUj4C,KAAMglC,GACrBhmC,KAAKk5C,eAAiB,EAIvBK,WAECv5C,KAAKi5C,UAAUva,MACf1+B,KAAKk5C,eAAiB,EAIvBM,eAAgBnqB,EAAKhuB,GAEpBrB,KAAKq5C,YAAchqB,EACnBrvB,KAAKy5C,gBAAkBp4C,EAIxB25B,MAAOS,GAENz7B,KAAKk5C,cAAgB,EAErBl5C,KAAK05C,SAAW,IAAIC,GACpB35C,KAAKi5C,UAAY,GACjBj5C,KAAKq5C,YAAc,GACnBr5C,KAAKy5C,gBAAkB,GAEvB,MAAM/oC,EAAQ1Q,KAERspB,EAAQmS,EAAKnS,MAAO,WAmC1B,OAjCAA,EAAMzc,SAAS,SAAW+sC,EAAMh9B,GAE/B,MAAMi9B,EAAeD,EAAKp1C,MAAO,aAC3Bs1C,EAAaF,EAAKp1C,MAAO,aAE/B,GAAKq1C,GAAgBC,EAAa,OAElC,MAAMC,EAAiBH,EAAKp1C,MAAO,QAAUkM,EAAMwoC,cAAgB,gBAAiB,IAC9Ec,EAAgBJ,EAAKp1C,MAAO,QAAYkM,EAAoB,cAAI,8BAChEupC,EAAWL,EAAKp1C,MAAO,SAAYkM,EAAMwoC,cAAgB,GAAM,MAEhEa,EAEJrpC,EAAMwpC,eAAgBN,EAAMG,GAEjBC,EAEXtpC,EAAMypC,kBAAmBP,EAAMI,EAAe1wB,IAAU1M,IAE7Cq9B,EAEXvpC,EAAM6oC,WAEKK,EAAKp1C,MAAO,cAIvBkM,EAAM0pC,2BAA4BR,MAM7B55C,KAAK05C,SAIbQ,eAAgBN,EAAM/5C,GAErB,MAAMw6C,EAAWx6C,EAAU,GAAIy6C,OAAOjxB,QAAS,KAAM,IAAKA,QAAS,KAAM,IAEnEkxB,EAAY16C,EAAU,GAAIypB,MAAO,KAAMoZ,KAAK,SAAW0E,GAE5D,OAAOA,EAAKkT,OAAOjxB,QAAS,KAAM,IAAKA,QAAS,KAAM,OAIjD2c,EAAO,CAAE3kC,KAAMg5C,GACfjoB,EAAQpyB,KAAKw6C,cAAeD,GAE5BE,EAAcz6C,KAAKm5C,iBAGG,IAAvBn5C,KAAKk5C,cAETl5C,KAAK05C,SAASl5C,IAAK65C,EAAUrU,GAKxBqU,KAAYI,GAGE,aAAbJ,EAEJI,EAAYjP,SAASxqC,KAAMglC,QAEepkC,IAA/B64C,EAAaJ,GAAW15C,KAEnC85C,EAAaJ,GAAa,GAC1BI,EAAaJ,GAAYI,EAAaJ,GAAW15C,IAAO85C,EAAaJ,IAIpD,KAAbjoB,EAAMzxB,KAAY85C,EAAaJ,GAAYjoB,EAAMzxB,IAAOqlC,IAE9B,kBAAb5T,EAAMzxB,IAExB85C,EAAaJ,GAAa,GAC1BI,EAAaJ,GAAYjoB,EAAMzxB,IAAOqlC,GAEd,iBAAbqU,IAEoBI,EAAaJ,GAA1B,aAAbA,EAAoD,CAAErU,GAC5BA,GAMR,kBAAb5T,EAAMzxB,KAAkBqlC,EAAKrlC,GAAKyxB,EAAMzxB,IAChC,KAAfyxB,EAAM/wB,OAAc2kC,EAAKxG,SAAWpN,EAAM/wB,MAC3B,KAAf+wB,EAAMzgB,OAAcq0B,EAAKtC,SAAWtR,EAAMzgB,MAE/C3R,KAAKs5C,UAAWtT,GAIjBwU,cAAepoB,GAEd,IAAIzxB,EAAKyxB,EAAO,GAEI,KAAfA,EAAO,KAEXzxB,EAAK+D,SAAU0tB,EAAO,IAEjB/pB,MAAO1H,KAEXA,EAAKyxB,EAAO,KAMd,IAAI/wB,EAAO,GAAIsQ,EAAO,GAStB,OAPKygB,EAAMnnB,OAAS,IAEnB5J,EAAO+wB,EAAO,GAAI/I,QAAS,WAAY,IACvC1X,EAAOygB,EAAO,IAIR,CAAEzxB,GAAIA,EAAIU,KAAMA,EAAMsQ,KAAMA,GAIpCwoC,kBAAmBP,EAAM/5C,EAAU66C,GAElC,IAAIC,EAAW96C,EAAU,GAAIwpB,QAAS,KAAM,IAAKA,QAAS,KAAM,IAAKixB,OACjEM,EAAY/6C,EAAU,GAAIwpB,QAAS,KAAM,IAAKA,QAAS,KAAM,IAAKixB,OAKpD,YAAbK,GAAwC,MAAdC,IAE9BA,EAAYF,EAAYrxB,QAAS,KAAM,IAAKA,QAAS,KAAM,IAAKixB,QAIjE,MAAMG,EAAcz6C,KAAKm5C,iBAGzB,GAAoB,iBAFDsB,EAAYp5C,KAE/B,CAQA,GAAkB,MAAbs5C,EAAmB,CAEvB,MAAME,EAAYD,EAAUtxB,MAAO,KAAMzG,MAAO,GAC1CrT,EAAO9K,SAAUm2C,EAAW,IAC5BC,EAAKp2C,SAAUm2C,EAAW,IAEhC,IAAIE,EAAOH,EAAUtxB,MAAO,KAAMzG,MAAO,GAEzCk4B,EAAOA,EAAKrY,KAAK,SAAWsY,GAE3B,OAAOA,EAAKV,OAAOjxB,QAAS,KAAM,OAInCsxB,EAAW,cACXC,EAAY,CAAEprC,EAAMsrC,GAo8BvB,SAAiB5wC,EAAGtE,GAEnB,IAAM,IAAIgX,EAAI,EAAGyB,EAAInU,EAAEe,OAAQgU,EAAIrZ,EAAEqF,OAAQ2R,EAAIqC,EAAGrC,IAAMyB,IAEzDnU,EAAGmU,GAAMzY,EAAGgX,GAv8BXq+B,CAAQL,EAAWG,QAEcn5C,IAA5B64C,EAAaE,KAEjBF,EAAaE,GAAa,IAOV,SAAbA,IAAsBF,EAAY95C,GAAKi6C,GAGvCD,KAAYF,GAAep1C,MAAMC,QAASm1C,EAAaE,IAE3DF,EAAaE,GAAW35C,KAAM45C,GAIZ,MAAbD,EAAmBF,EAAaE,GAAaC,EAC7CH,EAAYvwC,EAAI0wC,EAItB56C,KAAKw5C,eAAgBiB,EAAaE,GAGhB,MAAbA,GAA+C,MAA3BC,EAAU/3B,OAAS,KAE3C43B,EAAYvwC,EAAIgxC,GAAkBN,SApDlC56C,KAAKm7C,yBAA0BvB,EAAMe,EAAUC,GA0DjDR,2BAA4BR,GAE3B,MAAMa,EAAcz6C,KAAKm5C,iBAEzBsB,EAAYvwC,GAAK0vC,EAIU,MAAtBA,EAAK/2B,OAAS,KAElB43B,EAAYvwC,EAAIgxC,GAAkBT,EAAYvwC,IAOhDixC,yBAA0BvB,EAAMe,EAAUC,GAMzC,MAAMQ,EAAQR,EAAUtxB,MAAO,MAAOoZ,KAAK,SAAW2Y,GAErD,OAAOA,EAAKf,OAAOjxB,QAAS,MAAO,IAAKA,QAAS,KAAM,QAIlDiyB,EAAgBF,EAAO,GACvBG,EAAiBH,EAAO,GACxBI,EAAiBJ,EAAO,GACxBK,EAAgBL,EAAO,GAC7B,IAAIM,EAAiBN,EAAO,GAG5B,OAASG,GAER,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,YACL,IAAK,SACL,IAAK,SACL,IAAK,cACJG,EAAiBtzC,WAAYszC,GAC7B,MAED,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,kBACL,IAAK,eACL,IAAK,cACJA,EAAiBR,GAAkBQ,GAMrC17C,KAAKg5C,cAAesC,GAAkB,CAErC,KAAQC,EACR,MAASC,EACT,KAAQC,EACR,MAASC,GAIV17C,KAAKw5C,eAAgBx5C,KAAKg5C,cAAesC,IAO3C,MAAM/f,GAELP,MAAOzQ,GAEN,MAAMoxB,EAAS,IAAIC,GAAcrxB,GACjCoxB,EAAOE,KAAM,IAEb,MAAMC,EAAUH,EAAOI,YAEvB,GAAKD,EAAU,KAEd,MAAM,IAAI/sC,MAAO,4DAA8D+sC,GAIhF,MAAMpC,EAAW,IAAIC,GAErB,MAAU35C,KAAKg8C,aAAcL,IAAW,CAEvC,MAAM3V,EAAOhmC,KAAKi8C,UAAWN,EAAQG,GACvB,OAAT9V,GAAgB0T,EAASl5C,IAAKwlC,EAAK3kC,KAAM2kC,GAI/C,OAAO0T,EAKRsC,aAAcL,GAUb,OAAKA,EAAOjwB,OAAS,KAAO,GAEhBiwB,EAAOO,YAAc,IAAM,IAAO,KAAWP,EAAOjwB,OAIxDiwB,EAAOO,YAAc,IAAM,IAAMP,EAAOjwB,OAOjDuwB,UAAWN,EAAQG,GAElB,MAAM9V,EAAO,GAGPmW,EAAcL,GAAW,KAASH,EAAOS,YAAcT,EAAOI,YAC9DM,EAAkBP,GAAW,KAASH,EAAOS,YAAcT,EAAOI,YAEtED,GAAW,KAASH,EAAOS,YAAcT,EAAOI,YAElD,MAAMO,EAAUX,EAAOY,WACjBl7C,EAAOs6C,EAAOa,UAAWF,GAG/B,GAAmB,IAAdH,EAAkB,OAAO,KAE9B,MAAMM,EAAe,GAErB,IAAM,IAAI7/B,EAAI,EAAGA,EAAIy/B,EAAez/B,IAEnC6/B,EAAaz7C,KAAMhB,KAAK08C,cAAef,IAKxC,MAAMh7C,EAAK87C,EAAaxxC,OAAS,EAAIwxC,EAAc,GAAM,GACnDjd,EAAWid,EAAaxxC,OAAS,EAAIwxC,EAAc,GAAM,GACzD/Y,EAAW+Y,EAAaxxC,OAAS,EAAIwxC,EAAc,GAAM,GAM/D,IAFAzW,EAAK2W,eAAqC,IAAlBN,GAAuBV,EAAOO,cAAgBC,EAE9DA,EAAYR,EAAOO,aAAc,CAExC,MAAMU,EAAU58C,KAAKi8C,UAAWN,EAAQG,GAEvB,OAAZc,GAAmB58C,KAAK68C,aAAcx7C,EAAM2kC,EAAM4W,GAWxD,OAPA5W,EAAKyW,aAAeA,EAED,kBAAP97C,IAAkBqlC,EAAKrlC,GAAKA,GACtB,KAAb6+B,IAAkBwG,EAAKxG,SAAWA,GACrB,KAAbkE,IAAkBsC,EAAKtC,SAAWA,GACzB,KAATriC,IAAc2kC,EAAK3kC,KAAOA,GAExB2kC,EAIR6W,aAAcx7C,EAAM2kC,EAAM4W,GAGzB,IAAgC,IAA3BA,EAAQD,eAA0B,CAEtC,MAAMr5C,EAAQs5C,EAAQH,aAAc,GAE/Bp3C,MAAMC,QAAShC,IAEnB0iC,EAAM4W,EAAQv7C,MAASu7C,EAEvBA,EAAQ1yC,EAAI5G,GAIZ0iC,EAAM4W,EAAQv7C,MAASiC,OAIlB,GAAc,gBAATjC,GAA2C,MAAjBu7C,EAAQv7C,KAAe,CAE5D,MAAM29B,EAAQ,GAEd4d,EAAQH,aAAa5vC,SAAS,SAAWhN,EAAU+c,GAGvC,IAANA,GAAUoiB,EAAMh+B,KAAMnB,WAIF+B,IAArBokC,EAAKhM,cAETgM,EAAKhM,YAAc,IAIpBgM,EAAKhM,YAAYh5B,KAAMg+B,QAEjB,GAAsB,iBAAjB4d,EAAQv7C,KAA0B,CAEhCyE,OAAO8G,KAAMgwC,GAErB/vC,SAAS,SAAW0mC,GAExBvN,EAAMuN,GAAQqJ,EAASrJ,WAIlB,GAAc,iBAATlyC,GAA4C,MAAjBu7C,EAAQv7C,KAAe,CAE7D,IAAIi6C,EAAgBsB,EAAQH,aAAc,GACtClB,EAAiBqB,EAAQH,aAAc,GAC3C,MAAMjB,EAAiBoB,EAAQH,aAAc,GACvChB,EAAgBmB,EAAQH,aAAc,GAC5C,IAAIf,EAEqC,IAApCJ,EAAc53C,QAAS,UAAiB43C,EAAgBA,EAAcjyB,QAAS,OAAQ,SAClD,IAArCkyB,EAAe73C,QAAS,UAAiB63C,EAAiBA,EAAelyB,QAAS,OAAQ,SAI9FqyB,EAFuB,UAAnBH,GAAiD,aAAnBA,GAAoD,WAAnBA,GAAkD,aAAnBA,GAAsE,IAArCA,EAAe73C,QAAS,QAE1I,CAChBk5C,EAAQH,aAAc,GACtBG,EAAQH,aAAc,GACtBG,EAAQH,aAAc,IAKNG,EAAQH,aAAc,GAKxCzW,EAAMsV,GAAkB,CAEvB,KAAQC,EACR,MAASC,EACT,KAAQC,EACR,MAASC,aAI0B95C,IAAzBokC,EAAM4W,EAAQv7C,MAEE,kBAAfu7C,EAAQj8C,IAEnBqlC,EAAM4W,EAAQv7C,MAAS,GACvB2kC,EAAM4W,EAAQv7C,MAAQu7C,EAAQj8C,IAAOi8C,GAIrC5W,EAAM4W,EAAQv7C,MAASu7C,EAMF,aAAjBA,EAAQv7C,MAELgE,MAAMC,QAAS0gC,EAAM4W,EAAQv7C,SAEnC2kC,EAAM4W,EAAQv7C,MAAS,CAAE2kC,EAAM4W,EAAQv7C,QAIxC2kC,EAAM4W,EAAQv7C,MAAOL,KAAM47C,SAEuBh7C,IAAvCokC,EAAM4W,EAAQv7C,MAAQu7C,EAAQj8C,MAEzCqlC,EAAM4W,EAAQv7C,MAAQu7C,EAAQj8C,IAAOi8C,GAQxCF,cAAef,GAEd,MAAMhqC,EAAOgqC,EAAOa,UAAW,GAC/B,IAAIvxC,EAEJ,OAAS0G,GAER,IAAK,IACJ,OAAOgqC,EAAOmB,aAEf,IAAK,IACJ,OAAOnB,EAAOoB,aAEf,IAAK,IACJ,OAAOpB,EAAOqB,aAEf,IAAK,IACJ,OAAOrB,EAAOsB,WAEf,IAAK,IACJ,OAAOtB,EAAOuB,WAEf,IAAK,IAEJ,OADAjyC,EAAS0wC,EAAOI,YACTJ,EAAOwB,eAAgBlyC,GAE/B,IAAK,IAEJ,OADAA,EAAS0wC,EAAOI,YACTJ,EAAOa,UAAWvxC,GAE1B,IAAK,IACJ,OAAO0wC,EAAOyB,WAEf,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IAEJ,MAAMC,EAAc1B,EAAOI,YACrBpZ,EAAWgZ,EAAOI,YAClBuB,EAAmB3B,EAAOI,YAEhC,GAAkB,IAAbpZ,EAEJ,OAAShxB,GAER,IAAK,IACL,IAAK,IACJ,OAAOgqC,EAAO4B,gBAAiBF,GAEhC,IAAK,IACJ,OAAO1B,EAAO6B,gBAAiBH,GAEhC,IAAK,IACJ,OAAO1B,EAAO8B,gBAAiBJ,GAEhC,IAAK,IACJ,OAAO1B,EAAO+B,cAAeL,GAE9B,IAAK,IACJ,OAAO1B,EAAOgC,cAAeN,GAMT,qBAAX,GAEX9uC,QAAQC,MAAO,6DAIhB,MAAM4b,EAAO,GAAmB,IAAI1M,WAAYi+B,EAAOwB,eAAgBG,KACjEM,EAAU,IAAIhC,GAAcxxB,EAAKG,QAEvC,OAAS5Y,GAER,IAAK,IACL,IAAK,IACJ,OAAOisC,EAAQL,gBAAiBF,GAEjC,IAAK,IACJ,OAAOO,EAAQJ,gBAAiBH,GAEjC,IAAK,IACJ,OAAOO,EAAQH,gBAAiBJ,GAEjC,IAAK,IACJ,OAAOO,EAAQF,cAAeL,GAE/B,IAAK,IACJ,OAAOO,EAAQD,cAAeN,GAIjC,QACC,MAAM,IAAItuC,MAAO,0CAA4C4C,KAQjE,MAAMiqC,GAELl8C,YAAa6qB,EAAQszB,GAEpB79C,KAAK89C,GAAK,IAAIC,SAAUxzB,GACxBvqB,KAAKmW,OAAS,EACdnW,KAAK69C,kBAAkCj8C,IAAjBi8C,GAA+BA,EAItD3B,YAEC,OAAOl8C,KAAKmW,OAIbuV,OAEC,OAAO1rB,KAAK89C,GAAGvzB,OAAO6Q,WAIvBygB,KAAM5wC,GAELjL,KAAKmW,QAAUlL,EAOhB6xC,aAEC,OAAmC,KAAR,EAAlB98C,KAAKu8C,YAIfgB,gBAAiB7xB,GAEhB,MAAMxhB,EAAI,GAEV,IAAM,IAAI0S,EAAI,EAAGA,EAAI8O,EAAM9O,IAE1B1S,EAAElJ,KAAMhB,KAAK88C,cAId,OAAO5yC,EAIRqyC,WAEC,MAAMj5C,EAAQtD,KAAK89C,GAAGvB,SAAUv8C,KAAKmW,QAErC,OADAnW,KAAKmW,QAAU,EACR7S,EAIR85C,WAEC,MAAM95C,EAAQtD,KAAK89C,GAAGV,SAAUp9C,KAAKmW,OAAQnW,KAAK69C,cAElD,OADA79C,KAAKmW,QAAU,EACR7S,EAIR25C,WAEC,MAAM35C,EAAQtD,KAAK89C,GAAGb,SAAUj9C,KAAKmW,OAAQnW,KAAK69C,cAElD,OADA79C,KAAKmW,QAAU,EACR7S,EAIRo6C,cAAehyB,GAEd,MAAMxhB,EAAI,GAEV,IAAM,IAAI0S,EAAI,EAAGA,EAAI8O,EAAM9O,IAE1B1S,EAAElJ,KAAMhB,KAAKi9C,YAId,OAAO/yC,EAIR6xC,YAEC,MAAMz4C,EAAQtD,KAAK89C,GAAG/B,UAAW/7C,KAAKmW,OAAQnW,KAAK69C,cAEnD,OADA79C,KAAKmW,QAAU,EACR7S,EASR45C,WAEC,IAAIrmB,EAAKC,EAeT,OAbK92B,KAAK69C,cAEThnB,EAAM72B,KAAK+7C,YACXjlB,EAAO92B,KAAK+7C,cAIZjlB,EAAO92B,KAAK+7C,YACZllB,EAAM72B,KAAK+7C,aAKA,WAAPjlB,GAEJA,EAAgB,YAAPA,EACTD,EAAc,YAANA,EAEK,aAARA,IAAqBC,EAASA,EAAO,EAAM,YAEhDD,EAAQA,EAAM,EAAM,aAEF,WAAPC,EAAqBD,IAInB,WAAPC,EAAqBD,EAI7B8mB,cAAejyB,GAEd,MAAMxhB,EAAI,GAEV,IAAM,IAAI0S,EAAI,EAAGA,EAAI8O,EAAM9O,IAE1B1S,EAAElJ,KAAMhB,KAAKk9C,YAId,OAAOhzC,EAKRkyC,YAEC,IAAIvlB,EAAKC,EAcT,OAZK92B,KAAK69C,cAEThnB,EAAM72B,KAAK+7C,YACXjlB,EAAO92B,KAAK+7C,cAIZjlB,EAAO92B,KAAK+7C,YACZllB,EAAM72B,KAAK+7C,aAIE,WAAPjlB,EAAqBD,EAI7BmmB,aAEC,MAAM15C,EAAQtD,KAAK89C,GAAGd,WAAYh9C,KAAKmW,OAAQnW,KAAK69C,cAEpD,OADA79C,KAAKmW,QAAU,EACR7S,EAIRm6C,gBAAiB/xB,GAEhB,MAAMxhB,EAAI,GAEV,IAAM,IAAI0S,EAAI,EAAGA,EAAI8O,EAAM9O,IAE1B1S,EAAElJ,KAAMhB,KAAKg9C,cAId,OAAO9yC,EAIR6yC,aAEC,MAAMz5C,EAAQtD,KAAK89C,GAAGf,WAAY/8C,KAAKmW,OAAQnW,KAAK69C,cAEpD,OADA79C,KAAKmW,QAAU,EACR7S,EAIRk6C,gBAAiB9xB,GAEhB,MAAMxhB,EAAI,GAEV,IAAM,IAAI0S,EAAI,EAAGA,EAAI8O,EAAM9O,IAE1B1S,EAAElJ,KAAMhB,KAAK+8C,cAId,OAAO7yC,EAIRizC,eAAgBzxB,GAEf,MAAMpoB,EAAQtD,KAAK89C,GAAGvzB,OAAO1H,MAAO7iB,KAAKmW,OAAQnW,KAAKmW,OAASuV,GAE/D,OADA1rB,KAAKmW,QAAUuV,EACRpoB,EAIRk5C,UAAW9wB,GAGV,IAAIxhB,EAAI,GAER,IAAM,IAAI0S,EAAI,EAAGA,EAAI8O,EAAM9O,IAE1B1S,EAAG0S,GAAM5c,KAAKu8C,WAIf,MAAMyB,EAAW9zC,EAAExG,QAAS,GAG5B,OAFKs6C,GAAY,IAAI9zC,EAAIA,EAAE2Y,MAAO,EAAGm7B,IAE9B,iBAAwB,IAAItgC,WAAYxT,KAQjD,MAAMyvC,GAELn5C,IAAK+yC,EAAKlkB,GAETrvB,KAAMuzC,GAAQlkB,GA8ChB,SAASuM,GAAeH,GAEvB,MACMj3B,EAAQi3B,EAAKj3B,MADG,qBAGtB,GAAKA,EAAQ,CAGZ,OADgBE,SAAUF,EAAO,IAKlC,MAAM,IAAIuK,MAAO,uEAKlB,SAAS4lC,GAAyBsD,GAEjC,OAAOA,EAAO,WAIf,MAAMgG,GAAY,GAGlB,SAAShO,GAASH,EAAoBV,EAAcS,EAAaqO,GAEhE,IAAIjxC,EAEJ,OAASixC,EAAWzQ,aAEnB,IAAK,kBACJxgC,EAAQ6iC,EACR,MACD,IAAK,YACJ7iC,EAAQmiC,EACR,MACD,IAAK,YACJniC,EAAQ4iC,EACR,MACD,IAAK,UACJ5iC,EAAQixC,EAAW7Z,QAAS,GAC5B,MACD,QACC91B,QAAQwE,KAAM,mDAAqDmrC,EAAWzQ,aAI9C,kBAA7ByQ,EAAWvM,gBAAoC1kC,EAAQixC,EAAW7Z,QAASp3B,IAEhF,MAAMuC,EAAOvC,EAAQixC,EAAWjM,SAC1B6I,EAAKtrC,EAAO0uC,EAAWjM,SAE7B,OAwLD,SAAgB/nC,EAAGtE,EAAG4J,EAAMsrC,GAE3B,IAAM,IAAIl+B,EAAIpN,EAAM6O,EAAI,EAAGzB,EAAIk+B,EAAIl+B,IAAMyB,IAExCnU,EAAGmU,GAAMzY,EAAGgX,GAIb,OAAO1S,EAhMA2Y,CAAOo7B,GAAWC,EAAW3zB,OAAQ/a,EAAMsrC,GAInD,MAAMqD,GAAY,IAAI,MAChBC,GAAU,IAAI,MAKpB,SAAS9X,GAAmBJ,GAE3B,MAAMmY,EAAgB,IAAI,MACpBC,EAAgB,IAAI,MACpBC,EAAa,IAAI,MACjBC,EAAiB,IAAI,MAErBC,EAAY,IAAI,MAChBC,EAAiB,IAAI,MACrBC,EAAkB,IAAI,MACtBC,EAAmB,IAAI,MACvBC,EAAkB,IAAI,MAEtBC,EAAY,IAAI,MAChBC,EAAY,IAAI,MAChBC,EAAW,IAAI,MAEftV,EAAgBxD,EAA0B,YAAIA,EAAcwD,YAAc,EAIhF,GAFKxD,EAAc6D,aAAcsU,EAAcY,YAAab,GAAQjd,UAAW+E,EAAc6D,cAExF7D,EAAc+D,YAAc,CAEhC,MAAMjL,EAAQkH,EAAc+D,YAAYvH,IAAK,gBAC7C1D,EAAMh+B,KAAMklC,EAAc0D,YAC1B0U,EAAcY,sBAAuBf,GAAUhd,UAAWnC,IAI3D,GAAKkH,EAAciE,SAAW,CAE7B,MAAMnL,EAAQkH,EAAciE,SAASzH,IAAK,gBAC1C1D,EAAMh+B,KAAMklC,EAAc0D,YAC1B2U,EAAWW,sBAAuBf,GAAUhd,UAAWnC,IAIxD,GAAKkH,EAAcmE,aAAe,CAEjC,MAAMrL,EAAQkH,EAAcmE,aAAa3H,IAAK,gBAC9C1D,EAAMh+B,KAAMklC,EAAc0D,YAC1B4U,EAAeU,sBAAuBf,GAAUhd,UAAWnC,IAC3Dwf,EAAepsC,SAIX8zB,EAAchvB,OAAQunC,EAAUvnC,MAAOknC,GAAQjd,UAAW+E,EAAchvB,QAGxEgvB,EAAcsE,eAAgBmU,EAAgBM,YAAab,GAAQjd,UAAW+E,EAAcsE,gBAC5FtE,EAAcwE,cAAegU,EAAeO,YAAab,GAAQjd,UAAW+E,EAAcwE,eAC1FxE,EAAc0E,gBAAiBgU,EAAiBK,YAAab,GAAQjd,UAAW+E,EAAc0E,iBAC9F1E,EAAc4E,eAAgB+T,EAAgBI,YAAab,GAAQjd,UAAW+E,EAAc4E,gBAG5F5E,EAAcE,oBAElB2Y,EAAUxtC,KAAM20B,EAAcC,cAC9B2Y,EAAUvtC,KAAM20B,EAAcE,oBAI/B,MAAM+Y,EAAOb,EAAcvpC,QAAQuiC,SAAUiH,GAAajH,SAAUkH,GAE9DY,EAAa,IAAI,MACvBA,EAAWC,gBAAiBP,GAG5B,MAAMQ,EAAY,IAAI,MACtBA,EAAUC,aAAcT,GAExB,MAAMU,EAAcF,EAAUvqC,QAAQ3C,SAASklC,SAAUwH,GACnDW,EAAaL,EAAWrqC,QAAQ3C,SAASklC,SAAUkI,GACnDE,EAAOjB,EAEPkB,EAAY,IAAI,MAEtB,GAAqB,IAAhBjW,EAEJiW,EAAUpuC,KAAM6tC,GAAa9H,SAAU6H,GAAO7H,SAAUmI,GAAanI,SAAUoI,QAEzE,GAAqB,IAAhBhW,EAEXiW,EAAUpuC,KAAM6tC,GAAa9H,SAAUmI,GAAanI,SAAU6H,GAAO7H,SAAUoI,OAEzE,CAEN,MACME,GADa,IAAI,OAAU1oC,OAAO,IAAI,OAAU2oC,mBAAoBd,IACxChqC,QAAQ3C,SACpC0tC,EAAqBL,EAAW1qC,QAAQuiC,SAAUsI,GAExDD,EAAUpuC,KAAM6tC,GAAa9H,SAAU6H,GAAO7H,SAAUwI,GAAqBxI,SAAUoI,GAIxF,MAAMK,EAAsBlB,EAAgB9pC,QAAQ3C,SAC9C4tC,EAAqBtB,EAAe3pC,QAAQ3C,SAElD,IAAI6tC,EAAa5B,EAActpC,QAAQuiC,SAAUsH,GAAmBtH,SAAUuH,GAAkBvH,SAAUgH,GAAgBhH,SAAUiH,GAAajH,SAAUkH,GAAiBlH,SAAUyI,GAAsBzI,SAAUqH,GAAkBrH,SAAUoH,GAAiBpH,SAAUmH,GAAYnH,SAAU0I,GAEnS,MAAME,GAAmC,IAAI,OAAUX,aAAcU,GAE/DE,EAAqBrB,EAAU/pC,QAAQuiC,SAAU4I,GAQvD,OAPAlB,EAASO,aAAcY,GAEvBF,EAAajB,EAASjqC,QAAQuiC,SAAUqI,GAGxCM,EAAW5I,YAAayH,EAAU1sC,UAE3B6tC,EAMR,SAASpW,GAAe8I,GAIvB,MAAMyN,EAAQ,CACb,MACA,MACA,MACA,MACA,MACA,OAID,OAAe,KAZfzN,EAAQA,GAAS,IAchBpkC,QAAQwE,KAAM,uGACPqtC,EAAO,IAIRA,EAAOzN,GAMf,SAASuI,GAAkB53C,GAQ1B,OANcA,EAAMgmB,MAAO,KAAMoZ,KAAK,SAAWrT,GAEhD,OAAOjnB,WAAYinB,MAQrB,SAASgM,GAA4B9Q,EAAQ/a,EAAMsrC,GAKlD,YAHcl5C,IAAT4N,IAAqBA,EAAO,QACrB5N,IAAPk5C,IAAmBA,EAAKvwB,EAAO6Q,YAE7B,iBAAwB,IAAI1d,WAAY6M,EAAQ/a,EAAMsrC,IA2B9D,SAAS/B,GAAQsH,EAAIpzC,EAAOqzC,GAE3B,OAAOD,EAAGx9B,MAAO,EAAG5V,GAAQwC,OAAQ6wC,GAAK7wC,OAAQ4wC,EAAGx9B,MAAO5V,M,mECj9H5D,MAAMszC,UAAmB,MAExB7gD,YAAay6B,GAEZj2B,MAAOi2B,GAEPn6B,KAAKwgD,YAAc,KACnBxgD,KAAKygD,WAAa,KAClBzgD,KAAK0gD,eAAiB,KAEtB1gD,KAAK2gD,gBAAkB,GAEvB3gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIC,EAAiCD,MAI7C5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIE,EAA4BF,MAIxC5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIG,EAA0BH,MAItC5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAII,EAA6BJ,MAIzC5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIK,EAAoCL,MAIhD5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIM,EAA8BN,MAI1C5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIO,EAA2BP,MAIvC5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIQ,EAAgCR,MAI5C5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIS,EAAqBT,MAIjC5gD,KAAKk2B,UAAU,SAAW0qB,GAEzB,OAAO,IAAIU,EAAwBV,MAMrCr9C,KAAM62B,EAAKC,EAAQC,EAAYC,GAE9B,MAAM7pB,EAAQ1Q,KAEd,IAAI+7B,EAIHA,EAF0B,KAAtB/7B,KAAK+7B,aAEM/7B,KAAK+7B,aAEK,KAAd/7B,KAAKw6B,KAEDx6B,KAAKw6B,KAIL,qBAA4BJ,GAO5Cp6B,KAAKm6B,QAAQonB,UAAWnnB,GAExB,MAAMonB,EAAW,SAAWz9C,GAEtBw2B,EAEJA,EAASx2B,GAITwK,QAAQC,MAAOzK,GAIhB2M,EAAMypB,QAAQc,UAAWb,GACzB1pB,EAAMypB,QAAQsnB,QAASrnB,IAIlBK,EAAS,IAAI,MAAYz6B,KAAKm6B,SAEpCM,EAAOC,QAAS16B,KAAKw6B,MACrBC,EAAOE,gBAAiB,eACxBF,EAAOG,iBAAkB56B,KAAK66B,eAC9BJ,EAAOK,mBAAoB96B,KAAK+6B,iBAEhCN,EAAOl3B,KAAM62B,GAAK,SAAWhQ,GAE5B,IAEC1Z,EAAMsqB,MAAO5Q,EAAM2R,GAAc,SAAW2lB,GAE3CrnB,EAAQqnB,GAERhxC,EAAMypB,QAAQsnB,QAASrnB,KAErBonB,GAEF,MAAQz9C,GAETy9C,EAAUz9C,MAITu2B,EAAYknB,GAIhBG,eAAgBnB,GAGf,OADAxgD,KAAKwgD,YAAcA,EACZxgD,KAIR4hD,eAEC,MAAM,IAAI7yC,MAET,oGAMF8yC,cAAepB,GAGd,OADAzgD,KAAKygD,WAAaA,EACXzgD,KAIR8hD,kBAAmBpB,GAGlB,OADA1gD,KAAK0gD,eAAiBA,EACf1gD,KAIRk2B,SAAUz0B,GAQT,OANoD,IAA/CzB,KAAK2gD,gBAAgBj9C,QAASjC,IAElCzB,KAAK2gD,gBAAgB3/C,KAAMS,GAIrBzB,KAIR+hD,WAAYtgD,GAQX,OANoD,IAA/CzB,KAAK2gD,gBAAgBj9C,QAASjC,IAElCzB,KAAK2gD,gBAAgBl9C,OAAQzD,KAAK2gD,gBAAgBj9C,QAASjC,GAAY,GAIjEzB,KAIRg7B,MAAO5Q,EAAMoQ,EAAMH,EAAQE,GAE1B,IAAIoE,EACJ,MAAMqjB,EAAa,GACbC,EAAU,GAEhB,GAAqB,kBAAT73B,EAEXuU,EAAUvU,MAEJ,CAIN,GAFc,iBAAwB,IAAI1M,WAAY0M,EAAM,EAAG,MAEhD83B,EAAgC,CAE9C,IAECF,EAAYG,EAAWC,iBAAoB,IAAIC,EAAqBj4B,GAEnE,MAAQ5b,GAGT,YADK+rB,GAAUA,EAAS/rB,IAKzBmwB,EAAUqjB,EAAYG,EAAWC,iBAAkBzjB,aAInDA,EAAU,iBAAwB,IAAIjhB,WAAY0M,IAMpD,MAAMk4B,EAAOC,KAAKvnB,MAAO2D,GAEzB,QAAoB/8B,IAAf0gD,EAAKE,OAAuBF,EAAKE,MAAM1G,QAAS,GAAM,EAG1D,YADKvhB,GAAUA,EAAS,IAAIxrB,MAAO,6EAKpC,MAAM6xC,EAAS,IAAI6B,EAAYH,EAAM,CAEpC9nB,KAAMA,GAAQx6B,KAAK+7B,cAAgB,GACnCE,YAAaj8B,KAAKi8B,YAClBpB,cAAe76B,KAAK66B,cACpBV,QAASn6B,KAAKm6B,QACdsmB,WAAYzgD,KAAKygD,WACjBC,eAAgB1gD,KAAK0gD,iBAItBE,EAAO8B,WAAW9nB,iBAAkB56B,KAAK66B,eAEzC,IAAM,IAAIje,EAAI,EAAGA,EAAI5c,KAAK2gD,gBAAgB11C,OAAQ2R,IAAO,CAExD,MAAM+lC,EAAS3iD,KAAK2gD,gBAAiB/jC,GAAKgkC,GAC1CqB,EAASU,EAAOthD,MAASshD,EAMzBX,EAAYW,EAAOthD,OAAS,EAI7B,GAAKihD,EAAKM,eAET,IAAM,IAAIhmC,EAAI,EAAGA,EAAI0lC,EAAKM,eAAe33C,SAAW2R,EAAI,CAEvD,MAAMimC,EAAgBP,EAAKM,eAAgBhmC,GACrCkmC,EAAqBR,EAAKQ,oBAAsB,GAEtD,OAASD,GAER,KAAKV,EAAWY,oBACff,EAAYa,GAAkB,IAAIG,EAClC,MAED,KAAKb,EAAWc,sCACfjB,EAAYa,GAAkB,IAAIK,EAClC,MAED,KAAKf,EAAWgB,2BACfnB,EAAYa,GAAkB,IAAIO,EAAmCd,EAAMtiD,KAAKwgD,aAChF,MAED,KAAK2B,EAAWkB,sBACfrB,EAAYa,GAAkB,IAAIS,EAClC,MAED,KAAKnB,EAAWoB,sBACfvB,EAAYa,GAAkB,IAAIW,EAClC,MAED,QAEMV,EAAmBp/C,QAASm/C,IAAmB,QAAkCjhD,IAA7BqgD,EAASY,IAEjEt0C,QAAQwE,KAAM,wCAA0C8vC,EAAgB,OAU7EjC,EAAO6C,cAAezB,GACtBpB,EAAO8C,WAAYzB,GACnBrB,EAAO5lB,MAAOX,EAAQE,GAIvBopB,WAAYv5B,EAAMoQ,GAEjB,MAAM9pB,EAAQ1Q,KAEd,OAAO,IAAI4jD,SAAS,SAAWC,EAASC,GAEvCpzC,EAAMsqB,MAAO5Q,EAAMoQ,EAAMqpB,EAASC,OAUrC,SAASC,IAER,IAAIC,EAAU,GAEd,MAAO,CAENtmB,IAAK,SAAW6V,GAEf,OAAOyQ,EAASzQ,IAIjB/yC,IAAK,SAAW+yC,EAAK3zC,GAEpBokD,EAASzQ,GAAQ3zC,GAIlBoN,OAAQ,SAAWumC,UAEXyQ,EAASzQ,IAIjB0Q,UAAW,WAEVD,EAAU,KAYb,MAAM7B,EAAa,CAClBC,gBAAiB,kBACjBe,2BAA4B,6BAC5Be,oBAAqB,sBACrBC,wBAAyB,0BACzBC,kBAAmB,oBACnBnB,sCAAuC,sCACvCoB,oBAAqB,sBACrBC,uBAAwB,yBACxBC,2BAA4B,6BAC5BxB,oBAAqB,sBACrByB,qBAAsB,uBACtBC,mBAAoB,qBACpBpB,sBAAuB,wBACvBE,sBAAuB,wBACvBmB,iBAAkB,mBAClBC,wBAAyB,2BAQ1B,MAAMtD,EAEL3hD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAW+B,oBAGvBlkD,KAAK4kD,MAAQ,CAAEC,KAAM,GAAIC,KAAM,IAIhCC,YAEC,MAAMnE,EAAS5gD,KAAK4gD,OACdoE,EAAWhlD,KAAK4gD,OAAO0B,KAAK2C,OAAS,GAE3C,IAAM,IAAIC,EAAY,EAAGC,EAAaH,EAAS/5C,OAAQi6C,EAAYC,EAAYD,IAAe,CAE7F,MAAME,EAAUJ,EAAUE,GAErBE,EAAQpD,YACRoD,EAAQpD,WAAYhiD,KAAKqB,YACiBO,IAA1CwjD,EAAQpD,WAAYhiD,KAAKqB,MAAOgkD,OAEpCzE,EAAO0E,YAAatlD,KAAK4kD,MAAOQ,EAAQpD,WAAYhiD,KAAKqB,MAAOgkD,QAQnEE,WAAYC,GAEX,MAAM5E,EAAS5gD,KAAK4gD,OACd6E,EAAW,SAAWD,EAC5B,IAAIE,EAAa9E,EAAOgE,MAAMlnB,IAAK+nB,GAEnC,GAAKC,EAAa,OAAOA,EAEzB,MAAMpD,EAAO1B,EAAO0B,KAGdqD,IAFerD,EAAKN,YAAcM,EAAKN,WAAYhiD,KAAKqB,OAAY,IAC7CukD,QAAU,IACXJ,GAC5B,IAAIK,EAEJ,MAAM3kB,EAAQ,IAAI,MAAO,eAEDt/B,IAAnB+jD,EAASzkB,OAAsBA,EAAMC,UAAWwkB,EAASzkB,OAE9D,MAAM4kB,OAA2BlkD,IAAnB+jD,EAASG,MAAsBH,EAASG,MAAQ,EAE9D,OAASH,EAASh0C,MAEjB,IAAK,cACJk0C,EAAY,IAAI,MAAkB3kB,GAClC2kB,EAAUtgD,OAAO+L,SAASkG,IAAK,EAAG,GAAK,GACvCquC,EAAUrlD,IAAKqlD,EAAUtgD,QACzB,MAED,IAAK,QACJsgD,EAAY,IAAI,MAAY3kB,GAC5B2kB,EAAUrsC,SAAWssC,EACrB,MAED,IAAK,OACJD,EAAY,IAAI,MAAW3kB,GAC3B2kB,EAAUrsC,SAAWssC,EAErBH,EAASI,KAAOJ,EAASI,MAAQ,GACjCJ,EAASI,KAAKC,oBAAkDpkD,IAAjC+jD,EAASI,KAAKC,eAA+BL,EAASI,KAAKC,eAAiB,EAC3GL,EAASI,KAAKE,oBAAkDrkD,IAAjC+jD,EAASI,KAAKE,eAA+BN,EAASI,KAAKE,eAAiBn+C,KAAKyL,GAAK,EACrHsyC,EAAUxsC,MAAQssC,EAASI,KAAKE,eAChCJ,EAAU/c,SAAW,EAAM6c,EAASI,KAAKC,eAAiBL,EAASI,KAAKE,eACxEJ,EAAUtgD,OAAO+L,SAASkG,IAAK,EAAG,GAAK,GACvCquC,EAAUrlD,IAAKqlD,EAAUtgD,QACzB,MAED,QACC,MAAM,IAAIwJ,MAAO,4CAA8C42C,EAASh0C,MAkB1E,OAZAk0C,EAAUv0C,SAASkG,IAAK,EAAG,EAAG,GAE9BquC,EAAUjd,MAAQ,OAEUhnC,IAAvB+jD,EAASpd,YAA0Bsd,EAAUtd,UAAYod,EAASpd,WAEvEsd,EAAUxkD,KAAOu/C,EAAOsF,iBAAkBP,EAAStkD,MAAU,SAAWmkD,GAExEE,EAAa9B,QAAQC,QAASgC,GAE9BjF,EAAOgE,MAAMpkD,IAAKilD,EAAUC,GAErBA,EAIRS,qBAAsBjB,GAErB,MAAMkB,EAAOpmD,KACP4gD,EAAS5gD,KAAK4gD,OAEdwE,EADOxE,EAAO0B,KACC2C,MAAOC,GAEtBM,GADaJ,EAAQpD,YAAcoD,EAAQpD,WAAYhiD,KAAKqB,OAAY,IAClDgkD,MAE5B,YAAoBzjD,IAAf4jD,EAAkC,KAEhCxlD,KAAKulD,WAAYC,GAAaa,MAAM,SAAWhB,GAErD,OAAOzE,EAAO0F,YAAaF,EAAKxB,MAAOY,EAAYH,OAatD,MAAMrC,EAELtjD,cAECM,KAAKqB,KAAO8gD,EAAWY,oBAIxBwD,kBAEC,OAAO,MAIRC,aAAcC,EAAgBC,EAAa9F,GAE1C,MAAM+F,EAAU,GAEhBF,EAAevlB,MAAQ,IAAI,MAAO,EAAK,EAAK,GAC5CulB,EAAe5kB,QAAU,EAEzB,MAAM+kB,EAAoBF,EAAYG,qBAEtC,GAAKD,EAAoB,CAExB,GAAKvhD,MAAMC,QAASshD,EAAkBE,iBAAoB,CAEzD,MAAM9nB,EAAQ4nB,EAAkBE,gBAEhCL,EAAevlB,MAAMC,UAAWnC,GAChCynB,EAAe5kB,QAAU7C,EAAO,QAIWp9B,IAAvCglD,EAAkBG,kBAEtBJ,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,MAAOG,EAAkBG,mBAM/E,OAAOnD,QAAQqD,IAAKN,IAWtB,MAAM9F,EAELnhD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWgC,wBAIxBoC,gBAAiB5Y,GAEhB,MACM+Y,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,OAAO+Y,EAAY1E,YAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAEzD,MAFyE,KAMjF6lD,qBAAsBvZ,EAAe8Y,GAEpC,MAAM7F,EAAS5gD,KAAK4gD,OACd8F,EAAc9F,EAAO0B,KAAK9lB,UAAWmR,GAE3C,IAAO+Y,EAAY1E,aAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAE/D,OAAOuiD,QAAQC,UAIhB,MAAM8C,EAAU,GAEV9nB,EAAY6nB,EAAY1E,WAAYhiD,KAAKqB,MA0B/C,QAxBmCO,IAA9Bi9B,EAAUsoB,kBAEdV,EAAeW,UAAYvoB,EAAUsoB,sBAIFvlD,IAA/Bi9B,EAAUwoB,kBAEdV,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,eAAgB5nB,EAAUwoB,wBAInCzlD,IAAvCi9B,EAAUyoB,2BAEdb,EAAec,mBAAqB1oB,EAAUyoB,+BAIF1lD,IAAxCi9B,EAAU2oB,2BAEdb,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,wBAAyB5nB,EAAU2oB,iCAI9C5lD,IAArCi9B,EAAU4oB,yBAEdd,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,qBAAsB5nB,EAAU4oB,8BAEpC7lD,IAA3Ci9B,EAAU4oB,uBAAuBvwC,OAAsB,CAE3D,MAAMA,EAAQ2nB,EAAU4oB,uBAAuBvwC,MAE/CuvC,EAAeiB,qBAAuB,IAAI,MAASxwC,EAAOA,GAM5D,OAAO0sC,QAAQqD,IAAKN,IAWtB,MAAM3F,EAELthD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWkC,oBAIxBkC,gBAAiB5Y,GAEhB,MACM+Y,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,OAAO+Y,EAAY1E,YAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAEzD,MAFyE,KAMjF6lD,qBAAsBvZ,EAAe8Y,GAEpC,MAAM7F,EAAS5gD,KAAK4gD,OACd8F,EAAc9F,EAAO0B,KAAK9lB,UAAWmR,GAE3C,IAAO+Y,EAAY1E,aAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAE/D,OAAOuiD,QAAQC,UAIhB,MAAM8C,EAAU,GAEhBF,EAAekB,WAAa,IAAI,MAAO,EAAG,EAAG,GAC7ClB,EAAemB,eAAiB,EAChCnB,EAAeoB,MAAQ,EAEvB,MAAMhpB,EAAY6nB,EAAY1E,WAAYhiD,KAAKqB,MA0B/C,YAxBoCO,IAA/Bi9B,EAAUipB,kBAEdrB,EAAekB,WAAWxmB,UAAWtC,EAAUipB,uBAIRlmD,IAAnCi9B,EAAUkpB,uBAEdtB,EAAemB,eAAiB/oB,EAAUkpB,2BAINnmD,IAAhCi9B,EAAUmpB,mBAEdrB,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,gBAAiB5nB,EAAUmpB,yBAIvCpmD,IAApCi9B,EAAUopB,uBAEdtB,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,oBAAqB5nB,EAAUopB,wBAI7ErE,QAAQqD,IAAKN,IAYtB,MAAM1F,EAELvhD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWoC,2BAIxBgC,gBAAiB5Y,GAEhB,MACM+Y,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,OAAO+Y,EAAY1E,YAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAEzD,MAFyE,KAMjF6lD,qBAAsBvZ,EAAe8Y,GAEpC,MAAM7F,EAAS5gD,KAAK4gD,OACd8F,EAAc9F,EAAO0B,KAAK9lB,UAAWmR,GAE3C,IAAO+Y,EAAY1E,aAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAE/D,OAAOuiD,QAAQC,UAIhB,MAAM8C,EAAU,GAEV9nB,EAAY6nB,EAAY1E,WAAYhiD,KAAKqB,MAc/C,YAZsCO,IAAjCi9B,EAAUqpB,qBAEdzB,EAAe0B,aAAetpB,EAAUqpB,yBAIFtmD,IAAlCi9B,EAAUupB,qBAEdzB,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,kBAAmB5nB,EAAUupB,sBAI3ExE,QAAQqD,IAAKN,IAWtB,MAAMzF,EAELxhD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWqC,qBAIxB+B,gBAAiB5Y,GAEhB,MACM+Y,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,OAAO+Y,EAAY1E,YAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAEzD,MAFyE,KAMjF6lD,qBAAsBvZ,EAAe8Y,GAEpC,MAAM7F,EAAS5gD,KAAK4gD,OACd8F,EAAc9F,EAAO0B,KAAK9lB,UAAWmR,GAE3C,IAAO+Y,EAAY1E,aAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAE/D,OAAOuiD,QAAQC,UAIhB,MAAM8C,EAAU,GAEV9nB,EAAY6nB,EAAY1E,WAAYhiD,KAAKqB,MAE/ColD,EAAe4B,eAA0CzmD,IAA9Bi9B,EAAUypB,gBAAgCzpB,EAAUypB,gBAAkB,OAE7D1mD,IAA/Bi9B,EAAU0pB,kBAEd5B,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,eAAgB5nB,EAAU0pB,mBAI/E9B,EAAe+B,oBAAsB3pB,EAAU2pB,qBAAuB,EAEtE,MAAMC,EAAa5pB,EAAU6pB,kBAAoB,CAAE,EAAG,EAAG,GAGzD,OAFAjC,EAAeiC,iBAAmB,IAAI,MAAOD,EAAY,GAAKA,EAAY,GAAKA,EAAY,IAEpF7E,QAAQqD,IAAKN,IAWtB,MAAMxF,EAELzhD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWiC,kBAIxBmC,gBAAiB5Y,GAEhB,MACM+Y,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,OAAO+Y,EAAY1E,YAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAEzD,MAFyE,KAMjF6lD,qBAAsBvZ,EAAe8Y,GAEpC,MACMC,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,IAAO+Y,EAAY1E,aAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAE/D,OAAOuiD,QAAQC,UAIhB,MAAMhlB,EAAY6nB,EAAY1E,WAAYhiD,KAAKqB,MAI/C,OAFAolD,EAAekC,SAAwB/mD,IAAlBi9B,EAAU8pB,IAAoB9pB,EAAU8pB,IAAM,IAE5D/E,QAAQC,WAWjB,MAAMzC,EAEL1hD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWmC,uBAIxBiC,gBAAiB5Y,GAEhB,MACM+Y,EADS1mD,KAAK4gD,OACO0B,KAAK9lB,UAAWmR,GAE3C,OAAO+Y,EAAY1E,YAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAEzD,MAFyE,KAMjF6lD,qBAAsBvZ,EAAe8Y,GAEpC,MAAM7F,EAAS5gD,KAAK4gD,OACd8F,EAAc9F,EAAO0B,KAAK9lB,UAAWmR,GAE3C,IAAO+Y,EAAY1E,aAAgB0E,EAAY1E,WAAYhiD,KAAKqB,MAE/D,OAAOuiD,QAAQC,UAIhB,MAAM8C,EAAU,GAEV9nB,EAAY6nB,EAAY1E,WAAYhiD,KAAKqB,MAE/ColD,EAAemC,uBAAiDhnD,IAA7Bi9B,EAAUgqB,eAA+BhqB,EAAUgqB,eAAiB,OAEpEjnD,IAA9Bi9B,EAAUiqB,iBAEdnC,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,uBAAwB5nB,EAAUiqB,kBAIvF,MAAML,EAAa5pB,EAAUkqB,qBAAuB,CAAE,EAAG,EAAG,GAa5D,OAZAtC,EAAeuC,cAAgB,IAAI,MAAOP,EAAY,GAAKA,EAAY,GAAKA,EAAY,SAEhD7mD,IAAnCi9B,EAAUoqB,sBAEdtC,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,mBAAoB5nB,EAAUoqB,sBAAuB5C,MAAM,SAAWjnB,GAEzHA,EAAQuD,SAAW,UAMdihB,QAAQqD,IAAKN,IAWtB,MAAM7F,EAELphD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWsC,mBAIxBllB,YAAa2pB,GAEZ,MAAMtI,EAAS5gD,KAAK4gD,OACd0B,EAAO1B,EAAO0B,KAEd6G,EAAa7G,EAAKhmB,SAAU4sB,GAElC,IAAOC,EAAWnH,aAAgBmH,EAAWnH,WAAYhiD,KAAKqB,MAE7D,OAAO,KAIR,MAAMw9B,EAAYsqB,EAAWnH,WAAYhiD,KAAKqB,MACxC+nD,EAAS9G,EAAKlmB,OAAQyC,EAAUuqB,QAChC3uB,EAASmmB,EAAOl+C,QAAQ+9C,WAE9B,IAAOhmB,EAAS,CAEf,GAAK6nB,EAAKQ,oBAAsBR,EAAKQ,mBAAmBp/C,QAAS1D,KAAKqB,OAAU,EAE/E,MAAM,IAAI0N,MAAO,+EAKjB,OAAO,KAMT,OAAO6xC,EAAOyI,iBAAkBH,EAAcE,EAAQ3uB,IAWxD,MAAMsmB,EAELrhD,YAAakhD,GAEZ5gD,KAAK4gD,OAASA,EACd5gD,KAAKqB,KAAO8gD,EAAWuC,iBACvB1kD,KAAKspD,YAAc,KAIpB/pB,YAAa2pB,GAEZ,MAAM7nD,EAAOrB,KAAKqB,KACZu/C,EAAS5gD,KAAK4gD,OACd0B,EAAO1B,EAAO0B,KAEd6G,EAAa7G,EAAKhmB,SAAU4sB,GAElC,IAAOC,EAAWnH,aAAgBmH,EAAWnH,WAAY3gD,GAExD,OAAO,KAIR,MAAMw9B,EAAYsqB,EAAWnH,WAAY3gD,GACnC+nD,EAAS9G,EAAKlmB,OAAQyC,EAAUuqB,QAEtC,IAAI3uB,EAASmmB,EAAO9kB,cACpB,GAAKstB,EAAOG,IAAM,CAEjB,MAAMC,EAAU5I,EAAOl+C,QAAQy3B,QAAQ4E,WAAYqqB,EAAOG,KACzC,OAAZC,IAAmB/uB,EAAS+uB,GAIlC,OAAOxpD,KAAKypD,gBAAgBpD,MAAM,SAAWiD,GAE5C,GAAKA,EAAc,OAAO1I,EAAOyI,iBAAkBH,EAAcE,EAAQ3uB,GAEzE,GAAK6nB,EAAKQ,oBAAsBR,EAAKQ,mBAAmBp/C,QAASrC,IAAU,EAE1E,MAAM,IAAI0N,MAAO,6DAKlB,OAAO6xC,EAAOrhB,YAAa2pB,MAM7BO,gBAsBC,OApBOzpD,KAAKspD,cAEXtpD,KAAKspD,YAAc,IAAI1F,SAAS,SAAWC,GAE1C,MAAMrlB,EAAQ,IAAIkrB,MAIlBlrB,EAAMmrB,IAAM,kFAEZnrB,EAAMorB,OAASprB,EAAMtU,QAAU,WAE9B25B,EAA0B,IAAjBrlB,EAAMrvB,aAQXnP,KAAKspD,aAWd,MAAMhI,EAEL5hD,YAAakhD,GAEZ5gD,KAAKqB,KAAO8gD,EAAWwC,wBACvB3kD,KAAK4gD,OAASA,EAIfiJ,eAAgB58C,GAEf,MAAMq1C,EAAOtiD,KAAK4gD,OAAO0B,KACnBwH,EAAaxH,EAAKyH,YAAa98C,GAErC,GAAK68C,EAAW9H,YAAc8H,EAAW9H,WAAYhiD,KAAKqB,MAAS,CAElE,MAAM2oD,EAAeF,EAAW9H,WAAYhiD,KAAKqB,MAE3CkpB,EAASvqB,KAAK4gD,OAAOqJ,cAAe,SAAUD,EAAaz/B,QAC3D4L,EAAUn2B,KAAK4gD,OAAOl+C,QAAQg+C,eAEpC,IAAOvqB,IAAaA,EAAQ+zB,UAAY,CAEvC,GAAK5H,EAAKQ,oBAAsBR,EAAKQ,mBAAmBp/C,QAAS1D,KAAKqB,OAAU,EAE/E,MAAM,IAAI0N,MAAO,sFAKjB,OAAO,KAMT,OAAO60C,QAAQqD,IAAK,CAAE18B,EAAQ4L,EAAQg0B,QAAU9D,MAAM,SAAW+D,GAEhE,MAAMC,EAAaL,EAAaK,YAAc,EACxCjvB,EAAa4uB,EAAa5uB,YAAc,EAExC8S,EAAQ8b,EAAa9b,MACrBoc,EAASN,EAAaO,WAEtB9lD,EAAS,IAAI65B,YAAa4P,EAAQoc,GAClClB,EAAS,IAAI1rC,WAAY0sC,EAAK,GAAKC,EAAYjvB,GAGrD,OADAjF,EAAQq0B,iBAAkB,IAAI9sC,WAAYjZ,GAAUypC,EAAOoc,EAAQlB,EAAQY,EAAaS,KAAMT,EAAa5kB,QACpG3gC,KAMR,OAAO,MASV,MAAMy9C,EAAgC,OAEhCwI,EAAuC,WAAvCA,EAAwD,QAE9D,MAAMrI,EAEL3iD,YAAa0qB,GAEZpqB,KAAKqB,KAAO8gD,EAAWC,gBACvBpiD,KAAK2+B,QAAU,KACf3+B,KAAKyL,KAAO,KAEZ,MAAMk/C,EAAa,IAAI5M,SAAU3zB,EAAM,EAXF,IAmBrC,GANApqB,KAAKgzB,OAAS,CACb43B,MAAO,iBAAwB,IAAIltC,WAAY0M,EAAKvH,MAAO,EAAG,KAC9Di5B,QAAS6O,EAAW5O,UAAW,GAAG,GAClC9wC,OAAQ0/C,EAAW5O,UAAW,GAAG,IAG7B/7C,KAAKgzB,OAAO43B,QAAU1I,EAE1B,MAAM,IAAInzC,MAAO,qDAEX,GAAK/O,KAAKgzB,OAAO8oB,QAAU,EAEjC,MAAM,IAAI/sC,MAAO,kDAIlB,MAAM87C,EAAsB7qD,KAAKgzB,OAAO/nB,OA7BH,GA8B/B6/C,EAAY,IAAI/M,SAAU3zB,EA9BK,IA+BrC,IAAI2gC,EAAa,EAEjB,KAAQA,EAAaF,GAAsB,CAE1C,MAAMG,EAAcF,EAAU/O,UAAWgP,GAAY,GACrDA,GAAc,EAEd,MAAME,EAAYH,EAAU/O,UAAWgP,GAAY,GAGnD,GAFAA,GAAc,EAETE,IAAcP,EAAoC,CAEtD,MAAMQ,EAAe,IAAIxtC,WAAY0M,EA3CF,GA2CyC2gC,EAAYC,GACxFhrD,KAAK2+B,QAAU,iBAAwBusB,QAEjC,GAAKD,IAAcP,EAAmC,CAE5D,MAAML,EAhD6B,GAgDiBU,EACpD/qD,KAAKyL,KAAO2e,EAAKvH,MAAOwnC,EAAYA,EAAaW,GAMlDD,GAAcC,EAIf,GAAsB,OAAjBhrD,KAAK2+B,QAET,MAAM,IAAI5vB,MAAO,8CAapB,MAAMq0C,EAEL1jD,YAAa4iD,EAAM9B,GAElB,IAAOA,EAEN,MAAM,IAAIzxC,MAAO,uDAIlB/O,KAAKqB,KAAO8gD,EAAWgB,2BACvBnjD,KAAKsiD,KAAOA,EACZtiD,KAAKwgD,YAAcA,EACnBxgD,KAAKwgD,YAAY2K,UAIlBC,gBAAiBC,EAAWzK,GAE3B,MAAM0B,EAAOtiD,KAAKsiD,KACZ9B,EAAcxgD,KAAKwgD,YACnB8K,EAAkBD,EAAUrJ,WAAYhiD,KAAKqB,MAAOyoD,WACpDyB,EAAmBF,EAAUrJ,WAAYhiD,KAAKqB,MAAO8nC,WACrDqiB,EAAoB,GACpBC,EAAyB,GACzBC,EAAmB,GAEzB,IAAM,MAAMC,KAAiBJ,EAAmB,CAE/C,MAAMK,EAAqBC,EAAYF,IAAmBA,EAAc7sB,cAExE0sB,EAAmBI,GAAuBL,EAAkBI,GAI7D,IAAM,MAAMA,KAAiBN,EAAUliB,WAAa,CAEnD,MAAMyiB,EAAqBC,EAAYF,IAAmBA,EAAc7sB,cAExE,QAA2Cl9B,IAAtC2pD,EAAkBI,GAAgC,CAEtD,MAAMG,EAAcxJ,EAAKyJ,UAAWV,EAAUliB,WAAYwiB,IACpDK,EAAgBC,EAAuBH,EAAYE,eAEzDN,EAAkBE,GAAuBI,EACzCP,EAAwBG,IAAkD,IAA3BE,EAAYI,YAM7D,OAAOtL,EAAOqJ,cAAe,aAAcqB,GAAkBjF,MAAM,SAAWyD,GAE7E,OAAO,IAAIlG,SAAS,SAAWC,GAE9BrD,EAAY2L,gBAAiBrC,GAAY,SAAW5gB,GAEnD,IAAM,MAAMyiB,KAAiBziB,EAASC,WAAa,CAElD,MAAMijB,EAAYljB,EAASC,WAAYwiB,GACjCO,EAAaT,EAAwBE,QAEvB/pD,IAAfsqD,IAA2BE,EAAUF,WAAaA,GAIxDrI,EAAS3a,KAEPsiB,EAAmBE,UAe1B,MAAMpI,EAEL5jD,cAECM,KAAKqB,KAAO8gD,EAAWkB,sBAIxBgJ,cAAejtB,EAASiH,GAQvB,YAN4BzkC,IAAvBykC,EAAUimB,UAEd/9C,QAAQwE,KAAM,wCAA0C/S,KAAKqB,KAAO,uCAI3CO,IAArBykC,EAAUlwB,aAA+CvU,IAAvBykC,EAAU8D,eAA8CvoC,IAApBykC,EAAUnvB,QAOrFkoB,EAAUA,EAAQrqB,aAEQnT,IAArBykC,EAAUlwB,QAEdipB,EAAQjpB,OAAOgrB,UAAWkF,EAAUlwB,aAITvU,IAAvBykC,EAAU8D,WAEd/K,EAAQ+K,SAAW9D,EAAU8D,eAILvoC,IAApBykC,EAAUnvB,OAEdkoB,EAAQc,OAAOiB,UAAWkF,EAAUnvB,OAIrCkoB,EAAQ1iB,aAAc,GAxBd0iB,GA2CV,MAAMmtB,UAAmC,MAExC7sD,YAAa8sD,GAEZtoD,QAEAlE,KAAKysD,kCAAmC,EAGxC,MAAMC,EAA+B,CACpC,yBACA,mCACA,UACCC,KAAM,MAEFC,EAAiC,CACtC,2BACA,qCACA,UACCD,KAAM,MAEFE,EAA2B,CAChC,kCACA,yBACA,wDACA,mDACA,oFACA,yCACA,UACCF,KAAM,MAEFG,EAA6B,CAClC,uCACA,2BACA,4DACA,kFACA,2CACA,UACCH,KAAM,MAEFI,EAA6B,CAClC,6BACA,0HACA,kFACA,+DACA,sHACA,2CACA,uDACA,4CACCJ,KAAM,MAEFK,EAAW,CAChB5qB,SAAU,CAAE9+B,OAAO,IAAI,OAAQ2pD,OAAQ,WACvCC,WAAY,CAAE5pD,MAAO,GACrB2/B,YAAa,CAAE3/B,MAAO,MACtB6pD,cAAe,CAAE7pD,MAAO,OAGzBtD,KAAKotD,eAAiBJ,EAEtBhtD,KAAKqtD,gBAAkB,SAAWC,GAEjC,IAAM,MAAMC,KAAeP,EAE1BM,EAAON,SAAUO,GAAgBP,EAAUO,GAI5CD,EAAOE,eAAiBF,EAAOE,eAC7BnkC,QAAS,2BAA4B,0BACrCA,QAAS,2BAA4B,6BACrCA,QAAS,wCAAyCqjC,GAClDrjC,QAAS,wCAAyCujC,GAClDvjC,QAAS,mCAAoCwjC,GAC7CxjC,QAAS,mCAAoCyjC,GAC7CzjC,QAAS,sCAAuC0jC,IAInDjnD,OAAO2nD,iBAAkBztD,KAAM,CAE9BoiC,SAAU,CACT1E,IAAK,WAEJ,OAAOsvB,EAAS5qB,SAAS9+B,OAG1BkU,IAAK,SAAWzS,GAEfioD,EAAS5qB,SAAS9+B,MAAQyB,IAK5Bk+B,YAAa,CACZvF,IAAK,WAEJ,OAAOsvB,EAAS/pB,YAAY3/B,OAG7BkU,IAAK,SAAWzS,GAEfioD,EAAS/pB,YAAY3/B,MAAQyB,EAExBA,EAEJ/E,KAAK0tD,QAAQC,gBAAkB,UAIxB3tD,KAAK0tD,QAAQC,kBAOvBT,WAAY,CACXxvB,IAAK,WAEJ,OAAOsvB,EAASE,WAAW5pD,OAG5BkU,IAAK,SAAWzS,GAEfioD,EAASE,WAAW5pD,MAAQyB,IAK9BooD,cAAe,CACdzvB,IAAK,WAEJ,OAAOsvB,EAASG,cAAc7pD,OAG/BkU,IAAK,SAAWzS,GAEfioD,EAASG,cAAc7pD,MAAQyB,EAE1BA,GAEJ/E,KAAK0tD,QAAQE,kBAAoB,GACjC5tD,KAAK0tD,QAAQG,OAAS,YAIf7tD,KAAK0tD,QAAQE,yBACb5tD,KAAK0tD,QAAQG,mBASjB7tD,KAAK8tD,iBACL9tD,KAAK+tD,iBACL/tD,KAAKguD,oBACLhuD,KAAKiuD,aAEZjuD,KAAK8gC,UAAW0rB,GAIjBj7C,KAAM63C,GAYL,OAVAllD,MAAMqN,KAAM63C,GAEZppD,KAAKijC,YAAcmmB,EAAOnmB,YAC1BjjC,KAAKoiC,SAAS7wB,KAAM63C,EAAOhnB,UAC3BpiC,KAAKmtD,cAAgB/D,EAAO+D,cAC5BntD,KAAKktD,WAAa9D,EAAO8D,kBAClBltD,KAAK8tD,iBACL9tD,KAAK+tD,iBACL/tD,KAAKguD,oBACLhuD,KAAKiuD,aACLjuD,MAOT,MAAMkjD,EAELxjD,cAECM,KAAKqB,KAAO8gD,EAAWc,sCAEvBjjD,KAAKkuD,yBAA2B,CAC/B,QACA,MACA,WACA,oBACA,QACA,iBACA,WACA,oBACA,cACA,UACA,YACA,YACA,gBACA,kBACA,oBACA,mBACA,cACA,WACA,gBACA,aACA,WACA,SACA,kBACA,mBAKF3H,kBAEC,OAAOgG,EAIR/F,aAAcC,EAAgBC,EAAa9F,GAE1C,MAAMuN,EAAwBzH,EAAY1E,WAAYhiD,KAAKqB,MAE3DolD,EAAevlB,MAAQ,IAAI,MAAO,EAAK,EAAK,GAC5CulB,EAAe5kB,QAAU,EAEzB,MAAM8kB,EAAU,GAEhB,GAAKthD,MAAMC,QAAS6oD,EAAsBC,eAAkB,CAE3D,MAAMpvB,EAAQmvB,EAAsBC,cAEpC3H,EAAevlB,MAAMC,UAAWnC,GAChCynB,EAAe5kB,QAAU7C,EAAO,GAoBjC,QAhB8Cp9B,IAAzCusD,EAAsBE,gBAE1B1H,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,MAAO0H,EAAsBE,iBAIlF5H,EAAejlB,SAAW,IAAI,MAAO,EAAK,EAAK,GAC/CilB,EAAeyG,gBAAwDtrD,IAA3CusD,EAAsBG,iBAAiCH,EAAsBG,iBAAmB,EAC5H7H,EAAerkB,SAAW,IAAI,MAAO,EAAK,EAAK,GAE1C/8B,MAAMC,QAAS6oD,EAAsBtF,iBAEzCpC,EAAerkB,SAASjB,UAAWgtB,EAAsBtF,qBAIDjnD,IAApDusD,EAAsBI,0BAA0C,CAEpE,MAAMC,EAAkBL,EAAsBI,0BAC9C5H,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,gBAAiB+H,IACrE7H,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,cAAe+H,IAIpE,OAAO5K,QAAQqD,IAAKN,GAIrB8H,eAAgBhI,GAEf,MAAMjmB,EAAW,IAAI+rB,EAA4B9F,GA0CjD,OAzCAjmB,EAASkuB,KAAM,EAEfluB,EAASU,MAAQulB,EAAevlB,MAEhCV,EAASkC,SAA6B9gC,IAAvB6kD,EAAe/jB,IAAoB,KAAO+jB,EAAe/jB,IAExElC,EAASmuB,SAAW,KACpBnuB,EAASouB,kBAAoB,EAE7BpuB,EAASiC,WAAiC7gC,IAAzB6kD,EAAehkB,MAAsB,KAAOgkB,EAAehkB,MAC5EjC,EAASquB,eAAiB,EAE1BruB,EAASgB,SAAWilB,EAAejlB,SACnChB,EAASmB,kBAAoB,EAC7BnB,EAASqC,iBAA6CjhC,IAA/B6kD,EAAe5jB,YAA4B,KAAO4jB,EAAe5jB,YAExFrC,EAAS+B,aAAqC3gC,IAA3B6kD,EAAelkB,QAAwB,KAAOkkB,EAAelkB,QAChF/B,EAASQ,UAAY,EAErBR,EAASsC,eAAyClhC,IAA7B6kD,EAAe3jB,UAA0B,KAAO2jB,EAAe3jB,UACpFtC,EAASsuB,cAAgB,MAEpBrI,EAAesI,cAAcvuB,EAASuuB,YAActI,EAAesI,aAExEvuB,EAASoC,gBAAkB,KAC3BpC,EAASc,kBAAoB,EAC7Bd,EAASwuB,iBAAmB,EAE5BxuB,EAASyC,iBAA6CrhC,IAA/B6kD,EAAexjB,YAA4B,KAAOwjB,EAAexjB,YACxFzC,EAAS4B,SAAWqkB,EAAerkB,SAEnC5B,EAAS2sB,mBAAiDvrD,IAAjC6kD,EAAe0G,cAA8B,KAAO1G,EAAe0G,cAC5F3sB,EAAS0sB,WAAazG,EAAeyG,WAErC1sB,EAAS0C,SAAW,KAEpB1C,EAASuC,YAAmCnhC,IAA1B6kD,EAAe1jB,OAAuB,KAAO0jB,EAAe1jB,OAC9EvC,EAASyuB,gBAAkB,EAE3BzuB,EAAS0uB,gBAAkB,IAEpB1uB,GAWT,MAAMgjB,EAEL9jD,cAECM,KAAKqB,KAAO8gD,EAAWoB,uBAYzB,MAAM4L,UAAmC,MAExCzvD,YAAa0vD,EAAoBC,EAAcC,EAAYC,GAE1DrrD,MAAOkrD,EAAoBC,EAAcC,EAAYC,GAItDC,iBAAkBviD,GAKjB,MAAMxI,EAASzE,KAAKuvD,aACnB7iD,EAAS1M,KAAKqvD,aACdI,EAAYzvD,KAAKyvD,UACjBt5C,EAASlJ,EAAQwiD,EAAY,EAAIA,EAElC,IAAM,IAAI7yC,EAAI,EAAGA,IAAM6yC,EAAW7yC,IAEjCnY,EAAQmY,GAAMlQ,EAAQyJ,EAASyG,GAIhC,OAAOnY,GAMT0qD,EAA2B3lC,UAAUkmC,aAAeP,EAA2B3lC,UAAUgmC,iBAEzFL,EAA2B3lC,UAAUmmC,UAAYR,EAA2B3lC,UAAUgmC,iBAEtFL,EAA2B3lC,UAAUomC,aAAe,SAAW3sC,EAAI4sC,EAAIruC,EAAGsuC,GAEzE,MAAMrrD,EAASzE,KAAKuvD,aACd7iD,EAAS1M,KAAKqvD,aACd/E,EAAStqD,KAAKyvD,UAEdM,EAAmB,EAATzF,EACV0F,EAAmB,EAAT1F,EAEVphC,EAAK4mC,EAAKD,EAEV9vC,GAAMyB,EAAIquC,GAAO3mC,EACjB+mC,EAAKlwC,EAAIA,EACTmwC,EAAMD,EAAKlwC,EAEXowC,EAAUltC,EAAK+sC,EACfI,EAAUD,EAAUH,EAEpBv3B,GAAO,EAAIy3B,EAAM,EAAID,EACrBI,EAAKH,EAAMD,EACXK,EAAK,EAAI73B,EACTD,EAAK63B,EAAKJ,EAAKlwC,EAIrB,IAAM,IAAInD,EAAI,EAAGA,IAAM0tC,EAAQ1tC,IAAO,CAErC,MAAM2zC,EAAK7jD,EAAQ0jD,EAAUxzC,EAAI0tC,GAC3BkG,EAAK9jD,EAAQ0jD,EAAUxzC,EAAImzC,GAAY7mC,EACvCunC,EAAK/jD,EAAQyjD,EAAUvzC,EAAI0tC,GAC3BoG,EAAKhkD,EAAQyjD,EAAUvzC,GAAMsM,EAEnCzkB,EAAQmY,GAAM0zC,EAAKC,EAAK/3B,EAAKg4B,EAAK/3B,EAAKg4B,EAAKJ,EAAKK,EAIlD,OAAOjsD,GAIR,MAAMksD,EAAK,IAAI,MAEf,MAAMC,UAA6CzB,EAElDS,aAAc3sC,EAAI4sC,EAAIruC,EAAGsuC,GAExB,MAAMrrD,EAASP,MAAM0rD,aAAc3sC,EAAI4sC,EAAIruC,EAAGsuC,GAI9C,OAFAa,EAAGxvB,UAAW18B,GAASq1B,YAAYqc,QAAS1xC,GAErCA,GAaT,MAAMosD,EAWG,EAXHA,EAYE,EAZFA,EAaM,EAbNA,EAcO,EAdPA,EAeM,EAfNA,EAgBW,EAhBXA,EAiBS,EAKT5E,EAAwB,CAC7B,KAAM6E,UACN,KAAMpzC,WACN,KAAMqzC,WACN,KAAMnzC,YACN,KAAME,YACN,KAAMuzB,cAGD2f,EAAgB,CACrB,KAAM,MACN,KAAM,MACN,KAAM,MACN,KAAM,MACN,KAAM,MACN,KAAM,OAGDC,EAAkB,CACvB,MAAO,MACP,MAAO,MACP,MAAO,OAGFC,EAAmB,CACxB,OAAU,EACV,KAAQ,EACR,KAAQ,EACR,KAAQ,EACR,KAAQ,EACR,KAAQ,EACR,KAAQ,IAGHrF,EAAa,CAClBsF,SAAU,WACVC,OAAQ,SACRC,QAAS,UACTC,WAAY,KACZC,WAAY,MACZC,QAAS,QACTC,UAAW,aACXC,SAAU,aAGLC,EAAkB,CACvBz6C,MAAO,QACP6yB,YAAa,WACbI,SAAU,aACV7F,QAAS,yBAGJstB,EAAgB,CACrBC,iBAAajwD,EAEbkwD,OAAQ,MACRC,KAAM,OAGDC,EACG,SADHA,EAEC,OAFDA,EAGE,QA0BR,SAASC,EAAgCC,EAAiBtyD,EAAQuyD,GAIjE,IAAM,MAAM9wD,KAAQ8wD,EAAUnQ,gBAEIpgD,IAA5BswD,EAAiB7wD,KAErBzB,EAAOqmC,SAASmsB,eAAiBxyD,EAAOqmC,SAASmsB,gBAAkB,GACnExyD,EAAOqmC,SAASmsB,eAAgB/wD,GAAS8wD,EAAUnQ,WAAY3gD,IAYlE,SAASgxD,EAAwBzyD,EAAQ0yD,QAEhB1wD,IAAnB0wD,EAAQC,SAEmB,kBAAnBD,EAAQC,OAEnBzsD,OAAO0sD,OAAQ5yD,EAAOqmC,SAAUqsB,EAAQC,QAIxChkD,QAAQwE,KAAM,sDAAwDu/C,EAAQC,SAqFjF,SAASE,EAAoBC,EAAMC,GAIlC,GAFAD,EAAKD,0BAEoB7wD,IAApB+wD,EAAQruB,QAEZ,IAAM,IAAI1nB,EAAI,EAAGg2C,EAAKD,EAAQruB,QAAQr5B,OAAQ2R,EAAIg2C,EAAIh2C,IAErD81C,EAAKG,sBAAuBj2C,GAAM+1C,EAAQruB,QAAS1nB,GAOrD,GAAK+1C,EAAQJ,QAAUltD,MAAMC,QAASqtD,EAAQJ,OAAOO,aAAgB,CAEpE,MAAMA,EAAcH,EAAQJ,OAAOO,YAEnC,GAAKJ,EAAKG,sBAAsB5nD,SAAW6nD,EAAY7nD,OAAS,CAE/DynD,EAAKjb,sBAAwB,GAE7B,IAAM,IAAI76B,EAAI,EAAGg2C,EAAKE,EAAY7nD,OAAQ2R,EAAIg2C,EAAIh2C,IAEjD81C,EAAKjb,sBAAuBqb,EAAal2C,IAAQA,OAMlDrO,QAAQwE,KAAM,yEAQjB,SAASggD,EAAoBC,GAE5B,MAAMC,EAAiBD,EAAahR,YAAcgR,EAAahR,WAAYG,EAAWgB,4BACtF,IAAI+P,EAcJ,OAVCA,EAFID,EAEU,SAAWA,EAAenJ,WACpC,IAAMmJ,EAAe5uB,QACrB,IAAM8uB,EAAqBF,EAAe9pB,YAIhC6pB,EAAa3uB,QAAU,IAAM8uB,EAAqBH,EAAa7pB,YAAe,IAAM6pB,EAAavI,KAIzGyI,EAIR,SAASC,EAAqBhqB,GAE7B,IAAIiqB,EAAgB,GAEpB,MAAMxmD,EAAO9G,OAAO8G,KAAMu8B,GAAapmB,OAEvC,IAAM,IAAInG,EAAI,EAAGg2C,EAAKhmD,EAAK3B,OAAQ2R,EAAIg2C,EAAIh2C,IAE1Cw2C,GAAiBxmD,EAAMgQ,GAAM,IAAMusB,EAAYv8B,EAAMgQ,IAAQ,IAI9D,OAAOw2C,EAIR,SAASC,EAA6B3zD,GAKrC,OAASA,GAER,KAAKoxD,UACJ,OAAO,EAAI,IAEZ,KAAKpzC,WACJ,OAAO,EAAI,IAEZ,KAAKqzC,WACJ,OAAO,EAAI,MAEZ,KAAKnzC,YACJ,OAAO,EAAI,MAEZ,QACC,MAAM,IAAI7O,MAAO,sEAQpB,MAAM0zC,EAEL/iD,YAAa4iD,EAAO,GAAI5/C,EAAU,IAEjC1C,KAAKsiD,KAAOA,EACZtiD,KAAKgiD,WAAa,GAClBhiD,KAAKiiD,QAAU,GACfjiD,KAAK0C,QAAUA,EAGf1C,KAAK4kD,MAAQ,IAAIb,EAGjB/jD,KAAKszD,aAAe,IAAIt2B,IAGxBh9B,KAAKuzD,eAAiB,GAGtBvzD,KAAKwzD,UAAY,CAAE3O,KAAM,GAAIC,KAAM,IACnC9kD,KAAKyzD,YAAc,CAAE5O,KAAM,GAAIC,KAAM,IACrC9kD,KAAK0zD,WAAa,CAAE7O,KAAM,GAAIC,KAAM,IAEpC9kD,KAAK2zD,aAAe,GAGpB3zD,KAAK4zD,cAAgB,GAIa,qBAAtBC,oBAA+E,IAA1C,UAAUC,KAAMC,UAAUC,WAE1Eh0D,KAAK87B,cAAgB,IAAI,MAAmB97B,KAAK0C,QAAQy3B,SAIzDn6B,KAAK87B,cAAgB,IAAI,MAAe97B,KAAK0C,QAAQy3B,SAItDn6B,KAAK87B,cAAcE,eAAgBh8B,KAAK0C,QAAQu5B,aAChDj8B,KAAK87B,cAAclB,iBAAkB56B,KAAK0C,QAAQm4B,eAElD76B,KAAK0iD,WAAa,IAAI,MAAY1iD,KAAK0C,QAAQy3B,SAC/Cn6B,KAAK0iD,WAAW/nB,gBAAiB,eAEC,oBAA7B36B,KAAK0C,QAAQu5B,aAEjBj8B,KAAK0iD,WAAW5nB,oBAAoB,GAMtC2oB,cAAezB,GAEdhiD,KAAKgiD,WAAaA,EAInB0B,WAAYzB,GAEXjiD,KAAKiiD,QAAUA,EAIhBjnB,MAAOX,EAAQE,GAEd,MAAMqmB,EAAS5gD,KACTsiD,EAAOtiD,KAAKsiD,KACZN,EAAahiD,KAAKgiD,WAGxBhiD,KAAK4kD,MAAMX,YAGXjkD,KAAKi0D,YAAY,SAAWC,GAE3B,OAAOA,EAAInP,WAAamP,EAAInP,eAI7BnB,QAAQqD,IAAKjnD,KAAKi0D,YAAY,SAAWC,GAExC,OAAOA,EAAIC,YAAcD,EAAIC,iBAExB9N,MAAM,WAEX,OAAOzC,QAAQqD,IAAK,CAEnBrG,EAAOwT,gBAAiB,SACxBxT,EAAOwT,gBAAiB,aACxBxT,EAAOwT,gBAAiB,eAItB/N,MAAM,SAAWgO,GAEpB,MAAM5vD,EAAS,CACd6vD,MAAOD,EAAc,GAAK/R,EAAKgS,OAAS,GACxCC,OAAQF,EAAc,GACtB7tB,WAAY6tB,EAAc,GAC1BG,QAASH,EAAc,GACvB7R,MAAOF,EAAKE,MACZ5B,OAAQA,EACR3a,SAAU,IAGXgsB,EAAgCjQ,EAAYv9C,EAAQ69C,GAEpD+P,EAAwB5tD,EAAQ69C,GAEhCsB,QAAQqD,IAAKrG,EAAOqT,YAAY,SAAWC,GAE1C,OAAOA,EAAIO,WAAaP,EAAIO,UAAWhwD,OAElC4hD,MAAM,WAEXhsB,EAAQ51B,SAINiwD,MAAOn6B,GAOZwqB,YAEC,MAAMC,EAAWhlD,KAAKsiD,KAAK2C,OAAS,GAC9B0P,EAAW30D,KAAKsiD,KAAKsS,OAAS,GAC9BC,EAAW70D,KAAKsiD,KAAKwS,QAAU,GAIrC,IAAM,IAAIC,EAAY,EAAGC,EAAaL,EAAS1pD,OAAQ8pD,EAAYC,EAAYD,IAAe,CAE7F,MAAME,EAASN,EAAUI,GAAYE,OAErC,IAAM,IAAIr4C,EAAI,EAAGg2C,EAAKqC,EAAOhqD,OAAQ2R,EAAIg2C,EAAIh2C,IAE5CooC,EAAUiQ,EAAQr4C,IAAMs4C,QAAS,EAQnC,IAAM,IAAIhQ,EAAY,EAAGC,EAAaH,EAAS/5C,OAAQi6C,EAAYC,EAAYD,IAAe,CAE7F,MAAME,EAAUJ,EAAUE,QAEJtjD,IAAjBwjD,EAAQsN,OAEZ1yD,KAAKslD,YAAatlD,KAAKwzD,UAAWpO,EAAQsN,WAKpB9wD,IAAjBwjD,EAAQ+P,OAEZN,EAAUzP,EAAQsN,MAAO0C,eAAgB,SAMnBxzD,IAAnBwjD,EAAQiQ,QAEZr1D,KAAKslD,YAAatlD,KAAKyzD,YAAarO,EAAQiQ,SAiB/C/P,YAAaV,EAAO33C,QAEJrL,IAAVqL,SAEwBrL,IAAxBgjD,EAAMC,KAAM53C,KAEhB23C,EAAMC,KAAM53C,GAAU23C,EAAME,KAAM73C,GAAU,GAI7C23C,EAAMC,KAAM53C,MAKbq5C,YAAa1B,EAAO33C,EAAOrN,GAE1B,GAAKglD,EAAMC,KAAM53C,IAAW,EAAI,OAAOrN,EAEvC,MAAM01D,EAAM11D,EAAOmV,QAIbwgD,EAAiB,CAAEC,EAAUzgD,KAElC,MAAM0gD,EAAWz1D,KAAKszD,aAAa51B,IAAK83B,GACvB,MAAZC,GAEJz1D,KAAKszD,aAAa97C,IAAKzC,EAAO0gD,GAI/B,IAAM,MAAQ74C,EAAG0lB,KAAWkzB,EAASz0D,SAAS20D,UAE7CH,EAAgBjzB,EAAOvtB,EAAMhU,SAAU6b,KAUzC,OAJA24C,EAAgB31D,EAAQ01D,GAExBA,EAAIj0D,MAAQ,aAAiBujD,EAAME,KAAM73C,KAElCqoD,EAIRK,WAAYC,GAEX,MAAM5T,EAAal8C,OAAO4G,OAAQ1M,KAAKiiD,SACvCD,EAAWhhD,KAAMhB,MAEjB,IAAM,IAAI4c,EAAI,EAAGA,EAAIolC,EAAW/2C,OAAQ2R,IAAO,CAE9C,MAAMnY,EAASmxD,EAAM5T,EAAYplC,IAEjC,GAAKnY,EAAS,OAAOA,EAItB,OAAO,KAIRwvD,WAAY2B,GAEX,MAAM5T,EAAal8C,OAAO4G,OAAQ1M,KAAKiiD,SACvCD,EAAWvsB,QAASz1B,MAEpB,MAAM2mD,EAAU,GAEhB,IAAM,IAAI/pC,EAAI,EAAGA,EAAIolC,EAAW/2C,OAAQ2R,IAAO,CAE9C,MAAMnY,EAASmxD,EAAM5T,EAAYplC,IAE5BnY,GAASkiD,EAAQ3lD,KAAMyD,GAI7B,OAAOkiD,EAURsD,cAAet4C,EAAM1E,GAEpB,MAAMw4C,EAAW9zC,EAAO,IAAM1E,EAC9B,IAAIy4C,EAAa1lD,KAAK4kD,MAAMlnB,IAAK+nB,GAEjC,IAAOC,EAAa,CAEnB,OAAS/zC,GAER,IAAK,QACJ+zC,EAAa1lD,KAAK61D,UAAW5oD,GAC7B,MAED,IAAK,OACJy4C,EAAa1lD,KAAK81D,SAAU7oD,GAC5B,MAED,IAAK,OACJy4C,EAAa1lD,KAAK21D,YAAY,SAAWzB,GAExC,OAAOA,EAAI6B,UAAY7B,EAAI6B,SAAU9oD,MAGtC,MAED,IAAK,WACJy4C,EAAa1lD,KAAKg2D,aAAc/oD,GAChC,MAED,IAAK,aACJy4C,EAAa1lD,KAAK21D,YAAY,SAAWzB,GAExC,OAAOA,EAAIrK,gBAAkBqK,EAAIrK,eAAgB58C,MAGlD,MAED,IAAK,SACJy4C,EAAa1lD,KAAKi2D,WAAYhpD,GAC9B,MAED,IAAK,WACJy4C,EAAa1lD,KAAK21D,YAAY,SAAWzB,GAExC,OAAOA,EAAIgC,cAAgBhC,EAAIgC,aAAcjpD,MAG9C,MAED,IAAK,UACJy4C,EAAa1lD,KAAK21D,YAAY,SAAWzB,GAExC,OAAOA,EAAI30B,aAAe20B,EAAI30B,YAAatyB,MAG5C,MAED,IAAK,OACJy4C,EAAa1lD,KAAKm2D,SAAUlpD,GAC5B,MAED,IAAK,YACJy4C,EAAa1lD,KAAKo2D,cAAenpD,GACjC,MAED,IAAK,SACJy4C,EAAa1lD,KAAKq2D,WAAYppD,GAC9B,MAED,QACC,MAAM,IAAI8B,MAAO,iBAAmB4C,GAItC3R,KAAK4kD,MAAMpkD,IAAKilD,EAAUC,GAI3B,OAAOA,EASR0O,gBAAiBziD,GAEhB,IAAI0iD,EAAer0D,KAAK4kD,MAAMlnB,IAAK/rB,GAEnC,IAAO0iD,EAAe,CAErB,MAAMzT,EAAS5gD,KACTs2D,EAAOt2D,KAAKsiD,KAAM3wC,GAAkB,SAATA,EAAkB,KAAO,OAAW,GAErE0iD,EAAezQ,QAAQqD,IAAKqP,EAAK5zB,KAAK,SAAW6zB,EAAKtpD,GAErD,OAAO2zC,EAAOqJ,cAAet4C,EAAM1E,OAIpCjN,KAAK4kD,MAAMpkD,IAAKmR,EAAM0iD,GAIvB,OAAOA,EASR4B,WAAYO,GAEX,MAAMC,EAAYz2D,KAAKsiD,KAAK1V,QAAS4pB,GAC/B/7B,EAASz6B,KAAK0iD,WAEpB,GAAK+T,EAAU9kD,MAA2B,gBAAnB8kD,EAAU9kD,KAEhC,MAAM,IAAI5C,MAAO,qBAAuB0nD,EAAU9kD,KAAO,kCAK1D,QAAuB/P,IAAlB60D,EAAUlN,KAAqC,IAAhBiN,EAEnC,OAAO5S,QAAQC,QAAS7jD,KAAKgiD,WAAYG,EAAWC,iBAAkB32C,MAIvE,MAAM/I,EAAU1C,KAAK0C,QAErB,OAAO,IAAIkhD,SAAS,SAAWC,EAASC,GAEvCrpB,EAAOl3B,KAAM,iBAAwBkzD,EAAUlN,IAAK7mD,EAAQ83B,MAAQqpB,OAASjiD,GAAW,WAEvFkiD,EAAQ,IAAI/0C,MAAO,4CAA8C0nD,EAAUlN,IAAM,aAapFM,eAAgByB,GAEf,MAAMoL,EAAgB12D,KAAKsiD,KAAKyH,YAAauB,GAE7C,OAAOtrD,KAAKiqD,cAAe,SAAUyM,EAAcnsC,QAAS87B,MAAM,SAAW97B,GAE5E,MAAM6Q,EAAas7B,EAAct7B,YAAc,EACzCivB,EAAaqM,EAAcrM,YAAc,EAC/C,OAAO9/B,EAAO1H,MAAOwnC,EAAYA,EAAajvB,MAWhD46B,aAAcW,GAEb,MAAM/V,EAAS5gD,KACTsiD,EAAOtiD,KAAKsiD,KAEZwJ,EAAc9rD,KAAKsiD,KAAKyJ,UAAW4K,GAEzC,QAAgC/0D,IAA3BkqD,EAAYhC,iBAAmDloD,IAAvBkqD,EAAY8K,OAKxD,OAAOhT,QAAQC,QAAS,MAIzB,MAAMgT,EAAqB,GAmB3B,YAjBgCj1D,IAA3BkqD,EAAYhC,WAEhB+M,EAAmB71D,KAAMhB,KAAKiqD,cAAe,aAAc6B,EAAYhC,aAIvE+M,EAAmB71D,KAAM,WAIEY,IAAvBkqD,EAAY8K,SAEhBC,EAAmB71D,KAAMhB,KAAKiqD,cAAe,aAAc6B,EAAY8K,OAAOvyB,QAAQylB,aACtF+M,EAAmB71D,KAAMhB,KAAKiqD,cAAe,aAAc6B,EAAY8K,OAAOlqD,OAAOo9C,cAI/ElG,QAAQqD,IAAK4P,GAAqBxQ,MAAM,SAAW0D,GAEzD,MAAMD,EAAaC,EAAa,GAE1B+M,EAAW5F,EAAkBpF,EAAYn6C,MACzColD,EAAa9K,EAAuBH,EAAYE,eAGhDgL,EAAeD,EAAWE,kBAC1BC,EAAYF,EAAeF,EAC3BzM,EAAayB,EAAYzB,YAAc,EACvCE,OAAwC3oD,IAA3BkqD,EAAYhC,WAA2BxH,EAAKyH,YAAa+B,EAAYhC,YAAaS,gBAAa3oD,EAC5GsqD,GAAwC,IAA3BJ,EAAYI,WAC/B,IAAIltB,EAAOm4B,EAGX,GAAK5M,GAAcA,IAAe2M,EAAY,CAI7C,MAAME,EAAUtvD,KAAK8D,MAAOy+C,EAAaE,GACnC8M,EAAa,qBAAuBvL,EAAYhC,WAAa,IAAMgC,EAAYE,cAAgB,IAAMoL,EAAU,IAAMtL,EAAY5d,MACvI,IAAIopB,EAAK1W,EAAOgE,MAAMlnB,IAAK25B,GAEpBC,IAENt4B,EAAQ,IAAI+3B,EAAYjN,EAAYsN,EAAU7M,EAAYuB,EAAY5d,MAAQqc,EAAayM,GAG3FM,EAAK,IAAI,MAAmBt4B,EAAOurB,EAAayM,GAEhDpW,EAAOgE,MAAMpkD,IAAK62D,EAAYC,IAI/BH,EAAkB,IAAI,MAA4BG,EAAIR,EAAYzM,EAAaE,EAAeyM,EAAc9K,QAM3GltB,EAFmB,OAAf8qB,EAEI,IAAIiN,EAAYjL,EAAY5d,MAAQ4oB,GAIpC,IAAIC,EAAYjN,EAAYO,EAAYyB,EAAY5d,MAAQ4oB,GAIrEK,EAAkB,IAAI,MAAiBn4B,EAAO83B,EAAU5K,GAKzD,QAA4BtqD,IAAvBkqD,EAAY8K,OAAuB,CAEvC,MAAMW,EAAkBrG,EAAiBsG,OACnCC,EAAoBxL,EAAuBH,EAAY8K,OAAOvyB,QAAQ2nB,eAEtE0L,EAAoB5L,EAAY8K,OAAOvyB,QAAQgmB,YAAc,EAC7DsN,EAAmB7L,EAAY8K,OAAOlqD,OAAO29C,YAAc,EAE3DuN,EAAgB,IAAIH,EAAmB1N,EAAa,GAAK2N,EAAmB5L,EAAY8K,OAAO1oB,MAAQqpB,GACvGM,EAAe,IAAId,EAAYhN,EAAa,GAAK4N,EAAkB7L,EAAY8K,OAAO1oB,MAAQ4oB,GAEhF,OAAfhN,IAGJqN,EAAkB,IAAI,MAAiBA,EAAgBn4B,MAAMnc,QAASs0C,EAAgBL,SAAUK,EAAgBjL,aAIjH,IAAM,IAAItvC,EAAI,EAAGg2C,EAAKgF,EAAc3sD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAE1D,MAAM3P,EAAQ2qD,EAAeh7C,GAM7B,GAJAu6C,EAAgBW,KAAM7qD,EAAO4qD,EAAcj7C,EAAIk6C,IAC1CA,GAAY,GAAIK,EAAgBY,KAAM9qD,EAAO4qD,EAAcj7C,EAAIk6C,EAAW,IAC1EA,GAAY,GAAIK,EAAgBa,KAAM/qD,EAAO4qD,EAAcj7C,EAAIk6C,EAAW,IAC1EA,GAAY,GAAIK,EAAgBc,KAAMhrD,EAAO4qD,EAAcj7C,EAAIk6C,EAAW,IAC1EA,GAAY,EAAI,MAAM,IAAI/nD,MAAO,sEAMxC,OAAOooD,KAWT53B,YAAa2pB,GAEZ,MAAM5G,EAAOtiD,KAAKsiD,KACZ5/C,EAAU1C,KAAK0C,QACfymD,EAAa7G,EAAKhmB,SAAU4sB,GAC5BE,EAAS9G,EAAKlmB,OAAQ+sB,EAAWC,QAEvC,IAAI3uB,EAASz6B,KAAK87B,cAElB,GAAKstB,EAAOG,IAAM,CAEjB,MAAMC,EAAU9mD,EAAQy3B,QAAQ4E,WAAYqqB,EAAOG,KAClC,OAAZC,IAAmB/uB,EAAS+uB,GAIlC,OAAOxpD,KAAKqpD,iBAAkBH,EAAcE,EAAQ3uB,GAIrD4uB,iBAAkBH,EAAcE,EAAQ3uB,GAEvC,MAAMmmB,EAAS5gD,KACTsiD,EAAOtiD,KAAKsiD,KACZ5/C,EAAU1C,KAAK0C,QAEfymD,EAAa7G,EAAKhmB,SAAU4sB,GAE5BzD,GAAa2D,EAAOG,KAAOH,EAAOU,YAAe,IAAMX,EAAW+O,QAExE,GAAKl4D,KAAK2zD,aAAclO,GAGvB,OAAOzlD,KAAK2zD,aAAclO,GAI3B,MAAMxoC,EAAMmpC,KAAKnpC,KAAOmpC,KAAK+R,UAE7B,IAAIC,EAAYhP,EAAOG,KAAO,GAC1B8O,GAAc,EAElB,QAA2Bz2D,IAAtBwnD,EAAOU,WAIXsO,EAAYxX,EAAOqJ,cAAe,aAAcb,EAAOU,YAAazD,MAAM,SAAWyD,GAEpFuO,GAAc,EACd,MAAMC,EAAO,IAAIn7C,KAAM,CAAE2sC,GAAc,CAAEn4C,KAAMy3C,EAAOmP,WAEtD,OADAH,EAAYn7C,EAAIC,gBAAiBo7C,GAC1BF,UAIF,QAAoBx2D,IAAfwnD,EAAOG,IAElB,MAAM,IAAIx6C,MAAO,2BAA6Bm6C,EAAe,kCAI9D,MAAMsP,EAAU5U,QAAQC,QAASuU,GAAY/R,MAAM,SAAW+R,GAE7D,OAAO,IAAIxU,SAAS,SAAWC,EAASC,GAEvC,IAAIzpB,EAASwpB,GAEuB,IAA/BppB,EAAOg+B,sBAEXp+B,EAAS,SAAWq+B,GAEnB,MAAMt5B,EAAU,IAAI,MAASs5B,GAC7Bt5B,EAAQ1iB,aAAc,EAEtBmnC,EAASzkB,KAMX3E,EAAOl3B,KAAM,iBAAwB60D,EAAW11D,EAAQ83B,MAAQH,OAAQz4B,EAAWkiD,SAIjFuC,MAAM,SAAWjnB,IAIC,IAAhBi5B,GAEJp7C,EAAIM,gBAAiB66C,GAItBh5B,EAAQu5B,OAAQ,EAEXxP,EAAW9nD,OAAO+9B,EAAQ/9B,KAAO8nD,EAAW9nD,MAEjD,MACM62D,GADW5V,EAAKsW,UAAY,IACRzP,EAAW+O,UAAa,GASlD,OAPA94B,EAAQy5B,UAAY7H,EAAekH,EAAQW,YAAe,MAC1Dz5B,EAAQ05B,UAAY9H,EAAekH,EAAQY,YAAe,MAC1D15B,EAAQW,MAAQkxB,EAAiBiH,EAAQn4B,QAAW,MACpDX,EAAQY,MAAQixB,EAAiBiH,EAAQl4B,QAAW,MAEpD4gB,EAAO0S,aAAa97C,IAAK4nB,EAAS,CAAE9C,SAAU4sB,IAEvC9pB,KAEJs1B,OAAO,WAGV,OADAnmD,QAAQC,MAAO,0CAA4C4pD,GACpD,QAMR,OAFAp4D,KAAK2zD,aAAclO,GAAa+S,EAEzBA,EAWRxR,cAAeP,EAAgBsS,EAASC,GAEvC,MAAMpY,EAAS5gD,KAEf,OAAOA,KAAKiqD,cAAe,UAAW+O,EAAO/rD,OAAQo5C,MAAM,SAAWjnB,GAUrE,QANyBx9B,IAApBo3D,EAAO1M,UAA6C,GAAnB0M,EAAO1M,UAAiC,UAAZyM,GAA0C,GAAnBC,EAAO1M,UAE/F/9C,QAAQwE,KAAM,mCAAqCimD,EAAO1M,SAAW,gBAAkByM,EAAU,uBAI7FnY,EAAOoB,WAAYG,EAAWkB,uBAA0B,CAE5D,MAAMhd,OAAkCzkC,IAAtBo3D,EAAOhX,WAA2BgX,EAAOhX,WAAYG,EAAWkB,4BAA0BzhD,EAE5G,GAAKykC,EAAY,CAEhB,MAAM4yB,EAAgBrY,EAAO0S,aAAa51B,IAAK0B,GAC/CA,EAAUwhB,EAAOoB,WAAYG,EAAWkB,uBAAwBgJ,cAAejtB,EAASiH,GACxFua,EAAO0S,aAAa97C,IAAK4nB,EAAS65B,IAQpC,OAFAxS,EAAgBsS,GAAY35B,EAErBA,KAcT85B,oBAAqBxG,GAEpB,MAAMxpB,EAAWwpB,EAAKxpB,SACtB,IAAI1I,EAAWkyB,EAAKlyB,SAEpB,MAAM24B,OAAwDv3D,IAAhCsnC,EAASC,WAAWtP,QAC5Cu/B,OAAgDx3D,IAA9BsnC,EAASC,WAAWjI,MACtCm4B,OAAgDz3D,IAA/BsnC,EAASC,WAAWn3B,OAE3C,GAAK0gD,EAAK4G,SAAW,CAEpB,MAAM7T,EAAW,kBAAoBjlB,EAAS+4B,KAE9C,IAAIC,EAAiBx5D,KAAK4kD,MAAMlnB,IAAK+nB,GAE9B+T,IAENA,EAAiB,IAAI,MACrB,0BAA8BA,EAAgBh5B,GAC9Cg5B,EAAet4B,MAAM3vB,KAAMivB,EAASU,OACpCs4B,EAAe92B,IAAMlC,EAASkC,IAC9B82B,EAAeC,iBAAkB,EAEjCz5D,KAAK4kD,MAAMpkD,IAAKilD,EAAU+T,IAI3Bh5B,EAAWg5B,OAEL,GAAK9G,EAAKgH,OAAS,CAEzB,MAAMjU,EAAW,qBAAuBjlB,EAAS+4B,KAEjD,IAAII,EAAe35D,KAAK4kD,MAAMlnB,IAAK+nB,GAE5BkU,IAENA,EAAe,IAAI,MACnB,0BAA8BA,EAAcn5B,GAC5Cm5B,EAAaz4B,MAAM3vB,KAAMivB,EAASU,OAElClhC,KAAK4kD,MAAMpkD,IAAKilD,EAAUkU,IAI3Bn5B,EAAWm5B,EAKZ,GAAKR,GAAyBC,GAAmBC,EAAiB,CAEjE,IAAI5T,EAAW,kBAAoBjlB,EAAS+4B,KAAO,IAE9C/4B,EAASisB,mCAAmChH,GAAY,wBACxD0T,IAAwB1T,GAAY,wBACpC2T,IAAkB3T,GAAY,kBAC9B4T,IAAiB5T,GAAY,iBAElC,IAAImU,EAAiB55D,KAAK4kD,MAAMlnB,IAAK+nB,GAE9BmU,IAENA,EAAiBp5B,EAASzrB,QAErBqkD,IAAkBQ,EAAexwB,cAAe,GAChDiwB,IAAiBO,EAAeC,aAAc,GAE9CV,IAGCS,EAAe7K,cAAc6K,EAAe7K,YAAYz8C,IAAO,GAC/DsnD,EAAelS,uBAAuBkS,EAAelS,qBAAqBp1C,IAAO,IAIvFtS,KAAK4kD,MAAMpkD,IAAKilD,EAAUmU,GAE1B55D,KAAKszD,aAAa97C,IAAKoiD,EAAgB55D,KAAKszD,aAAa51B,IAAK8C,KAI/DA,EAAWo5B,EAMPp5B,EAASiC,YAAqC7gC,IAA5BsnC,EAASC,WAAW2wB,UAAgDl4D,IAA3BsnC,EAASC,WAAW4F,IAEnF7F,EAAS9kC,aAAc,MAAO8kC,EAASC,WAAW4F,IAInD2jB,EAAKlyB,SAAWA,EAIjB+lB,kBAEC,OAAO,MASR2P,aAAcvoB,GAEb,MAAMiT,EAAS5gD,KACTsiD,EAAOtiD,KAAKsiD,KACZN,EAAahiD,KAAKgiD,WAClB0E,EAAcpE,EAAK9lB,UAAWmR,GAEpC,IAAIosB,EACJ,MAAMtT,EAAiB,GACjBuT,EAAqBtT,EAAY1E,YAAc,GAE/C2E,EAAU,GAEhB,GAAKqT,EAAoB7X,EAAWc,uCAA0C,CAE7E,MAAMgX,EAAcjY,EAAYG,EAAWc,uCAC3C8W,EAAeE,EAAY1T,kBAC3BI,EAAQ3lD,KAAMi5D,EAAYzT,aAAcC,EAAgBC,EAAa9F,SAE/D,GAAKoZ,EAAoB7X,EAAWY,qBAAwB,CAElE,MAAMmX,EAAelY,EAAYG,EAAWY,qBAC5CgX,EAAeG,EAAa3T,kBAC5BI,EAAQ3lD,KAAMk5D,EAAa1T,aAAcC,EAAgBC,EAAa9F,QAEhE,CAKN,MAAMgG,EAAoBF,EAAYG,sBAAwB,GAK9D,GAHAJ,EAAevlB,MAAQ,IAAI,MAAO,EAAK,EAAK,GAC5CulB,EAAe5kB,QAAU,EAEpBx8B,MAAMC,QAASshD,EAAkBE,iBAAoB,CAEzD,MAAM9nB,EAAQ4nB,EAAkBE,gBAEhCL,EAAevlB,MAAMC,UAAWnC,GAChCynB,EAAe5kB,QAAU7C,EAAO,QAIWp9B,IAAvCglD,EAAkBG,kBAEtBJ,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,MAAOG,EAAkBG,mBAI9EN,EAAeqH,eAAiDlsD,IAArCglD,EAAkBuT,eAA+BvT,EAAkBuT,eAAiB,EAC/G1T,EAAesH,eAAkDnsD,IAAtCglD,EAAkBwT,gBAAgCxT,EAAkBwT,gBAAkB,OAE7Dx4D,IAA/CglD,EAAkByT,2BAEtB1T,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,eAAgBG,EAAkByT,2BACtF1T,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,eAAgBG,EAAkByT,4BAIvFN,EAAe/5D,KAAK21D,YAAY,SAAWzB,GAE1C,OAAOA,EAAI3N,iBAAmB2N,EAAI3N,gBAAiB5Y,MAIpDgZ,EAAQ3lD,KAAM4iD,QAAQqD,IAAKjnD,KAAKi0D,YAAY,SAAWC,GAEtD,OAAOA,EAAIhN,sBAAwBgN,EAAIhN,qBAAsBvZ,EAAe8Y,SAM7C,IAA5BC,EAAY4T,cAEhB7T,EAAe8T,KAAO,OAIvB,MAAMC,EAAY9T,EAAY8T,WAAaxI,EAsB3C,GApBKwI,IAAcxI,GAElBvL,EAAe3kB,aAAc,EAG7B2kB,EAAegU,YAAa,IAI5BhU,EAAepgD,OAAS,MACxBogD,EAAe3kB,aAAc,EAExB04B,IAAcxI,IAElBvL,EAAeiU,eAAwC94D,IAA5B8kD,EAAYiU,YAA4BjU,EAAYiU,YAAc,UAM5D/4D,IAA9B8kD,EAAYkU,eAA+Bb,IAAiB,QAEhEpT,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,YAAaC,EAAYkU,gBAE7EnU,EAAesI,YAAc,IAAI,MAAS,EAAG,QAEJntD,IAApC8kD,EAAYkU,cAAc1jD,OAAsB,CAEpD,MAAMA,EAAQwvC,EAAYkU,cAAc1jD,MAExCuvC,EAAesI,YAAYv3C,IAAKN,EAAOA,GA8BzC,YAxBsCtV,IAAjC8kD,EAAYmU,kBAAkCd,IAAiB,QAEnEpT,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,QAASC,EAAYmU,wBAE1Bj5D,IAA1C8kD,EAAYmU,iBAAiBC,WAEjCrU,EAAeoI,eAAiBnI,EAAYmU,iBAAiBC,gBAM3Bl5D,IAA/B8kD,EAAYqU,gBAAgChB,IAAiB,QAEjEtT,EAAejlB,UAAW,IAAI,OAAQL,UAAWulB,EAAYqU,sBAIzBn5D,IAAhC8kD,EAAYsU,iBAAiCjB,IAAiB,OAElEpT,EAAQ3lD,KAAM4/C,EAAOoG,cAAeP,EAAgB,cAAeC,EAAYsU,kBAIzEpX,QAAQqD,IAAKN,GAAUN,MAAM,WAEnC,IAAI7lB,EAwBJ,OApBCA,EAFIu5B,IAAiBxN,EAEVvK,EAAYG,EAAWc,uCAAwCwL,eAAgBhI,GAI/E,IAAIsT,EAActT,GAIzBC,EAAYrlD,OAAOm/B,EAASn/B,KAAOqlD,EAAYrlD,MAG/Cm/B,EAASkC,MAAMlC,EAASkC,IAAIC,SAAW,OACvCnC,EAASqC,cAAcrC,EAASqC,YAAYF,SAAW,OAE5D0vB,EAAwB7xB,EAAUkmB,GAElC9F,EAAO0S,aAAa97C,IAAKgpB,EAAU,CAAEhE,UAAWmR,IAE3C+Y,EAAY1E,YAAaiQ,EAAgCjQ,EAAYxhB,EAAUkmB,GAE7ElmB,KAOT0lB,iBAAkB+U,GAEjB,MAAMC,EAAgB,uBAAkCD,GAAgB,IAExE,IAAI55D,EAAO65D,EAEX,IAAM,IAAIt+C,EAAI,EAAG5c,KAAK4zD,cAAevyD,KAAWub,EAE/Cvb,EAAO65D,EAAgB,IAAMt+C,EAM9B,OAFA5c,KAAK4zD,cAAevyD,IAAS,EAEtBA,EAYR85D,eAAgBC,GAEf,MAAMxa,EAAS5gD,KACTgiD,EAAahiD,KAAKgiD,WAClB4C,EAAQ5kD,KAAKuzD,eAEnB,SAAS8H,EAAsBhQ,GAE9B,OAAOrJ,EAAYG,EAAWgB,4BAC5BiI,gBAAiBC,EAAWzK,GAC5ByF,MAAM,SAAWnd,GAEjB,OAAOoyB,GAAwBpyB,EAAUmiB,EAAWzK,MAMvD,MAAM+F,EAAU,GAEhB,IAAM,IAAI/pC,EAAI,EAAGg2C,EAAKwI,EAAWnwD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAEvD,MAAMyuC,EAAY+P,EAAYx+C,GACxB6oC,EAAWsN,EAAoB1H,GAG/BkQ,EAAS3W,EAAOa,GAEtB,GAAK8V,EAGJ5U,EAAQ3lD,KAAMu6D,EAAO/C,aAEf,CAEN,IAAIgD,EAKHA,EAHInQ,EAAUrJ,YAAcqJ,EAAUrJ,WAAYG,EAAWgB,4BAG3CkY,EAAsBhQ,GAKtBiQ,GAAwB,IAAI,MAAkBjQ,EAAWzK,GAK5EgE,EAAOa,GAAa,CAAE4F,UAAWA,EAAWmN,QAASgD,GAErD7U,EAAQ3lD,KAAMw6D,IAMhB,OAAO5X,QAAQqD,IAAKN,GASrBoP,SAAU0F,GAET,MAAM7a,EAAS5gD,KACTsiD,EAAOtiD,KAAKsiD,KACZN,EAAahiD,KAAKgiD,WAElB2Q,EAAUrQ,EAAKwS,OAAQ2G,GACvBL,EAAazI,EAAQyI,WAErBzU,EAAU,GAEhB,IAAM,IAAI/pC,EAAI,EAAGg2C,EAAKwI,EAAWnwD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAEvD,MAAM4jB,OAAwC5+B,IAA7Bw5D,EAAYx+C,GAAI4jB,eAx2CC5+B,KAFLgjD,EA22CH5kD,KAAK4kD,OAz2CH,kBAE7BA,EAAyB,gBAAI,IAAI,MAAsB,CACtD1jB,MAAO,SACPM,SAAU,EACVssB,UAAW,EACXC,UAAW,EACXjsB,aAAa,EACb45B,WAAW,EACXnB,KAAM,SAKD3V,EAAyB,iBA41C3B5kD,KAAKiqD,cAAe,WAAYmR,EAAYx+C,GAAI4jB,UAEnDmmB,EAAQ3lD,KAAMw/B,GA92CjB,IAAgCokB,EAo3C9B,OAFA+B,EAAQ3lD,KAAM4/C,EAAOua,eAAgBC,IAE9BxX,QAAQqD,IAAKN,GAAUN,MAAM,SAAWsV,GAE9C,MAAMn/B,EAAYm/B,EAAQ94C,MAAO,EAAG84C,EAAQ1wD,OAAS,GAC/C2wD,EAAaD,EAASA,EAAQ1wD,OAAS,GAEvC6pD,EAAS,GAEf,IAAM,IAAIl4C,EAAI,EAAGg2C,EAAKgJ,EAAW3wD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAEvD,MAAMssB,EAAW0yB,EAAYh/C,GACvByuC,EAAY+P,EAAYx+C,GAI9B,IAAI81C,EAEJ,MAAMlyB,EAAWhE,EAAW5f,GAE5B,GAAKyuC,EAAUZ,OAASoG,GACtBxF,EAAUZ,OAASoG,GACnBxF,EAAUZ,OAASoG,QACAjvD,IAAnBypD,EAAUZ,KAGXiI,GAAiC,IAA1BC,EAAQyC,cACZ,IAAI,MAAalsB,EAAU1I,GAC3B,IAAI,MAAM0I,EAAU1I,IAEK,IAAvBkyB,EAAK0C,eAA4B1C,EAAKxpB,SAASC,WAAW0yB,WAAW3P,YAIzEwG,EAAKppB,uBAID+hB,EAAUZ,OAASoG,EAEvB6B,EAAKxpB,SAAW4yB,GAAqBpJ,EAAKxpB,SAAU,OAEzCmiB,EAAUZ,OAASoG,IAE9B6B,EAAKxpB,SAAW4yB,GAAqBpJ,EAAKxpB,SAAU,aAI/C,GAAKmiB,EAAUZ,OAASoG,EAE9B6B,EAAO,IAAI,MAAcxpB,EAAU1I,QAE7B,GAAK6qB,EAAUZ,OAASoG,EAE9B6B,EAAO,IAAI,MAAMxpB,EAAU1I,QAErB,GAAK6qB,EAAUZ,OAASoG,EAE9B6B,EAAO,IAAI,MAAUxpB,EAAU1I,OAEzB,IAAK6qB,EAAUZ,OAASoG,EAM9B,MAAM,IAAI9hD,MAAO,iDAAmDs8C,EAAUZ,MAJ9EiI,EAAO,IAAI,MAAQxpB,EAAU1I,GAQzB16B,OAAO8G,KAAM8lD,EAAKxpB,SAAS6H,iBAAkB9lC,OAAS,GAE1DwnD,EAAoBC,EAAMC,GAI3BD,EAAKrxD,KAAOu/C,EAAOsF,iBAAkByM,EAAQtxD,MAAU,QAAUo6D,GAEjEpJ,EAAwBK,EAAMC,GAEzBtH,EAAUrJ,YAAaiQ,EAAgCjQ,EAAY0Q,EAAMrH,GAE9EzK,EAAOsY,oBAAqBxG,GAE5BoC,EAAO9zD,KAAM0xD,GAId,IAAM,IAAI91C,EAAI,EAAGg2C,EAAKkC,EAAO7pD,OAAQ2R,EAAIg2C,EAAIh2C,IAE5CgkC,EAAO0S,aAAa97C,IAAKs9C,EAAQl4C,GAAK,CACrCk4C,OAAQ2G,EACRL,WAAYx+C,IAKd,GAAuB,IAAlBk4C,EAAO7pD,OAEX,OAAO6pD,EAAQ,GAIhB,MAAMiH,EAAQ,IAAI,MAElBnb,EAAO0S,aAAa97C,IAAKukD,EAAO,CAAEjH,OAAQ2G,IAE1C,IAAM,IAAI7+C,EAAI,EAAGg2C,EAAKkC,EAAO7pD,OAAQ2R,EAAIg2C,EAAIh2C,IAE5Cm/C,EAAMv7D,IAAKs0D,EAAQl4C,IAIpB,OAAOm/C,KAWT1F,WAAY2F,GAEX,IAAI3G,EACJ,MAAM4G,EAAYj8D,KAAKsiD,KAAKkS,QAASwH,GAC/BxP,EAASyP,EAAWA,EAAUtqD,MAEpC,GAAO66C,EAqBP,MAdwB,gBAAnByP,EAAUtqD,KAEd0jD,EAAS,IAAI,MAAmB,eAAoB7I,EAAO0P,MAAQ1P,EAAO2P,aAAe,EAAG3P,EAAO4P,OAAS,EAAG5P,EAAO6P,MAAQ,KAEhG,iBAAnBJ,EAAUtqD,OAErB0jD,EAAS,IAAI,OAAsB7I,EAAO8P,KAAM9P,EAAO8P,KAAM9P,EAAO+P,MAAQ/P,EAAO+P,KAAM/P,EAAO4P,MAAO5P,EAAO6P,OAI1GJ,EAAU56D,OAAOg0D,EAAOh0D,KAAOrB,KAAKkmD,iBAAkB+V,EAAU56D,OAErEgxD,EAAwBgD,EAAQ4G,GAEzBrY,QAAQC,QAASwR,GAnBvB9mD,QAAQwE,KAAM,gDA4BhBojD,SAAUpB,GAET,MAAMyH,EAAUx8D,KAAKsiD,KAAKsS,MAAOG,GAE3B0H,EAAY,CAAExH,OAAQuH,EAAQvH,QAEpC,YAAqCrzD,IAAhC46D,EAAQE,oBAEL9Y,QAAQC,QAAS4Y,GAIlBz8D,KAAKiqD,cAAe,WAAYuS,EAAQE,qBAAsBrW,MAAM,SAAWsW,GAIrF,OAFAF,EAAUC,oBAAsBC,EAEzBF,KAWTrG,cAAewG,GAEd,MAEMC,EAFO78D,KAAKsiD,KAEQ9b,WAAYo2B,GAEhCE,EAAe,GACfC,EAAwB,GACxBC,EAAyB,GACzBC,EAAkB,GAClBC,EAAiB,GAEvB,IAAM,IAAItgD,EAAI,EAAGg2C,EAAKiK,EAAaM,SAASlyD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAElE,MAAMwgD,EAAUP,EAAaM,SAAUvgD,GACjCs7C,EAAU2E,EAAajE,SAAUwE,EAAQlF,SACzC3yD,EAAS63D,EAAQ73D,OACjBlE,OAAuBO,IAAhB2D,EAAOygC,KAAqBzgC,EAAOygC,KAAOzgC,EAAO5E,GACxD08D,OAAoCz7D,IAA5Bi7D,EAAaj8B,WAA2Bi8B,EAAaj8B,WAAYs3B,EAAQmF,OAAUnF,EAAQmF,MACnGC,OAAqC17D,IAA5Bi7D,EAAaj8B,WAA2Bi8B,EAAaj8B,WAAYs3B,EAAQoF,QAAWpF,EAAQoF,OAE3GR,EAAa97D,KAAMhB,KAAKiqD,cAAe,OAAQ5oD,IAC/C07D,EAAsB/7D,KAAMhB,KAAKiqD,cAAe,WAAYoT,IAC5DL,EAAuBh8D,KAAMhB,KAAKiqD,cAAe,WAAYqT,IAC7DL,EAAgBj8D,KAAMk3D,GACtBgF,EAAel8D,KAAMuE,GAItB,OAAOq+C,QAAQqD,IAAK,CAEnBrD,QAAQqD,IAAK6V,GACblZ,QAAQqD,IAAK8V,GACbnZ,QAAQqD,IAAK+V,GACbpZ,QAAQqD,IAAKgW,GACbrZ,QAAQqD,IAAKiW,KAEV7W,MAAM,SAAWgO,GAEpB,MAAMpP,EAAQoP,EAAc,GACtBkJ,EAAiBlJ,EAAc,GAC/BmJ,EAAkBnJ,EAAc,GAChCuE,EAAWvE,EAAc,GACzBoJ,EAAUpJ,EAAc,GAExBte,EAAS,GAEf,IAAM,IAAIn5B,EAAI,EAAGg2C,EAAK3N,EAAMh6C,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAElD,MAAMopB,EAAOif,EAAOroC,GACd8gD,EAAgBH,EAAgB3gD,GAChC+gD,EAAiBH,EAAiB5gD,GAClCs7C,EAAUU,EAAUh8C,GACpBrX,EAASk4D,EAAS7gD,GAExB,QAAchb,IAATokC,EAAqB,SAK1B,IAAI43B,EAEJ,OALA53B,EAAK63B,eACL73B,EAAK83B,kBAAmB,EAIfnM,EAAiBpsD,EAAOi1B,OAEhC,KAAKm3B,EAAgBrtB,QAEpBs5B,EAAqB,MACrB,MAED,KAAKjM,EAAgBxnB,SAEpByzB,EAAqB,MACrB,MAED,KAAKjM,EAAgBrgD,SACrB,KAAKqgD,EAAgBz6C,MACrB,QAEC0mD,EAAqB,MAKvB,MAAMG,EAAa/3B,EAAK3kC,KAAO2kC,EAAK3kC,KAAO2kC,EAAKuzB,KAE1CyE,OAA0Cp8D,IAA1Bs2D,EAAQ8F,cAA8BpM,EAAesG,EAAQ8F,eAAkB,MAE/FlL,EAAc,GAEfnB,EAAiBpsD,EAAOi1B,QAAWm3B,EAAgBrtB,QAEvD0B,EAAKD,UAAU,SAAWnmC,GAEpBA,EAAOizD,uBAEXC,EAAY9xD,KAAMpB,EAAOyB,KAAOzB,EAAOyB,KAAOzB,EAAO25D,SAQvDzG,EAAY9xD,KAAM+8D,GAInB,IAAIE,EAAcN,EAAe3+B,MAEjC,GAAK2+B,EAAezR,WAAa,CAEhC,MAAMh1C,EAAQm8C,EAA6B4K,EAAYv+D,aACjDw+D,EAAS,IAAI7sB,aAAc4sB,EAAYhzD,QAE7C,IAAM,IAAIoT,EAAI,EAAG8/C,EAAKF,EAAYhzD,OAAQoT,EAAI8/C,EAAI9/C,IAEjD6/C,EAAQ7/C,GAAM4/C,EAAa5/C,GAAMnH,EAIlC+mD,EAAcC,EAIf,IAAM,IAAI7/C,EAAI,EAAG8/C,EAAKrL,EAAY7nD,OAAQoT,EAAI8/C,EAAI9/C,IAAO,CAExD,MAAM+/C,EAAQ,IAAIR,EACjB9K,EAAaz0C,GAAM,IAAMszC,EAAiBpsD,EAAOi1B,MACjDkjC,EAAc1+B,MACdi/B,EACAD,GAI8B,gBAA1B9F,EAAQ8F,gBAEZI,EAAMC,kBAAoB,SAAkD55D,GAQ3E,OAAO,IAFmBzE,gBAAgB,MAA4B4wD,EAAuCzB,GAEjFnvD,KAAKy0C,MAAOz0C,KAAK0M,OAAQ1M,KAAKs+D,eAAiB,EAAG75D,IAK/E25D,EAAMC,kBAAkBE,2CAA4C,GAIrExoB,EAAO/0C,KAAMo9D,IAMf,MAAM/8D,EAAOw7D,EAAax7D,KAAOw7D,EAAax7D,KAAO,aAAeu7D,EAEpE,OAAO,IAAI,MAAev7D,OAAMO,EAAWm0C,MAM7CyoB,eAAgBtZ,GAEf,MAAM5C,EAAOtiD,KAAKsiD,KACZ1B,EAAS5gD,KACTolD,EAAU9C,EAAK2C,MAAOC,GAE5B,YAAsBtjD,IAAjBwjD,EAAQsN,KAA4B,KAElC9R,EAAOqJ,cAAe,OAAQ7E,EAAQsN,MAAOrM,MAAM,SAAWqM,GAEpE,MAAM1sB,EAAO4a,EAAO0F,YAAa1F,EAAO4S,UAAWpO,EAAQsN,KAAMA,GAmBjE,YAhByB9wD,IAApBwjD,EAAQ9gB,SAEZ0B,EAAKD,UAAU,SAAW/lB,GAEzB,GAAOA,EAAEy+C,OAET,IAAM,IAAI7hD,EAAI,EAAGg2C,EAAKxN,EAAQ9gB,QAAQr5B,OAAQ2R,EAAIg2C,EAAIh2C,IAErDoD,EAAE6yC,sBAAuBj2C,GAAMwoC,EAAQ9gB,QAAS1nB,MAQ5CopB,KAWT8vB,SAAU5Q,GAET,MAAM5C,EAAOtiD,KAAKsiD,KACZN,EAAahiD,KAAKgiD,WAClBpB,EAAS5gD,KAETolD,EAAU9C,EAAK2C,MAAOC,GAGtB7K,EAAW+K,EAAQ/jD,KAAOu/C,EAAOsF,iBAAkBd,EAAQ/jD,MAAS,GAE1E,OAAS,WAER,MAAMslD,EAAU,GAEV+X,EAAc9d,EAAO+U,YAAY,SAAWzB,GAEjD,OAAOA,EAAIsK,gBAAkBtK,EAAIsK,eAAgBtZ,MA8BlD,OA1BKwZ,GAEJ/X,EAAQ3lD,KAAM09D,QAIS98D,IAAnBwjD,EAAQiQ,QAEZ1O,EAAQ3lD,KAAM4/C,EAAOqJ,cAAe,SAAU7E,EAAQiQ,QAAShP,MAAM,SAAWgP,GAE/E,OAAOzU,EAAO0F,YAAa1F,EAAO6S,YAAarO,EAAQiQ,OAAQA,OAMjEzU,EAAOqT,YAAY,SAAWC,GAE7B,OAAOA,EAAI/N,sBAAwB+N,EAAI/N,qBAAsBjB,MAE1Dr4C,SAAS,SAAW2rD,GAEvB7R,EAAQ3lD,KAAMw3D,MAIR5U,QAAQqD,IAAKN,GApCd,GAsCDN,MAAM,SAAWrC,GAEtB,IAAIhe,EAqBJ,GAhBCA,GAFuB,IAAnBof,EAAQ8P,OAEL,IAAI,MAEAlR,EAAQ/4C,OAAS,EAErB,IAAI,MAEmB,IAAnB+4C,EAAQ/4C,OAEZ+4C,EAAS,GAIT,IAAI,MAIPhe,IAASge,EAAS,GAEtB,IAAM,IAAIpnC,EAAI,EAAGg2C,EAAK5O,EAAQ/4C,OAAQ2R,EAAIg2C,EAAIh2C,IAE7CopB,EAAKxlC,IAAKwjD,EAASpnC,IAiBrB,GAXKwoC,EAAQ/jD,OAEZ2kC,EAAKC,SAAS5kC,KAAO+jD,EAAQ/jD,KAC7B2kC,EAAK3kC,KAAOg5C,GAIbgY,EAAwBrsB,EAAMof,GAEzBA,EAAQpD,YAAaiQ,EAAgCjQ,EAAYhc,EAAMof,QAEpDxjD,IAAnBwjD,EAAQjrC,OAAuB,CAEnC,MAAMA,EAAS,IAAI,MACnBA,EAAOgnB,UAAWikB,EAAQjrC,QAC1B6rB,EAAKv0B,aAAc0I,aAIUvY,IAAxBwjD,EAAQrb,aAEZ/D,EAAK10B,SAAS6vB,UAAWikB,EAAQrb,kBAIRnoC,IAArBwjD,EAAQjb,UAEZnE,EAAKnuB,WAAWspB,UAAWikB,EAAQjb,eAIbvoC,IAAlBwjD,EAAQluC,OAEZ8uB,EAAK9uB,MAAMiqB,UAAWikB,EAAQluC,OAchC,OARO0pC,EAAO0S,aAAah2B,IAAK0I,IAE/B4a,EAAO0S,aAAa97C,IAAKwuB,EAAM,IAIhC4a,EAAO0S,aAAa51B,IAAKsI,GAAOif,MAAQC,EAEjClf,KAWT6vB,UAAW8I,GAEV,MAAMrc,EAAOtiD,KAAKsiD,KACZN,EAAahiD,KAAKgiD,WAClB4c,EAAW5+D,KAAKsiD,KAAKiS,OAAQoK,GAC7B/d,EAAS5gD,KAITs0D,EAAQ,IAAI,MACbsK,EAASv9D,OAAOizD,EAAMjzD,KAAOu/C,EAAOsF,iBAAkB0Y,EAASv9D,OAEpEgxD,EAAwBiC,EAAOsK,GAE1BA,EAAS5c,YAAaiQ,EAAgCjQ,EAAYsS,EAAOsK,GAE9E,MAAMC,EAAUD,EAAS3Z,OAAS,GAE5B0B,EAAU,GAEhB,IAAM,IAAI/pC,EAAI,EAAGg2C,EAAKiM,EAAQ5zD,OAAQ2R,EAAIg2C,EAAIh2C,IAE7C+pC,EAAQ3lD,KAAM89D,GAAoBD,EAASjiD,GAAK03C,EAAOhS,EAAM1B,IAI9D,OAAOgD,QAAQqD,IAAKN,GAAUN,MAAM,WAoCnC,OAFAzF,EAAO0S,aA9BoB,CAAEttB,IAE5B,MAAM+4B,EAAsB,IAAI/hC,IAEhC,IAAM,MAAQuW,EAAKjwC,KAAWs9C,EAAO0S,cAE/B/f,aAAe,OAAYA,aAAe,QAE9CwrB,EAAoBvnD,IAAK+7B,EAAKjwC,GAkBhC,OAZA0iC,EAAKD,UAAYC,IAEhB,MAAMyvB,EAAW7U,EAAO0S,aAAa51B,IAAKsI,GAEzB,MAAZyvB,GAEJsJ,EAAoBvnD,IAAKwuB,EAAMyvB,MAM1BsJ,GAIcC,CAAoB1K,GAEnCA,MAQV,SAASwK,GAAoBG,EAAQC,EAAc5c,EAAM1B,GAExD,MAAMwE,EAAU9C,EAAK2C,MAAOga,GAE5B,OAAOre,EAAOqJ,cAAe,OAAQgV,GAAS5Y,MAAM,SAAWrgB,GAE9D,QAAsBpkC,IAAjBwjD,EAAQ+P,KAAqB,OAAOnvB,EAIzC,IAAIy2B,EAEJ,OAAO7b,EAAOqJ,cAAe,OAAQ7E,EAAQ+P,MAAO9O,MAAM,SAAW8O,GAEpEsH,EAAYtH,EAEZ,MAAMgK,EAAgB,GAEtB,IAAM,IAAIviD,EAAI,EAAGg2C,EAAK6J,EAAUxH,OAAOhqD,OAAQ2R,EAAIg2C,EAAIh2C,IAEtDuiD,EAAcn+D,KAAM4/C,EAAOqJ,cAAe,OAAQwS,EAAUxH,OAAQr4C,KAIrE,OAAOgnC,QAAQqD,IAAKkY,MAEjB9Y,MAAM,SAAW+Y,GAuCpB,OArCAp5B,EAAKD,UAAU,SAAW2sB,GAEzB,IAAOA,EAAK+L,OAAS,OAErB,MAAM95B,EAAQ,GACR06B,EAAe,GAErB,IAAM,IAAIhhD,EAAI,EAAG8/C,EAAKiB,EAAWn0D,OAAQoT,EAAI8/C,EAAI9/C,IAAO,CAEvD,MAAMihD,EAAYF,EAAY/gD,GAE9B,GAAKihD,EAAY,CAEhB36B,EAAM3jC,KAAMs+D,GAEZ,MAAMC,EAAM,IAAI,WAEuB39D,IAAlC66D,EAAUC,qBAEd6C,EAAIp+B,UAAWs7B,EAAUC,oBAAoB19B,MAAW,GAAJ3gB,GAIrDghD,EAAar+D,KAAMu+D,QAInBhxD,QAAQwE,KAAM,mDAAoD0pD,EAAUxH,OAAQ52C,IAMtFq0C,EAAKtxD,KAAM,IAAI,MAAUujC,EAAO06B,GAAgB3M,EAAKxgD,gBAI/C8zB,QAILqgB,MAAM,SAAWrgB,GAIpBk5B,EAAa1+D,IAAKwlC,GAElB,MAAM2gB,EAAU,GAEhB,GAAKvB,EAAQrkD,SAAW,CAEvB,MAAMA,EAAWqkD,EAAQrkD,SAEzB,IAAM,IAAI6b,EAAI,EAAGg2C,EAAK7xD,EAASkK,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAErD,MAAM0lB,EAAQvhC,EAAU6b,GACxB+pC,EAAQ3lD,KAAM89D,GAAoBx8B,EAAO0D,EAAMsc,EAAM1B,KAMvD,OAAOgD,QAAQqD,IAAKN,MA+HtB,SAAS2U,GAAwBpyB,EAAU8pB,EAAcpS,GAExD,MAAMzX,EAAa6pB,EAAa7pB,WAE1Bwd,EAAU,GAEhB,SAAS6Y,EAAyB7I,EAAehL,GAEhD,OAAO/K,EAAOqJ,cAAe,WAAY0M,GACvCtQ,MAAM,SAAWsW,GAEjBzzB,EAAS9kC,aAAcunD,EAAegR,MAMzC,IAAM,MAAM8C,KAAqBt2B,EAAa,CAE7C,MAAMyiB,EAAqBC,EAAY4T,IAAuBA,EAAkB3gC,cAG3E8sB,KAAsB1iB,EAASC,YAEpCwd,EAAQ3lD,KAAMw+D,EAAyBr2B,EAAYs2B,GAAqB7T,IAIzE,QAA8BhqD,IAAzBoxD,EAAa3uB,UAA2B6E,EAASj8B,MAAQ,CAE7D,MAAM0vD,EAAW/b,EAAOqJ,cAAe,WAAY+I,EAAa3uB,SAAUgiB,MAAM,SAAWsW,GAE1FzzB,EAASw2B,SAAU/C,MAIpBhW,EAAQ3lD,KAAM27D,GAQf,OAJAtK,EAAwBnpB,EAAU8pB,GA5JnC,SAAwB9pB,EAAU8pB,EAAcpS,GAE/C,MAAMzX,EAAa6pB,EAAa7pB,WAE1Bw2B,EAAM,IAAI,MAEhB,QAA6B/9D,IAAxBunC,EAAWgoB,SAkCf,OAlCwC,CAExC,MAAMwL,EAAW/b,EAAO0B,KAAKyJ,UAAW5iB,EAAWgoB,UAE7CtuD,EAAM85D,EAAS95D,IACfC,EAAM65D,EAAS75D,IAIrB,QAAalB,IAARiB,QAA6BjB,IAARkB,EAmBzB,YAFAyL,QAAQwE,KAAM,uEAVd,GALA4sD,EAAInoD,IACH,IAAI,MAAS3U,EAAK,GAAKA,EAAK,GAAKA,EAAK,IACtC,IAAI,MAASC,EAAK,GAAKA,EAAK,GAAKA,EAAK,KAGlC65D,EAASzQ,WAAa,CAE1B,MAAM0T,EAAWvM,EAA6BpH,EAAuB0Q,EAAS3Q,gBAC9E2T,EAAI98D,IAAI0U,eAAgBqoD,GACxBD,EAAI78D,IAAIyU,eAAgBqoD,IAkB3B,MAAMnC,EAAUzK,EAAayK,QAE7B,QAAiB77D,IAAZ67D,EAAwB,CAE5B,MAAMoC,EAAkB,IAAI,MACtBC,EAAS,IAAI,MAEnB,IAAM,IAAIljD,EAAI,EAAGg2C,EAAK6K,EAAQxyD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAEpD,MAAMrX,EAASk4D,EAAS7gD,GAExB,QAAyBhb,IAApB2D,EAAO4rD,SAAyB,CAEpC,MAAMwL,EAAW/b,EAAO0B,KAAKyJ,UAAWxmD,EAAO4rD,UACzCtuD,EAAM85D,EAAS95D,IACfC,EAAM65D,EAAS75D,IAIrB,QAAalB,IAARiB,QAA6BjB,IAARkB,EAAoB,CAQ7C,GALAg9D,EAAOhI,KAAMhwD,KAAKhF,IAAKgF,KAAKoB,IAAKrG,EAAK,IAAOiF,KAAKoB,IAAKpG,EAAK,MAC5Dg9D,EAAO/H,KAAMjwD,KAAKhF,IAAKgF,KAAKoB,IAAKrG,EAAK,IAAOiF,KAAKoB,IAAKpG,EAAK,MAC5Dg9D,EAAO9H,KAAMlwD,KAAKhF,IAAKgF,KAAKoB,IAAKrG,EAAK,IAAOiF,KAAKoB,IAAKpG,EAAK,MAGvD65D,EAASzQ,WAAa,CAE1B,MAAM0T,EAAWvM,EAA6BpH,EAAuB0Q,EAAS3Q,gBAC9E8T,EAAOvoD,eAAgBqoD,GAQxBC,EAAgB/8D,IAAKg9D,QAIrBvxD,QAAQwE,KAAM,wEASjB4sD,EAAII,eAAgBF,GAIrB32B,EAAS82B,YAAcL,EAEvB,MAAMM,EAAS,IAAI,MAEnBN,EAAIO,UAAWD,EAAOE,QACtBF,EAAOhpD,OAAS0oD,EAAI98D,IAAI6S,WAAYiqD,EAAI78D,KAAQ,EAEhDomC,EAASk3B,eAAiBH,EAoD1BI,CAAen3B,EAAU8pB,EAAcpS,GAEhCgD,QAAQqD,IAAKN,GAAUN,MAAM,WAEnC,YAAgCzkD,IAAzBoxD,EAAayK,QAlpEtB,SAA0Bv0B,EAAUu0B,EAAS7c,GAE5C,IAAI0f,GAAmB,EACnBC,GAAiB,EAErB,IAAM,IAAI3jD,EAAI,EAAGg2C,EAAK6K,EAAQxyD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAEpD,MAAMrX,EAASk4D,EAAS7gD,GAKxB,QAHyBhb,IAApB2D,EAAO4rD,WAAyBmP,GAAmB,QACjC1+D,IAAlB2D,EAAO6rD,SAAuBmP,GAAiB,GAE/CD,GAAoBC,EAAiB,MAI3C,IAAOD,IAAsBC,EAAiB,OAAO3c,QAAQC,QAAS3a,GAEtE,MAAMs3B,EAA2B,GAC3BC,EAAyB,GAE/B,IAAM,IAAI7jD,EAAI,EAAGg2C,EAAK6K,EAAQxyD,OAAQ2R,EAAIg2C,EAAIh2C,IAAO,CAEpD,MAAMrX,EAASk4D,EAAS7gD,GAExB,GAAK0jD,EAAmB,CAEvB,MAAMI,OAAsC9+D,IAApB2D,EAAO4rD,SAC5BvQ,EAAOqJ,cAAe,WAAY1kD,EAAO4rD,UACzCjoB,EAASC,WAAW73B,SAEvBkvD,EAAyBx/D,KAAM0/D,GAIhC,GAAKH,EAAiB,CAErB,MAAMG,OAAoC9+D,IAAlB2D,EAAO6rD,OAC5BxQ,EAAOqJ,cAAe,WAAY1kD,EAAO6rD,QACzCloB,EAASC,WAAWn3B,OAEvByuD,EAAuBz/D,KAAM0/D,IAM/B,OAAO9c,QAAQqD,IAAK,CACnBrD,QAAQqD,IAAKuZ,GACb5c,QAAQqD,IAAKwZ,KACVpa,MAAM,SAAW0F,GAEpB,MAAM3a,EAAiB2a,EAAW,GAC5B4U,EAAe5U,EAAW,GAMhC,OAJKuU,IAAmBp3B,EAAS6H,gBAAgBz/B,SAAW8/B,GACvDmvB,IAAiBr3B,EAAS6H,gBAAgB/+B,OAAS2uD,GACxDz3B,EAAS4H,sBAAuB,EAEzB5H,KAwlEJiF,CAAiBjF,EAAU8pB,EAAayK,QAAS7c,GACjD1X,KAWL,SAAS4yB,GAAqB5yB,EAAU03B,GAEvC,IAAI3zD,EAAQi8B,EAAS23B,WAIrB,GAAe,OAAV5zD,EAAiB,CAErB,MAAMo3B,EAAU,GAEV/yB,EAAW43B,EAAS43B,aAAc,YAExC,QAAkBl/D,IAAb0P,EAcJ,OADA/C,QAAQC,MAAO,kGACR06B,EAZP,IAAM,IAAItsB,EAAI,EAAGA,EAAItL,EAAS48B,MAAOtxB,IAEpCynB,EAAQrjC,KAAM4b,GAIfssB,EAASw2B,SAAUr7B,GACnBp3B,EAAQi8B,EAAS23B,WAanB,MAAME,EAAoB9zD,EAAMihC,MAAQ,EAClC8yB,EAAa,GAEnB,GAAKJ,IAAa,MAIjB,IAAM,IAAIhkD,EAAI,EAAGA,GAAKmkD,EAAmBnkD,IAExCokD,EAAWhgE,KAAMiM,EAAMg0D,KAAM,IAC7BD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,IAC7BokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,EAAI,SAQlC,IAAM,IAAIA,EAAI,EAAGA,EAAImkD,EAAmBnkD,IAElCA,EAAI,IAAM,GAEdokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,IAC7BokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,EAAI,IACjCokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,EAAI,MAKjCokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,EAAI,IACjCokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,EAAI,IACjCokD,EAAWhgE,KAAMiM,EAAMg0D,KAAMrkD,KAQzBokD,EAAW/1D,OAAS,IAAQ81D,GAElCxyD,QAAQC,MAAO,2FAMhB,MAAM0yD,EAAch4B,EAASn0B,QAG7B,OAFAmsD,EAAYxB,SAAUsB,GAEfE,I,mECvuIR,MAAMC,EAAkB,gBAElBC,EAA4B,WAE5BC,EAAwB,WAExBC,EAAmB,WAEnBC,EAAM,IAAI,MACVC,EAAM,IAAI,MACVC,EAAM,IAAI,MAEVC,EAAM,IAAI,MACVC,EAAM,IAAI,MAEhB,SAASC,IAER,MAAM5rD,EAAQ,CACbguC,QAAS,GACTpkD,OAAQ,GAERiiE,SAAU,GACVC,QAAS,GACT90B,OAAQ,GACRO,IAAK,GAEL/Q,UAAW,GACXulC,kBAAmB,GAEnBC,YAAa,SAAW3gE,EAAM4gE,GAI7B,GAAKjiE,KAAKJ,SAA0C,IAAhCI,KAAKJ,OAAOqiE,gBAI/B,OAFAjiE,KAAKJ,OAAOyB,KAAOA,OACnBrB,KAAKJ,OAAOqiE,iBAAwC,IAApBA,GAKjC,MAAMC,EAAqBliE,KAAKJ,QAAiD,oBAAhCI,KAAKJ,OAAOuiE,gBAAiCniE,KAAKJ,OAAOuiE,uBAAoBvgE,EA+H9H,GA7HK5B,KAAKJ,QAA2C,oBAA1BI,KAAKJ,OAAOwiE,WAEtCpiE,KAAKJ,OAAOwiE,WAAW,GAIxBpiE,KAAKJ,OAAS,CACbyB,KAAMA,GAAQ,GACd4gE,iBAAuC,IAApBA,EAEnB/4B,SAAU,CACT24B,SAAU,GACVC,QAAS,GACT90B,OAAQ,GACRO,IAAK,GACL80B,cAAc,GAEf7lC,UAAW,GACX8lC,QAAQ,EAERC,cAAe,SAAWlhE,EAAMmhE,GAE/B,MAAMC,EAAWziE,KAAKoiE,WAAW,GAI5BK,IAAcA,EAASC,WAAaD,EAASE,YAAc,IAE/D3iE,KAAKw8B,UAAU/4B,OAAQg/D,EAASx1D,MAAO,GAIxC,MAAMuzB,EAAW,CAChBvzB,MAAOjN,KAAKw8B,UAAUvxB,OACtB5J,KAAMA,GAAQ,GACduhE,OAAUv9D,MAAMC,QAASk9D,IAAeA,EAAUv3D,OAAS,EAAIu3D,EAAWA,EAAUv3D,OAAS,GAAM,GACnGq3D,YAAuB1gE,IAAb6gE,EAAyBA,EAASH,OAAStiE,KAAKsiE,OAC1DO,gBAA2BjhE,IAAb6gE,EAAyBA,EAASK,SAAW,EAC3DA,UAAY,EACZH,YAAc,EACdD,WAAW,EAEX3tD,MAAO,SAAW9H,GAEjB,MAAM81D,EAAS,CACd91D,MAA0B,kBAAVA,EAAqBA,EAAQjN,KAAKiN,MAClD5L,KAAMrB,KAAKqB,KACXuhE,OAAQ5iE,KAAK4iE,OACbN,OAAQtiE,KAAKsiE,OACbO,WAAY,EACZC,UAAY,EACZH,YAAc,EACdD,WAAW,GAGZ,OADAK,EAAOhuD,MAAQ/U,KAAK+U,MAAM3T,KAAM2hE,GACzBA,IAOT,OAFA/iE,KAAKw8B,UAAUx7B,KAAMw/B,GAEdA,GAIR2hC,gBAAiB,WAEhB,GAAKniE,KAAKw8B,UAAUvxB,OAAS,EAE5B,OAAOjL,KAAKw8B,UAAWx8B,KAAKw8B,UAAUvxB,OAAS,IAQjDm3D,UAAW,SAAW5/C,GAErB,MAAMwgD,EAAoBhjE,KAAKmiE,kBAU/B,GATKa,IAAsD,IAAjCA,EAAkBF,WAE3CE,EAAkBF,SAAW9iE,KAAKkpC,SAAS24B,SAAS52D,OAAS,EAC7D+3D,EAAkBL,WAAaK,EAAkBF,SAAWE,EAAkBH,WAC9EG,EAAkBN,WAAY,GAK1BlgD,GAAOxiB,KAAKw8B,UAAUvxB,OAAS,EAEnC,IAAM,IAAIg4D,EAAKjjE,KAAKw8B,UAAUvxB,OAAS,EAAGg4D,GAAM,EAAGA,IAE7CjjE,KAAKw8B,UAAWymC,GAAKN,YAAc,GAEvC3iE,KAAKw8B,UAAU/4B,OAAQw/D,EAAI,GAkB9B,OATKzgD,GAAiC,IAA1BxiB,KAAKw8B,UAAUvxB,QAE1BjL,KAAKw8B,UAAUx7B,KAAM,CACpBK,KAAM,GACNihE,OAAQtiE,KAAKsiE,SAKRU,IAWJd,GAAoBA,EAAiB7gE,MAA0C,oBAA3B6gE,EAAiBntD,MAAuB,CAEhG,MAAMmuD,EAAWhB,EAAiBntD,MAAO,GACzCmuD,EAASR,WAAY,EACrB1iE,KAAKJ,OAAO48B,UAAUx7B,KAAMkiE,GAI7BljE,KAAKgkD,QAAQhjD,KAAMhB,KAAKJ,SAIzBujE,SAAU,WAEJnjE,KAAKJ,QAA2C,oBAA1BI,KAAKJ,OAAOwiE,WAEtCpiE,KAAKJ,OAAOwiE,WAAW,IAMzBgB,iBAAkB,SAAW9/D,EAAO8iB,GAEnC,MAAMnZ,EAAQvI,SAAUpB,EAAO,IAC/B,OAAsD,GAA7C2J,GAAS,EAAIA,EAAQ,EAAIA,EAAQmZ,EAAM,IAIjDi9C,iBAAkB,SAAW//D,EAAO8iB,GAEnC,MAAMnZ,EAAQvI,SAAUpB,EAAO,IAC/B,OAAsD,GAA7C2J,GAAS,EAAIA,EAAQ,EAAIA,EAAQmZ,EAAM,IAIjDk9C,aAAc,SAAWhgE,EAAO8iB,GAE/B,MAAMnZ,EAAQvI,SAAUpB,EAAO,IAC/B,OAAsD,GAA7C2J,GAAS,EAAIA,EAAQ,EAAIA,EAAQmZ,EAAM,IAIjDm9C,UAAW,SAAWr5D,EAAGtE,EAAGyE,GAE3B,MAAMs/C,EAAM3pD,KAAK6hE,SACXx7C,EAAMrmB,KAAKJ,OAAOspC,SAAS24B,SAEjCx7C,EAAIrlB,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,IAC/Cmc,EAAIrlB,KAAM2oD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,IAC/CygB,EAAIrlB,KAAM2oD,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,KAIhDm5D,eAAgB,SAAWt5D,GAE1B,MAAMy/C,EAAM3pD,KAAK6hE,SACL7hE,KAAKJ,OAAOspC,SAAS24B,SAE7B7gE,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,KAIhDu5D,cAAe,SAAWv5D,GAEzB,MAAMy/C,EAAM3pD,KAAK6hE,SACL7hE,KAAKJ,OAAOspC,SAAS24B,SAE7B7gE,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,KAIhDw5D,UAAW,SAAWx5D,EAAGtE,EAAGyE,GAE3B,MAAMs/C,EAAM3pD,KAAK8hE,QACXz7C,EAAMrmB,KAAKJ,OAAOspC,SAAS44B,QAEjCz7C,EAAIrlB,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,IAC/Cmc,EAAIrlB,KAAM2oD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,IAC/CygB,EAAIrlB,KAAM2oD,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,KAIhDs5D,cAAe,SAAWz5D,EAAGtE,EAAGyE,GAE/B,MAAMs/C,EAAM3pD,KAAK6hE,SACXx7C,EAAMrmB,KAAKJ,OAAOspC,SAAS44B,QAEjCP,EAAIpgC,UAAWwoB,EAAKz/C,GACpBs3D,EAAIrgC,UAAWwoB,EAAK/jD,GACpB67D,EAAItgC,UAAWwoB,EAAKt/C,GAEpBs3D,EAAIvmD,WAAYqmD,EAAKD,GACrBE,EAAItmD,WAAYmmD,EAAKC,GACrBG,EAAIiC,MAAOlC,GAEXC,EAAI7nC,YAEJzT,EAAIrlB,KAAM2gE,EAAItvD,EAAGsvD,EAAIrvD,EAAGqvD,EAAI9wC,GAC5BxK,EAAIrlB,KAAM2gE,EAAItvD,EAAGsvD,EAAIrvD,EAAGqvD,EAAI9wC,GAC5BxK,EAAIrlB,KAAM2gE,EAAItvD,EAAGsvD,EAAIrvD,EAAGqvD,EAAI9wC,IAI7BpiB,SAAU,SAAWvE,EAAGtE,EAAGyE,GAE1B,MAAMs/C,EAAM3pD,KAAKgtC,OACX3mB,EAAMrmB,KAAKJ,OAAOspC,SAAS8D,YAEfprC,IAAb+nD,EAAKz/C,IAAoBmc,EAAIrlB,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,SAC3DtI,IAAb+nD,EAAK/jD,IAAoBygB,EAAIrlB,KAAM2oD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,SAC3DhE,IAAb+nD,EAAKt/C,IAAoBgc,EAAIrlB,KAAM2oD,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,KAI9Ew5D,MAAO,SAAW35D,EAAGtE,EAAGyE,GAEvB,MAAMs/C,EAAM3pD,KAAKutC,IACXlnB,EAAMrmB,KAAKJ,OAAOspC,SAASqE,IAEjClnB,EAAIrlB,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,IACjCmc,EAAIrlB,KAAM2oD,EAAK/jD,EAAI,GAAK+jD,EAAK/jD,EAAI,IACjCygB,EAAIrlB,KAAM2oD,EAAKt/C,EAAI,GAAKs/C,EAAKt/C,EAAI,KAIlCy5D,aAAc,WAEb,MAAMz9C,EAAMrmB,KAAKJ,OAAOspC,SAASqE,IAEjClnB,EAAIrlB,KAAM,EAAG,GACbqlB,EAAIrlB,KAAM,EAAG,GACbqlB,EAAIrlB,KAAM,EAAG,IAId+iE,UAAW,SAAW75D,GAErB,MAAMy/C,EAAM3pD,KAAKutC,IACLvtC,KAAKJ,OAAOspC,SAASqE,IAE7BvsC,KAAM2oD,EAAKz/C,EAAI,GAAKy/C,EAAKz/C,EAAI,KAIlC85D,QAAS,SAAW95D,EAAGtE,EAAGyE,EAAG45D,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAEhD,MAAMC,EAAOvkE,KAAK6hE,SAAS52D,OAE3B,IAAIu5D,EAAKxkE,KAAKojE,iBAAkBl5D,EAAGq6D,GAC/BjN,EAAKt3D,KAAKojE,iBAAkBx9D,EAAG2+D,GAC/BE,EAAKzkE,KAAKojE,iBAAkB/4D,EAAGk6D,GAOnC,GALAvkE,KAAKujE,UAAWiB,EAAIlN,EAAImN,GACxBzkE,KAAKyO,SAAU+1D,EAAIlN,EAAImN,QAIX7iE,IAAPwiE,GAA2B,KAAPA,EAAY,CAEpC,MAAMM,EAAO1kE,KAAK8hE,QAAQ72D,OAE1Bu5D,EAAKxkE,KAAKqjE,iBAAkBe,EAAIM,GAChCpN,EAAKt3D,KAAKqjE,iBAAkBgB,EAAIK,GAChCD,EAAKzkE,KAAKqjE,iBAAkBiB,EAAII,GAEhC1kE,KAAK0jE,UAAWc,EAAIlN,EAAImN,QAIxBzkE,KAAK2jE,cAAea,EAAIlN,EAAImN,GAM7B,QAAY7iE,IAAPqiE,GAA2B,KAAPA,EAAY,CAEpC,MAAMU,EAAQ3kE,KAAKutC,IAAItiC,OAEvBu5D,EAAKxkE,KAAKsjE,aAAcW,EAAIU,GAC5BrN,EAAKt3D,KAAKsjE,aAAcY,EAAIS,GAC5BF,EAAKzkE,KAAKsjE,aAAca,EAAIQ,GAE5B3kE,KAAK6jE,MAAOW,EAAIlN,EAAImN,GAEpBzkE,KAAKJ,OAAOspC,SAASm5B,cAAe,OAMpCriE,KAAK8jE,gBAMPc,iBAAkB,SAAW/C,GAE5B7hE,KAAKJ,OAAOspC,SAASv3B,KAAO,SAE5B,MAAM4yD,EAAOvkE,KAAK6hE,SAAS52D,OAE3B,IAAM,IAAI45D,EAAK,EAAG5lD,EAAI4iD,EAAS52D,OAAQ45D,EAAK5lD,EAAG4lD,IAAQ,CAEtD,MAAM53D,EAAQjN,KAAKojE,iBAAkBvB,EAAUgD,GAAMN,GAErDvkE,KAAKwjE,eAAgBv2D,GACrBjN,KAAKyO,SAAUxB,KAMjB63D,gBAAiB,SAAWjD,EAAUt0B,GAErCvtC,KAAKJ,OAAOspC,SAASv3B,KAAO,OAE5B,MAAM4yD,EAAOvkE,KAAK6hE,SAAS52D,OACrB05D,EAAQ3kE,KAAKutC,IAAItiC,OAEvB,IAAM,IAAI45D,EAAK,EAAG5lD,EAAI4iD,EAAS52D,OAAQ45D,EAAK5lD,EAAG4lD,IAE9C7kE,KAAKyjE,cAAezjE,KAAKojE,iBAAkBvB,EAAUgD,GAAMN,IAI5D,IAAM,IAAIQ,EAAM,EAAG9lD,EAAIsuB,EAAItiC,OAAQ85D,EAAM9lD,EAAG8lD,IAE3C/kE,KAAK+jE,UAAW/jE,KAAKsjE,aAAc/1B,EAAKw3B,GAAOJ,MAUlD,OAFA3uD,EAAMgsD,YAAa,IAAI,GAEhBhsD,EAMR,MAAMgvD,UAAkB,MAEvBtlE,YAAay6B,GAEZj2B,MAAOi2B,GAEPn6B,KAAKw8B,UAAY,KAIlBj5B,KAAM62B,EAAKC,EAAQC,EAAYC,GAE9B,MAAM7pB,EAAQ1Q,KAERy6B,EAAS,IAAI,MAAYz6B,KAAKm6B,SACpCM,EAAOC,QAAS16B,KAAKw6B,MACrBC,EAAOG,iBAAkB56B,KAAK66B,eAC9BJ,EAAOK,mBAAoB96B,KAAK+6B,iBAChCN,EAAOl3B,KAAM62B,GAAK,SAAWqB,GAE5B,IAECpB,EAAQ3pB,EAAMsqB,MAAOS,IAEpB,MAAQ13B,GAEJw2B,EAEJA,EAASx2B,GAITwK,QAAQC,MAAOzK,GAIhB2M,EAAMypB,QAAQc,UAAWb,MAIxBE,EAAYC,GAIhB0qC,aAAczoC,GAIb,OAFAx8B,KAAKw8B,UAAYA,EAEVx8B,KAIRg7B,MAAOS,GAEN,MAAMzlB,EAAQ,IAAI4rD,GAEgB,IAA7BnmC,EAAK/3B,QAAS,UAGlB+3B,EAAOA,EAAKpS,QAAS,QAAS,QAIG,IAA7BoS,EAAK/3B,QAAS,UAGlB+3B,EAAOA,EAAKpS,QAAS,QAAS,KAI/B,MAAM67C,EAAQzpC,EAAKnS,MAAO,MAC1B,IAAIswB,EAAO,GAAIurB,EAAgB,GAC3BC,EAAa,EACb3gE,EAAS,GAGb,MAAM4gE,EAAoC,mBAAhB,GAAGA,SAE7B,IAAM,IAAIzoD,EAAI,EAAGqC,EAAIimD,EAAMj6D,OAAQ2R,EAAIqC,EAAGrC,IAQzC,GANAg9B,EAAOsrB,EAAOtoD,GAEdg9B,EAAOyrB,EAAWzrB,EAAKyrB,WAAazrB,EAAKU,OAEzC8qB,EAAaxrB,EAAK3uC,OAEE,IAAfm6D,IAELD,EAAgBvrB,EAAK0rB,OAAQ,GAGN,MAAlBH,GAEL,GAAuB,MAAlBA,EAAwB,CAE5B,MAAM/6C,EAAOwvB,EAAKtwB,MAAO,OAEzB,OAASc,EAAM,IAEd,IAAK,IACJpU,EAAM6rD,SAAS7gE,KACdoH,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,KAEdA,EAAKnf,QAAU,EAEnB+K,EAAMg3B,OAAOhsC,KACZoH,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,KAQnBpU,EAAMg3B,OAAOhsC,UAAMY,OAAWA,OAAWA,GAI1C,MACD,IAAK,KACJoU,EAAM8rD,QAAQ9gE,KACboH,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,KAEnB,MACD,IAAK,KACJpU,EAAMu3B,IAAIvsC,KACToH,WAAYgiB,EAAM,IAClBhiB,WAAYgiB,EAAM,WAMf,GAAuB,MAAlB+6C,EAAwB,CAEnC,MACMI,EADW3rB,EAAK4rB,OAAQ,GAAIlrB,OACNhxB,MAAO,OAC7Bm8C,EAAe,GAIrB,IAAM,IAAIpnD,EAAI,EAAG8/C,EAAKoH,EAAWt6D,OAAQoT,EAAI8/C,EAAI9/C,IAAO,CAEvD,MAAM0uB,EAASw4B,EAAYlnD,GAE3B,GAAK0uB,EAAO9hC,OAAS,EAAI,CAExB,MAAMy6D,EAAc34B,EAAOzjB,MAAO,KAClCm8C,EAAazkE,KAAM0kE,IAQrB,MAAMC,EAAKF,EAAc,GAEzB,IAAM,IAAIpnD,EAAI,EAAG8/C,EAAKsH,EAAax6D,OAAS,EAAGoT,EAAI8/C,EAAI9/C,IAAO,CAE7D,MAAMunD,EAAKH,EAAcpnD,GACnBwnD,EAAKJ,EAAcpnD,EAAI,GAE7BrI,EAAMguD,QACL2B,EAAI,GAAKC,EAAI,GAAKC,EAAI,GACtBF,EAAI,GAAKC,EAAI,GAAKC,EAAI,GACtBF,EAAI,GAAKC,EAAI,GAAKC,EAAI,UAKlB,GAAuB,MAAlBV,EAAwB,CAEnC,MAAMW,EAAYlsB,EAAKz0C,UAAW,GAAIm1C,OAAOhxB,MAAO,KACpD,IAAIy8C,EAAe,GACnB,MAAMC,EAAU,GAEhB,IAA+B,IAA1BpsB,EAAKl2C,QAAS,KAElBqiE,EAAeD,OAIf,IAAM,IAAIphD,EAAK,EAAGuhD,EAAOH,EAAU76D,OAAQyZ,EAAKuhD,EAAMvhD,IAAQ,CAE7D,MAAMwhD,EAAQJ,EAAWphD,GAAK4E,MAAO,KAEjB,KAAf48C,EAAO,IAAaH,EAAa/kE,KAAMklE,EAAO,IAC/B,KAAfA,EAAO,IAAaF,EAAQhlE,KAAMklE,EAAO,IAMhDlwD,EAAM8uD,gBAAiBiB,EAAcC,QAE/B,GAAuB,MAAlBb,EAAwB,CAEnC,MACMgB,EADWvsB,EAAK4rB,OAAQ,GAAIlrB,OACPhxB,MAAO,KAElCtT,EAAM4uD,iBAAkBuB,QAElB,GAAmD,QAA5C1hE,EAAS08D,EAAgBiF,KAAMxsB,IAAoB,CAQhE,MAAMv4C,GAAS,IAAMoD,EAAQ,GAAI+gE,OAAQ,GAAIlrB,QAASkrB,OAAQ,GAE9DxvD,EAAMgsD,YAAa3gE,QAEb,GAAKggE,EAAsBvN,KAAMla,GAIvC5jC,EAAMpW,OAAO2iE,cAAe3oB,EAAKz0C,UAAW,GAAIm1C,OAAQtkC,EAAM+rD,wBAExD,GAAKX,EAA0BtN,KAAMla,GAI3C5jC,EAAM+rD,kBAAkB/gE,KAAM44C,EAAKz0C,UAAW,GAAIm1C,aAE5C,GAAKgnB,EAAiBxN,KAAMla,GAKlCrrC,QAAQwE,KAAM,6GAER,GAAuB,MAAlBoyD,EAAwB,CAwBnC,GAtBA1gE,EAASm1C,EAAKtwB,MAAO,KAsBhB7kB,EAAOwG,OAAS,EAAI,CAExB,MAAM3H,EAAQmB,EAAQ,GAAI61C,OAAOxb,cACjC9oB,EAAMpW,OAAO0iE,OAAqB,MAAVh/D,GAA2B,QAAVA,OAKzC0S,EAAMpW,OAAO0iE,QAAS,EAIvB,MAAM9hC,EAAWxqB,EAAMpW,OAAOuiE,kBACzB3hC,IAAWA,EAAS8hC,OAAStsD,EAAMpW,OAAO0iE,YAEzC,CAGN,GAAc,OAAT1oB,EAAgB,SAErBrrC,QAAQwE,KAAM,sCAAwC6mC,EAAO,KAM/D5jC,EAAMmtD,WAEN,MAAM71D,EAAY,IAAI,MACtBA,EAAUy0D,kBAAoB,GAAGtyD,OAAQuG,EAAM+rD,mBAI/C,IAAuB,MAF4B,IAAzB/rD,EAAMguC,QAAQ/4C,QAAgE,IAAhD+K,EAAMguC,QAAS,GAAI9a,SAAS24B,SAAS52D,QAI5F,IAAM,IAAI2R,EAAI,EAAGqC,EAAIjJ,EAAMguC,QAAQ/4C,OAAQ2R,EAAIqC,EAAGrC,IAAO,CAExD,MAAMhd,EAASoW,EAAMguC,QAASpnC,GACxBssB,EAAWtpC,EAAOspC,SAClB1M,EAAY58B,EAAO48B,UACnBk9B,EAA6B,SAAlBxwB,EAASv3B,KACpB2nD,EAA+B,WAAlBpwB,EAASv3B,KAC5B,IAAI00D,GAAkB,EAGtB,GAAkC,IAA7Bn9B,EAAS24B,SAAS52D,OAAe,SAEtC,MAAMq7D,EAAiB,IAAI,MAE3BA,EAAeliE,aAAc,WAAY,IAAI,MAAwB8kC,EAAS24B,SAAU,IAEnF34B,EAAS44B,QAAQ72D,OAAS,GAE9Bq7D,EAAeliE,aAAc,SAAU,IAAI,MAAwB8kC,EAAS44B,QAAS,IAIjF54B,EAAS8D,OAAO/hC,OAAS,IAE7Bo7D,GAAkB,EAClBC,EAAeliE,aAAc,QAAS,IAAI,MAAwB8kC,EAAS8D,OAAQ,MAIrD,IAA1B9D,EAASm5B,cAEbiE,EAAeliE,aAAc,KAAM,IAAI,MAAwB8kC,EAASqE,IAAK,IAM9E,MAAMg5B,EAAmB,GAEzB,IAAM,IAAItD,EAAK,EAAGuD,EAAQhqC,EAAUvxB,OAAQg4D,EAAKuD,EAAOvD,IAAQ,CAE/D,MAAMwD,EAAiBjqC,EAAWymC,GAC5ByD,EAAeD,EAAeplE,KAAO,IAAMolE,EAAenE,OAAS,IAAM+D,EAC/E,IAAI7lC,EAAWxqB,EAAMwmB,UAAWkqC,GAEhC,GAAwB,OAAnB1mE,KAAKw8B,UAKT,GAHAgE,EAAWxgC,KAAKw8B,UAAUmqC,OAAQF,EAAeplE,OAG5Cq4D,IAAUl5B,GAAgBA,aAAoB,OAO5C,GAAK84B,GAAY94B,KAAgBA,aAAoB,OAAmB,CAE9E,MAAMomC,EAAiB,IAAI,MAAgB,CAAEl7C,KAAM,GAAI+tC,iBAAiB,IACxE,0BAA8BmN,EAAgBpmC,GAC9ComC,EAAe1lC,MAAM3vB,KAAMivB,EAASU,OACpC0lC,EAAelkC,IAAMlC,EAASkC,IAC9BlC,EAAWomC,OAb6D,CAExE,MAAMC,EAAe,IAAI,MACzB,0BAA8BA,EAAcrmC,GAC5CqmC,EAAa3lC,MAAM3vB,KAAMivB,EAASU,OAClCV,EAAWqmC,OAcKjlE,IAAb4+B,IAIHA,EAFIk5B,EAEO,IAAI,MAEJJ,EAEA,IAAI,MAAgB,CAAE5tC,KAAM,EAAG+tC,iBAAiB,IAIhD,IAAI,MAIhBj5B,EAASn/B,KAAOolE,EAAeplE,KAC/Bm/B,EAASq5B,aAAc4M,EAAenE,OACtC9hC,EAAS4I,aAAei9B,EAExBrwD,EAAMwmB,UAAWkqC,GAAiBlmC,GAInC+lC,EAAiBvlE,KAAMw/B,GAMxB,IAAIkyB,EAEJ,GAAK6T,EAAiBt7D,OAAS,EAAI,CAElC,IAAM,IAAIg4D,EAAK,EAAGuD,EAAQhqC,EAAUvxB,OAAQg4D,EAAKuD,EAAOvD,IAAQ,CAE/D,MAAMwD,EAAiBjqC,EAAWymC,GAClCqD,EAAex4B,SAAU24B,EAAe5D,WAAY4D,EAAe9D,WAAYM,GAM/EvQ,EAFIgH,EAEG,IAAI,MAAc4M,EAAgBC,GAE9BjN,EAEJ,IAAI,MAAQgN,EAAgBC,GAI5B,IAAI,MAAMD,EAAgBC,QAQjC7T,EAFIgH,EAEG,IAAI,MAAc4M,EAAgBC,EAAkB,IAEhDjN,EAEJ,IAAI,MAAQgN,EAAgBC,EAAkB,IAI9C,IAAI,MAAMD,EAAgBC,EAAkB,IAMrD7T,EAAKrxD,KAAOzB,EAAOyB,KAEnBiM,EAAU9M,IAAKkyD,QAQhB,GAAK18C,EAAM6rD,SAAS52D,OAAS,EAAI,CAEhC,MAAMu1B,EAAW,IAAI,MAAgB,CAAE9U,KAAM,EAAG+tC,iBAAiB,IAE3D6M,EAAiB,IAAI,MAE3BA,EAAeliE,aAAc,WAAY,IAAI,MAAwB4R,EAAM6rD,SAAU,IAEhF7rD,EAAMg3B,OAAO/hC,OAAS,QAA2BrJ,IAAtBoU,EAAMg3B,OAAQ,KAE7Cs5B,EAAeliE,aAAc,QAAS,IAAI,MAAwB4R,EAAMg3B,OAAQ,IAChFxM,EAAS4I,cAAe,GAIzB,MAAM6J,EAAS,IAAI,MAAQqzB,EAAgB9lC,GAC3ClzB,EAAU9M,IAAKyyC,GAMjB,OAAO3lC,K,0FCr3BT,MAAMw5D,UAAkB,MAEvBpnE,cAECwE,MAAO4iE,EAAU96B,SAAU,IAAI,MAAmB,CAAEnK,QAAS,EAAGC,aAAa,KAE7E9hC,KAAK2R,KAAO,YACZ3R,KAAK+mE,eAAgB,EACrB/mE,KAAKgnE,YAAc9zD,EAAAA,EAInB,MAAM+zD,EAAiB,IAAI,MACrBC,EAAe,IAAI,MAInBC,EAAU,IAAI,MAAa,IAAIzpD,WAAY,KAAe,GAAI,GAAI,OACxEypD,EAAQrO,UAAY,MACpBqO,EAAQtO,UAAY,MACpBsO,EAAQpnC,MAAQ,MAChBonC,EAAQnnC,MAAQ,MAEhB,MAAMonC,EAAe,IAAI,MAAa,IAAI1pD,WAAY,KAAe,GAAI,GAAI,OAC7E0pD,EAAatO,UAAY,MACzBsO,EAAavO,UAAY,MACzBuO,EAAarnC,MAAQ,MACrBqnC,EAAapnC,MAAQ,MAIrB,MAAMkJ,EAAW49B,EAAU96B,SAErBq7B,EAAa,IAAI,MAAmB,CACzCra,SAAU,CACT,MAAS,CAAE1pD,MAAO,MAClB,eAAkB,CAAEA,MAAO,OAE5BgkE,aAAwB,uRAexB9Z,eAA0B,mIAS1BkO,WAAW,EACXjB,YAAY,EACZ34B,aAAa,IAGRylC,EAAa,IAAI,MAAmB,CACzCva,SAAU,CACT,IAAO,CAAE1pD,MAAO6jE,GAChB,MAAS,CAAE7jE,MAAO,MAClB,eAAkB,CAAEA,MAAO,OAE5BgkE,aAAwB,uWAoBxB9Z,eAA0B,6LAa1BkO,WAAW,EACXjB,YAAY,EACZ34B,aAAa,IAKR0lC,EAAQ,IAAI,MAAMt+B,EAAUm+B,GAI5BI,EAAW,GAEXna,EAASoa,EAAiBC,OAE1BC,EAAY,IAAI,MAAmB,CACxC5a,SAAU,CACT,IAAO,CAAE1pD,MAAO,MAChB,aAAgB,CAAEA,MAAO8jE,GACzB,MAAS,CAAE9jE,MAAO,IAAI,MAAO,WAC7B,MAAS,CAAEA,MAAO,IAAI,OACtB,eAAkB,CAAEA,MAAO,IAAI,QAEhCgkE,aAAcha,EAAOga,aACrB9Z,eAAgBF,EAAOE,eACvBqa,SAAU,MACV/lC,aAAa,EACb24B,YAAY,IAGPqN,EAAQ,IAAI,MAAM5+B,EAAU0+B,GAElC5nE,KAAK+nE,WAAa,SAAWjuD,GAE5B2tD,EAASzmE,KAAM8Y,IAMhB,MAAM5C,EAAQ,IAAI,MACZ8wD,EAAuB,IAAI,MAC3BC,EAAY,IAAI,MAChBC,EAAW,IAAI,MAErBloE,KAAKmoE,eAAiB,SAAWC,EAAU9T,EAAOe,GAEjD+S,EAASC,mBAAoBH,GAE7B,MAAMI,EAAYJ,EAASjkD,EAAIikD,EAASr3C,EAClC03C,EAAoBL,EAASr3C,EAAI,EACjC23C,EAAqBN,EAASjkD,EAAI,EAExC,IAAIyH,EAAO,GAAKw8C,EAASjkD,EAWzB,GAVA/M,EAAMM,IAAKkU,EAAO48C,EAAW58C,GAE7Bu8C,EAAUplE,IAAI2U,IAAK0wD,EAAS71D,EAAG61D,EAAS51D,GACxC21D,EAAUnlE,IAAI0U,IAAK0wD,EAAS71D,GAAM61D,EAASr3C,EAAI,IAAMq3C,EAAS51D,GAAM41D,EAASjkD,EAAI,KAIjFijD,EAAaj1D,sBAAuBjS,KAAKkS,aACzCg1D,EAAaz1D,aAAc4jD,EAAOoT,sBAE7BvB,EAAar2C,EAAI,KAEtBo2C,EAAe11D,KAAM21D,GAAez1D,aAAc4jD,EAAOqT,kBAIzDV,EAAqB31D,EAAI61D,EAAS71D,EAAM40D,EAAe50D,EAAIk2D,EAAsBA,EAAoB,EACrGP,EAAqB11D,EAAI41D,EAAS51D,EAAM20D,EAAe30D,EAAIk2D,EAAuBA,EAAqB,EAIlGP,EAAUU,cAAeX,IAAyB,CAItDI,EAASQ,yBAA0BZ,EAAsBb,GAIzD,IAAIna,EAAWqa,EAAWra,SAC1BA,EAAkB,MAAE1pD,MAAQ4T,EAC5B81C,EAA2B,eAAE1pD,MAAQ2jE,EAErCmB,EAASS,mBAAoBxT,EAAQ,KAAMnsB,EAAUm+B,EAAYG,EAAO,MAIxEY,EAASQ,yBAA0BZ,EAAsBZ,GAIzDpa,EAAWua,EAAWva,SACtBA,EAAkB,MAAE1pD,MAAQ4T,EAC5B81C,EAA2B,eAAE1pD,MAAQ2jE,EAErCmB,EAASS,mBAAoBxT,EAAQ,KAAMnsB,EAAUq+B,EAAYC,EAAO,MAIxE,MAAMsB,EAA4B,GAAnB7B,EAAe50D,EACxB02D,EAA4B,GAAnB9B,EAAe30D,EAE9B,IAAM,IAAIsK,EAAI,EAAGqC,EAAIwoD,EAASx8D,OAAQ2R,EAAIqC,EAAGrC,IAAO,CAEnD,MAAM9C,EAAU2tD,EAAU7qD,GAEpBowC,EAAW4a,EAAU5a,SAE3BA,EAAkB,MAAE1pD,MAAMiO,KAAMuI,EAAQonB,OACxC8rB,EAAgB,IAAE1pD,MAAQwW,EAAQslB,QAClC4tB,EAA2B,eAAE1pD,MAAM+O,EAAI40D,EAAe50D,EAAIy2D,EAAOhvD,EAAQN,SACzEwzC,EAA2B,eAAE1pD,MAAMgP,EAAI20D,EAAe30D,EAAIy2D,EAAOjvD,EAAQN,SAEzEkS,EAAO5R,EAAQ4R,KAAOw8C,EAASjkD,EAC/B,MAAMqkD,EAAYJ,EAASjkD,EAAIikD,EAASr3C,EAExCm8B,EAAkB,MAAE1pD,MAAMkU,IAAKkU,EAAO48C,EAAW58C,GAEjDk8C,EAAUoB,oBAAqB,EAE/BZ,EAASS,mBAAoBxT,EAAQ,KAAMnsB,EAAU0+B,EAAWE,EAAO,SAQ1E9nE,KAAKwS,QAAU,WAEd60D,EAAW70D,UACX+0D,EAAW/0D,UACXo1D,EAAUp1D,UAEV20D,EAAQ30D,UACR40D,EAAa50D,UAEb,IAAM,IAAIoK,EAAI,EAAGqC,EAAIwoD,EAASx8D,OAAQ2R,EAAIqC,EAAGrC,IAE5C6qD,EAAU7qD,GAAIwiB,QAAQ5sB,YAU1Bs0D,EAAUt9C,UAAUy/C,aAAc,EAIlC,MAAMvB,EAELhoE,YAAa0/B,EAAS1T,EAAO,EAAGlS,EAAW,EAAG0nB,EAAQ,IAAI,MAAO,WAEhElhC,KAAKo/B,QAAUA,EACfp/B,KAAK0rB,KAAOA,EACZ1rB,KAAKwZ,SAAWA,EAChBxZ,KAAKkhC,MAAQA,GAMfwmC,EAAiBC,OAAS,CAEzB3a,SAAU,CAET,IAAO,CAAE1pD,MAAO,MAChB,aAAgB,CAAEA,MAAO,MACzB,MAAS,CAAEA,MAAO,MAClB,MAAS,CAAEA,MAAO,MAClB,eAAkB,CAAEA,MAAO,OAI5BgkE,aAAwB,gpCAuCxB9Z,eAA0B,iUAqB3BsZ,EAAU96B,SAAW,WAEpB,MAAM9C,EAAW,IAAI,MAEfggC,EAAe,IAAI73B,aAAc,EACpC,GAAK,EAAG,EAAG,EAAG,EAChB,GAAK,EAAG,EAAG,EAAG,EACd,EAAG,EAAG,EAAG,EAAG,GACV,EAAG,EAAG,EAAG,EAAG,IAGT83B,EAAoB,IAAI,MAAmBD,EAAc,GAM/D,OAJAhgC,EAASw2B,SAAU,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,IACpCx2B,EAAS9kC,aAAc,WAAY,IAAI,MAA4B+kE,EAAmB,EAAG,GAAG,IAC5FjgC,EAAS9kC,aAAc,KAAM,IAAI,MAA4B+kE,EAAmB,EAAG,GAAG,IAE/EjgC,EAjBa","sources":["webpack://_N_E/./node_modules/lil-gui/dist/lil-gui.esm.js","webpack://_N_E/./node_modules/three/examples/jsm/controls/DragControls.js","webpack://_N_E/./node_modules/three/examples/jsm/controls/OrbitControls.js","webpack://_N_E/./node_modules/three/examples/jsm/libs/fflate.module.js","webpack://_N_E/./node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack://_N_E/./node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack://_N_E/./node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack://_N_E/./node_modules/three/examples/jsm/loaders/GLTFLoader.js","webpack://_N_E/./node_modules/three/examples/jsm/loaders/OBJLoader.js","webpack://_N_E/./node_modules/three/examples/jsm/objects/Lensflare.js"],"sourcesContent":["/**\n * lil-gui\n * https://lil-gui.georgealways.com\n * @version 0.15.0\n * @author George Michael Brower\n * @license MIT\n */\n\n/**\n * Base class for all controllers.\n */\nclass Controller {\n\n\tconstructor( parent, object, property, className, widgetTag = 'div' ) {\n\n\t\t/**\n\t\t * The GUI that contains this controller.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.parent = parent;\n\n\t\t/**\n\t\t * The object this controller will modify.\n\t\t * @type {object}\n\t\t */\n\t\tthis.object = object;\n\n\t\t/**\n\t\t * The name of the property to control.\n\t\t * @type {string}\n\t\t */\n\t\tthis.property = property;\n\n\t\t/**\n\t\t * Used to determine if the controller is disabled.\n\t\t * Use `controller.disable( true|false )` to modify this value\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._disabled = false;\n\n\t\t/**\n\t\t * The value of `object[ property ]` when the controller was created.\n\t\t * @type {any}\n\t\t */\n\t\tthis.initialValue = this.getValue();\n\n\t\t/**\n\t\t * The outermost container DOM element for this controller.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.domElement = document.createElement( 'div' );\n\t\tthis.domElement.classList.add( 'controller' );\n\t\tthis.domElement.classList.add( className );\n\n\t\t/**\n\t\t * The DOM element that contains the controller's name.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$name = document.createElement( 'div' );\n\t\tthis.$name.classList.add( 'name' );\n\n\t\tController.nextNameID = Controller.nextNameID || 0;\n\t\tthis.$name.id = `lil-gui-name-${++Controller.nextNameID}`;\n\n\t\t/**\n\t\t * The DOM element that contains the controller's \"widget\" (which differs by controller type).\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$widget = document.createElement( widgetTag );\n\t\tthis.$widget.classList.add( 'widget' );\n\n\t\t/**\n\t\t * The DOM element that receives the disabled attribute when using disable()\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$disable = this.$widget;\n\n\t\tthis.domElement.appendChild( this.$name );\n\t\tthis.domElement.appendChild( this.$widget );\n\n\t\tthis.parent.children.push( this );\n\t\tthis.parent.controllers.push( this );\n\n\t\tthis.parent.$children.appendChild( this.domElement );\n\n\t\tthis._listenCallback = this._listenCallback.bind( this );\n\n\t\tthis.name( property );\n\n\t}\n\n\t/**\n\t * Sets the name of the controller and its label in the GUI.\n\t * @param {string} name\n\t * @returns {this}\n\t */\n\tname( name ) {\n\t\t/**\n\t\t * The controller's name. Use `controller.name( 'Name' )` to modify this value.\n\t\t * @type {string}\n\t\t */\n\t\tthis._name = name;\n\t\tthis.$name.innerHTML = name;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Pass a function to be called whenever the value is modified by this controller.\n\t * The function receives the new value as its first parameter. The value of `this` will be the\n\t * controller.\n\t * @param {Function} callback\n\t * @returns {this}\n\t * @example\n\t * const controller = gui.add( object, 'property' );\n\t *\n\t * controller.onChange( function( v ) {\n\t * \tconsole.log( 'The value is now ' + v );\n\t * \tconsole.assert( this === controller );\n\t * } );\n\t */\n\tonChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onChange` events. Don't modify this value directly.\n\t\t * Use the `controller.onChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onChange = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Calls the onChange methods of this controller and its parent GUI.\n\t * @protected\n\t */\n\t_callOnChange() {\n\n\t\tthis.parent._callOnChange( this );\n\n\t\tif ( this._onChange !== undefined ) {\n\t\t\tthis._onChange.call( this, this.getValue() );\n\t\t}\n\n\t\tthis._changed = true;\n\n\t}\n\n\t/**\n\t * Pass a function to be called after this controller has been modified and loses focus.\n\t * @param {Function} callback\n\t * @returns {this}\n\t * @example\n\t * const controller = gui.add( object, 'property' );\n\t *\n\t * controller.onFinishChange( function( v ) {\n\t * \tconsole.log( 'Changes complete: ' + v );\n\t * \tconsole.assert( this === controller );\n\t * } );\n\t */\n\tonFinishChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onFinishChange` events. Don't modify this value\n\t\t * directly. Use the `controller.onFinishChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onFinishChange = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Should be called by Controller when its widgets lose focus.\n\t * @protected\n\t */\n\t_callOnFinishChange() {\n\n\t\tif ( this._changed ) {\n\n\t\t\tthis.parent._callOnFinishChange( this );\n\n\t\t\tif ( this._onFinishChange !== undefined ) {\n\t\t\t\tthis._onFinishChange.call( this, this.getValue() );\n\t\t\t}\n\n\t\t}\n\n\t\tthis._changed = false;\n\n\t}\n\n\t/**\n\t * Sets the controller back to its initial value.\n\t * @returns {this}\n\t */\n\treset() {\n\t\tthis.setValue( this.initialValue );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Enables this controller.\n\t * @param {boolean} enabled\n\t * @returns {this}\n\t * @example\n\t * controller.enable();\n\t * controller.enable( false ); // disable\n\t * controller.enable( controller._disabled ); // toggle\n\t */\n\tenable( enabled = true ) {\n\t\treturn this.disable( !enabled );\n\t}\n\n\t/**\n\t * Disables this controller.\n\t * @param {boolean} disabled\n\t * @returns {this}\n\t * @example\n\t * controller.disable();\n\t * controller.disable( false ); // enable\n\t * controller.disable( !controller._disabled ); // toggle\n\t */\n\tdisable( disabled = true ) {\n\n\t\tif ( disabled === this._disabled ) return this;\n\n\t\tthis._disabled = disabled;\n\n\t\tthis.domElement.classList.toggle( 'disabled', disabled );\n\t\tthis.$disable.toggleAttribute( 'disabled', disabled );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Destroys this controller and replaces it with a new option controller. Provided as a more\n\t * descriptive syntax for `gui.add`, but primarily for compatibility with dat.gui.\n\t *\n\t * Use caution, as this method will destroy old references to this controller. It will also\n\t * change controller order if called out of sequence, moving the option controller to the end of\n\t * the GUI.\n\t * @example\n\t * // safe usage\n\t *\n\t * gui.add( object1, 'property' ).options( [ 'a', 'b', 'c' ] );\n\t * gui.add( object2, 'property' );\n\t *\n\t * // danger\n\t *\n\t * const c = gui.add( object1, 'property' );\n\t * gui.add( object2, 'property' );\n\t *\n\t * c.options( [ 'a', 'b', 'c' ] );\n\t * // controller is now at the end of the GUI even though it was added first\n\t *\n\t * assert( c.parent.children.indexOf( c ) === -1 )\n\t * // c references a controller that no longer exists\n\t *\n\t * @param {object|Array} options\n\t * @returns {Controller}\n\t */\n\toptions( options ) {\n\t\tconst controller = this.parent.add( this.object, this.property, options );\n\t\tcontroller.name( this._name );\n\t\tthis.destroy();\n\t\treturn controller;\n\t}\n\n\t/**\n\t * Sets the minimum value. Only works on number controllers.\n\t * @param {number} min\n\t * @returns {this}\n\t */\n\tmin( min ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the maximum value. Only works on number controllers.\n\t * @param {number} max\n\t * @returns {this}\n\t */\n\tmax( max ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the step. Only works on number controllers.\n\t * @param {number} step\n\t * @returns {this}\n\t */\n\tstep( step ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Calls `updateDisplay()` every animation frame. Pass `false` to stop listening.\n\t * @param {boolean} listen\n\t * @returns {this}\n\t */\n\tlisten( listen = true ) {\n\n\t\t/**\n\t\t * Used to determine if the controller is currently listening. Don't modify this value\n\t\t * directly. Use the `controller.listen( true|false )` method instead.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._listening = listen;\n\n\t\tif ( this._listenCallbackID !== undefined ) {\n\t\t\tcancelAnimationFrame( this._listenCallbackID );\n\t\t\tthis._listenCallbackID = undefined;\n\t\t}\n\n\t\tif ( this._listening ) {\n\t\t\tthis._listenCallback();\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t_listenCallback() {\n\t\tthis._listenCallbackID = requestAnimationFrame( this._listenCallback );\n\t\tthis.updateDisplay();\n\t}\n\n\t/**\n\t * Returns `object[ property ]`.\n\t * @returns {any}\n\t */\n\tgetValue() {\n\t\treturn this.object[ this.property ];\n\t}\n\n\t/**\n\t * Sets the value of `object[ property ]`, invokes any `onChange` handlers and updates the display.\n\t * @param {any} value\n\t * @returns {this}\n\t */\n\tsetValue( value ) {\n\t\tthis.object[ this.property ] = value;\n\t\tthis._callOnChange();\n\t\tthis.updateDisplay();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Updates the display to keep it in sync with the current value. Useful for updating your\n\t * controllers when their values have been modified outside of the GUI.\n\t * @returns {this}\n\t */\n\tupdateDisplay() {\n\t\treturn this;\n\t}\n\n\tload( value ) {\n\t\tthis.setValue( value );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\tsave() {\n\t\treturn this.getValue();\n\t}\n\n\t/**\n\t * Destroys this controller and removes it from the parent GUI.\n\t */\n\tdestroy() {\n\t\tthis.parent.children.splice( this.parent.children.indexOf( this ), 1 );\n\t\tthis.parent.controllers.splice( this.parent.controllers.indexOf( this ), 1 );\n\t\tthis.parent.$children.removeChild( this.domElement );\n\t}\n\n\t/**\n\t * Stops propagation of `keyup` and `keydown` events for `el`. Used on inputs\n\t * that allow typing to prevent triggering global key commands.\n\t * @param {HTMLElement} el\n\t * @protected\n\t */\n\t_captureKeyEvents( el ) {\n\t\tel.addEventListener( 'keydown', e => e.stopPropagation() );\n\t\tel.addEventListener( 'keyup', e => e.stopPropagation() );\n\t}\n\n}\n\nclass BooleanController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'boolean', 'label' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'checkbox' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$input.addEventListener( 'change', () => {\n\t\t\tthis.setValue( this.$input.checked );\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.checked = this.getValue();\n\t\treturn this;\n\t}\n\n}\n\nfunction normalizeColorString( string ) {\n\n\tlet match, result;\n\n\tif ( match = string.match( /(#|0x)?([a-f0-9]{6})/i ) ) {\n\n\t\tresult = match[ 2 ];\n\n\t} else if ( match = string.match( /rgb\\(\\s*(\\d*)\\s*,\\s*(\\d*)\\s*,\\s*(\\d*)\\s*\\)/ ) ) {\n\n\t\tresult = parseInt( match[ 1 ] ).toString( 16 ).padStart( 2, 0 )\n\t\t\t+ parseInt( match[ 2 ] ).toString( 16 ).padStart( 2, 0 )\n\t\t\t+ parseInt( match[ 3 ] ).toString( 16 ).padStart( 2, 0 );\n\n\t} else if ( match = string.match( /^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i ) ) {\n\n\t\tresult = match[ 1 ] + match[ 1 ] + match[ 2 ] + match[ 2 ] + match[ 3 ] + match[ 3 ];\n\n\t}\n\n\tif ( result ) {\n\t\treturn '#' + result;\n\t}\n\n\treturn false;\n\n}\n\nconst STRING = {\n\tisPrimitive: true,\n\tmatch: v => typeof v === 'string',\n\tfromHexString: normalizeColorString,\n\ttoHexString: normalizeColorString\n};\n\nconst INT = {\n\tisPrimitive: true,\n\tmatch: v => typeof v === 'number',\n\tfromHexString: string => parseInt( string.substring( 1 ), 16 ),\n\ttoHexString: value => '#' + value.toString( 16 ).padStart( 6, 0 )\n};\n\nconst ARRAY = {\n\tisPrimitive: false,\n\tmatch: Array.isArray,\n\tfromHexString( string, target, rgbScale = 1 ) {\n\n\t\tconst int = INT.fromHexString( string );\n\n\t\ttarget[ 0 ] = ( int >> 16 & 255 ) / 255 * rgbScale;\n\t\ttarget[ 1 ] = ( int >> 8 & 255 ) / 255 * rgbScale;\n\t\ttarget[ 2 ] = ( int & 255 ) / 255 * rgbScale;\n\n\t},\n\ttoHexString( [ r, g, b ], rgbScale = 1 ) {\n\n\t\trgbScale = 255 / rgbScale;\n\n\t\tconst int = ( r * rgbScale ) << 16 ^\n\t\t\t( g * rgbScale ) << 8 ^\n\t\t\t( b * rgbScale ) << 0;\n\n\t\treturn INT.toHexString( int );\n\n\t}\n};\n\nconst OBJECT = {\n\tisPrimitive: false,\n\tmatch: v => Object( v ) === v,\n\tfromHexString( string, target, rgbScale = 1 ) {\n\n\t\tconst int = INT.fromHexString( string );\n\n\t\ttarget.r = ( int >> 16 & 255 ) / 255 * rgbScale;\n\t\ttarget.g = ( int >> 8 & 255 ) / 255 * rgbScale;\n\t\ttarget.b = ( int & 255 ) / 255 * rgbScale;\n\n\t},\n\ttoHexString( { r, g, b }, rgbScale = 1 ) {\n\n\t\trgbScale = 255 / rgbScale;\n\n\t\tconst int = ( r * rgbScale ) << 16 ^\n\t\t\t( g * rgbScale ) << 8 ^\n\t\t\t( b * rgbScale ) << 0;\n\n\t\treturn INT.toHexString( int );\n\n\t}\n};\n\nconst FORMATS = [ STRING, INT, ARRAY, OBJECT ];\n\nfunction getColorFormat( value ) {\n\treturn FORMATS.find( format => format.match( value ) );\n}\n\nclass ColorController extends Controller {\n\n\tconstructor( parent, object, property, rgbScale ) {\n\n\t\tsuper( parent, object, property, 'color' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'color' );\n\t\tthis.$input.setAttribute( 'tabindex', -1 );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$text = document.createElement( 'input' );\n\t\tthis.$text.setAttribute( 'type', 'text' );\n\t\tthis.$text.setAttribute( 'spellcheck', 'false' );\n\t\tthis.$text.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$display = document.createElement( 'div' );\n\t\tthis.$display.classList.add( 'display' );\n\n\t\tthis.$display.appendChild( this.$input );\n\t\tthis.$widget.appendChild( this.$display );\n\t\tthis.$widget.appendChild( this.$text );\n\n\t\tthis._format = getColorFormat( this.initialValue );\n\t\tthis._rgbScale = rgbScale;\n\n\t\tthis._initialValueHexString = this.save();\n\t\tthis._textFocused = false;\n\n\t\tthis.$input.addEventListener( 'input', () => {\n\t\t\tthis._setValueFromHexString( this.$input.value );\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'blur', () => {\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'input', () => {\n\t\t\tconst tryParse = normalizeColorString( this.$text.value );\n\t\t\tif ( tryParse ) {\n\t\t\t\tthis._setValueFromHexString( tryParse );\n\t\t\t}\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'focus', () => {\n\t\t\tthis._textFocused = true;\n\t\t\tthis.$text.select();\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'blur', () => {\n\t\t\tthis._textFocused = false;\n\t\t\tthis.updateDisplay();\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$disable = this.$text;\n\n\t\tthis._captureKeyEvents( this.$text );\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\treset() {\n\t\tthis._setValueFromHexString( this._initialValueHexString );\n\t\treturn this;\n\t}\n\n\t_setValueFromHexString( value ) {\n\n\t\tif ( this._format.isPrimitive ) {\n\n\t\t\tconst newValue = this._format.fromHexString( value );\n\t\t\tthis.setValue( newValue );\n\n\t\t} else {\n\n\t\t\tthis._format.fromHexString( value, this.getValue(), this._rgbScale );\n\t\t\tthis._callOnChange();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t}\n\n\tsave() {\n\t\treturn this._format.toHexString( this.getValue(), this._rgbScale );\n\t}\n\n\tload( value ) {\n\t\tthis._setValueFromHexString( value );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.value = this._format.toHexString( this.getValue(), this._rgbScale );\n\t\tif ( !this._textFocused ) {\n\t\t\tthis.$text.value = this.$input.value.substring( 1 );\n\t\t}\n\t\tthis.$display.style.backgroundColor = this.$input.value;\n\t\treturn this;\n\t}\n\n}\n\nclass FunctionController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'function' );\n\n\t\t// Buttons are the only case where widget contains name\n\t\tthis.$button = document.createElement( 'button' );\n\t\tthis.$button.appendChild( this.$name );\n\t\tthis.$widget.appendChild( this.$button );\n\n\t\tthis.$button.addEventListener( 'click', e => {\n\t\t\te.preventDefault();\n\t\t\tthis.getValue().call( this.object );\n\t\t} );\n\n\t\t// enables :active pseudo class on mobile\n\t\tthis.$button.addEventListener( 'touchstart', () => { } );\n\n\t\tthis.$disable = this.$button;\n\n\t}\n\n}\n\nclass NumberController extends Controller {\n\n\tconstructor( parent, object, property, min, max, step ) {\n\n\t\tsuper( parent, object, property, 'number' );\n\n\t\tthis._initInput();\n\n\t\tthis.min( min );\n\t\tthis.max( max );\n\n\t\tconst stepExplicit = step !== undefined;\n\t\tthis.step( stepExplicit ? step : this._getImplicitStep(), stepExplicit );\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tmin( min ) {\n\t\tthis._min = min;\n\t\tthis._onUpdateMinMax();\n\t\treturn this;\n\t}\n\n\tmax( max ) {\n\t\tthis._max = max;\n\t\tthis._onUpdateMinMax();\n\t\treturn this;\n\t}\n\n\tstep( step, explicit = true ) {\n\t\tthis._step = step;\n\t\tthis._stepExplicit = explicit;\n\t\treturn this;\n\t}\n\n\tupdateDisplay() {\n\n\t\tconst value = this.getValue();\n\n\t\tif ( this._hasSlider ) {\n\n\t\t\tlet percent = ( value - this._min ) / ( this._max - this._min );\n\t\t\tpercent = Math.max( 0, Math.min( percent, 1 ) );\n\n\t\t\tthis.$fill.style.width = percent * 100 + '%';\n\n\t\t}\n\n\t\tif ( !this._inputFocused ) {\n\t\t\tthis.$input.value = value;\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t_initInput() {\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'number' );\n\t\tthis.$input.setAttribute( 'step', 'any' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis._captureKeyEvents( this.$input );\n\n\t\tconst onInput = () => {\n\n\t\t\tconst value = parseFloat( this.$input.value );\n\n\t\t\tif ( isNaN( value ) ) return;\n\n\t\t\tthis.setValue( this._clamp( value ) );\n\n\t\t};\n\n\t\t// Keys & mouse wheel\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst increment = delta => {\n\n\t\t\tconst value = parseFloat( this.$input.value );\n\n\t\t\tif ( isNaN( value ) ) return;\n\n\t\t\tthis._snapClampSetValue( value + delta );\n\n\t\t\t// Force the input to updateDisplay when it's focused\n\t\t\tthis.$input.value = this.getValue();\n\n\t\t};\n\n\t\tconst onKeyDown = e => {\n\t\t\tif ( e.code === 'Enter' ) {\n\t\t\t\tthis.$input.blur();\n\t\t\t}\n\t\t\tif ( e.code === 'ArrowUp' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._arrowKeyMultiplier( e ) );\n\t\t\t}\n\t\t\tif ( e.code === 'ArrowDown' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._arrowKeyMultiplier( e ) * -1 );\n\t\t\t}\n\t\t};\n\n\t\tconst onWheel = e => {\n\t\t\tif ( this._inputFocused ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._normalizeMouseWheel( e ) );\n\t\t\t}\n\t\t};\n\n\t\t// Vertical drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tlet testingForVerticalDrag = false,\n\t\t\tinitClientX,\n\t\t\tinitClientY,\n\t\t\tprevClientY,\n\t\t\tinitValue,\n\t\t\tdragDelta;\n\n\t\t// Once the mouse is dragged more than DRAG_THRESH px on any axis, we decide\n\t\t// on the user's intent: horizontal means highlight, vertical means drag.\n\t\tconst DRAG_THRESH = 5;\n\n\t\tconst onMouseDown = e => {\n\n\t\t\tinitClientX = e.clientX;\n\t\t\tinitClientY = prevClientY = e.clientY;\n\t\t\ttestingForVerticalDrag = true;\n\n\t\t\tinitValue = this.getValue();\n\t\t\tdragDelta = 0;\n\n\t\t\twindow.addEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.addEventListener( 'mouseup', onMouseUp );\n\n\t\t};\n\n\t\tconst onMouseMove = e => {\n\n\t\t\tif ( testingForVerticalDrag ) {\n\n\t\t\t\tconst dx = e.clientX - initClientX;\n\t\t\t\tconst dy = e.clientY - initClientY;\n\n\t\t\t\tif ( Math.abs( dy ) > DRAG_THRESH ) {\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.$input.blur();\n\t\t\t\t\ttestingForVerticalDrag = false;\n\t\t\t\t\tthis._setDraggingStyle( true, 'vertical' );\n\n\t\t\t\t} else if ( Math.abs( dx ) > DRAG_THRESH ) {\n\n\t\t\t\t\tonMouseUp();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// This isn't an else so that the first move counts towards dragDelta\n\t\t\tif ( !testingForVerticalDrag ) {\n\n\t\t\t\tconst dy = e.clientY - prevClientY;\n\n\t\t\t\tdragDelta -= dy * this._step * this._arrowKeyMultiplier( e );\n\n\t\t\t\t// Clamp dragDelta so we don't have 'dead space' after dragging past bounds.\n\t\t\t\t// We're okay with the fact that bounds can be undefined here.\n\t\t\t\tif ( initValue + dragDelta > this._max ) {\n\t\t\t\t\tdragDelta = this._max - initValue;\n\t\t\t\t} else if ( initValue + dragDelta < this._min ) {\n\t\t\t\t\tdragDelta = this._min - initValue;\n\t\t\t\t}\n\n\t\t\t\tthis._snapClampSetValue( initValue + dragDelta );\n\n\t\t\t}\n\n\t\t\tprevClientY = e.clientY;\n\n\t\t};\n\n\t\tconst onMouseUp = () => {\n\t\t\tthis._setDraggingStyle( false, 'vertical' );\n\t\t\tthis._callOnFinishChange();\n\t\t\twindow.removeEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', onMouseUp );\n\t\t};\n\n\t\t// Focus state & onFinishChange\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst onFocus = () => {\n\t\t\tthis._inputFocused = true;\n\t\t};\n\n\t\tconst onBlur = () => {\n\t\t\tthis._inputFocused = false;\n\t\t\tthis.updateDisplay();\n\t\t\tthis._callOnFinishChange();\n\t\t};\n\n\t\tthis.$input.addEventListener( 'input', onInput );\n\t\tthis.$input.addEventListener( 'keydown', onKeyDown );\n\t\tthis.$input.addEventListener( 'wheel', onWheel );\n\t\tthis.$input.addEventListener( 'mousedown', onMouseDown );\n\t\tthis.$input.addEventListener( 'focus', onFocus );\n\t\tthis.$input.addEventListener( 'blur', onBlur );\n\n\t}\n\n\t_initSlider() {\n\n\t\tthis._hasSlider = true;\n\n\t\t// Build DOM\n\t\t// ---------------------------------------------------------------------\n\n\t\tthis.$slider = document.createElement( 'div' );\n\t\tthis.$slider.classList.add( 'slider' );\n\n\t\tthis.$fill = document.createElement( 'div' );\n\t\tthis.$fill.classList.add( 'fill' );\n\n\t\tthis.$slider.appendChild( this.$fill );\n\t\tthis.$widget.insertBefore( this.$slider, this.$input );\n\n\t\tthis.domElement.classList.add( 'hasSlider' );\n\n\t\t// Map clientX to value\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst map = ( v, a, b, c, d ) => {\n\t\t\treturn ( v - a ) / ( b - a ) * ( d - c ) + c;\n\t\t};\n\n\t\tconst setValueFromX = clientX => {\n\t\t\tconst rect = this.$slider.getBoundingClientRect();\n\t\t\tlet value = map( clientX, rect.left, rect.right, this._min, this._max );\n\t\t\tthis._snapClampSetValue( value );\n\t\t};\n\n\t\t// Mouse drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst mouseDown = e => {\n\t\t\tthis._setDraggingStyle( true );\n\t\t\tsetValueFromX( e.clientX );\n\t\t\twindow.addEventListener( 'mousemove', mouseMove );\n\t\t\twindow.addEventListener( 'mouseup', mouseUp );\n\t\t};\n\n\t\tconst mouseMove = e => {\n\t\t\tsetValueFromX( e.clientX );\n\t\t};\n\n\t\tconst mouseUp = () => {\n\t\t\tthis._callOnFinishChange();\n\t\t\tthis._setDraggingStyle( false );\n\t\t\twindow.removeEventListener( 'mousemove', mouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', mouseUp );\n\t\t};\n\n\t\t// Touch drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tlet testingForScroll = false, prevClientX, prevClientY;\n\n\t\tconst beginTouchDrag = e => {\n\t\t\te.preventDefault();\n\t\t\tthis._setDraggingStyle( true );\n\t\t\tsetValueFromX( e.touches[ 0 ].clientX );\n\t\t\ttestingForScroll = false;\n\t\t};\n\n\t\tconst onTouchStart = e => {\n\n\t\t\tif ( e.touches.length > 1 ) return;\n\n\t\t\t// If we're in a scrollable container, we should wait for the first\n\t\t\t// touchmove to see if the user is trying to slide or scroll.\n\t\t\tif ( this._hasScrollBar ) {\n\n\t\t\t\tprevClientX = e.touches[ 0 ].clientX;\n\t\t\t\tprevClientY = e.touches[ 0 ].clientY;\n\t\t\t\ttestingForScroll = true;\n\n\t\t\t} else {\n\n\t\t\t\t// Otherwise, we can set the value straight away on touchstart.\n\t\t\t\tbeginTouchDrag( e );\n\n\t\t\t}\n\n\t\t\twindow.addEventListener( 'touchmove', onTouchMove );\n\t\t\twindow.addEventListener( 'touchend', onTouchEnd );\n\n\t\t};\n\n\t\tconst onTouchMove = e => {\n\n\t\t\tif ( testingForScroll ) {\n\n\t\t\t\tconst dx = e.touches[ 0 ].clientX - prevClientX;\n\t\t\t\tconst dy = e.touches[ 0 ].clientY - prevClientY;\n\n\t\t\t\tif ( Math.abs( dx ) > Math.abs( dy ) ) {\n\n\t\t\t\t\t// We moved horizontally, set the value and stop checking.\n\t\t\t\t\tbeginTouchDrag( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// This was, in fact, an attempt to scroll. Abort.\n\t\t\t\t\twindow.removeEventListener( 'touchmove', onTouchMove );\n\t\t\t\t\twindow.removeEventListener( 'touchend', onTouchEnd );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\te.preventDefault();\n\t\t\t\tsetValueFromX( e.touches[ 0 ].clientX );\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst onTouchEnd = () => {\n\t\t\tthis._callOnFinishChange();\n\t\t\tthis._setDraggingStyle( false );\n\t\t\twindow.removeEventListener( 'touchmove', onTouchMove );\n\t\t\twindow.removeEventListener( 'touchend', onTouchEnd );\n\t\t};\n\n\t\t// Mouse wheel\n\t\t// ---------------------------------------------------------------------\n\n\t\t// We have to use a debounced function to call onFinishChange because\n\t\t// there's no way to tell when the user is \"done\" mouse-wheeling.\n\t\tconst callOnFinishChange = this._callOnFinishChange.bind( this );\n\t\tconst WHEEL_DEBOUNCE_TIME = 400;\n\t\tlet wheelFinishChangeTimeout;\n\n\t\tconst onWheel = e => {\n\n\t\t\t// ignore vertical wheels if there's a scrollbar\n\t\t\tconst isVertical = Math.abs( e.deltaX ) < Math.abs( e.deltaY );\n\t\t\tif ( isVertical && this._hasScrollBar ) return;\n\n\t\t\te.preventDefault();\n\n\t\t\t// set value\n\t\t\tconst delta = this._normalizeMouseWheel( e ) * this._step;\n\t\t\tthis._snapClampSetValue( this.getValue() + delta );\n\n\t\t\t// force the input to updateDisplay when it's focused\n\t\t\tthis.$input.value = this.getValue();\n\n\t\t\t// debounce onFinishChange\n\t\t\tclearTimeout( wheelFinishChangeTimeout );\n\t\t\twheelFinishChangeTimeout = setTimeout( callOnFinishChange, WHEEL_DEBOUNCE_TIME );\n\n\t\t};\n\n\t\tthis.$slider.addEventListener( 'mousedown', mouseDown );\n\t\tthis.$slider.addEventListener( 'touchstart', onTouchStart );\n\t\tthis.$slider.addEventListener( 'wheel', onWheel );\n\n\t}\n\n\t_setDraggingStyle( active, axis = 'horizontal' ) {\n\t\tif ( this.$slider ) {\n\t\t\tthis.$slider.classList.toggle( 'active', active );\n\t\t}\n\t\tdocument.body.classList.toggle( 'lil-gui-dragging', active );\n\t\tdocument.body.classList.toggle( `lil-gui-${axis}`, active );\n\t}\n\n\t_getImplicitStep() {\n\n\t\tif ( this._hasMin && this._hasMax ) {\n\t\t\treturn ( this._max - this._min ) / 1000;\n\t\t}\n\n\t\treturn 0.1;\n\n\t}\n\n\t_onUpdateMinMax() {\n\n\t\tif ( !this._hasSlider && this._hasMin && this._hasMax ) {\n\n\t\t\t// If this is the first time we're hearing about min and max\n\t\t\t// and we haven't explicitly stated what our step is, let's\n\t\t\t// update that too.\n\t\t\tif ( !this._stepExplicit ) {\n\t\t\t\tthis.step( this._getImplicitStep(), false );\n\t\t\t}\n\n\t\t\tthis._initSlider();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t}\n\n\t_normalizeMouseWheel( e ) {\n\n\t\tlet { deltaX, deltaY } = e;\n\n\t\t// Safari and Chrome report weird non-integral values for a notched wheel,\n\t\t// but still expose actual lines scrolled via wheelDelta. Notched wheels\n\t\t// should behave the same way as arrow keys.\n\t\tif ( Math.floor( e.deltaY ) !== e.deltaY && e.wheelDelta ) {\n\t\t\tdeltaX = 0;\n\t\t\tdeltaY = -e.wheelDelta / 120;\n\t\t\tdeltaY *= this._stepExplicit ? 1 : 10;\n\t\t}\n\n\t\tconst wheel = deltaX + -deltaY;\n\n\t\treturn wheel;\n\n\t}\n\n\t_arrowKeyMultiplier( e ) {\n\n\t\tlet mult = this._stepExplicit ? 1 : 10;\n\n\t\tif ( e.shiftKey ) {\n\t\t\tmult *= 10;\n\t\t} else if ( e.altKey ) {\n\t\t\tmult /= 10;\n\t\t}\n\n\t\treturn mult;\n\n\t}\n\n\t_snap( value ) {\n\n\t\t// This would be the logical way to do things, but floating point errors.\n\t\t// return Math.round( value / this._step ) * this._step;\n\n\t\t// Using inverse step solves a lot of them, but not all\n\t\t// const inverseStep = 1 / this._step;\n\t\t// return Math.round( value * inverseStep ) / inverseStep;\n\n\t\t// Not happy about this, but haven't seen it break.\n\t\tconst r = Math.round( value / this._step ) * this._step;\n\t\treturn parseFloat( r.toPrecision( 15 ) );\n\n\t}\n\n\t_clamp( value ) {\n\t\t// either condition is false if min or max is undefined\n\t\tif ( value < this._min ) value = this._min;\n\t\tif ( value > this._max ) value = this._max;\n\t\treturn value;\n\t}\n\n\t_snapClampSetValue( value ) {\n\t\tthis.setValue( this._clamp( this._snap( value ) ) );\n\t}\n\n\tget _hasScrollBar() {\n\t\tconst root = this.parent.root.$children;\n\t\treturn root.scrollHeight > root.clientHeight;\n\t}\n\n\tget _hasMin() {\n\t\treturn this._min !== undefined;\n\t}\n\n\tget _hasMax() {\n\t\treturn this._max !== undefined;\n\t}\n\n}\n\nclass OptionController extends Controller {\n\n\tconstructor( parent, object, property, options ) {\n\n\t\tsuper( parent, object, property, 'option' );\n\n\t\tthis.$select = document.createElement( 'select' );\n\t\tthis.$select.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$display = document.createElement( 'div' );\n\t\tthis.$display.classList.add( 'display' );\n\n\t\tthis._values = Array.isArray( options ) ? options : Object.values( options );\n\t\tthis._names = Array.isArray( options ) ? options : Object.keys( options );\n\n\t\tthis._names.forEach( name => {\n\t\t\tconst $option = document.createElement( 'option' );\n\t\t\t$option.innerHTML = name;\n\t\t\tthis.$select.appendChild( $option );\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'change', () => {\n\t\t\tthis.setValue( this._values[ this.$select.selectedIndex ] );\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'focus', () => {\n\t\t\tthis.$display.classList.add( 'focus' );\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'blur', () => {\n\t\t\tthis.$display.classList.remove( 'focus' );\n\t\t} );\n\n\t\tthis.$widget.appendChild( this.$select );\n\t\tthis.$widget.appendChild( this.$display );\n\n\t\tthis.$disable = this.$select;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tconst value = this.getValue();\n\t\tconst index = this._values.indexOf( value );\n\t\tthis.$select.selectedIndex = index;\n\t\tthis.$display.innerHTML = index === -1 ? value : this._names[ index ];\n\t\treturn this;\n\t}\n\n}\n\nclass StringController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'string' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'text' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$input.addEventListener( 'input', () => {\n\t\t\tthis.setValue( this.$input.value );\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'keydown', e => {\n\t\t\tif ( e.code === 'Enter' ) {\n\t\t\t\tthis.$input.blur();\n\t\t\t}\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'blur', () => {\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis._captureKeyEvents( this.$input );\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.value = this.getValue();\n\t\treturn this;\n\t}\n\n}\n\nconst stylesheet = `.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, \"Droid Sans Mono\", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --widget-padding: 0 0 0 3px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --widget-padding: 0 0 0 3px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: \" \";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: \"lil-gui\";\n  content: \"↕\";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: \"lil-gui\";\n  content: \"▾\";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: \"▸\";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: \"Empty\";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: \"lil-gui\";\n  content: \"✓\";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: \"lil-gui\";\n  src: url(\"data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==\") format(\"woff\");\n}`;\n\nfunction _injectStyles( cssContent ) {\n\tconst injected = document.createElement( 'style' );\n\tinjected.innerHTML = cssContent;\n\tconst before = document.querySelector( 'head link[rel=stylesheet], head style' );\n\tif ( before ) {\n\t\tdocument.head.insertBefore( injected, before );\n\t} else {\n\t\tdocument.head.appendChild( injected );\n\t}\n}\n\nlet stylesInjected = false;\n\nclass GUI {\n\n\t/**\n\t * Creates a panel that holds controllers.\n\t * @example\n\t * new GUI();\n\t * new GUI( { container: document.getElementById( 'custom' ) } );\n\t *\n\t * @param {object} [options]\n\t * @param {boolean} [options.autoPlace=true]\n\t * Adds the GUI to `document.body` and fixes it to the top right of the page.\n\t *\n\t * @param {HTMLElement} [options.container]\n\t * Adds the GUI to this DOM element. Overrides `autoPlace`.\n\t *\n\t * @param {number} [options.width=245]\n\t * Width of the GUI in pixels, usually set when name labels become too long. Note that you can make\n\t * name labels wider in CSS with `.lil‑gui { ‑‑name‑width: 55% }`\n\t *\n\t * @param {string} [options.title=Controls]\n\t * Name to display in the title bar.\n\t *\n\t * @param {boolean} [options.injectStyles=true]\n\t * Injects the default stylesheet into the page if this is the first GUI.\n\t * Pass `false` to use your own stylesheet.\n\t *\n\t * @param {number} [options.touchStyles=true]\n\t * Makes controllers larger on touch devices. Pass `false` to disable touch styles.\n\t *\n\t * @param {GUI} [options.parent]\n\t * Adds this GUI as a child in another GUI. Usually this is done for you by `addFolder()`.\n\t *\n\t */\n\tconstructor( {\n\t\tparent,\n\t\tautoPlace = parent === undefined,\n\t\tcontainer,\n\t\twidth,\n\t\ttitle = 'Controls',\n\t\tinjectStyles = true,\n\t\ttouchStyles = true\n\t} = {} ) {\n\n\t\t/**\n\t\t * The GUI containing this folder, or `undefined` if this is the root GUI.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.parent = parent;\n\n\t\t/**\n\t\t * The top level GUI containing this folder, or `this` if this is the root GUI.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.root = parent ? parent.root : this;\n\n\t\t/**\n\t\t * The list of controllers and folders contained by this GUI.\n\t\t * @type {Array<GUI|Controller>}\n\t\t */\n\t\tthis.children = [];\n\n\t\t/**\n\t\t * The list of controllers contained by this GUI.\n\t\t * @type {Array<Controller>}\n\t\t */\n\t\tthis.controllers = [];\n\n\t\t/**\n\t\t * The list of folders contained by this GUI.\n\t\t * @type {Array<GUI>}\n\t\t */\n\t\tthis.folders = [];\n\n\t\t/**\n\t\t * Used to determine if the GUI is closed. Use `gui.open()` or `gui.close()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._closed = false;\n\n\t\t/**\n\t\t * The outermost container element.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.domElement = document.createElement( 'div' );\n\t\tthis.domElement.classList.add( 'lil-gui' );\n\n\t\t/**\n\t\t * The DOM element that contains the title.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$title = document.createElement( 'div' );\n\t\tthis.$title.classList.add( 'title' );\n\t\tthis.$title.setAttribute( 'role', 'button' );\n\t\tthis.$title.setAttribute( 'aria-expanded', true );\n\t\tthis.$title.setAttribute( 'tabindex', 0 );\n\n\t\tthis.$title.addEventListener( 'click', () => this.openAnimated( this._closed ) );\n\t\tthis.$title.addEventListener( 'keydown', e => {\n\t\t\tif ( e.code === 'Enter' || e.code === 'Space' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.$title.click();\n\t\t\t}\n\t\t} );\n\n\t\t// enables :active pseudo class on mobile\n\t\tthis.$title.addEventListener( 'touchstart', () => { } );\n\n\t\t/**\n\t\t * The DOM element that contains children.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$children = document.createElement( 'div' );\n\t\tthis.$children.classList.add( 'children' );\n\n\t\tthis.domElement.appendChild( this.$title );\n\t\tthis.domElement.appendChild( this.$children );\n\n\t\tthis.title( title );\n\n\t\tif ( touchStyles ) {\n\t\t\tthis.domElement.classList.add( 'allow-touch-styles' );\n\t\t}\n\n\t\tif ( this.parent ) {\n\n\t\t\tthis.parent.children.push( this );\n\t\t\tthis.parent.folders.push( this );\n\n\t\t\tthis.parent.$children.appendChild( this.domElement );\n\n\t\t\t// Stop the constructor early, everything onward only applies to root GUI's\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.domElement.classList.add( 'root' );\n\n\t\t// Inject stylesheet if we haven't done that yet\n\t\tif ( !stylesInjected && injectStyles ) {\n\t\t\t_injectStyles( stylesheet );\n\t\t\tstylesInjected = true;\n\t\t}\n\n\t\tif ( container ) {\n\n\t\t\tcontainer.appendChild( this.domElement );\n\n\t\t} else if ( autoPlace ) {\n\n\t\t\tthis.domElement.classList.add( 'autoPlace' );\n\t\t\tdocument.body.appendChild( this.domElement );\n\n\t\t}\n\n\t\tif ( width ) {\n\t\t\tthis.domElement.style.setProperty( '--width', width + 'px' );\n\t\t}\n\n\t}\n\n\t/**\n\t * Adds a controller to the GUI, inferring controller type using the `typeof` operator.\n\t * @example\n\t * gui.add( object, 'property' );\n\t * gui.add( object, 'number', 0, 100, 1 );\n\t * gui.add( object, 'options', [ 1, 2, 3 ] );\n\t *\n\t * @param {object} object The object the controller will modify.\n\t * @param {string} property Name of the property to control.\n\t * @param {number|object|Array} [$1] Minimum value for number controllers, or the set of\n\t * selectable values for a dropdown.\n\t * @param {number} [max] Maximum value for number controllers.\n\t * @param {number} [step] Step value for number controllers.\n\t * @returns {Controller}\n\t */\n\tadd( object, property, $1, max, step ) {\n\n\t\tif ( Object( $1 ) === $1 ) {\n\n\t\t\treturn new OptionController( this, object, property, $1 );\n\n\t\t}\n\n\t\tconst initialValue = object[ property ];\n\n\t\tswitch ( typeof initialValue ) {\n\n\t\t\tcase 'number':\n\n\t\t\t\treturn new NumberController( this, object, property, $1, max, step );\n\n\t\t\tcase 'boolean':\n\n\t\t\t\treturn new BooleanController( this, object, property );\n\n\t\t\tcase 'string':\n\n\t\t\t\treturn new StringController( this, object, property );\n\n\t\t\tcase 'function':\n\n\t\t\t\treturn new FunctionController( this, object, property );\n\n\t\t}\n\n\t\tconsole.error( `gui.add failed\n\tproperty:`, property, `\n\tobject:`, object, `\n\tvalue:`, initialValue );\n\n\t}\n\n\t/**\n\t * Adds a color controller to the GUI.\n\t * @example\n\t * params = {\n\t * \tcssColor: '#ff00ff',\n\t * \trgbColor: { r: 0, g: 0.2, b: 0.4 },\n\t * \tcustomRange: [ 0, 127, 255 ],\n\t * };\n\t *\n\t * gui.addColor( params, 'cssColor' );\n\t * gui.addColor( params, 'rgbColor' );\n\t * gui.addColor( params, 'customRange', 255 );\n\t *\n\t * @param {object} object The object the controller will modify.\n\t * @param {string} property Name of the property to control.\n\t * @param {number} rgbScale Maximum value for a color channel when using an RGB color. You may\n\t * need to set this to 255 if your colors are too dark.\n\t * @returns {Controller}\n\t */\n\taddColor( object, property, rgbScale = 1 ) {\n\t\treturn new ColorController( this, object, property, rgbScale );\n\t}\n\n\t/**\n\t * Adds a folder to the GUI, which is just another GUI. This method returns\n\t * the nested GUI so you can add controllers to it.\n\t * @example\n\t * const folder = gui.addFolder( 'Position' );\n\t * folder.add( position, 'x' );\n\t * folder.add( position, 'y' );\n\t * folder.add( position, 'z' );\n\t *\n\t * @param {string} title Name to display in the folder's title bar.\n\t * @returns {GUI}\n\t */\n\taddFolder( title ) {\n\t\treturn new GUI( { parent: this, title } );\n\t}\n\n\t/**\n\t * Recalls values that were saved with `gui.save()`.\n\t * @param {object} obj\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {this}\n\t */\n\tload( obj, recursive = true ) {\n\n\t\tif ( obj.controllers ) {\n\n\t\t\tthis.controllers.forEach( c => {\n\n\t\t\t\tif ( c instanceof FunctionController ) return;\n\n\t\t\t\tif ( c._name in obj.controllers ) {\n\t\t\t\t\tc.load( obj.controllers[ c._name ] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( recursive && obj.folders ) {\n\n\t\t\tthis.folders.forEach( f => {\n\n\t\t\t\tif ( f._title in obj.folders ) {\n\t\t\t\t\tf.load( obj.folders[ f._title ] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Returns an object mapping controller names to values. The object can be passed to `gui.load()` to\n\t * recall these values.\n\t * @example\n\t * {\n\t * \tcontrollers: {\n\t * \t\tprop1: 1,\n\t * \t\tprop2: 'value',\n\t * \t\t...\n\t * \t},\n\t * \tfolders: {\n\t * \t\tfolderName1: { controllers, folders },\n\t * \t\tfolderName2: { controllers, folders }\n\t * \t\t...\n\t * \t}\n\t * }\n\t *\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {object}\n\t */\n\tsave( recursive = true ) {\n\n\t\tconst obj = {\n\t\t\tcontrollers: {},\n\t\t\tfolders: {}\n\t\t};\n\n\t\tthis.controllers.forEach( c => {\n\n\t\t\tif ( c instanceof FunctionController ) return;\n\n\t\t\tif ( c._name in obj.controllers ) {\n\t\t\t\tthrow new Error( `Cannot save GUI with duplicate property \"${c._name}\"` );\n\t\t\t}\n\n\t\t\tobj.controllers[ c._name ] = c.save();\n\n\t\t} );\n\n\t\tif ( recursive ) {\n\n\t\t\tthis.folders.forEach( f => {\n\n\t\t\t\tif ( f._title in obj.folders ) {\n\t\t\t\t\tthrow new Error( `Cannot save GUI with duplicate folder \"${f._title}\"` );\n\t\t\t\t}\n\n\t\t\t\tobj.folders[ f._title ] = f.save();\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn obj;\n\n\t}\n\n\t/**\n\t * Opens a GUI or folder. GUI and folders are open by default.\n\t * @param {boolean} open Pass false to close\n\t * @returns {this}\n\t * @example\n\t * gui.open(); // open\n\t * gui.open( false ); // close\n\t * gui.open( gui._closed ); // toggle\n\t */\n\topen( open = true ) {\n\n\t\tthis._closed = !open;\n\n\t\tthis.$title.setAttribute( 'aria-expanded', !this._closed );\n\t\tthis.domElement.classList.toggle( 'closed', this._closed );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Closes the GUI.\n\t * @returns {this}\n\t */\n\tclose() {\n\t\treturn this.open( false );\n\t}\n\n\topenAnimated( open = true ) {\n\n\t\t// set state immediately\n\t\tthis._closed = !open;\n\n\t\tthis.$title.setAttribute( 'aria-expanded', !this._closed );\n\n\t\t// wait for next frame to measure $children\n\t\trequestAnimationFrame( () => {\n\n\t\t\t// explicitly set initial height for transition\n\t\t\tconst initialHeight = this.$children.clientHeight;\n\t\t\tthis.$children.style.height = initialHeight + 'px';\n\n\t\t\tthis.domElement.classList.add( 'transition' );\n\n\t\t\tconst onTransitionEnd = e => {\n\t\t\t\tif ( e.target !== this.$children ) return;\n\t\t\t\tthis.$children.style.height = '';\n\t\t\t\tthis.domElement.classList.remove( 'transition' );\n\t\t\t\tthis.$children.removeEventListener( 'transitionend', onTransitionEnd );\n\t\t\t};\n\n\t\t\tthis.$children.addEventListener( 'transitionend', onTransitionEnd );\n\n\t\t\t// todo: this is wrong if children's scrollHeight makes for a gui taller than maxHeight\n\t\t\tconst targetHeight = !open ? 0 : this.$children.scrollHeight;\n\n\t\t\tthis.domElement.classList.toggle( 'closed', !open );\n\n\t\t\trequestAnimationFrame( () => {\n\t\t\t\tthis.$children.style.height = targetHeight + 'px';\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Change the title of this GUI.\n\t * @param {string} title\n\t * @returns {this}\n\t */\n\ttitle( title ) {\n\t\t/**\n\t\t * Current title of the GUI. Use `gui.title( 'Title' )` to modify this value.\n\t\t * @type {string}\n\t\t */\n\t\tthis._title = title;\n\t\tthis.$title.innerHTML = title;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Resets all controllers to their initial values.\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {this}\n\t */\n\treset( recursive = true ) {\n\t\tconst controllers = recursive ? this.controllersRecursive() : this.controllers;\n\t\tcontrollers.forEach( c => c.reset() );\n\t\treturn this;\n\t}\n\n\t/**\n\t * Pass a function to be called whenever a controller in this GUI changes.\n\t * @param {function({object:object, property:string, value:any, controller:Controller})} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onChange( event => {\n\t * \tevent.object     // object that was modified\n\t * \tevent.property   // string, name of property\n\t * \tevent.value      // new value of controller\n\t * \tevent.controller // controller that was modified\n\t * } );\n\t */\n\tonChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onChange` events. Don't modify this value\n\t\t * directly. Use the `gui.onChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onChange = callback;\n\t\treturn this;\n\t}\n\n\t_callOnChange( controller ) {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnChange( controller );\n\t\t}\n\n\t\tif ( this._onChange !== undefined ) {\n\t\t\tthis._onChange.call( this, {\n\t\t\t\tobject: controller.object,\n\t\t\t\tproperty: controller.property,\n\t\t\t\tvalue: controller.getValue(),\n\t\t\t\tcontroller\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Pass a function to be called whenever a controller in this GUI has finished changing.\n\t * @param {function({object:object, property:string, value:any, controller:Controller})} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onFinishChange( event => {\n\t * \tevent.object     // object that was modified\n\t * \tevent.property   // string, name of property\n\t * \tevent.value      // new value of controller\n\t * \tevent.controller // controller that was modified\n\t * } );\n\t */\n\tonFinishChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onFinishChange` events. Don't modify this value\n\t\t * directly. Use the `gui.onFinishChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onFinishChange = callback;\n\t\treturn this;\n\t}\n\n\t_callOnFinishChange( controller ) {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnFinishChange( controller );\n\t\t}\n\n\t\tif ( this._onFinishChange !== undefined ) {\n\t\t\tthis._onFinishChange.call( this, {\n\t\t\t\tobject: controller.object,\n\t\t\t\tproperty: controller.property,\n\t\t\t\tvalue: controller.getValue(),\n\t\t\t\tcontroller\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Destroys all DOM elements and event listeners associated with this GUI\n\t */\n\tdestroy() {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent.children.splice( this.parent.children.indexOf( this ), 1 );\n\t\t\tthis.parent.folders.splice( this.parent.folders.indexOf( this ), 1 );\n\t\t}\n\n\t\tif ( this.domElement.parentElement ) {\n\t\t\tthis.domElement.parentElement.removeChild( this.domElement );\n\t\t}\n\n\t\tArray.from( this.children ).forEach( c => c.destroy() );\n\n\t}\n\n\t/**\n\t * Returns an array of controllers contained by this GUI and its descendents.\n\t * @returns {Controller[]}\n\t */\n\tcontrollersRecursive() {\n\t\tlet controllers = Array.from( this.controllers );\n\t\tthis.folders.forEach( f => {\n\t\t\tcontrollers = controllers.concat( f.controllersRecursive() );\n\t\t} );\n\t\treturn controllers;\n\t}\n\n\t/**\n\t * Returns an array of folders contained by this GUI and its descendents.\n\t * @returns {GUI[]}\n\t */\n\tfoldersRecursive() {\n\t\tlet folders = Array.from( this.folders );\n\t\tthis.folders.forEach( f => {\n\t\t\tfolders = folders.concat( f.foldersRecursive() );\n\t\t} );\n\t\treturn folders;\n\t}\n\n}\n\nexport default GUI;\nexport { BooleanController, ColorController, Controller, FunctionController, GUI, NumberController, OptionController, StringController };\n","import {\n\tEventDispatcher,\n\tMatrix4,\n\tPlane,\n\tRaycaster,\n\tVector2,\n\tVector3\n} from 'three';\n\nconst _plane = new Plane();\nconst _raycaster = new Raycaster();\n\nconst _pointer = new Vector2();\nconst _offset = new Vector3();\nconst _intersection = new Vector3();\nconst _worldPosition = new Vector3();\nconst _inverseMatrix = new Matrix4();\n\nclass DragControls extends EventDispatcher {\n\n\tconstructor( _objects, _camera, _domElement ) {\n\n\t\tsuper();\n\n\t\t_domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\tlet _selected = null, _hovered = null;\n\n\t\tconst _intersections = [];\n\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tfunction activate() {\n\n\t\t\t_domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.addEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.addEventListener( 'pointerleave', onPointerCancel );\n\n\t\t}\n\n\t\tfunction deactivate() {\n\n\t\t\t_domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.removeEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.removeEventListener( 'pointerleave', onPointerCancel );\n\n\t\t\t_domElement.style.cursor = '';\n\n\t\t}\n\n\t\tfunction dispose() {\n\n\t\t\tdeactivate();\n\n\t\t}\n\n\t\tfunction getObjects() {\n\n\t\t\treturn _objects;\n\n\t\t}\n\n\t\tfunction getRaycaster() {\n\n\t\t\treturn _raycaster;\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t_selected.position.copy( _intersection.sub( _offset ).applyMatrix4( _inverseMatrix ) );\n\n\t\t\t\t}\n\n\t\t\t\tscope.dispatchEvent( { type: 'drag', object: _selected } );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// hover support\n\n\t\t\tif ( event.pointerType === 'mouse' || event.pointerType === 'pen' ) {\n\n\t\t\t\t_intersections.length = 0;\n\n\t\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t\t_raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t\tconst object = _intersections[ 0 ].object;\n\n\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( object.matrixWorld ) );\n\n\t\t\t\t\tif ( _hovered !== object && _hovered !== null ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( _hovered !== object ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveron', object: object } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'pointer';\n\t\t\t\t\t\t_hovered = object;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( _hovered !== null ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_intersections.length = 0;\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t_raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t_selected = ( scope.transformGroup === true ) ? _objects[ 0 ] : _intersections[ 0 ].object;\n\n\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t_inverseMatrix.copy( _selected.parent.matrixWorld ).invert();\n\t\t\t\t\t_offset.copy( _intersection ).sub( _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\t}\n\n\t\t\t\t_domElement.style.cursor = 'move';\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragstart', object: _selected } );\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction onPointerCancel() {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragend', object: _selected } );\n\n\t\t\t\t_selected = null;\n\n\t\t\t}\n\n\t\t\t_domElement.style.cursor = _hovered ? 'pointer' : 'auto';\n\n\t\t}\n\n\t\tfunction updatePointer( event ) {\n\n\t\t\tconst rect = _domElement.getBoundingClientRect();\n\n\t\t\t_pointer.x = ( event.clientX - rect.left ) / rect.width * 2 - 1;\n\t\t\t_pointer.y = - ( event.clientY - rect.top ) / rect.height * 2 + 1;\n\n\t\t}\n\n\t\tactivate();\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\t\tthis.transformGroup = false;\n\n\t\tthis.activate = activate;\n\t\tthis.deactivate = deactivate;\n\t\tthis.dispose = dispose;\n\t\tthis.getObjects = getObjects;\n\t\tthis.getRaycaster = getRaycaster;\n\n\t}\n\n}\n\nexport { DragControls };\n","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\n\nclass OrbitControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = function () {\n\n\t\t\treturn spherical.phi;\n\n\t\t};\n\n\t\tthis.getAzimuthalAngle = function () {\n\n\t\t\treturn spherical.theta;\n\n\t\t};\n\n\t\tthis.getDistance = function () {\n\n\t\t\treturn this.object.position.distanceTo( this.target );\n\n\t\t};\n\n\t\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = domElement;\n\n\t\t};\n\n\t\tthis.saveState = function () {\n\n\t\t\tscope.target0.copy( scope.target );\n\t\t\tscope.position0.copy( scope.object.position );\n\t\t\tscope.zoom0 = scope.object.zoom;\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tscope.update();\n\n\t\t\tstate = STATE.NONE;\n\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\t\tconst quatInverse = quat.clone().invert();\n\n\t\t\tconst lastPosition = new Vector3();\n\t\t\tconst lastQuaternion = new Quaternion();\n\n\t\t\tconst twoPI = 2 * Math.PI;\n\n\t\t\treturn function update() {\n\n\t\t\t\tconst position = scope.object.position;\n\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3( offset );\n\n\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle;\n\t\t\t\tlet max = scope.maxAzimuthAngle;\n\n\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\t\tspherical.makeSafe();\n\n\n\t\t\t\tspherical.radius *= scale;\n\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tscale = 1;\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif ( zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\t\tzoomChanged = false;\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerCancel );\n\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t\t}\n\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t\t};\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tconst STATE = {\n\t\t\tNONE: - 1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t};\n\n\t\tlet state = STATE.NONE;\n\n\t\tconst EPS = 0.000001;\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical();\n\t\tconst sphericalDelta = new Spherical();\n\n\t\tlet scale = 1;\n\t\tconst panOffset = new Vector3();\n\t\tlet zoomChanged = false;\n\n\t\tconst rotateStart = new Vector2();\n\t\tconst rotateEnd = new Vector2();\n\t\tconst rotateDelta = new Vector2();\n\n\t\tconst panStart = new Vector2();\n\t\tconst panEnd = new Vector2();\n\t\tconst panDelta = new Vector2();\n\n\t\tconst dollyStart = new Vector2();\n\t\tconst dollyEnd = new Vector2();\n\t\tconst dollyDelta = new Vector2();\n\n\t\tconst pointers = [];\n\t\tconst pointerPositions = {};\n\n\t\tfunction getAutoRotationAngle() {\n\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t\t}\n\n\t\tfunction getZoomScale() {\n\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t\t}\n\n\t\tfunction rotateLeft( angle ) {\n\n\t\t\tsphericalDelta.theta -= angle;\n\n\t\t}\n\n\t\tfunction rotateUp( angle ) {\n\n\t\t\tsphericalDelta.phi -= angle;\n\n\t\t}\n\n\t\tconst panLeft = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar( - distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tconst panUp = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar( distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\t\tconst element = scope.domElement;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst position = scope.object.position;\n\t\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\t\tlet targetDistance = offset.length();\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\t\tscope.enablePan = false;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}();\n\n\t\tfunction dollyOut( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale /= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction dollyIn( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale *= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\n\t\tfunction handleMouseDownRotate( event ) {\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownDolly( event ) {\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownPan( event ) {\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseMoveRotate( event ) {\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMoveDolly( event ) {\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMovePan( event ) {\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseWheel( event ) {\n\n\t\t\tif ( event.deltaY < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleKeyDown( event ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tscope.update();\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction handleTouchStartRotate() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\trotateStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\trotateStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartPan() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\tpanStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartDolly() {\n\n\t\t\tconst dx = pointers[ 0 ].pageX - pointers[ 1 ].pageX;\n\t\t\tconst dy = pointers[ 0 ].pageY - pointers[ 1 ].pageY;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enablePan ) handleTouchStartPan();\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\n\n\t\t}\n\n\t\tfunction handleTouchMoveRotate( event ) {\n\n\t\t\tif ( pointers.length == 1 ) {\n\n\t\t\t\trotateEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\trotateEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMovePan( event ) {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\tpanEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDolly( event ) {\n\n\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\tconst dx = event.pageX - position.x;\n\t\t\tconst dy = event.pageY - position.y;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyOut( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.setPointerCapture( event.pointerId );\n\n\t\t\t\tscope.domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\taddPointer( event );\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchStart( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseDown( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchMove( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseMove( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t    removePointer( event );\n\n\t\t    if ( pointers.length === 0 ) {\n\n\t\t        scope.domElement.releasePointerCapture( event.pointerId );\n\n\t\t        scope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t        scope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t    }\n\n\t\t    scope.dispatchEvent( _endEvent );\n\n\t\t    state = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onPointerCancel( event ) {\n\n\t\t\tremovePointer( event );\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tlet mouseAction;\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tmouseAction = - 1;\n\n\t\t\t}\n\n\t\t\tswitch ( mouseAction ) {\n\n\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseWheel( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\thandleMouseWheel( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction onKeyDown( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\t\thandleKeyDown( event );\n\n\t\t}\n\n\t\tfunction onTouchStart( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( pointers.length ) {\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchMove( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onContextMenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tfunction addPointer( event ) {\n\n\t\t\tpointers.push( event );\n\n\t\t}\n\n\t\tfunction removePointer( event ) {\n\n\t\t\tdelete pointerPositions[ event.pointerId ];\n\n\t\t\tfor ( let i = 0; i < pointers.length; i ++ ) {\n\n\t\t\t\tif ( pointers[ i ].pointerId == event.pointerId ) {\n\n\t\t\t\t\tpointers.splice( i, 1 );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction trackPointer( event ) {\n\n\t\t\tlet position = pointerPositions[ event.pointerId ];\n\n\t\t\tif ( position === undefined ) {\n\n\t\t\t\tposition = new Vector2();\n\t\t\t\tpointerPositions[ event.pointerId ] = position;\n\n\t\t\t}\n\n\t\t\tposition.set( event.pageX, event.pageY );\n\n\t\t}\n\n\t\tfunction getSecondPointerPosition( event ) {\n\n\t\t\tconst pointer = ( event.pointerId === pointers[ 0 ].pointerId ) ? pointers[ 1 ] : pointers[ 0 ];\n\n\t\t\treturn pointerPositions[ pointer.pointerId ];\n\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.addEventListener( 'pointercancel', onPointerCancel );\n\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\n\n\t\t// force an update at start\n\n\t\tthis.update();\n\n\t}\n\n}\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nclass MapControls extends OrbitControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\t\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\t\tthis.touches.ONE = TOUCH.PAN;\n\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n\t}\n\n}\n\nexport { OrbitControls, MapControls };\n","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\n/*\nFinds knot vector span.\n\np : degree\nu : parametric value\nU : knot vector\n\nreturns the span\n*/\nfunction findSpan( p, u, U ) {\n\n\tconst n = U.length - p - 1;\n\n\tif ( u >= U[ n ] ) {\n\n\t\treturn n - 1;\n\n\t}\n\n\tif ( u <= U[ p ] ) {\n\n\t\treturn p;\n\n\t}\n\n\tlet low = p;\n\tlet high = n;\n\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\tif ( u < U[ mid ] ) {\n\n\t\t\thigh = mid;\n\n\t\t} else {\n\n\t\t\tlow = mid;\n\n\t\t}\n\n\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t}\n\n\treturn mid;\n\n}\n\n\n/*\nCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nU    : knot vector\n\nreturns array[p+1] with basis functions values.\n*/\nfunction calcBasisFunctions( span, u, p, U ) {\n\n\tconst N = [];\n\tconst left = [];\n\tconst right = [];\n\tN[ 0 ] = 1.0;\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\tN[ r ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tN[ j ] = saved;\n\n\t}\n\n\treturn N;\n\n}\n\n\n/*\nCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\np : degree of B-Spline\nU : knot vector\nP : control points (x, y, z, w)\nu : parametric point\n\nreturns point for given u\n*/\nfunction calcBSplinePoint( p, U, P, u ) {\n\n\tconst span = findSpan( p, u, U );\n\tconst N = calcBasisFunctions( span, u, p, U );\n\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tconst point = P[ span - p + j ];\n\t\tconst Nj = N[ j ];\n\t\tconst wNj = point.w * Nj;\n\t\tC.x += point.x * wNj;\n\t\tC.y += point.y * wNj;\n\t\tC.z += point.z * wNj;\n\t\tC.w += point.w * Nj;\n\n\t}\n\n\treturn C;\n\n}\n\n\n/*\nCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nn    : number of derivatives to calculate\nU    : knot vector\n\nreturns array[n+1][p+1] with basis functions derivatives\n*/\nfunction calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\tconst zeroArr = [];\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tzeroArr[ i ] = 0.0;\n\n\tconst ders = [];\n\n\tfor ( let i = 0; i <= n; ++ i )\n\t\tders[ i ] = zeroArr.slice( 0 );\n\n\tconst ndu = [];\n\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\tndu[ 0 ][ 0 ] = 1.0;\n\n\tconst left = zeroArr.slice( 0 );\n\tconst right = zeroArr.slice( 0 );\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tndu[ j ][ j ] = saved;\n\n\t}\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t}\n\n\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\tlet s1 = 0;\n\t\tlet s2 = 1;\n\n\t\tconst a = [];\n\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t}\n\n\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tlet d = 0.0;\n\t\t\tconst rk = r - k;\n\t\t\tconst pk = p - k;\n\n\t\t\tif ( r >= k ) {\n\n\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t}\n\n\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t}\n\n\t\t\tif ( r <= pk ) {\n\n\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t}\n\n\t\t\tders[ k ][ r ] = d;\n\n\t\t\tconst j = s1;\n\t\t\ts1 = s2;\n\t\t\ts2 = j;\n\n\t\t}\n\n\t}\n\n\tlet r = p;\n\n\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ k ][ j ] *= r;\n\n\t\t}\n\n\t\tr *= p - k;\n\n\t}\n\n\treturn ders;\n\n}\n\n\n/*\n\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points\n\tu  : Parametric points\n\tnd : number of derivatives\n\n\treturns array[d+1] with derivatives\n\t*/\nfunction calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\tconst du = nd < p ? nd : p;\n\tconst CK = [];\n\tconst span = findSpan( p, u, U );\n\tconst nders = calcBasisFunctionDerivatives( span, u, p, du, U );\n\tconst Pw = [];\n\n\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\tconst point = P[ i ].clone();\n\t\tconst w = point.w;\n\n\t\tpoint.x *= w;\n\t\tpoint.y *= w;\n\t\tpoint.z *= w;\n\n\t\tPw[ i ] = point;\n\n\t}\n\n\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = point;\n\n\t}\n\n\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate \"K over I\"\n\nreturns k!/(i!(k-i)!)\n*/\nfunction calcKoverI( k, i ) {\n\n\tlet nom = 1;\n\n\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\tnom *= j;\n\n\t}\n\n\tlet denom = 1;\n\n\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\treturn nom / denom;\n\n}\n\n\n/*\nCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\nPders : result of function calcBSplineDerivatives\n\nreturns array with derivatives for rational curve.\n*/\nfunction calcRationalCurveDerivatives( Pders ) {\n\n\tconst nd = Pders.length;\n\tconst Aders = [];\n\tconst wders = [];\n\n\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\tconst point = Pders[ i ];\n\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\twders[ i ] = point.w;\n\n\t}\n\n\tconst CK = [];\n\n\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\tconst v = Aders[ k ].clone();\n\n\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\np  : degree\nU  : knot vector\nP  : control points in homogeneous space\nu  : parametric points\nnd : number of derivatives\n\nreturns array with derivatives.\n*/\nfunction calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\tconst Pders = calcBSplineDerivatives( p, U, P, u, nd );\n\treturn calcRationalCurveDerivatives( Pders );\n\n}\n\n\n/*\nCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\np1, p2 : degrees of B-Spline surface\nU1, U2 : knot vectors\nP      : control points (x, y, z, w)\nu, v   : parametric values\n\nreturns point for given (u, v)\n*/\nfunction calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\tconst uspan = findSpan( p, u, U );\n\tconst vspan = findSpan( q, v, V );\n\tconst Nu = calcBasisFunctions( uspan, u, p, U );\n\tconst Nv = calcBasisFunctions( vspan, v, q, V );\n\tconst temp = [];\n\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\tconst w = point.w;\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t}\n\n\t}\n\n\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t}\n\n\tSw.divideScalar( Sw.w );\n\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n}\n\n\n\nexport {\n\tfindSpan,\n\tcalcBasisFunctions,\n\tcalcBSplinePoint,\n\tcalcBasisFunctionDerivatives,\n\tcalcBSplineDerivatives,\n\tcalcKoverI,\n\tcalcRationalCurveDerivatives,\n\tcalcNURBSDerivatives,\n\tcalcSurfacePoint,\n};\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport * as NURBSUtils from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://wiki.blender.org/index.php/User:Mont29/Foundation/FBX_File_Structure\n * \thttp://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * \tBinary format specification:\n *\t\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value );\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value );\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value );\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.map !== undefined ) {\n\n\t\t\t\t\t\tparameters.map.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.emissiveMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.envMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\t\tparameters.envMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.specularMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.specularMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.createAmbientLight();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' && BindPoseNode[ nodeID ].NbPoseNodes > 0 ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\tcreateAmbientLight() {\n\n\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\tconst r = ambientColor[ 0 ];\n\t\t\tconst g = ambientColor[ 1 ];\n\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\tconst color = new Color( r, g, b );\n\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\tlet name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t// the first uv buffer is just called 'uv'\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tname = 'uv';\n\n\t\t\t}\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tfor ( let i = 2; i < faceLength; i ++ ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tif ( NURBSCurve === undefined ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst points = curve.getPoints( controlPoints.length * 12 );\n\n\t\treturn new BufferGeometry().setFromPoints( points );\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialRotation = new Quaternion();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialRotation = new Euler().setFromQuaternion( initialRotation, rawTracks.eulerOrder ).toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, initialValue, preRotation, postRotation, eulerOrder ) {\n\n\t\tif ( curves.x !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.x );\n\t\t\tcurves.x.values = curves.x.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.y !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.y );\n\t\t\tcurves.y.values = curves.y.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.z !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.z );\n\t\t\tcurves.z.values = curves.z.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curve ) {\n\n\t\tfor ( let i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\tconst initialValue = curve.values[ i - 1 ];\n\t\t\tconst valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\tconst absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\tconst numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\tconst step = valuesSpan / numSubIntervals;\n\t\t\t\tlet nextValue = initialValue + step;\n\n\t\t\t\tconst initialTime = curve.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\tconst interval = timeSpan / numSubIntervals;\n\t\t\t\tlet nextTime = initialTime + interval;\n\n\t\t\t\tconst interpolatedTimes = [];\n\t\t\t\tconst interpolatedValues = [];\n\n\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\tnextValue += step;\n\n\t\t\t\t}\n\n\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( typeof fflate === 'undefined' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library fflate.min.js required.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\tlet a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta[ i ] = this.getUint8();\n\n\t\t}\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\treturn LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n// inject array a2 into array a1 at index\nfunction inject( a1, index, a2 ) {\n\n\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n}\n\nexport { FBXLoader };\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRGBFormat,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTangentSpaceNormalMap,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\tresourcePath = this.path;\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetDDSLoader() {\n\n\t\tthrow new Error(\n\n\t\t\t'THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".'\n\n\t\t);\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet content;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tcontent = data;\n\n\t\t} else {\n\n\t\t\tconst magic = LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t} else {\n\n\t\t\t\tcontent = LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst json = JSON.parse( content );\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenColor.fromArray( extension.sheenColorFactor );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || 0;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ] );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ] );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture ).then( function ( texture ) {\n\n\t\t\t\ttexture.encoding = sRGBEncoding;\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst source = json.images[ extension.source ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn Promise.all( [ buffer, decoder.ready ] ).then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\tconst source = new Uint8Array( res[ 0 ], byteOffset, byteLength );\n\n\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\treturn result;\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\tif ( transform.offset === undefined && transform.rotation === undefined && transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n */\n\n/**\n * A sub class of StandardMaterial with some of the functionality\n * changed via the `onBeforeCompile` callback\n * @pailhead\n */\nclass GLTFMeshStandardSGMaterial extends MeshStandardMaterial {\n\n\tconstructor( params ) {\n\n\t\tsuper();\n\n\t\tthis.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t//various chunks that need replacing\n\t\tconst specularMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst specularMapFragmentChunk = [\n\t\t\t'vec3 specularFactor = specular;',\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapFragmentChunk = [\n\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst lightPhysicalFragmentChunk = [\n\t\t\t'PhysicalMaterial material;',\n\t\t\t'material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );',\n\t\t\t'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n\t\t\t'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n\t\t\t'material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.',\n\t\t\t'material.roughness += geometryRoughness;',\n\t\t\t'material.roughness = min( material.roughness, 1.0 );',\n\t\t\t'material.specularColor = specularFactor;',\n\t\t].join( '\\n' );\n\n\t\tconst uniforms = {\n\t\t\tspecular: { value: new Color().setHex( 0xffffff ) },\n\t\t\tglossiness: { value: 1 },\n\t\t\tspecularMap: { value: null },\n\t\t\tglossinessMap: { value: null }\n\t\t};\n\n\t\tthis._extraUniforms = uniforms;\n\n\t\tthis.onBeforeCompile = function ( shader ) {\n\n\t\t\tfor ( const uniformName in uniforms ) {\n\n\t\t\t\tshader.uniforms[ uniformName ] = uniforms[ uniformName ];\n\n\t\t\t}\n\n\t\t\tshader.fragmentShader = shader.fragmentShader\n\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t};\n\n\t\tObject.defineProperties( this, {\n\n\t\t\tspecular: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specular.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specular.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tspecularMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specularMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specularMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_SPECULARMAP = ''; // USE_UV is set by the renderer for specular maps\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_SPECULARMAP;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossiness: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossiness.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossiness.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossinessMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossinessMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossinessMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t\tthis.defines.USE_UV = '';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_GLOSSINESSMAP;\n\t\t\t\t\t\tdelete this.defines.USE_UV;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.specularMap = source.specularMap;\n\t\tthis.specular.copy( source.specular );\n\t\tthis.glossinessMap = source.glossinessMap;\n\t\tthis.glossiness = source.glossiness;\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\t\treturn this;\n\n\t}\n\n}\n\n\nclass GLTFMaterialsPbrSpecularGlossinessExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS;\n\n\t\tthis.specularGlossinessParams = [\n\t\t\t'color',\n\t\t\t'map',\n\t\t\t'lightMap',\n\t\t\t'lightMapIntensity',\n\t\t\t'aoMap',\n\t\t\t'aoMapIntensity',\n\t\t\t'emissive',\n\t\t\t'emissiveIntensity',\n\t\t\t'emissiveMap',\n\t\t\t'bumpMap',\n\t\t\t'bumpScale',\n\t\t\t'normalMap',\n\t\t\t'normalMapType',\n\t\t\t'displacementMap',\n\t\t\t'displacementScale',\n\t\t\t'displacementBias',\n\t\t\t'specularMap',\n\t\t\t'specular',\n\t\t\t'glossinessMap',\n\t\t\t'glossiness',\n\t\t\t'alphaMap',\n\t\t\t'envMap',\n\t\t\t'envMapIntensity',\n\t\t\t'refractionRatio',\n\t\t];\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn GLTFMeshStandardSGMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst pending = [];\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\tconst array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\tmaterialParams.color.fromArray( array );\n\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.emissive = new Color( 0.0, 0.0, 0.0 );\n\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\tmaterialParams.specular = new Color( 1.0, 1.0, 1.0 );\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\tconst specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\tcreateMaterial( materialParams ) {\n\n\t\tconst material = new GLTFMeshStandardSGMaterial( materialParams );\n\t\tmaterial.fog = true;\n\n\t\tmaterial.color = materialParams.color;\n\n\t\tmaterial.map = materialParams.map === undefined ? null : materialParams.map;\n\n\t\tmaterial.lightMap = null;\n\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\tmaterial.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\tmaterial.emissive = materialParams.emissive;\n\t\tmaterial.emissiveIntensity = 1.0;\n\t\tmaterial.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n\t\tmaterial.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n\t\tmaterial.bumpScale = 1;\n\n\t\tmaterial.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;\n\t\tmaterial.normalMapType = TangentSpaceNormalMap;\n\n\t\tif ( materialParams.normalScale ) material.normalScale = materialParams.normalScale;\n\n\t\tmaterial.displacementMap = null;\n\t\tmaterial.displacementScale = 1;\n\t\tmaterial.displacementBias = 0;\n\n\t\tmaterial.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;\n\t\tmaterial.specular = materialParams.specular;\n\n\t\tmaterial.glossinessMap = materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n\t\tmaterial.glossiness = materialParams.glossiness;\n\n\t\tmaterial.alphaMap = null;\n\n\t\tmaterial.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n\t\tmaterial.envMapIntensity = 1.0;\n\n\t\tmaterial.refractionRatio = 0.98;\n\n\t\treturn material;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\tconst result = this.resultBuffer;\n\tconst values = this.sampleValues;\n\tconst stride = this.valueSize;\n\n\tconst stride2 = stride * 2;\n\tconst stride3 = stride * 3;\n\n\tconst td = t1 - t0;\n\n\tconst p = ( t - t0 ) / td;\n\tconst pp = p * p;\n\tconst ppp = pp * p;\n\n\tconst offset1 = i1 * stride3;\n\tconst offset0 = offset1 - stride3;\n\n\tconst s2 = - 2 * ppp + 3 * pp;\n\tconst s3 = ppp - pp;\n\tconst s0 = 1 - s2;\n\tconst s1 = s3 - pp + p;\n\n\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t}\n\n\treturn result;\n\n};\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv2',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\tlet geometryKey;\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\t\tif ( typeof createImageBitmap !== 'undefined' && /Firefox/.test( navigator.userAgent ) === false ) {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\tPromise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst source = json.images[ textureDef.source ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, source, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tconst cacheKey = ( source.uri || source.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = source.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( source.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + textureIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name ) texture.name = textureDef.name;\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\t// Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n\t\t\t// However, we will copy UV set 0 to UV set 1 on demand for aoMap\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord != 0 && ! ( mapName === 'aoMap' && mapDef.texCoord == 1 ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV set ' + mapDef.texCoord + ' for texture ' + mapName + ' not yet supported.' );\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tgeometry.setAttribute( 'uv2', geometry.attributes.uv );\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tconst sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.format = RGBFormat;\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tlet material;\n\n\t\t\tif ( materialType === GLTFMeshStandardSGMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tlet name = sanitizedName;\n\n\t\tfor ( let i = 1; this.nodeNamesUsed[ name ]; ++ i ) {\n\n\t\t\tname = sanitizedName + '_' + i;\n\n\t\t}\n\n\t\tthis.nodeNamesUsed[ name ] = true;\n\n\t\treturn name;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true && ! mesh.geometry.attributes.skinWeight.normalized ) {\n\n\t\t\t\t\t\t// we normalize floating point skin weight array to fix malformed assets (see #15319)\n\t\t\t\t\t\t// it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tlet TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tconst targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\t\t\t\tconst targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tlet outputArray = outputAccessor.array;\n\n\t\t\t\tif ( outputAccessor.normalized ) {\n\n\t\t\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutputArray = scaled;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputArray,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\t\t\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\treturn ( function () {\n\n\t\t\tconst pending = [];\n\n\t\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t\t} );\n\n\t\t\tif ( meshPromise ) {\n\n\t\t\t\tpending.push( meshPromise );\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t\t} ).forEach( function ( promise ) {\n\n\t\t\t\tpending.push( promise );\n\n\t\t\t} );\n\n\t\t\treturn Promise.all( pending );\n\n\t\t}() ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( buildNodeHierarchy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n}\n\nfunction buildNodeHierarchy( nodeId, parentObject, json, parser ) {\n\n\tconst nodeDef = json.nodes[ nodeId ];\n\n\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t// build skeleton here as well\n\n\t\tlet skinEntry;\n\n\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\tskinEntry = skin;\n\n\t\t\tconst pendingJoints = [];\n\n\t\t\tfor ( let i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pendingJoints );\n\n\t\t} ).then( function ( jointNodes ) {\n\n\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\tif ( ! mesh.isMesh ) return;\n\n\t\t\t\tconst bones = [];\n\t\t\t\tconst boneInverses = [];\n\n\t\t\t\tfor ( let j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst jointNode = jointNodes[ j ];\n\n\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.bind( new Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t} );\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t} ).then( function ( node ) {\n\n\t\t// build node hierachy\n\n\t\tparentObject.add( node );\n\n\t\tconst pending = [];\n\n\t\tif ( nodeDef.children ) {\n\n\t\t\tconst children = nodeDef.children;\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tpending.push( buildNodeHierarchy( child, node, json, parser ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {Number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tlet index = geometry.getIndex();\n\n\t// generate index if not present\n\n\tif ( index === null ) {\n\n\t\tconst indices = [];\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\tindices.push( i );\n\n\t\t\t}\n\n\t\t\tgeometry.setIndex( indices );\n\t\t\tindex = geometry.getIndex();\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\treturn geometry;\n\n\t\t}\n\n\t}\n\n\t//\n\n\tconst numberOfTriangles = index.count - 2;\n\tconst newIndices = [];\n\n\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t// gl.TRIANGLE_FAN\n\n\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t}\n\n\t} else {\n\n\t\t// gl.TRIANGLE_STRIP\n\n\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\n\t\t\t} else {\n\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t}\n\n\t// build final geometry\n\n\tconst newGeometry = geometry.clone();\n\tnewGeometry.setIndex( newIndices );\n\n\treturn newGeometry;\n\n}\n\nexport { GLTFLoader };\n","import {\n\tBufferGeometry,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLineBasicMaterial,\n\tLineSegments,\n\tLoader,\n\tMaterial,\n\tMesh,\n\tMeshPhongMaterial,\n\tPoints,\n\tPointsMaterial,\n\tVector3\n} from 'three';\n\n// o object_name | g group_name\nconst _object_pattern = /^[og]\\s*(.+)?/;\n// mtllib file_reference\nconst _material_library_pattern = /^mtllib /;\n// usemtl material_name\nconst _material_use_pattern = /^usemtl /;\n// usemap map_name\nconst _map_use_pattern = /^usemap /;\n\nconst _vA = new Vector3();\nconst _vB = new Vector3();\nconst _vC = new Vector3();\n\nconst _ab = new Vector3();\nconst _cb = new Vector3();\n\nfunction ParserState() {\n\n\tconst state = {\n\t\tobjects: [],\n\t\tobject: {},\n\n\t\tvertices: [],\n\t\tnormals: [],\n\t\tcolors: [],\n\t\tuvs: [],\n\n\t\tmaterials: {},\n\t\tmaterialLibraries: [],\n\n\t\tstartObject: function ( name, fromDeclaration ) {\n\n\t\t\t// If the current object (initial from reset) is not from a g/o declaration in the parsed\n\t\t\t// file. We need to use it for the first parsed g/o to keep things in sync.\n\t\t\tif ( this.object && this.object.fromDeclaration === false ) {\n\n\t\t\t\tthis.object.name = name;\n\t\t\t\tthis.object.fromDeclaration = ( fromDeclaration !== false );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst previousMaterial = ( this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined );\n\n\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\tthis.object._finalize( true );\n\n\t\t\t}\n\n\t\t\tthis.object = {\n\t\t\t\tname: name || '',\n\t\t\t\tfromDeclaration: ( fromDeclaration !== false ),\n\n\t\t\t\tgeometry: {\n\t\t\t\t\tvertices: [],\n\t\t\t\t\tnormals: [],\n\t\t\t\t\tcolors: [],\n\t\t\t\t\tuvs: [],\n\t\t\t\t\thasUVIndices: false\n\t\t\t\t},\n\t\t\t\tmaterials: [],\n\t\t\t\tsmooth: true,\n\n\t\t\t\tstartMaterial: function ( name, libraries ) {\n\n\t\t\t\t\tconst previous = this._finalize( false );\n\n\t\t\t\t\t// New usemtl declaration overwrites an inherited material, except if faces were declared\n\t\t\t\t\t// after the material, then it must be preserved for proper MultiMaterial continuation.\n\t\t\t\t\tif ( previous && ( previous.inherited || previous.groupCount <= 0 ) ) {\n\n\t\t\t\t\t\tthis.materials.splice( previous.index, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst material = {\n\t\t\t\t\t\tindex: this.materials.length,\n\t\t\t\t\t\tname: name || '',\n\t\t\t\t\t\tmtllib: ( Array.isArray( libraries ) && libraries.length > 0 ? libraries[ libraries.length - 1 ] : '' ),\n\t\t\t\t\t\tsmooth: ( previous !== undefined ? previous.smooth : this.smooth ),\n\t\t\t\t\t\tgroupStart: ( previous !== undefined ? previous.groupEnd : 0 ),\n\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\tinherited: false,\n\n\t\t\t\t\t\tclone: function ( index ) {\n\n\t\t\t\t\t\t\tconst cloned = {\n\t\t\t\t\t\t\t\tindex: ( typeof index === 'number' ? index : this.index ),\n\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\tmtllib: this.mtllib,\n\t\t\t\t\t\t\t\tsmooth: this.smooth,\n\t\t\t\t\t\t\t\tgroupStart: 0,\n\t\t\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\t\t\tinherited: false\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcloned.clone = this.clone.bind( cloned );\n\t\t\t\t\t\t\treturn cloned;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.materials.push( material );\n\n\t\t\t\t\treturn material;\n\n\t\t\t\t},\n\n\t\t\t\tcurrentMaterial: function () {\n\n\t\t\t\t\tif ( this.materials.length > 0 ) {\n\n\t\t\t\t\t\treturn this.materials[ this.materials.length - 1 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn undefined;\n\n\t\t\t\t},\n\n\t\t\t\t_finalize: function ( end ) {\n\n\t\t\t\t\tconst lastMultiMaterial = this.currentMaterial();\n\t\t\t\t\tif ( lastMultiMaterial && lastMultiMaterial.groupEnd === - 1 ) {\n\n\t\t\t\t\t\tlastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;\n\t\t\t\t\t\tlastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;\n\t\t\t\t\t\tlastMultiMaterial.inherited = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Ignore objects tail materials if no face declarations followed them before a new o/g started.\n\t\t\t\t\tif ( end && this.materials.length > 1 ) {\n\n\t\t\t\t\t\tfor ( let mi = this.materials.length - 1; mi >= 0; mi -- ) {\n\n\t\t\t\t\t\t\tif ( this.materials[ mi ].groupCount <= 0 ) {\n\n\t\t\t\t\t\t\t\tthis.materials.splice( mi, 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Guarantee at least one empty material, this makes the creation later more straight forward.\n\t\t\t\t\tif ( end && this.materials.length === 0 ) {\n\n\t\t\t\t\t\tthis.materials.push( {\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\tsmooth: this.smooth\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn lastMultiMaterial;\n\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Inherit previous objects material.\n\t\t\t// Spec tells us that a declared material must be set to all objects until a new material is declared.\n\t\t\t// If a usemtl declaration is encountered while this new object is being parsed, it will\n\t\t\t// overwrite the inherited material. Exception being that there was already face declarations\n\t\t\t// to the inherited material, then it will be preserved for proper MultiMaterial continuation.\n\n\t\t\tif ( previousMaterial && previousMaterial.name && typeof previousMaterial.clone === 'function' ) {\n\n\t\t\t\tconst declared = previousMaterial.clone( 0 );\n\t\t\t\tdeclared.inherited = true;\n\t\t\t\tthis.object.materials.push( declared );\n\n\t\t\t}\n\n\t\t\tthis.objects.push( this.object );\n\n\t\t},\n\n\t\tfinalize: function () {\n\n\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\tthis.object._finalize( true );\n\n\t\t\t}\n\n\t\t},\n\n\t\tparseVertexIndex: function ( value, len ) {\n\n\t\t\tconst index = parseInt( value, 10 );\n\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t},\n\n\t\tparseNormalIndex: function ( value, len ) {\n\n\t\t\tconst index = parseInt( value, 10 );\n\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t},\n\n\t\tparseUVIndex: function ( value, len ) {\n\n\t\t\tconst index = parseInt( value, 10 );\n\t\t\treturn ( index >= 0 ? index - 1 : index + len / 2 ) * 2;\n\n\t\t},\n\n\t\taddVertex: function ( a, b, c ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.vertices;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t},\n\n\t\taddVertexPoint: function ( a ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.vertices;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t},\n\n\t\taddVertexLine: function ( a ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.vertices;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t},\n\n\t\taddNormal: function ( a, b, c ) {\n\n\t\t\tconst src = this.normals;\n\t\t\tconst dst = this.object.geometry.normals;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t},\n\n\t\taddFaceNormal: function ( a, b, c ) {\n\n\t\t\tconst src = this.vertices;\n\t\t\tconst dst = this.object.geometry.normals;\n\n\t\t\t_vA.fromArray( src, a );\n\t\t\t_vB.fromArray( src, b );\n\t\t\t_vC.fromArray( src, c );\n\n\t\t\t_cb.subVectors( _vC, _vB );\n\t\t\t_ab.subVectors( _vA, _vB );\n\t\t\t_cb.cross( _ab );\n\n\t\t\t_cb.normalize();\n\n\t\t\tdst.push( _cb.x, _cb.y, _cb.z );\n\t\t\tdst.push( _cb.x, _cb.y, _cb.z );\n\t\t\tdst.push( _cb.x, _cb.y, _cb.z );\n\n\t\t},\n\n\t\taddColor: function ( a, b, c ) {\n\n\t\t\tconst src = this.colors;\n\t\t\tconst dst = this.object.geometry.colors;\n\n\t\t\tif ( src[ a ] !== undefined ) dst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\tif ( src[ b ] !== undefined ) dst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\tif ( src[ c ] !== undefined ) dst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t},\n\n\t\taddUV: function ( a, b, c ) {\n\n\t\t\tconst src = this.uvs;\n\t\t\tconst dst = this.object.geometry.uvs;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ] );\n\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ] );\n\n\t\t},\n\n\t\taddDefaultUV: function () {\n\n\t\t\tconst dst = this.object.geometry.uvs;\n\n\t\t\tdst.push( 0, 0 );\n\t\t\tdst.push( 0, 0 );\n\t\t\tdst.push( 0, 0 );\n\n\t\t},\n\n\t\taddUVLine: function ( a ) {\n\n\t\t\tconst src = this.uvs;\n\t\t\tconst dst = this.object.geometry.uvs;\n\n\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\n\t\t},\n\n\t\taddFace: function ( a, b, c, ua, ub, uc, na, nb, nc ) {\n\n\t\t\tconst vLen = this.vertices.length;\n\n\t\t\tlet ia = this.parseVertexIndex( a, vLen );\n\t\t\tlet ib = this.parseVertexIndex( b, vLen );\n\t\t\tlet ic = this.parseVertexIndex( c, vLen );\n\n\t\t\tthis.addVertex( ia, ib, ic );\n\t\t\tthis.addColor( ia, ib, ic );\n\n\t\t\t// normals\n\n\t\t\tif ( na !== undefined && na !== '' ) {\n\n\t\t\t\tconst nLen = this.normals.length;\n\n\t\t\t\tia = this.parseNormalIndex( na, nLen );\n\t\t\t\tib = this.parseNormalIndex( nb, nLen );\n\t\t\t\tic = this.parseNormalIndex( nc, nLen );\n\n\t\t\t\tthis.addNormal( ia, ib, ic );\n\n\t\t\t} else {\n\n\t\t\t\tthis.addFaceNormal( ia, ib, ic );\n\n\t\t\t}\n\n\t\t\t// uvs\n\n\t\t\tif ( ua !== undefined && ua !== '' ) {\n\n\t\t\t\tconst uvLen = this.uvs.length;\n\n\t\t\t\tia = this.parseUVIndex( ua, uvLen );\n\t\t\t\tib = this.parseUVIndex( ub, uvLen );\n\t\t\t\tic = this.parseUVIndex( uc, uvLen );\n\n\t\t\t\tthis.addUV( ia, ib, ic );\n\n\t\t\t\tthis.object.geometry.hasUVIndices = true;\n\n\t\t\t} else {\n\n\t\t\t\t// add placeholder values (for inconsistent face definitions)\n\n\t\t\t\tthis.addDefaultUV();\n\n\t\t\t}\n\n\t\t},\n\n\t\taddPointGeometry: function ( vertices ) {\n\n\t\t\tthis.object.geometry.type = 'Points';\n\n\t\t\tconst vLen = this.vertices.length;\n\n\t\t\tfor ( let vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\tconst index = this.parseVertexIndex( vertices[ vi ], vLen );\n\n\t\t\t\tthis.addVertexPoint( index );\n\t\t\t\tthis.addColor( index );\n\n\t\t\t}\n\n\t\t},\n\n\t\taddLineGeometry: function ( vertices, uvs ) {\n\n\t\t\tthis.object.geometry.type = 'Line';\n\n\t\t\tconst vLen = this.vertices.length;\n\t\t\tconst uvLen = this.uvs.length;\n\n\t\t\tfor ( let vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\tthis.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t}\n\n\t\t\tfor ( let uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {\n\n\t\t\t\tthis.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tstate.startObject( '', false );\n\n\treturn state;\n\n}\n\n//\n\nclass OBJLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.materials = null;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tsetMaterials( materials ) {\n\n\t\tthis.materials = materials;\n\n\t\treturn this;\n\n\t}\n\n\tparse( text ) {\n\n\t\tconst state = new ParserState();\n\n\t\tif ( text.indexOf( '\\r\\n' ) !== - 1 ) {\n\n\t\t\t// This is faster than String.split with regex that splits on both\n\t\t\ttext = text.replace( /\\r\\n/g, '\\n' );\n\n\t\t}\n\n\t\tif ( text.indexOf( '\\\\\\n' ) !== - 1 ) {\n\n\t\t\t// join lines separated by a line continuation character (\\)\n\t\t\ttext = text.replace( /\\\\\\n/g, '' );\n\n\t\t}\n\n\t\tconst lines = text.split( '\\n' );\n\t\tlet line = '', lineFirstChar = '';\n\t\tlet lineLength = 0;\n\t\tlet result = [];\n\n\t\t// Faster to just trim left side of the line. Use if available.\n\t\tconst trimLeft = ( typeof ''.trimLeft === 'function' );\n\n\t\tfor ( let i = 0, l = lines.length; i < l; i ++ ) {\n\n\t\t\tline = lines[ i ];\n\n\t\t\tline = trimLeft ? line.trimLeft() : line.trim();\n\n\t\t\tlineLength = line.length;\n\n\t\t\tif ( lineLength === 0 ) continue;\n\n\t\t\tlineFirstChar = line.charAt( 0 );\n\n\t\t\t// @todo invoke passed in handler if any\n\t\t\tif ( lineFirstChar === '#' ) continue;\n\n\t\t\tif ( lineFirstChar === 'v' ) {\n\n\t\t\t\tconst data = line.split( /\\s+/ );\n\n\t\t\t\tswitch ( data[ 0 ] ) {\n\n\t\t\t\t\tcase 'v':\n\t\t\t\t\t\tstate.vertices.push(\n\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif ( data.length >= 7 ) {\n\n\t\t\t\t\t\t\tstate.colors.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 4 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 5 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 6 ] )\n\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// if no colors are defined, add placeholders so color and vertex indices match\n\n\t\t\t\t\t\t\tstate.colors.push( undefined, undefined, undefined );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'vn':\n\t\t\t\t\t\tstate.normals.push(\n\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'vt':\n\t\t\t\t\t\tstate.uvs.push(\n\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\tparseFloat( data[ 2 ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t} else if ( lineFirstChar === 'f' ) {\n\n\t\t\t\tconst lineData = line.substr( 1 ).trim();\n\t\t\t\tconst vertexData = lineData.split( /\\s+/ );\n\t\t\t\tconst faceVertices = [];\n\n\t\t\t\t// Parse the face vertex data into an easy to work with format\n\n\t\t\t\tfor ( let j = 0, jl = vertexData.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst vertex = vertexData[ j ];\n\n\t\t\t\t\tif ( vertex.length > 0 ) {\n\n\t\t\t\t\t\tconst vertexParts = vertex.split( '/' );\n\t\t\t\t\t\tfaceVertices.push( vertexParts );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Draw an edge between the first vertex and all subsequent vertices to form an n-gon\n\n\t\t\t\tconst v1 = faceVertices[ 0 ];\n\n\t\t\t\tfor ( let j = 1, jl = faceVertices.length - 1; j < jl; j ++ ) {\n\n\t\t\t\t\tconst v2 = faceVertices[ j ];\n\t\t\t\t\tconst v3 = faceVertices[ j + 1 ];\n\n\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\tv1[ 0 ], v2[ 0 ], v3[ 0 ],\n\t\t\t\t\t\tv1[ 1 ], v2[ 1 ], v3[ 1 ],\n\t\t\t\t\t\tv1[ 2 ], v2[ 2 ], v3[ 2 ]\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t} else if ( lineFirstChar === 'l' ) {\n\n\t\t\t\tconst lineParts = line.substring( 1 ).trim().split( ' ' );\n\t\t\t\tlet lineVertices = [];\n\t\t\t\tconst lineUVs = [];\n\n\t\t\t\tif ( line.indexOf( '/' ) === - 1 ) {\n\n\t\t\t\t\tlineVertices = lineParts;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( let li = 0, llen = lineParts.length; li < llen; li ++ ) {\n\n\t\t\t\t\t\tconst parts = lineParts[ li ].split( '/' );\n\n\t\t\t\t\t\tif ( parts[ 0 ] !== '' ) lineVertices.push( parts[ 0 ] );\n\t\t\t\t\t\tif ( parts[ 1 ] !== '' ) lineUVs.push( parts[ 1 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tstate.addLineGeometry( lineVertices, lineUVs );\n\n\t\t\t} else if ( lineFirstChar === 'p' ) {\n\n\t\t\t\tconst lineData = line.substr( 1 ).trim();\n\t\t\t\tconst pointData = lineData.split( ' ' );\n\n\t\t\t\tstate.addPointGeometry( pointData );\n\n\t\t\t} else if ( ( result = _object_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t// o object_name\n\t\t\t\t// or\n\t\t\t\t// g group_name\n\n\t\t\t\t// WORKAROUND: https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t// let name = result[ 0 ].substr( 1 ).trim();\n\t\t\t\tconst name = ( ' ' + result[ 0 ].substr( 1 ).trim() ).substr( 1 );\n\n\t\t\t\tstate.startObject( name );\n\n\t\t\t} else if ( _material_use_pattern.test( line ) ) {\n\n\t\t\t\t// material\n\n\t\t\t\tstate.object.startMaterial( line.substring( 7 ).trim(), state.materialLibraries );\n\n\t\t\t} else if ( _material_library_pattern.test( line ) ) {\n\n\t\t\t\t// mtl file\n\n\t\t\t\tstate.materialLibraries.push( line.substring( 7 ).trim() );\n\n\t\t\t} else if ( _map_use_pattern.test( line ) ) {\n\n\t\t\t\t// the line is parsed but ignored since the loader assumes textures are defined MTL files\n\t\t\t\t// (according to https://www.okino.com/conv/imp_wave.htm, 'usemap' is the old-style Wavefront texture reference method)\n\n\t\t\t\tconsole.warn( 'THREE.OBJLoader: Rendering identifier \"usemap\" not supported. Textures must be defined in MTL files.' );\n\n\t\t\t} else if ( lineFirstChar === 's' ) {\n\n\t\t\t\tresult = line.split( ' ' );\n\n\t\t\t\t// smooth shading\n\n\t\t\t\t// @todo Handle files that have varying smooth values for a set of faces inside one geometry,\n\t\t\t\t// but does not define a usemtl for each face set.\n\t\t\t\t// This should be detected and a dummy material created (later MultiMaterial and geometry groups).\n\t\t\t\t// This requires some care to not create extra material on each smooth value for \"normal\" obj files.\n\t\t\t\t// where explicit usemtl defines geometry groups.\n\t\t\t\t// Example asset: examples/models/obj/cerberus/Cerberus.obj\n\n\t\t\t\t/*\n\t\t\t\t\t * http://paulbourke.net/dataformats/obj/\n\t\t\t\t\t * or\n\t\t\t\t\t * http://www.cs.utah.edu/~boulos/cs3505/obj_spec.pdf\n\t\t\t\t\t *\n\t\t\t\t\t * From chapter \"Grouping\" Syntax explanation \"s group_number\":\n\t\t\t\t\t * \"group_number is the smoothing group number. To turn off smoothing groups, use a value of 0 or off.\n\t\t\t\t\t * Polygonal elements use group numbers to put elements in different smoothing groups. For free-form\n\t\t\t\t\t * surfaces, smoothing groups are either turned on or off; there is no difference between values greater\n\t\t\t\t\t * than 0.\"\n\t\t\t\t\t */\n\t\t\t\tif ( result.length > 1 ) {\n\n\t\t\t\t\tconst value = result[ 1 ].trim().toLowerCase();\n\t\t\t\t\tstate.object.smooth = ( value !== '0' && value !== 'off' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// ZBrush can produce \"s\" lines #11707\n\t\t\t\t\tstate.object.smooth = true;\n\n\t\t\t\t}\n\n\t\t\t\tconst material = state.object.currentMaterial();\n\t\t\t\tif ( material ) material.smooth = state.object.smooth;\n\n\t\t\t} else {\n\n\t\t\t\t// Handle null terminated files without exception\n\t\t\t\tif ( line === '\\0' ) continue;\n\n\t\t\t\tconsole.warn( 'THREE.OBJLoader: Unexpected line: \"' + line + '\"' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.finalize();\n\n\t\tconst container = new Group();\n\t\tcontainer.materialLibraries = [].concat( state.materialLibraries );\n\n\t\tconst hasPrimitives = ! ( state.objects.length === 1 && state.objects[ 0 ].geometry.vertices.length === 0 );\n\n\t\tif ( hasPrimitives === true ) {\n\n\t\t\tfor ( let i = 0, l = state.objects.length; i < l; i ++ ) {\n\n\t\t\t\tconst object = state.objects[ i ];\n\t\t\t\tconst geometry = object.geometry;\n\t\t\t\tconst materials = object.materials;\n\t\t\t\tconst isLine = ( geometry.type === 'Line' );\n\t\t\t\tconst isPoints = ( geometry.type === 'Points' );\n\t\t\t\tlet hasVertexColors = false;\n\n\t\t\t\t// Skip o/g line declarations that did not follow with any faces\n\t\t\t\tif ( geometry.vertices.length === 0 ) continue;\n\n\t\t\t\tconst buffergeometry = new BufferGeometry();\n\n\t\t\t\tbuffergeometry.setAttribute( 'position', new Float32BufferAttribute( geometry.vertices, 3 ) );\n\n\t\t\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'normal', new Float32BufferAttribute( geometry.normals, 3 ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\t\t\thasVertexColors = true;\n\t\t\t\t\tbuffergeometry.setAttribute( 'color', new Float32BufferAttribute( geometry.colors, 3 ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.hasUVIndices === true ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'uv', new Float32BufferAttribute( geometry.uvs, 2 ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Create materials\n\n\t\t\t\tconst createdMaterials = [];\n\n\t\t\t\tfor ( let mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\tconst sourceMaterial = materials[ mi ];\n\t\t\t\t\tconst materialHash = sourceMaterial.name + '_' + sourceMaterial.smooth + '_' + hasVertexColors;\n\t\t\t\t\tlet material = state.materials[ materialHash ];\n\n\t\t\t\t\tif ( this.materials !== null ) {\n\n\t\t\t\t\t\tmaterial = this.materials.create( sourceMaterial.name );\n\n\t\t\t\t\t\t// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.\n\t\t\t\t\t\tif ( isLine && material && ! ( material instanceof LineBasicMaterial ) ) {\n\n\t\t\t\t\t\t\tconst materialLine = new LineBasicMaterial();\n\t\t\t\t\t\t\tMaterial.prototype.copy.call( materialLine, material );\n\t\t\t\t\t\t\tmaterialLine.color.copy( material.color );\n\t\t\t\t\t\t\tmaterial = materialLine;\n\n\t\t\t\t\t\t} else if ( isPoints && material && ! ( material instanceof PointsMaterial ) ) {\n\n\t\t\t\t\t\t\tconst materialPoints = new PointsMaterial( { size: 10, sizeAttenuation: false } );\n\t\t\t\t\t\t\tMaterial.prototype.copy.call( materialPoints, material );\n\t\t\t\t\t\t\tmaterialPoints.color.copy( material.color );\n\t\t\t\t\t\t\tmaterialPoints.map = material.map;\n\t\t\t\t\t\t\tmaterial = materialPoints;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( material === undefined ) {\n\n\t\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\t\tmaterial = new LineBasicMaterial();\n\n\t\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\t\tmaterial = new PointsMaterial( { size: 1, sizeAttenuation: false } );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tmaterial = new MeshPhongMaterial();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaterial.name = sourceMaterial.name;\n\t\t\t\t\t\tmaterial.flatShading = sourceMaterial.smooth ? false : true;\n\t\t\t\t\t\tmaterial.vertexColors = hasVertexColors;\n\n\t\t\t\t\t\tstate.materials[ materialHash ] = material;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcreatedMaterials.push( material );\n\n\t\t\t\t}\n\n\t\t\t\t// Create mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tif ( createdMaterials.length > 1 ) {\n\n\t\t\t\t\tfor ( let mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\t\tconst sourceMaterial = materials[ mi ];\n\t\t\t\t\t\tbuffergeometry.addGroup( sourceMaterial.groupStart, sourceMaterial.groupCount, mi );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new LineSegments( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new Points( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new Mesh( buffergeometry, createdMaterials );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new LineSegments( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new Points( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new Mesh( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = object.name;\n\n\t\t\t\tcontainer.add( mesh );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// if there is only the default parser state object with no geometry data, interpret data as point cloud\n\n\t\t\tif ( state.vertices.length > 0 ) {\n\n\t\t\t\tconst material = new PointsMaterial( { size: 1, sizeAttenuation: false } );\n\n\t\t\t\tconst buffergeometry = new BufferGeometry();\n\n\t\t\t\tbuffergeometry.setAttribute( 'position', new Float32BufferAttribute( state.vertices, 3 ) );\n\n\t\t\t\tif ( state.colors.length > 0 && state.colors[ 0 ] !== undefined ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'color', new Float32BufferAttribute( state.colors, 3 ) );\n\t\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t\t}\n\n\t\t\t\tconst points = new Points( buffergeometry, material );\n\t\t\t\tcontainer.add( points );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn container;\n\n\t}\n\n}\n\nexport { OBJLoader };\n","import {\n\tAdditiveBlending,\n\tBox2,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDataTexture,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tMesh,\n\tMeshBasicMaterial,\n\tNearestFilter,\n\tRGBFormat,\n\tRawShaderMaterial,\n\tVector2,\n\tVector3,\n\tVector4\n} from 'three';\n\nclass Lensflare extends Mesh {\n\n\tconstructor() {\n\n\t\tsuper( Lensflare.Geometry, new MeshBasicMaterial( { opacity: 0, transparent: true } ) );\n\n\t\tthis.type = 'Lensflare';\n\t\tthis.frustumCulled = false;\n\t\tthis.renderOrder = Infinity;\n\n\t\t//\n\n\t\tconst positionScreen = new Vector3();\n\t\tconst positionView = new Vector3();\n\n\t\t// textures\n\n\t\tconst tempMap = new DataTexture( new Uint8Array( 16 * 16 * 3 ), 16, 16, RGBFormat );\n\t\ttempMap.minFilter = NearestFilter;\n\t\ttempMap.magFilter = NearestFilter;\n\t\ttempMap.wrapS = ClampToEdgeWrapping;\n\t\ttempMap.wrapT = ClampToEdgeWrapping;\n\n\t\tconst occlusionMap = new DataTexture( new Uint8Array( 16 * 16 * 3 ), 16, 16, RGBFormat );\n\t\tocclusionMap.minFilter = NearestFilter;\n\t\tocclusionMap.magFilter = NearestFilter;\n\t\tocclusionMap.wrapS = ClampToEdgeWrapping;\n\t\tocclusionMap.wrapT = ClampToEdgeWrapping;\n\n\t\t// material\n\n\t\tconst geometry = Lensflare.Geometry;\n\n\t\tconst material1a = new RawShaderMaterial( {\n\t\t\tuniforms: {\n\t\t\t\t'scale': { value: null },\n\t\t\t\t'screenPosition': { value: null }\n\t\t\t},\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );\n\n\t\t\t\t}`,\n\t\t\tdepthTest: true,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: false\n\t\t} );\n\n\t\tconst material1b = new RawShaderMaterial( {\n\t\t\tuniforms: {\n\t\t\t\t'map': { value: tempMap },\n\t\t\t\t'scale': { value: null },\n\t\t\t\t'screenPosition': { value: null }\n\t\t\t},\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\t\t\t\tattribute vec2 uv;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUV = uv;\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform sampler2D map;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = texture2D( map, vUV );\n\n\t\t\t\t}`,\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: false\n\t\t} );\n\n\t\t// the following object is used for occlusionMap generation\n\n\t\tconst mesh1 = new Mesh( geometry, material1a );\n\n\t\t//\n\n\t\tconst elements = [];\n\n\t\tconst shader = LensflareElement.Shader;\n\n\t\tconst material2 = new RawShaderMaterial( {\n\t\t\tuniforms: {\n\t\t\t\t'map': { value: null },\n\t\t\t\t'occlusionMap': { value: occlusionMap },\n\t\t\t\t'color': { value: new Color( 0xffffff ) },\n\t\t\t\t'scale': { value: new Vector2() },\n\t\t\t\t'screenPosition': { value: new Vector3() }\n\t\t\t},\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tblending: AdditiveBlending,\n\t\t\ttransparent: true,\n\t\t\tdepthWrite: false\n\t\t} );\n\n\t\tconst mesh2 = new Mesh( geometry, material2 );\n\n\t\tthis.addElement = function ( element ) {\n\n\t\t\telements.push( element );\n\n\t\t};\n\n\t\t//\n\n\t\tconst scale = new Vector2();\n\t\tconst screenPositionPixels = new Vector2();\n\t\tconst validArea = new Box2();\n\t\tconst viewport = new Vector4();\n\n\t\tthis.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\trenderer.getCurrentViewport( viewport );\n\n\t\t\tconst invAspect = viewport.w / viewport.z;\n\t\t\tconst halfViewportWidth = viewport.z / 2.0;\n\t\t\tconst halfViewportHeight = viewport.w / 2.0;\n\n\t\t\tlet size = 16 / viewport.w;\n\t\t\tscale.set( size * invAspect, size );\n\n\t\t\tvalidArea.min.set( viewport.x, viewport.y );\n\t\t\tvalidArea.max.set( viewport.x + ( viewport.z - 16 ), viewport.y + ( viewport.w - 16 ) );\n\n\t\t\t// calculate position in screen space\n\n\t\t\tpositionView.setFromMatrixPosition( this.matrixWorld );\n\t\t\tpositionView.applyMatrix4( camera.matrixWorldInverse );\n\n\t\t\tif ( positionView.z > 0 ) return; // lensflare is behind the camera\n\n\t\t\tpositionScreen.copy( positionView ).applyMatrix4( camera.projectionMatrix );\n\n\t\t\t// horizontal and vertical coordinate of the lower left corner of the pixels to copy\n\n\t\t\tscreenPositionPixels.x = viewport.x + ( positionScreen.x * halfViewportWidth ) + halfViewportWidth - 8;\n\t\t\tscreenPositionPixels.y = viewport.y + ( positionScreen.y * halfViewportHeight ) + halfViewportHeight - 8;\n\n\t\t\t// screen cull\n\n\t\t\tif ( validArea.containsPoint( screenPositionPixels ) ) {\n\n\t\t\t\t// save current RGB to temp texture\n\n\t\t\t\trenderer.copyFramebufferToTexture( screenPositionPixels, tempMap );\n\n\t\t\t\t// render pink quad\n\n\t\t\t\tlet uniforms = material1a.uniforms;\n\t\t\t\tuniforms[ 'scale' ].value = scale;\n\t\t\t\tuniforms[ 'screenPosition' ].value = positionScreen;\n\n\t\t\t\trenderer.renderBufferDirect( camera, null, geometry, material1a, mesh1, null );\n\n\t\t\t\t// copy result to occlusionMap\n\n\t\t\t\trenderer.copyFramebufferToTexture( screenPositionPixels, occlusionMap );\n\n\t\t\t\t// restore graphics\n\n\t\t\t\tuniforms = material1b.uniforms;\n\t\t\t\tuniforms[ 'scale' ].value = scale;\n\t\t\t\tuniforms[ 'screenPosition' ].value = positionScreen;\n\n\t\t\t\trenderer.renderBufferDirect( camera, null, geometry, material1b, mesh1, null );\n\n\t\t\t\t// render elements\n\n\t\t\t\tconst vecX = - positionScreen.x * 2;\n\t\t\t\tconst vecY = - positionScreen.y * 2;\n\n\t\t\t\tfor ( let i = 0, l = elements.length; i < l; i ++ ) {\n\n\t\t\t\t\tconst element = elements[ i ];\n\n\t\t\t\t\tconst uniforms = material2.uniforms;\n\n\t\t\t\t\tuniforms[ 'color' ].value.copy( element.color );\n\t\t\t\t\tuniforms[ 'map' ].value = element.texture;\n\t\t\t\t\tuniforms[ 'screenPosition' ].value.x = positionScreen.x + vecX * element.distance;\n\t\t\t\t\tuniforms[ 'screenPosition' ].value.y = positionScreen.y + vecY * element.distance;\n\n\t\t\t\t\tsize = element.size / viewport.w;\n\t\t\t\t\tconst invAspect = viewport.w / viewport.z;\n\n\t\t\t\t\tuniforms[ 'scale' ].value.set( size * invAspect, size );\n\n\t\t\t\t\tmaterial2.uniformsNeedUpdate = true;\n\n\t\t\t\t\trenderer.renderBufferDirect( camera, null, geometry, material2, mesh2, null );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\tmaterial1a.dispose();\n\t\t\tmaterial1b.dispose();\n\t\t\tmaterial2.dispose();\n\n\t\t\ttempMap.dispose();\n\t\t\tocclusionMap.dispose();\n\n\t\t\tfor ( let i = 0, l = elements.length; i < l; i ++ ) {\n\n\t\t\t\telements[ i ].texture.dispose();\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n}\n\nLensflare.prototype.isLensflare = true;\n\n//\n\nclass LensflareElement {\n\n\tconstructor( texture, size = 1, distance = 0, color = new Color( 0xffffff ) ) {\n\n\t\tthis.texture = texture;\n\t\tthis.size = size;\n\t\tthis.distance = distance;\n\t\tthis.color = color;\n\n\t}\n\n}\n\nLensflareElement.Shader = {\n\n\tuniforms: {\n\n\t\t'map': { value: null },\n\t\t'occlusionMap': { value: null },\n\t\t'color': { value: null },\n\t\t'scale': { value: null },\n\t\t'screenPosition': { value: null }\n\n\t},\n\n\tvertexShader: /* glsl */`\n\n\t\tprecision highp float;\n\n\t\tuniform vec3 screenPosition;\n\t\tuniform vec2 scale;\n\n\t\tuniform sampler2D occlusionMap;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvUV = uv;\n\n\t\t\tvec2 pos = position.xy;\n\n\t\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\n\t\t\tvVisibility =        visibility.r / 9.0;\n\t\t\tvVisibility *= 1.0 - visibility.g / 9.0;\n\t\t\tvVisibility *=       visibility.b / 9.0;\n\n\t\t\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n\n\t\t}`,\n\n\tfragmentShader: /* glsl */`\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D map;\n\t\tuniform vec3 color;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texture = texture2D( map, vUV );\n\t\t\ttexture.a *= vVisibility;\n\t\t\tgl_FragColor = texture;\n\t\t\tgl_FragColor.rgb *= color;\n\n\t\t}`\n\n};\n\nLensflare.Geometry = ( function () {\n\n\tconst geometry = new BufferGeometry();\n\n\tconst float32Array = new Float32Array( [\n\t\t- 1, - 1, 0, 0, 0,\n\t\t1, - 1, 0, 1, 0,\n\t\t1, 1, 0, 1, 1,\n\t\t- 1, 1, 0, 0, 1\n\t] );\n\n\tconst interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\n\n\tgeometry.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\n\tgeometry.setAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\n\tgeometry.setAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\n\n\treturn geometry;\n\n} )();\n\nexport { Lensflare, LensflareElement };\n"],"names":["Controller","constructor","parent","object","property","className","widgetTag","this","_disabled","initialValue","getValue","domElement","document","createElement","classList","add","$name","nextNameID","id","$widget","$disable","appendChild","children","push","controllers","$children","_listenCallback","bind","name","_name","innerHTML","onChange","callback","_onChange","_callOnChange","undefined","call","_changed","onFinishChange","_onFinishChange","_callOnFinishChange","reset","setValue","enable","enabled","disable","disabled","toggle","toggleAttribute","options","controller","destroy","min","max","step","listen","_listening","_listenCallbackID","cancelAnimationFrame","requestAnimationFrame","updateDisplay","value","load","save","splice","indexOf","removeChild","_captureKeyEvents","el","addEventListener","e","stopPropagation","BooleanController","super","$input","setAttribute","checked","normalizeColorString","string","match","result","parseInt","toString","padStart","STRING","isPrimitive","v","fromHexString","toHexString","INT","substring","ARRAY","Array","isArray","target","rgbScale","int","r","g","b","OBJECT","Object","FORMATS","ColorController","$text","$display","_format","find","format","_rgbScale","_initialValueHexString","_textFocused","_setValueFromHexString","tryParse","select","newValue","style","backgroundColor","FunctionController","$button","preventDefault","NumberController","_initInput","stepExplicit","_getImplicitStep","_min","_onUpdateMinMax","_max","explicit","_step","_stepExplicit","_hasSlider","percent","Math","$fill","width","_inputFocused","increment","delta","parseFloat","isNaN","_snapClampSetValue","initClientX","initClientY","prevClientY","initValue","dragDelta","testingForVerticalDrag","onMouseMove","dx","clientX","dy","clientY","abs","blur","_setDraggingStyle","onMouseUp","_arrowKeyMultiplier","window","removeEventListener","_clamp","code","_normalizeMouseWheel","_initSlider","$slider","insertBefore","setValueFromX","rect","getBoundingClientRect","a","left","right","c","d","mouseMove","mouseUp","prevClientX","testingForScroll","beginTouchDrag","touches","onTouchMove","onTouchEnd","callOnFinishChange","wheelFinishChangeTimeout","length","_hasScrollBar","deltaX","deltaY","clearTimeout","setTimeout","active","axis","body","_hasMin","_hasMax","floor","wheelDelta","mult","shiftKey","altKey","_snap","round","toPrecision","root","scrollHeight","clientHeight","OptionController","$select","_values","values","_names","keys","forEach","$option","selectedIndex","remove","index","StringController","stylesInjected","GUI","autoPlace","container","title","injectStyles","touchStyles","folders","_closed","$title","openAnimated","click","cssContent","injected","before","querySelector","head","_injectStyles","setProperty","$1","console","error","addColor","addFolder","obj","recursive","f","_title","Error","open","close","initialHeight","height","onTransitionEnd","targetHeight","controllersRecursive","parentElement","from","concat","foldersRecursive","_plane","_raycaster","_pointer","_offset","_intersection","_worldPosition","_inverseMatrix","DragControls","_objects","_camera","_domElement","touchAction","_selected","_hovered","_intersections","scope","activate","onPointerMove","onPointerDown","onPointerCancel","deactivate","cursor","event","updatePointer","setFromCamera","ray","intersectPlane","position","copy","sub","applyMatrix4","dispatchEvent","type","pointerType","intersectObjects","setFromNormalAndCoplanarPoint","getWorldDirection","normal","setFromMatrixPosition","matrixWorld","transformGroup","invert","x","y","top","dispose","getObjects","getRaycaster","_changeEvent","_startEvent","_endEvent","OrbitControls","warn","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MIDDLE","ONE","TWO","target0","clone","position0","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","getDistance","distanceTo","listenToKeyEvents","onKeyDown","saveState","updateProjectionMatrix","update","state","STATE","NONE","offset","quat","setFromUnitVectors","up","quatInverse","lastPosition","lastQuaternion","twoPI","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","isFinite","makeSafe","radius","scale","addScaledVector","panOffset","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","onContextMenu","onMouseWheel","onPointerUp","ROTATE","DOLLY","PAN","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","pointers","pointerPositions","getZoomScale","pow","angle","rotateUp","panLeft","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","element","isPerspectiveCamera","targetDistance","tan","fov","matrix","isOrthographicCamera","clientWidth","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","sqrt","handleTouchMoveRotate","getSecondPointerPosition","subVectors","handleTouchMovePan","handleTouchMoveDolly","setPointerCapture","pointerId","addPointer","trackPointer","onTouchStart","mouseAction","button","handleMouseDownDolly","ctrlKey","metaKey","onMouseDown","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","removePointer","releasePointerCapture","handleMouseWheel","needsUpdate","handleKeyDown","i","pointer","passive","ch2","durl","URL","createObjectURL","Blob","cwk","u","Worker","revokeObjectURL","encodeURI","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","start","j","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","s","l","co","le","rvb","sv","r_1","m","flt","fdt","flm","flrm","fdm","fdrm","bits","p","o","bits16","shft","slc","n","subarray","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","pos","bt","lm","dm","lbt","dbt","tbts","t","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","end","wbits","wbits16","hTree","t2","slice","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","w","clen","cf","wfblk","out","wblk","syms","lf","df","li","bs","dlt","mlb","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","ll","dl","flen","ftlen","dtlen","llm","lcts","it","clct","len","dst","deo","dflt","lvl","plvl","pre","post","lst","ceil","opt","msk_1","prev","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","ti","lin","din","crct","k","crc","cr","adler","dopt","level","mem","log","mrg","wcln","fn","fnStr","td","ks","lastIndexOf","replace","split","st_1","prototype","spInd","ch","wrkr","fns","init","cb","td_1","msg","transfer","onerror","onmessage","data","postMessage","wk","buffer","cbfs","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","size","cbify","opts","err","terminate","consume","astrm","strm","ondata","ev","astrmify","b2","b4","b8","filename","mtime","Date","now","charCodeAt","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","apply","arguments","AsyncDecompress","decompress","decompressSync","fltn","val","te","TextEncoder","TextDecoder","tds","decode","stream","dutf8","String","fromCharCode","DecodeUTF8","np","EncodeUTF8","strToU8","str","latin1","ar_1","encode","ar","ai","strFromU8","dbf","slzh","zh","z","fnl","es","z64e","sc","su","off","exfl","ex","wzh","ce","extra","col","exl","os","flag","compression","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","attrs","exf","wzf","ZipPassThrough","process","ZipDeflate","AsyncZipDeflate","Zip","file","com","comment","hl","header","chks","pAll","_i","chks_1","chk","ind","uf","nxt","dd","zip","tot","slft","files","term","tAll","cbf","oe","cdl","badd","loc","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","sz","Unzip","onfile","toAdd","is","oc","_loop_2","sig","this_1","bf","cmp_1","chks_2","unshift","d_1","sc_1","su_1","fn_1","file_1","ctr","chks_3","originalSize","register","decoder","unzip","_loop_3","c_1","no","infl","unzipSync","c_2","findSpan","U","low","high","mid","calcBasisFunctions","span","N","saved","rv","temp","calcKoverI","nom","denom","calcNURBSDerivatives","P","nd","Pders","Aders","wders","point","CK","divideScalar","calcRationalCurveDerivatives","du","nders","zeroArr","ders","ndu","s1","s2","rk","pk","j2","calcBasisFunctionDerivatives","Pw","calcBSplineDerivatives","NURBSCurve","degree","knots","controlPoints","startKnot","endKnot","getPoint","optionalTarget","hpoint","C","Nj","wNj","getTangent","tangent","normalize","fbxTree","connections","sceneGraph","FBXLoader","manager","url","onLoad","onProgress","onError","path","loader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","parse","itemError","FBXBuffer","CORRECT","byteLength","convertArrayBufferToString","isFbxFormatBinary","BinaryParser","FBXText","text","read","isFbxFormatASCII","getFbxVersion","TextParser","textureLoader","resourcePath","setCrossOrigin","crossOrigin","FBXTreeParser","parseConnections","images","parseImages","textures","parseTextures","materials","parseMaterials","deformers","parseDeformers","geometryMap","GeometryParser","parseScene","connectionMap","Map","Connections","rawConnection","fromID","toID","relationship","has","parents","parentRelationship","ID","get","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","base64Content","image","parseImage","pop","content","fileName","extension","toLowerCase","getHandler","array","textureMap","textureNodes","Texture","texture","parseTexture","textureNode","loadTexture","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","wrapS","wrapT","Scaling","repeat","currentPath","FileName","materialMap","materialNodes","Material","material","parseMaterial","materialNode","ShadingModel","parameters","parseParameters","setValues","BumpFactor","bumpScale","Diffuse","color","fromArray","DiffuseColor","DisplacementFactor","displacementScale","Emissive","emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","Opacity","opacity","transparent","ReflectionFactor","reflectivity","Shininess","shininess","Specular","specular","SpecularColor","child","bumpMap","getTexture","aoMap","map","encoding","displacementMap","emissiveMap","normalMap","envMap","mapping","specularMap","alphaMap","LayeredTexture","skeletons","morphTargets","DeformerNodes","Deformer","deformerNode","relationships","attrType","skeleton","parseSkeleton","geometryID","morphTarget","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","indices","weights","transformLink","TransformLink","Indexes","Weights","bones","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","filter","modelMap","parseModels","modelNodes","Model","model","modelNode","setLookAtProperties","connection","bindSkeleton","createAmbientLight","traverse","node","userData","transformData","parentMatrix","parentMatrixWorld","transform","generateTransform","updateWorldMatrix","animations","AnimationParser","isGroup","buildSkeleton","createCamera","createLight","createMesh","createCurve","getTransformData","bone","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","innerWidth","innerHeight","AspectWidth","AspectHeight","aspect","FieldOfView","focalLength","FocalLength","setFocalLength","lightAttribute","LightType","Color","intensity","Intensity","CastLightOnObject","FarAttenuationEnd","EnableFarAttenuation","decay","InnerAngle","penumbra","OuterAngle","CastShadows","castShadow","geometry","attributes","vertexColors","FBX_Deformer","normalizeSkinWeights","reduce","geo","linewidth","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","translation","Lcl_Translation","preRotation","PreRotation","rotation","Lcl_Rotation","postRotation","PostRotation","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","bindMatrices","parsePoseNodes","geoConnParent","BindPoseNode","Pose","NbPoseNodes","poseNodes","PoseNode","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","vertex","colors","weightsIndices","vertexWeights","normalMatrix","getNormalMatrix","normalAttribute","applyNormalMatrix","uvs","uvBuffer","mappingType","prevMaterialIndex","materialIndex","startIndex","currentIndex","addGroup","groups","lastGroup","lastIndex","count","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","uv","UV","parseUVs","weightTable","weight","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","tmp","genFace","parentGeo","parentGeoNode","morphTargetsRelative","morphAttributes","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphPositions","Float32Array","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","order","Order","KnotVector","pointsValues","Points","Form","points","getPoints","setFromPoints","animationClips","rawClips","parseClips","key","rawClip","clip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","curveNode","curves","rawCurves","animationCurve","times","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","tracks","rawTracks","generateTracks","decompose","toArray","setFromQuaternion","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","setFromEuler","euler","quaternionValues","premultiply","multiply","morphNum","getObjectByName","morphTargetDictionary","targetIndex","lastValue","currentValue","prevValue","xIndex","yIndex","zIndex","time","xValue","yValue","zValue","curve","valuesSpan","absoluteSpan","numSubIntervals","nextValue","initialTime","interval","nextTime","interpolatedTimes","interpolatedValues","inject","getPrevNode","nodeStack","currentIndent","getCurrentNode","getCurrentProp","currentProp","pushStack","popStack","setCurrentProp","currentPropName","allNodes","FBXTree","line","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","parseNodePropertyContinued","nodeName","trim","nodeAttrs","parseNodeAttr","currentNode","contentLine","propName","propValue","connProps","to","rest","elem","append","parseNumberArray","parseNodeSpecialProperty","props","prop","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","reader","BinaryReader","skip","version","getUint32","endOfContent","parseNode","getOffset","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","reader2","littleEndian","dv","DataView","nullByte","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","setPosition","makeRotationFromEuler","lLRM","lParentGRM","extractRotation","lParentTM","copyPosition","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM_inv","setFromMatrixScale","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","a1","a2","GLTFLoader","dracoLoader","ktx2Loader","meshoptDecoder","pluginCallbacks","parser","GLTFMaterialsClearcoatExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsSpecularExtension","GLTFLightsExtension","GLTFMeshoptCompression","itemStart","_onError","itemEnd","gltf","setDRACOLoader","setDDSLoader","setKTX2Loader","setMeshoptDecoder","unregister","extensions","plugins","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","GLTFParser","fileLoader","plugin","extensionsUsed","extensionName","extensionsRequired","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","setExtensions","setPlugins","parseAsync","Promise","resolve","reject","GLTFRegistry","objects","removeAll","KHR_LIGHTS_PUNCTUAL","KHR_MATERIALS_CLEARCOAT","KHR_MATERIALS_IOR","KHR_MATERIALS_SHEEN","KHR_MATERIALS_SPECULAR","KHR_MATERIALS_TRANSMISSION","KHR_MATERIALS_VOLUME","KHR_TEXTURE_BASISU","EXT_TEXTURE_WEBP","EXT_MESHOPT_COMPRESSION","cache","refs","uses","_markDefs","nodeDefs","nodes","nodeIndex","nodeLength","nodeDef","light","_addNodeRef","_loadLight","lightIndex","cacheKey","dependency","lightDef","lights","lightNode","range","spot","innerConeAngle","outerConeAngle","createUniqueName","createNodeAttachment","self","then","_getNodeRef","getMaterialType","extendParams","materialParams","materialDef","pending","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","all","extendMaterialParams","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","sheenColor","sheenRoughness","sheen","sheenColorFactor","sheenRoughnessFactor","sheenColorTexture","sheenRoughnessTexture","transmissionFactor","transmission","transmissionTexture","thickness","thicknessFactor","thicknessTexture","attenuationDistance","colorArray","attenuationColor","ior","specularIntensity","specularFactor","specularTexture","specularColorFactor","specularColor","specularColorTexture","textureIndex","textureDef","source","loadTextureImage","isSupported","uri","handler","detectSupport","Image","src","onload","loadBufferView","bufferView","bufferViews","extensionDef","getDependency","supported","ready","res","byteOffset","stride","byteStride","decodeGltfBuffer","mode","BINARY_EXTENSION_CHUNK_TYPES","headerView","magic","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","preload","decodePrimitive","primitive","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","decodeDracoFile","attribute","extendTexture","texCoord","GLTFMeshStandardSGMaterial","params","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","join","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","setHex","glossiness","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","defineProperties","defines","USE_SPECULARMAP","USE_GLOSSINESSMAP","USE_UV","metalness","roughness","metalnessMap","roughnessMap","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","fog","lightMap","lightMapIntensity","aoMapIntensity","normalMapType","normalScale","displacementBias","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","copySampleValue_","valueSize","beforeStart_","afterEnd_","interpolate_","t0","t1","stride2","stride3","pp","ppp","offset1","offset0","s3","s0","p0","m0","p1","m1","_q","GLTFCubicSplineQuaternionInterpolant","WEBGL_CONSTANTS","Int8Array","Int16Array","WEBGL_FILTERS","WEBGL_WRAPPINGS","WEBGL_TYPE_SIZES","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","INTERPOLATION","CUBICSPLINE","LINEAR","STEP","ALPHA_MODES","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","assign","updateMorphTargets","mesh","meshDef","il","morphTargetInfluences","targetNames","createPrimitiveKey","primitiveDef","dracoExtension","geometryKey","createAttributesKey","attributesKey","getNormalizedComponentScale","associations","primitiveCache","meshCache","cameraCache","lightCache","textureCache","nodeNamesUsed","createImageBitmap","test","navigator","userAgent","_invokeAll","ext","beforeRoot","getDependencies","dependencies","scene","scenes","cameras","afterRoot","catch","skinDefs","skins","meshDefs","meshes","skinIndex","skinLength","joints","isBone","skin","isSkinnedMesh","camera","ref","updateMappings","original","mappings","entries","_invokeOne","func","loadScene","loadNode","loadMesh","loadAccessor","loadBuffer","loadMaterial","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","bufferViewDef","accessorIndex","sparse","pendingBufferViews","itemSize","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","bufferAttribute","ibSlice","ibCacheKey","ib","itemSizeIndices","SCALAR","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setX","setY","setZ","setW","sampler","webkitURL","sourceURI","isObjectURL","blob","mimeType","promise","isImageBitmapLoader","imageBitmap","flipY","samplers","magFilter","minFilter","mapName","mapDef","gltfReference","assignFinalMaterial","useDerivativeTangents","useVertexColors","useFlatShading","isPoints","uuid","pointsMaterial","sizeAttenuation","isLine","lineMaterial","cachedMaterial","flatShading","uv2","materialType","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","side","alphaMode","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","originalName","sanitizedName","loadGeometries","primitives","createDracoPrimitive","addPrimitiveAttributes","cached","geometryPromise","meshIndex","depthTest","results","geometries","skinWeight","toTrianglesDrawMode","group","cameraIndex","cameraDef","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","accessor","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","input","output","inputAccessors","outputAccessors","targets","inputAccessor","outputAccessor","TypedKeyframeTrack","updateMatrix","matrixAutoUpdate","targetName","interpolation","outputArray","scaled","jl","track","createInterpolant","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","createNodeMesh","isMesh","meshPromise","sceneIndex","sceneDef","nodeIds","buildNodeHierarchy","reducedAssociations","reduceAssociations","nodeId","parentObject","pendingJoints","jointNodes","boneInverses","jointNode","mat","assignAttributeAccessor","gltfAttributeName","setIndex","box","boxScale","maxDisplacement","vector","expandByVector","boundingBox","sphere","getCenter","center","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphNormals","drawMode","getIndex","getAttribute","numberOfTriangles","newIndices","getX","newGeometry","_object_pattern","_material_library_pattern","_material_use_pattern","_map_use_pattern","_vA","_vB","_vC","_ab","_cb","ParserState","vertices","normals","materialLibraries","startObject","fromDeclaration","previousMaterial","currentMaterial","_finalize","hasUVIndices","smooth","startMaterial","libraries","previous","inherited","groupCount","mtllib","groupStart","groupEnd","cloned","lastMultiMaterial","mi","declared","finalize","parseVertexIndex","parseNormalIndex","parseUVIndex","addVertex","addVertexPoint","addVertexLine","addNormal","addFaceNormal","cross","addUV","addDefaultUV","addUVLine","addFace","ua","ub","uc","na","nb","nc","vLen","ia","ic","nLen","uvLen","addPointGeometry","vi","addLineGeometry","uvi","OBJLoader","setMaterials","lines","lineFirstChar","lineLength","trimLeft","charAt","vertexData","substr","faceVertices","vertexParts","v1","v2","v3","lineParts","lineVertices","lineUVs","llen","parts","pointData","exec","hasVertexColors","buffergeometry","createdMaterials","miLen","sourceMaterial","materialHash","create","materialPoints","materialLine","Lensflare","frustumCulled","renderOrder","positionScreen","positionView","tempMap","occlusionMap","material1a","vertexShader","material1b","mesh1","elements","LensflareElement","Shader","material2","blending","mesh2","addElement","screenPositionPixels","validArea","viewport","onBeforeRender","renderer","getCurrentViewport","invAspect","halfViewportWidth","halfViewportHeight","matrixWorldInverse","projectionMatrix","containsPoint","copyFramebufferToTexture","renderBufferDirect","vecX","vecY","uniformsNeedUpdate","isLensflare","float32Array","interleavedBuffer"],"sourceRoot":""}