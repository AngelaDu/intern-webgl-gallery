"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[362],{362:function(e,t,n){n.r(t),n.d(t,{default:function(){return ge}});var i=n(5893),r=n(7294),s=n(2212);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callbacks={},this.callbacks.base={}}var t,n,i;return t=e,(n=[{key:"on",value:function(e,t){var n=this;return"undefined"===typeof e||""===e?(console.warn("wrong names"),!1):"undefined"===typeof t?(console.warn("wrong callback"),!1):(this.resolveNames(e).forEach((function(e){var i=n.resolveName(e);a(n.callbacks[i.namespace],Object)||(n.callbacks[i.namespace]={}),a(n.callbacks[i.namespace][i.value],Array)||(n.callbacks[i.namespace][i.value]=[]),n.callbacks[i.namespace][i.value].push(t)})),this)}},{key:"off",value:function(e){var t=this;return"undefined"===typeof e||""===e?(console.warn("wrong name"),!1):(this.resolveNames(e).forEach((function(e){var n=t.resolveName(e);if("base"!==n.namespace&&""===n.value)delete t.callbacks[n.namespace];else if("base"===n.namespace)for(var i in t.callbacks)a(t.callbacks[i],Object)&&a(t.callbacks[i][n.value],Array)&&(delete t.callbacks[i][n.value],0===Object.keys(t.callbacks[i]).length&&delete t.callbacks[i]);else a(t.callbacks[n.namespace],Object)&&a(t.callbacks[n.namespace][n.value],Array)&&(delete t.callbacks[n.namespace][n.value],0===Object.keys(t.callbacks[n.namespace]).length&&delete t.callbacks[n.namespace])})),this)}},{key:"trigger",value:function(e,t){if("undefined"===typeof e||""===e)return console.warn("wrong name"),!1;var n=null,i=null,r=a(t,Array)?t:[],s=this.resolveNames(e);if("base"===(s=this.resolveName(s[0])).namespace)for(var o in this.callbacks)a(this.callbacks[o],Object)&&a(this.callbacks[o][s.value],Array)&&this.callbacks[o][s.value].forEach((function(e){i=e.apply(this,r),"undefined"===typeof n&&(n=i)}));else if(a(this.callbacks[s.namespace],Object)){if(""===s.value)return console.warn("wrong name"),this;this.callbacks[s.namespace][s.value].forEach((function(e){i=e.apply(this,r),"undefined"===typeof n&&(n=i)}))}return n}},{key:"resolveNames",value:function(e){var t=e;return t=(t=(t=t.replace(/[^a-zA-Z0-9 ,/.]/g,"")).replace(/[,/]+/g," ")).split(" ")}},{key:"resolveName",value:function(e){var t={},n=e.split(".");return t.original=e,t.value=n[0],t.namespace="base",n.length>1&&""!==n[1]&&(t.namespace=n[1]),t}}])&&o(t.prototype,n),i&&o(t,i),e}();function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}var p=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,e);var t=d(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).width=window.innerWidth,e.height=window.innerHeight,e.pixelRatio=Math.min(window.devicePixelRatio,2),window.addEventListener("resize",(function(){e.width=window.innerWidth,e.height=window.innerHeight,e.pixelRatio=Math.min(window.devicePixelRatio,2),e.trigger("resize")})),e}return n}(c);function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return!t||"object"!==b(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y(e);if(t){var r=y(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m(this,n)}}var x=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(s,e);var t,n,i,r=w(s);function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=r.call(this)).start=Date.now(),e.current=e.start,e.elapsed=0,e.delta=16,window.requestAnimationFrame((function(){e.tick()})),e}return t=s,(n=[{key:"tick",value:function(){var e=this,t=Date.now();this.delta=t-this.current,this.current=t,this.elapsed=this.current-this.start,this.trigger("tick"),window.requestAnimationFrame((function(){e.tick()}))}}])&&v(t.prototype,n),i&&v(t,i),s}(c),M=n(9365);function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P=function(){function e(){var t=this,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.sizes=this.experience.sizes,this.scene=this.experience.scene,this.canvas=this.experience.canvas,this.setInstance(),this.setOrbitControls(),window.addEventListener("keydown",(function(e){"KeyC"===e.code&&(t.controls.enabled=!1)})),window.addEventListener("keyup",(function(e){"KeyC"===e.code&&(n.controls.enabled=!0)}))}var t,n,i;return t=e,(n=[{key:"setInstance",value:function(){this.instance=new s.cPb(35,this.sizes.width/this.sizes.height,.1,1e4),this.instance.position.set(10,5,16),this.scene.add(this.instance)}},{key:"setOrbitControls",value:function(){this.controls=new M.z(this.instance,this.canvas),this.controls.target=new s.Pa4(0,5,0),this.controls.enableDamping=!0}},{key:"resize",value:function(){this.instance.aspect=this.sizes.width/this.sizes.height,this.instance.updateProjectionMatrix()}},{key:"update",value:function(){this.controls.autoRotate=!0,this.controls.autoRotateSpeed=2,this.controls.update()}}])&&k(t.prototype,n),i&&k(t,i),e}();function j(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.canvas=this.experience.canvas,this.sizes=this.experience.sizes,this.scene=this.experience.scene,this.camera=this.experience.camera,this.setInstance()}var t,n,i;return t=e,(n=[{key:"setInstance",value:function(){this.instance=new s.CP7({canvas:this.canvas,antialias:!0}),this.instance.physicallyCorrectLights=!0,this.instance.outputEncoding=s.knz,this.instance.toneMapping=s.YGz,this.instance.toneMappingExposure=1.75,this.instance.shadowMap.enabled=!0,this.instance.shadowMap.type=s.ntZ,this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}},{key:"resize",value:function(){this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}},{key:"update",value:function(){this.instance.render(this.scene,this.camera.instance)}}])&&j(t.prototype,n),i&&j(t,i),e}(),S=n(4294);function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.scene=this.experience.scene,this.resources=this.experience.resources,this.debug=this.experience.debug,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("environment")),this.fogColor="#8789c0",this.scene.fog=new s.ybr(this.fogColor,10,40),this.setPointLight(7,10,0),this.setStudioModel(),this.setEnvironmentMap()}var t,n,i;return t=e,(n=[{key:"setPointLight",value:function(e,t,n){this.pointLight=new s.cek(16772744,1,100,2);var i=new s.xo$(.15,16,8),r=new s.Wid({emissive:16777198,emissiveIntensity:1,color:0});this.pointLight.add(new s.Kj0(i,r)),this.pointLight.position.set(e,t,n),this.pointLight.intensity=250,this.pointLight.castShadow=!0,this.setLensflare(),this.scene.add(this.pointLight)}},{key:"setStudioModel",value:function(){this.studioModel=this.resources.items.studioLights.children.filter((function(e){return"spot_light"===e.name}))[0],this.studioModel.scale.set(.145,.145,.145),this.studioModel.position.set(8,7.4,0),this.studioModel.rotation.set(0,.5*-Math.PI,0),this.scene.add(this.studioModel)}},{key:"setLensflare",value:function(){var e=new S.Z;e.addElement(new S.B(this.resources.items.lensflare0,700,0,this.pointLight.color)),e.addElement(new S.B(this.resources.items.lensflare1,60,.6)),e.addElement(new S.B(this.resources.items.lensflare1,70,.7)),e.addElement(new S.B(this.resources.items.lensflare1,120,.9)),e.addElement(new S.B(this.resources.items.lensflare1,70,1)),this.pointLight.add(e)}},{key:"setEnvironmentMap",value:function(){var e=this;this.environmentMap={},this.environmentMap.intensity=.4,this.environmentMap.texture=this.resources.items.environmentMapTexture,this.scene.environment=this.environmentMap.texture,this.environmentMap.updateMaterials=function(){var t=e;e.scene.traverse((function(e){E(e,s.Kj0)&&E(e.material,s.Wid)&&(e.material.envMap=t.environmentMap.texture,e.material.envMapIntensity=t.environmentMap.intensity,e.material.needsUpdate=!0)}))},this.environmentMap.updateMaterials(),this.debug.active&&(this.debugFolder.add(this.pointLight,"intensity").name("sunLightIntensity").min(0).max(300).step(1),this.debugFolder.add(this.pointLight.position,"x").name("pointLightX").min(-5).max(5).step(.001),this.debugFolder.add(this.pointLight.position,"y").name("pointLightY").min(-5).max(5).step(.001),this.debugFolder.add(this.pointLight.position,"z").name("pointLightZ").min(-5).max(5).step(.001))}}])&&O(t.prototype,n),i&&O(t,i),e}();function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.scene=this.experience.scene,this.resources=this.experience.resources,this.setGeometry(),this.setTextures(),this.setMaterial(),this.setMesh()}var t,n,i;return t=e,(n=[{key:"setGeometry",value:function(){this.geometry=new s.xo$(30,32,32)}},{key:"setTextures",value:function(){this.textures={},this.textures.color="#ffcb47"}},{key:"setMaterial",value:function(){this.material=new s.vBJ(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){L(e,t,n[t])}))}return e}({},this.textures,{side:s._Li}))}},{key:"setMesh",value:function(){this.mesh=new s.Kj0(this.geometry,this.material),this.scene.add(this.mesh)}}])&&_(t.prototype,n),i&&_(t,i),e}();function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.scene=this.experience.scene,this.resources=this.experience.resources,this.physics=this.experience.physics,this.setGeometry(),this.setTextures(),this.setMaterial(),this.setMesh()}var t,n,i;return t=e,(n=[{key:"setGeometry",value:function(){this.geometry=new s.zf8(32,64)}},{key:"setTextures",value:function(){this.textures={},this.textures.map=this.resources.items.cliffAlbedo,this.textures.map.encoding=s.knz,this.textures.map.repeat.set(1.5,1.5),this.textures.map.wrapS=s.rpg,this.textures.map.wrapT=s.rpg,this.textures.displacementMap=this.resources.items.cliffDisplacement,this.textures.displacementMap.repeat.set(1.5,1.5),this.textures.displacementMap.wrapS=s.rpg,this.textures.displacementMap.wrapT=s.rpg,this.textures.normalMap=this.resources.items.cliffNormal,this.textures.normalMap.repeat.set(1.5,1.5),this.textures.normalMap.wrapS=s.rpg,this.textures.normalMap.wrapT=s.rpg,this.textures.roughnessMap=this.resources.items.cliffRoughness,this.textures.roughnessMap.repeat.set(1.5,1.5),this.textures.roughnessMap.wrapS=s.rpg,this.textures.roughnessMap.wrapT=s.rpg}},{key:"setMaterial",value:function(){this.material=new s.Wid(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){F(e,t,n[t])}))}return e}({},this.textures))}},{key:"setMesh",value:function(){this.mesh=new s.Kj0(this.geometry,this.material),this.mesh.rotation.x=.5*-Math.PI,this.mesh.receiveShadow=!0,this.scene.add(this.mesh)}}])&&B(t.prototype,n),i&&B(t,i),e}(),I=n(5892);function W(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function G(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var D=new WeakSet,K=new WeakSet,N=new WeakSet,q=new WeakSet,H=function(){function e(){var t=this,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),D.add(this),K.add(this),N.add(this),q.add(this),this.experience=new me,this.scene=this.experience.scene,this.resources=this.experience.resources,this.canvas=this.experience.canvas,this.camera=this.experience.camera,this.time=this.experience.time,this.debug=this.experience.debug,this.objects=[],this.physics=this.experience.physics,this.vertices=[],this.matrix=new s.yGw,this.color=new s.Ilk,this.mouse=new s.FM8(1,1),this.index=0,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("beads")),this.setGeometry(),this.setMaterial(),W(this,K,$).call(this),this.createMesh(this.resources.items.handModel,.9,.1),this.setDragControls(),window.addEventListener("keydown",(function(e){"KeyC"===e.code&&t.dragControls.activate(),"KeyB"===e.code&&t.createMesh(t.resources.items.handModel,.9,.1),"KeyR"===e.code&&t.resetMesh()})),window.addEventListener("keyup",(function(e){"KeyC"===e.code&&n.dragControls.deactivate()})),this.buttonColor="#eac435",this.buttonColorInactive="#000000",this.meshEventHandler=W(this,N,J).bind(this),this.createMeshButton=document.getElementById("create-mesh"),this.resetMeshEventHandler=W(this,q,U).bind(this),this.resetMeshButton=document.getElementById("reset-mesh"),this.resetMeshButton.addEventListener("click",this.resetMeshEventHandler)}var t,n,i;return t=e,(n=[{key:"setGeometry",value:function(){this.boxGeometry=new s.DvJ(1,1,1,12,12,12),this.planeGeometry=new s._12(2,2,25,25),this.sphereGeometry=new s.xo$(1,32,32)}},{key:"setMaterial",value:function(){this.shaderMaterial=new s.jyz({uniforms:{color:{value:new s.Ilk(16777215)},pointTexture:{value:this.resources.items.beadParticle}},vertexShader:"\nattribute float size;\n\t\t\tattribute vec3 ca;\n\n\t\t\tvarying vec3 vColor;\n\n\t\t\tvoid main() {\n\n\t\t\t\tvColor = ca;\n\n\t\t\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t\tgl_PointSize = size * ( 300.0 / -mvPosition.z );\n\n\t\t\t\tgl_Position = projectionMatrix * mvPosition;\n\n\t\t\t}\n",fragmentShader:"\nuniform vec3 color;\n\t\t\tuniform sampler2D pointTexture;\n\n\t\t\tvarying vec3 vColor;\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec4 color = vec4( color * vColor, 1.0 ) * texture2D( pointTexture, gl_PointCoord );\n\n\t\t\t\tgl_FragColor = color;\n\n\t\t\t}\n",transparent:!0}),this.material=new s.Wid({color:8408433,metalness:1,roughness:0})}},{key:"createSphere",value:function(){var e=new s.Kj0(this.sphereGeometry,this.material);e.position.y=5,e.castShadow=!0,this.scene.add(e),this.objects.push(e)}},{key:"createMesh",value:function(e,t,n,i){for(var r=void 0===t?.15:t,o=void 0===n?.5:n,a=void 0===i?"sphere":i,c=W(this,D,Z).call(this,e,"position"),l=[],u=0;u<c.array.length;u+=3)l.push([c.array[u],c.array[u+1],c.array[u+2]]);if(l.length>1e4)console.log("Model has too many vertices (> 10000)",l.length);else{var h=void 0;h="box"===a?new s.DvJ(o,o,o):new s.xo$(o,10,10),this.mesh=new s.SPe(h,this.material,l.length),this.mesh.instanceMatrix.setUsage(s.dj0);for(var f=new s.yGw,d=new s.Ilk,p=0,v=0,y=0;y<l.length;y++)this.mesh.setMatrixAt(y,f.setPosition(l[y][0],0,l[y][2])),0!==y&&l[y][1]<p&&(p=l[y][1]),0!==y&&l[y][1]>v&&(v=l[y][1]),this.mesh.setColorAt(y,d.setHex(16777215*Math.random()));var m=r*((v-p)/2)-1;console.log({vertices:l.length}),this.vertices=l,this.mesh.scale.set(r,r,r),this.mesh.position.set(0,m,0),this.mesh.castShadow=!0,this.scene.add(this.mesh),this.objects.push(this.mesh)}}},{key:"setDragControls",value:function(){this.dragControls=new I.S(this.objects,this.camera.instance,this.canvas),this.dragControls.deactivate()}},{key:"resetMesh",value:function(){this.dragControls.dispose();var e=!0,t=!1,n=void 0;try{for(var i,r=this.objects[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var s=i.value;this.scene.remove(s)}}catch(o){t=!0,n=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}this.objects=[],this.setDragControls(),this.mesh=null,this.index=0}},{key:"update",value:function(){var e,t=new s.yGw;this.mesh&&this.index<this.vertices.length&&(this.mesh.setMatrixAt(this.index,(e=t).setPosition.apply(e,G(this.vertices[this.index]))),this.mesh.instanceMatrix.needsUpdate=!0,this.index++)}}])&&A(t.prototype,n),i&&A(t,i),e}();function Z(e,t){var n=0;e.traverse((function(e){if(e.isMesh){var i=e.geometry.attributes[t];n+=i.array.length}}));var i=new Float32Array(n),r=0;return e.traverse((function(e){if(e.isMesh){var n=e.geometry.attributes[t];i.set(n.array,r),r+=n.array.length}})),new s.TlE(i,3)}function $(){if(this.debug.active){var e=this,t=this,n=this,i=this,r=this,s={Sphere:function(){e.createSphere()},Mandalorian:function(){t.createMesh(t.resources.items.mandalorianModel)},CoffeeMug:function(){n.createMesh(n.resources.items.coffeeMugModel)},CustomMesh:function(){i.createMesh(i.resources.items.handModel,1,.1,"box")},Reset:function(){r.resetMesh()}};this.debugFolder.add(s,"Sphere"),this.debugFolder.add(s,"Mandalorian"),this.debugFolder.add(s,"CoffeeMug"),this.debugFolder.add(s,"CustomMesh"),this.debugFolder.add(s,"Reset")}}function J(){this.createMesh(this.resources.items.handModel,.9,.1),this.createMeshButton.style.background=this.buttonColorInactive,this.createMeshButton.removeEventListener("click",this.meshEventHandler),this.resetMeshButton.style.background=this.buttonColor,this.resetMeshButton.addEventListener("click",this.resetMeshEventHandler)}function U(){this.resetMesh(),this.resetMeshButton.removeEventListener("click",this.resetMeshEventHandler),this.resetMeshButton.style.background=this.buttonColorInactive,this.createMeshButton.style.background=this.buttonColor,this.createMeshButton.addEventListener("click",this.meshEventHandler)}function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.scene=this.experience.scene,this.resources=this.experience.resources,this.canvas=this.experience.canvas,this.camera=this.experience.camera,this.time=this.experience.time,this.debug=this.experience.debug,this.objects=[],this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("draggable waves")),this.setGeometry(),this.setMaterial(),this.setMesh()}var t,n,i;return t=e,(n=[{key:"setGeometry",value:function(){this.boxGeometry=new s.DvJ(1,1,1,12,12,12),this.planeGeometry=new s._12(2,2,256,256),this.sphereGeometry=new s.xo$(1,32,32)}},{key:"setMaterial",value:function(){this.material=new s.jyz({vertexShader:"\nuniform float uTime;\nuniform float uBigWavesElevation;\nuniform vec2 uBigWavesFrequency;\nuniform float uBigWavesSpeed;\n\nuniform float uSmallWavesElevation;\nuniform float uSmallWavesFrequency;\nuniform float uSmallWavesSpeed;\nuniform float uSmallWavesIterations;\n\nvarying float vElevation;\n\n// Classic Perlin 3D Noise \n// by Stefan Gustavson\n//\nvec4 permute(vec4 x) {\n  return mod(((x * 34.0) + 1.0) * x, 289.0);\n}\nvec4 taylorInvSqrt(vec4 r) {\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t) {\n  return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n\nfloat cnoise(vec3 P) {\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod(Pi0, 289.0);\n  Pi1 = mod(Pi1, 289.0);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 / 7.0;\n  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 / 7.0;\n  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n  vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n  vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n  vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n  vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n  vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n  vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n  vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n\nvoid main() {\n  vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n\n  float elevation = sin(modelPosition.x * uBigWavesFrequency.x + uTime * uBigWavesSpeed) * sin(modelPosition.z * uBigWavesFrequency.y + uTime * uBigWavesSpeed) * uBigWavesElevation;\n\n  for(float i = 1.0; i <= uSmallWavesIterations; i++) {\n    elevation -= abs(cnoise(vec3(modelPosition.xz * uSmallWavesFrequency * i, uTime * uSmallWavesSpeed)) * uSmallWavesElevation / i);\n  }\n\n  modelPosition.y += elevation;\n\n  vec4 viewPosition = viewMatrix * modelPosition;\n  vec4 projectedPosition = projectionMatrix * viewPosition;\n\n  gl_Position = projectedPosition;\n\n  // Varyings\n  vElevation = elevation;\n}\n",fragmentShader:"\nuniform vec3 uDepthColor;\nuniform vec3 uSurfaceColor;\nuniform float uColorOffset;\nuniform float uColorMultiplier;\n\nvarying float vElevation;\n\nvoid main() {\n  float mixStrength = (vElevation + uColorOffset) * uColorMultiplier;\n  vec3 color = mix(uDepthColor, uSurfaceColor, mixStrength);\n  gl_FragColor = vec4(color, 1.0);\n\n}\n",uniforms:{uTime:{value:0},uBigWavesElevation:{value:.1},uBigWavesFrequency:{value:new s.FM8(1,1)},uBigWavesSpeed:{value:.75},uSmallWavesElevation:{value:.15},uSmallWavesFrequency:{value:3},uSmallWavesSpeed:{value:.2},uSmallWavesIterations:{value:4},uDepthColor:{value:new s.Ilk("#C02156")},uSurfaceColor:{value:new s.Ilk("#35FF69")},uColorOffset:{value:.08},uColorMultiplier:{value:5}}})}},{key:"createBox",value:function(){var e=new s.Kj0(this.boxGeometry,this.material);e.position.y=.6,e.castShadow=!0,this.scene.add(e),this.objects.push(e)}},{key:"createPlane",value:function(){var e=new s.Kj0(this.planeGeometry,this.material);e.rotation.x=.5*-Math.PI,e.position.y=.6,e.castShadow=!0,this.scene.add(e),this.objects.push(e)}},{key:"createSphere",value:function(){var e=new s.Kj0(this.sphereGeometry,this.material);e.position.y=.6,e.castShadow=!0,this.scene.add(e),this.objects.push(e)}},{key:"setMesh",value:function(){if(this.debug.active){var e=this,t=this,n=this,i=this,r={Box:function(){e.createBox()},Plane:function(){t.createPlane()},Sphere:function(){n.createSphere()},Reset:function(){var e=!0,t=!1,n=void 0;try{for(var r,s=i.objects[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value;i.scene.remove(o)}}catch(a){t=!0,n=a}finally{try{e||null==s.return||s.return()}finally{if(t)throw n}}i.objects=[]}};this.debugFolder.add(r,"Box"),this.debugFolder.add(r,"Plane"),this.debugFolder.add(r,"Sphere"),this.debugFolder.add(r,"Reset")}}},{key:"update",value:function(){this.material.uniforms.uTime.value=.001*this.time.elapsed}}])&&V(t.prototype,n),i&&V(t,i),e}();function X(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Q=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experience=new me,this.scene=this.experience.scene,this.resources=this.experience.resources,this.resources.on("ready",(function(){t.background=new T,t.floor=new R,t.beads=new H,t.waves=new Y,t.environment=new C}))}var t,n,i;return t=e,(n=[{key:"update",value:function(){this.beads&&this.beads.update(),this.waves&&this.waves.update()}}])&&X(t.prototype,n),i&&X(t,i),e}(),ee=n(1217),te=n(7011),ne=n(1411);function ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e,t){return!t||"object"!==ae(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ae=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=re(e);if(t){var r=re(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return se(this,n)}}var le=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(o,e);var t,n,i,r=ce(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).sources=e,t.items={},t.toLoad=t.sources.length,t.loaded=0,t.setLoaders(),t.startLoading(),t}return t=o,(n=[{key:"setLoaders",value:function(){this.loaders={},this.loaders.gltfLoader=new ee.E,this.loaders.objLoader=new te.L,this.loaders.fbxLoader=new ne.y,this.loaders.textureLoader=new s.dpR,this.loaders.cubeTextureLoader=new s.cBK}},{key:"startLoading",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this,s=function(e,t){var n=t.value;if("gltfModel"===n.type){var i=r;r.loaders.gltfLoader.load(n.path,(function(e){i.sourceLoaded(n,e)}))}else if("objModel"===n.type){var s=r;r.loaders.objLoader.load(n.path,(function(e){s.sourceLoaded(n,e)}))}else if("fbxModel"===n.type){var o=r;r.loaders.fbxLoader.load(n.path,(function(e){o.sourceLoaded(n,e)}))}else if("texture"===n.type){var a=r;r.loaders.textureLoader.load(n.path,(function(e){a.sourceLoaded(n,e)}))}else if("cubeTexture"===n.type){var c=r;r.loaders.cubeTextureLoader.load(n.path,(function(e){c.sourceLoaded(n,e)}))}},o=this.sources[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)s(0,i)}catch(a){t=!0,n=a}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"sourceLoaded",value:function(e,t){this.items[e.name]=t,this.loaded++,this.loaded===this.toLoad&&this.trigger("ready")}}])&&ie(t.prototype,n),i&&ie(t,i),o}(c),ue=n(7637);var he=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.active="#debug"===window.location.hash,this.active&&(this.ui=new ue.ZP)},fe=n(6698),de="".concat(fe.FH,"/assets/static-alastair/"),pe=[{name:"cliffAlbedo",type:"texture",path:"".concat(de,"textures/cliff/cliff_Albedo.jpg")},{name:"cliffDisplacement",type:"texture",path:"".concat(de,"textures/cliff/cliff_Displacement.jpg")},{name:"cliffNormal",type:"texture",path:"".concat(de,"textures/cliff/cliff_Normal.jpg")},{name:"cliffRoughness",type:"texture",path:"".concat(de,"textures/cliff/cliff_Roughness.jpg")},{name:"beadParticle",type:"texture",path:"".concat(de,"textures/beads/disc.png")},{name:"lensflare0_Alpha",type:"texture",path:"".concat(de,"textures/lensflare/lensflare0_alpha.png")},{name:"lensflare0",type:"texture",path:"".concat(de,"textures/lensflare/lensflare0.png")},{name:"lensflare1",type:"texture",path:"".concat(de,"textures/lensflare/lensflare1.png")},{name:"handModel",type:"objModel",path:"".concat(de,"models/hand/hand.obj")},{name:"studioLights",type:"fbxModel",path:"".concat(de,"models/studio_lights.fbx")},{name:"coffeeMugModel",type:"objModel",path:"".concat(de,"models/coffeeMug1_free_obj/coffeeMug.obj")},{name:"mandalorianModel",type:"objModel",path:"".concat(de,"models/mandalorian.obj")},{name:"skullModel",type:"objModel",path:"".concat(de,"models/skull.obj")},{name:"teapotModel",type:"objModel",path:"".concat(de,"models/teapot.obj")},{name:"maleHeadModel",type:"objModel",path:"".concat(de,"models/male_head.obj")},{name:"tvModel",type:"objModel",path:"".concat(de,"models/tv.obj")},{name:"environmentMapTexture",type:"cubeTexture",path:["".concat(de,"textures/envMap/0/px.jpg"),"".concat(de,"textures/envMap/0/nx.jpg"),"".concat(de,"textures/envMap/0/py.jpg"),"".concat(de,"textures/envMap/0/ny.jpg"),"".concat(de,"textures/envMap/0/pz.jpg"),"".concat(de,"textures/envMap/0/nz.jpg")]}];function ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ye=null,me=function(){function e(t,n){var i=void 0!==n&&n,r=this,o=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ye&&!1===i)return ye;ye=this,this.canvas=t,this.debug=new he,this.sizes=new p,this.time=new x,this.scene=new s.xsS,this.resources=new le(pe),this.camera=new P,this.renderer=new z,this.world=new Q,this.sizes.on("resize",(function(){r.resize()})),this.time.on("tick",(function(){o.update()}))}var t,n,i;return t=e,(n=[{key:"resize",value:function(){this.camera.resize(),this.renderer.resize()}},{key:"update",value:function(){this.camera.update(),this.world.update(),this.renderer.update()}},{key:"destroy",value:function(){this.sizes.off("resize"),this.time.off("tick"),this.scene.traverse((function(e){if(i=e,null!=(r=s.Kj0)&&"undefined"!==typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](i):i instanceof r)for(var t in e.geometry.dispose(),e.material){var n=e.material[t];n&&"function"===typeof n.dispose&&n.dispose()}var i,r})),this.camera.controls.dispose(),this.renderer.instance.dispose(),this.debug.active&&this.debug.ui.destroy()}}])&&ve(t.prototype,n),i&&ve(t,i),e}();var ge=function(){var e=(0,r.useRef)(null);return(0,r.useEffect)((function(){console.log("Creating Artwork Alastair");var t=new me(e.current,!0);return function(){t.destroy(),console.log("Destroying Artwork Alastair")}}),[]),(0,i.jsx)("canvas",{ref:e})}}}]);
//# sourceMappingURL=362-0642aba0c2dcb1b8.js.map